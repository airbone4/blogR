<!DOCTYPE html>
<html><head>
  <title>simulation_1</title>  
      
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href='../../images/favicon.ico'/>
      
    <link href="../../css/atom-one-dark-reasonable.css?1634789915" rel="stylesheet">
    <link href="../../css/syntax.css?1634789915" rel="stylesheet">
    <script src="../../js/jquery-3.3.1.min.js?1634789915"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
    <script src='../../js/datatables.min.js'></script>    
    <link href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css" rel="stylesheet">    
    
    <link href="../../css/fontawesome-all.min.css?1634789915" rel="stylesheet">
    
    <link href="../../css/theme-mine.css?1634789915" rel="stylesheet">
    
    <link href="../../css/theme.css?1634789915" rel="stylesheet">
    
    
    <link rel="stylesheet" href="../../scss/notice.9533fa19b2db5be8a6e0b7e9e8e77f6ec4639fd599c204f25dfd15dca5c9e22c.css" integrity="sha256-lTP6GbLbW&#43;im4Lfp6Od/bsRjn9WZwgTyXf0V3KXJ4iw=">

    
  </head><body><div id="top-pane" class="navbar  fixed-top ">
  <div class="container-fluid">
  <span >
    <a  href='../../' class="fs-5 accessory"><i class="fas fa-home"></i>R in Class</a>
    <span id="sidebar-toggle-span" class="fs-5"><i class="fas fa-align-justify"></i></span>
  </span><span >
      <span id="toc-menu">
    <label><i class="fas fa-list-alt" ></i> </label>    
<div id="variant-toc-content" >
    <div class="wrapper">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#均勻分配抽樣">均勻分配抽樣</a></li>
    <li><a href="#sampling-from-a-normal-distribution">Sampling from a normal distribution</a></li>
    <li><a href="#simulating-a-coin-toss">Simulating a coin toss</a></li>
    <li><a href="#t-test">t-test</a>
      <ul>
        <li><a href="#simulating-a-one-sample-t-test">Simulating a one-sample t-test</a></li>
        <li><a href="#獨立樣本的t-testindependent-samples-t-test---two-groups-between-subjects">獨立樣本的t-test(independent samples t-test - two groups, between-subjects</a></li>
        <li><a href="#成對樣本paired-samples的t檢定t-test-two-conditions-within-subjects">成對樣本(paired samples)的t檢定t-test (two conditions, within-subjects)</a></li>
      </ul>
    </li>
    <li><a href="#generality-of-the-t-test-examples">Generality of the t-test examples</a></li>
    <li><a href="#formatting-data-in-r-for-more-complex-designs">Formatting data in R for more complex designs</a></li>
    <li><a href="#single-factor-anovas-data-simulation-and-analysis">Single Factor ANOVAs: Data-Simulation and Analysis</a>
      <ul>
        <li><a href="#simulating-data-for-a-one-way-within-subjects-anova-with-3-levels">Simulating data for a one-way within subjects ANOVA with 3 levels</a></li>
        <li><a href="#simulating-data-for-a-one-way-between-subjects-design-with-3-levels">Simulating data for a one-way between subjects design with 3 levels</a></li>
      </ul>
    </li>
    <li><a href="#using-the-aov-function-for-within-or-between-subjects-designs">Using the aov function for within or between-subjects designs</a>
      <ul>
        <li><a href="#between-subjects-anova-formulas">Between subjects ANOVA formulas</a></li>
        <li><a href="#within-subjects-anova-formulas-all-factors-within">Within subjects ANOVA formulas (all factors within)</a></li>
        <li><a href="#mixed-design-anovas-with-between-and-within-factors">Mixed design ANOVAs with between and within factors</a></li>
      </ul>
    </li>
    <li><a href="#simulating-data-for-multi-factor-designs">Simulating data for multi-factor designs</a>
      <ul>
        <li><a href="#2x2-between-subjects-design">2x2 between subjects design</a></li>
        <li><a href="#2x2-within-subjects-designs">2x2 within subjects designs</a></li>
        <li><a href="#2x2-mixed-design-1-within-1-between">2x2 mixed design (1 within, 1 between)</a></li>
      </ul>
    </li>
    <li><a href="#power-analysis-and-sample-size-planning-by-monte-carlo-simulation">Power analysis and sample-size planning by Monte Carlo simulation</a>
      <ul>
        <li><a href="#monte-carlo-one-sample-t-test-simulation">Monte-Carlo one-sample T-test Simulation</a></li>
        <li><a href="#monte-carlo-paired-t-test-simulation">Monte-Carlo paired T-test Simulation</a></li>
        <li><a href="#monte-carlo-one-way-repeated-measures-simulation">Monte-Carlo One-way Repeated Measures Simulation</a></li>
      </ul>
    </li>
    <li><a href="#analysing-data-from-a-file">Analysing data from a file</a></li>
    <li><a href="#reading-data-into-r">Reading data into R</a>
      <ul>
        <li><a href="#prettier-results-using-kable-and-broom">Prettier results using kable and broom</a></li>
        <li><a href="#writing-up-the-results">Writing up the results</a></li>
        <li><a href="#writing-up-the-results-section">Writing up the results section</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    <hr class="p-0 m-0" />
    <div class="toa"></div>
</div>
</span>
<span class="fs-5 accessory" data-bs-toggle="tooltip" data-bs-placement="bottom" 
      title='最後修改October 18, 2021'>simulation_1</span>
        
    

    </span>
  
  <span></span><span >
    <span >
    <label for="search-query" id="search-button"><i class="fas fa-search"></i></label>
    <input id="search-query" type="search" placeholder="搜尋" autocomplete="off">
</span>    
 
<div id="search-pane">
 <ol id="search-results"></ul>
</div>

    </span>
</div> 
</div>


<div id="content-wrapper"><nav id="sidebar">

  

    
    
    <ul class="nav flex-column topics" id="home-topics">
      
        
          
          

 


<li class="nav-item" data-bs-toggle="tooltip" title="Rlangs">
     

  <a class="nav-link" 
    href="../../rlang.html"><i class="far fa-folder"></i>Rlangs  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_"  
  class="submenu collapse" 
  data-bs-parent="#home-topics"> 
    

  
  
  
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_0_requirement.html" data-bs-toggle="tooltip" title="1 Requirement">1 Requirement</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_1_%E7%B3%BB%E7%B5%B1.html" data-bs-toggle="tooltip" title="1.1 運作環境">1.1 運作環境</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_2_filesystem.html" data-bs-toggle="tooltip" title="1.2 檔案系統">1.2 檔案系統</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_3_%E5%9F%B7%E8%A1%8C.html" data-bs-toggle="tooltip" title="1.3 執行">1.3 執行</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_4_rpackages.html" data-bs-toggle="tooltip" title="1.4 R Package">1.4 R Package</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/1_5_%E7%B7%A8%E7%A2%BC.html" data-bs-toggle="tooltip" title="1.5 編碼">1.5 編碼</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/2_0_%E8%BC%B8%E5%87%BA%E8%BC%B8%E5%85%A5.html" data-bs-toggle="tooltip" title="2.0 基本輸出輸入">2.0 基本輸出輸入</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/2_1_%E8%AE%80%E6%AA%94%E5%AF%AB%E6%AA%94.html" data-bs-toggle="tooltip" title="2.1 讀檔寫檔">2.1 讀檔寫檔</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/2_2_data_explorer.html" data-bs-toggle="tooltip" title="2.2 資料探索">2.2 資料探索</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/2_3_data_explorer.html" data-bs-toggle="tooltip" title="2.3 data explorer">2.3 data explorer</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/3_quickview1.html" data-bs-toggle="tooltip" title="3. Quick view 1">3. Quick view 1</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/3_01_regular_expression.html" data-bs-toggle="tooltip" title="3.1 Regular expression syntax">3.1 Regular expression syntax</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_1_1_type_%E5%9F%BA%E6%9C%AC.html" data-bs-toggle="tooltip" title="4.1 基本">4.1 基本</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_1_2_type%E7%B7%B4%E7%BF%92.html" data-bs-toggle="tooltip" title="4.1.2 練習">4.1.2 練習</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_2_type_vector.html" data-bs-toggle="tooltip" title="4.2 向量">4.2 向量</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_3_type_matrix.html" data-bs-toggle="tooltip" title="4.3 矩陣">4.3 矩陣</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_4_type_list.html" data-bs-toggle="tooltip" title="4.4 串列 list">4.4 串列 list</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_11_json.html" data-bs-toggle="tooltip" title="4.4.1 json">4.4.1 json</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_5_type_string_function.html" data-bs-toggle="tooltip" title="4.5 字串">4.5 字串</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/4_7_type_more.html" data-bs-toggle="tooltip" title="4.7 更多">4.7 更多</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/5_objectbasic.html" data-bs-toggle="tooltip" title="5 R的物件相關概念">5 R的物件相關概念</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/5_1_%E7%89%A9%E4%BB%B6%E5%B0%8E%E5%90%91s3.html" data-bs-toggle="tooltip" title="5.1 物件導向S3">5.1 物件導向S3</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/6_1_programming.html" data-bs-toggle="tooltip" title="6.1 Programming basic">6.1 Programming basic</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/6_3_apply_family.html" data-bs-toggle="tooltip" title="6.3 function - apply family">6.3 function - apply family</a></li>
    
  
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/9_1_plot.html" data-bs-toggle="tooltip" title="9.1 基本繪圖">9.1 基本繪圖</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/9_2_%E5%A4%9A%E5%9C%96%E7%96%8A%E5%9C%96.html" data-bs-toggle="tooltip" title="9.2 多圖疊圖">9.2 多圖疊圖</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/9_3_plot.html" data-bs-toggle="tooltip" title="9.3 Plot more">9.3 Plot more</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/11_00_sampling.html" data-bs-toggle="tooltip" title="11. sampling">11. sampling</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/11_environments.html" data-bs-toggle="tooltip" title="11 Environments">11 Environments</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/13_0_eco_01_intro.html" data-bs-toggle="tooltip" title="13. Econometrics">13. Econometrics</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/14_00_sim_1.html" data-bs-toggle="tooltip" title="14. simulation 1">14. simulation 1</a></li>
    
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/xxx.html" data-bs-toggle="tooltip" title="xxx">xxx</a></li>
    
  
    
  <li>

 


<li class="nav-item" data-bs-toggle="tooltip" title="暫時">
     

  <a class="nav-link" 
    href="../../rlang/demo.html"><i class="far fa-folder"></i>暫時  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_f03d3d24b564dd9c39af6eb86300021f" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_f03d3d24b564dd9c39af6eb86300021f"  
  class="submenu collapse" 
  data-bs-parent="#menu_item_"> 
    

  
  
  
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/demo/citation.html" data-bs-toggle="tooltip" title="引用">引用</a></li>
    </ul>
  

</li>   
     
  
</li>
    
  <li>

 


<li class="nav-item" data-bs-toggle="tooltip" title="練習用">
     

  <a class="nav-link" 
    href="../../rlang/hw.html"><i class="far fa-folder"></i>練習用  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_b4809f6375b9dda8660e4938c2644e82" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_b4809f6375b9dda8660e4938c2644e82"  
  class="submenu collapse" 
  data-bs-parent="#menu_item_"> 
    

  
  
  
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/hw/hw_basic.html" data-bs-toggle="tooltip" title="assignment-1">assignment-1</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/hw/hw_regexp.html" data-bs-toggle="tooltip" title="regexpr">regexpr</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/hw/hw_filesystem.html" data-bs-toggle="tooltip" title="檔案系統">檔案系統</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/hw/dataset_class.html" data-bs-toggle="tooltip" title="資料集">資料集</a></li>
    </ul>
  

</li>   
     
  
</li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../rlang/resources.html" data-bs-toggle="tooltip" title="練習相關檔案">練習相關檔案</a></li>
    </ul>
  

</li>   
     
  

        
          
          

 


<li class="nav-item" data-bs-toggle="tooltip" title="基礎計量">
     

  <a class="nav-link" 
    href="../../econometrics.html"><i class="far fa-folder"></i>基礎計量  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_c59a6b16a979dae063e00e4a916e3284" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_c59a6b16a979dae063e00e4a916e3284"  
  class="submenu collapse" 
  data-bs-parent="#home-topics"> 
    

  
  
  
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../econometrics/1_t%E6%AA%A2%E5%AE%9A.html" data-bs-toggle="tooltip" title="1.0 t檢定">1.0 t檢定</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../econometrics/2_anova.html" data-bs-toggle="tooltip" title="2. ANOVA">2. ANOVA</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../econometrics/a_a_%E8%B3%87%E6%96%99%E8%99%95%E7%90%86.html" data-bs-toggle="tooltip" title="A.a 資料處理">A.a 資料處理</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../econometrics/a_b_mpg%E7%82%BA%E4%BE%8B%E7%9A%84ggplot.html" data-bs-toggle="tooltip" title="A.b mpg為例的ggplot">A.b mpg為例的ggplot</a></li>
    </ul>
  

</li>   
     
  

        
          
          

 


<li class="nav-item" data-bs-toggle="tooltip" title="專題">
     

  <a class="nav-link" 
    href="../../topic.html"><i class="far fa-folder"></i>專題  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_f7b6d4231ab239a316b7f2d9edf32817" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_f7b6d4231ab239a316b7f2d9edf32817"  
  class="submenu collapse show" 
  data-bs-parent="#home-topics"> 
    

  
  
  
  
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/interesting.html" data-bs-toggle="tooltip" title="interesting">interesting</a></li>
    
  
    
  
    
  <li>

 


<li class="nav-item" data-bs-toggle="tooltip" title="實驗">
     

  <a class="nav-link" 
    href="../../topic/simulation.html"><i class="far fa-folder"></i>實驗  </a>
    <span class="ps-1" data-bs-toggle="collapse" data-bs-target="#menu_item_e617bdc52da54290f99855ac9d5037aa" aria-expanded="false">
      <i class="fas fa-caret-up pairicon-open"></i>
      <i class="fas fa-caret-down pairicon-close"></i>
    </span>
   
  <ul id="menu_item_e617bdc52da54290f99855ac9d5037aa"  
  class="submenu collapse show" 
  data-bs-parent="#menu_item_f7b6d4231ab239a316b7f2d9edf32817"> 
    

  
  
  
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/simulation/bays1.html" data-bs-toggle="tooltip" title="bays1">bays1</a></li>
    
  
        <li class="nav-item active">
          
          <a class="nav-link" href="../../topic/simulation/simulation_1.html" data-bs-toggle="tooltip" title="simulation_1">simulation_1</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/simulation/2_1_%E9%9A%A8%E6%A9%9F%E8%AE%8A%E6%95%B8.html" data-bs-toggle="tooltip" title="2.1 隨機變數">2.1 隨機變數</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/simulation/xx.html" data-bs-toggle="tooltip" title="Inverse Transform Sampling">Inverse Transform Sampling</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/simulation/poisson%E5%88%86%E9%85%8D.html" data-bs-toggle="tooltip" title="Poisson分配">Poisson分配</a></li>
    
  
        <li class="nav-item">
          
          <a class="nav-link" href="../../topic/simulation/central.html" data-bs-toggle="tooltip" title="中央">中央</a></li>
    </ul>
  

</li>   
     
  
</li>
    
  
    </ul>
  

</li>   
     
  

          
        
  </ul> 

    
    

    <hr/>
    <section id="footer">
      最近3篇<br/><ul><li><a href="../../rlang/7_8_function_2.html"> <i class="far fa-clock" ></i>7.8 Function more[2021-10-21 PM 12:18]</a></li><li><a href="../../rlang/4_4_type_list.html"> <i class="far fa-clock" ></i>4.4 串列 list[2021-10-21 PM 12:13]</a></li><li><a href="../../rlang/4_3_type_matrix.html"> <i class="far fa-clock" ></i>4.3 矩陣[2021-10-21 AM 11:27]</a></li></ul>
    </section>
  
</nav><article class="article mx-2 mt-3" id="body-inner">
    <h2 id="均勻分配抽樣">均勻分配抽樣</h2>
<p><code>runif(n, min = 0, max = 1)</code>
<code>runif(100, min = 0, max = 100)</code></p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">RandomNumbers &lt;- runif(10000, min = 0, max = 100)
hist(RandomNumbers)
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-2-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<h2 id="sampling-from-a-normal-distribution">Sampling from a normal distribution</h2>
<p><code>rnorm(n, mean = 0, sd = 1)</code></p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">normalSample &lt;- rnorm(10000, mean = 100, sd = 50)
hist(normalSample)
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-3-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<h2 id="simulating-a-coin-toss">Simulating a coin toss</h2>
<p>擲硬幣10次,5H:5T,4H:6T的機率是多少?</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">
allHeads &lt;- c()
for (i in 1:10000) {
  totalHeads &lt;- sum(round(runif(10, min = 0, max = 1)))
  allHeads &lt;- c(allHeads,totalHeads)
}
x&lt;-hist(allHeads) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏如果要probability density function則 hist(allHeads,✔freq=FALSE)</span></span>
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-4-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">x #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏如果只要圖形,不用指派給變數x,就是說只要✔hist(allHeads)</span></span>
#&gt; $breaks
#&gt;  [1]  0.0  0.5  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5 10.0
#&gt; 
#&gt; $counts
#&gt;  [1]   15   76    0  469    0 1109    0 2139    0 2400    0 2032    0 1237    0  423    0   98    0    2
#&gt; 
#&gt; $density
#&gt;  [1] 0.0030 0.0152 0.0000 0.0938 0.0000 0.2218 0.0000 0.4278 0.0000 0.4800 0.0000 0.4064 0.0000 0.2474 0.0000 0.0846 0.0000 0.0196 0.0000 0.0004
#&gt; 
#&gt; $mids
#&gt;  [1] 0.25 0.75 1.25 1.75 2.25 2.75 3.25 3.75 4.25 4.75 5.25 5.75 6.25 6.75 7.25 7.75 8.25 8.75 9.25 9.75
#&gt; 
#&gt; $xname
#&gt; [1] &quot;allHeads&quot;
#&gt; 
#&gt; $equidist
#&gt; [1] TRUE
#&gt; 
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;histogram&quot;
</code></pre>
<p>上圖是10次中出現H的0,1,2..次數。
<div class="position-relative warning ms-5">
但是為甚麼柱狀之間有空格?<button type="button" class="btn btn-primary position-absolute top-0 end-0 p-0" 
    data-bs-toggle="collapse" data-bs-target="#quiz-1552">提示</button>
</div>    


<div class="collapse info" id="quiz-1552"><pre><code class="language-r">#&gt; $breaks &lt;span data-nopre class=&quot;codenote nopre&quot;&gt;🏷&lt;span data-nopre  class=&quot;tooltiptext&quot; &gt;👏0到10中的分割點&lt;/span&gt;&lt;/span&gt;
#&gt;  [1]  0.0  0.5  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5 10.0
#&gt; 
#&gt; $counts &lt;span data-nopre class=&quot;codenote nopre&quot;&gt;🏷&lt;span data-nopre  class=&quot;tooltiptext&quot; &gt;👏每個分割的H個數&lt;/span&gt;&lt;/span&gt;
#&gt;  [1]   12  104    0  464    0 1163    0 2005    0 2443    0 2045    0 1207    0  449    0  102    0    6
#&gt; 
#&gt; $density &lt;span data-nopre class=&quot;codenote nopre&quot;&gt;🏷&lt;span data-nopre  class=&quot;tooltiptext&quot; &gt;👏每個BIN的密度&lt;/span&gt;&lt;/span&gt;
#&gt;  [1] 0.0024 0.0208 0.0000 0.0928 0.0000 0.2326 0.0000 0.4010 0.0000 0.4886 0.0000 0.4090 0.0000 0.2414 0.0000 0.0898 0.0000 0.0204 0.0000 0.0012
</code></pre>
<p>因為輸出為整數,而分隔以0.5為單位,導致有些地方沒有資料=0。</p>
</div>

修正圖中不應該有的空白間隙。</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">hist(allHeads, freq = FALSE, breaks = 11) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏自行指定分割點</span></span>
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-5-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<h2 id="t-test">t-test</h2>
<p>t檢定。</p>
<ul>
<li>單一樣本</li>
<li>獨立樣本</li>
<li>配對樣本</li>
</ul>
<h3 id="simulating-a-one-sample-t-test">Simulating a one-sample t-test</h3>
<p>單樣本t-test用來看某個樣本平均是否顯著異於母體平均。
如果一個班級有10個學生餐與T/F考試,現在</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">testScores &lt;- rnorm(10, mean = 50, sd = 20)
 
testScores[testScores &gt; 100] &lt;- 100 #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏但是現在問題是常態分配抽到的可能小於0,也可能大於100。修正方法是&gt;100的設定為100,小於0的設定為0。</span></span>
testScores[testScores &lt; 0] &lt;- 0

mean(testScores) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏看一下這次抽樣的平均</span></span>
#&gt; [1] 60.69769

t.test(testScores,mu=50) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏one-sample t-test</span></span>
#&gt; 
#&gt; 	One Sample t-test
#&gt; 
#&gt; data:  testScores
#&gt; t = 2.0432, df = 9, p-value = 0.07139
#&gt; alternative hypothesis: true mean is not equal to 50
#&gt; 95 percent confidence interval:
#&gt;  48.85358 72.54181
#&gt; sample estimates:
#&gt; mean of x 
#&gt;  60.69769
</code></pre>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">testScores &lt;- rnorm(10, mean = 80, sd = 20)
testScores[testScores &gt; 100] &lt;- 100
testScores[testScores &lt; 0] &lt;- 0
t.test(testScores, mu = 50)
#&gt; 
#&gt; 	One Sample t-test
#&gt; 
#&gt; data:  testScores
#&gt; t = 7.0639, df = 9, p-value = 5.895e-05
#&gt; alternative hypothesis: true mean is not equal to 50
#&gt; 95 percent confidence interval:
#&gt;  73.01384 94.69806
#&gt; sample estimates:
#&gt; mean of x 
#&gt;  83.85595
</code></pre>
<h3 id="獨立樣本的t-testindependent-samples-t-test---two-groups-between-subjects">獨立樣本的t-test(independent samples t-test - two groups, between-subjects</h3>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">Alcohol &lt;- rnorm(20, mean = 250, sd = 100)
Control &lt;- rnorm(20, mean = 150, sd = 100)

Alcohol[Alcohol &lt; 0] &lt;- 0
Control[Control &lt; 0] &lt;- 0
t.test(Alcohol,Control)
#&gt; 
#&gt; 	Welch Two Sample t-test
#&gt; 
#&gt; data:  Alcohol and Control
#&gt; t = 3.5651, df = 35.619, p-value = 0.001059
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;   45.0944 164.2015
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;  241.9983  137.3503
</code></pre>
<p>在R中的t檢定,使用的是 Welch Two Sample t-test。如果要得到像是EXCEL,SPSS的類似數值,可以</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">t.test(Alcohol,Control, var.equal = TRUE)
#&gt; 
#&gt; 	Two Sample t-test
#&gt; 
#&gt; data:  Alcohol and Control
#&gt; t = 3.5651, df = 38, p-value = 0.001002
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;   45.22513 164.07077
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;  241.9983  137.3503
</code></pre>
<h3 id="成對樣本paired-samples的t檢定t-test-two-conditions-within-subjects">成對樣本(paired samples)的t檢定t-test (two conditions, within-subjects)</h3>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">day1&lt;-rnorm(20, mean = 20, sd = 5)
day2&lt;-rnorm(20, mean = 30, sd = 5)
day1[day1&lt;0]&lt;-0
day2[day2&lt;0]&lt;-0

mean(day1)
#&gt; [1] 18.73943
mean(day2)
#&gt; [1] 30.63218

t.test(day1, day2, var.equal=TRUE, paired=TRUE)
#&gt; 
#&gt; 	Paired t-test
#&gt; 
#&gt; data:  day1 and day2
#&gt; t = -6.0841, df = 19, p-value = 7.514e-06
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -15.984027  -7.801472
#&gt; sample estimates:
#&gt; mean of the differences 
#&gt;               -11.89275
</code></pre>
<p>Finally, compute the paired-samples t-test using the t.test function. This will be the same as before, except the option for a paired test will be set to TRUE.</p>
<h2 id="generality-of-the-t-test-examples">Generality of the t-test examples</h2>
<p>The above examples illustrate specific cases of simulating and analyzing data for one-sample, independent sample, and paired-sample t-tests. The code can be extended to simulate data for any kind of experiment or set of data that should be analyzed by these tests. The only changes that need to be made are the names of the variables, and the predictions for the number of subjects, and means, standard deviations, or other parameters of the sampling distribution chosen to model the data.</p>
<h2 id="formatting-data-in-r-for-more-complex-designs">Formatting data in R for more complex designs</h2>
<p>產生用來分析個體之間、之內的(between,within subject) 單/多 因子設計(single/multi factor design)
跑ANOVA利用的函數是<code>aov()</code>。這個函數需要資料整理成long-format的型態(在R中,使用data farme)
)</p>
<div data-nopre class="expand d-none ">
    <div data-nopre class="expand-label" onclick="vexpand(this)">
        <i data-nopre style="font-size:x-small;color:yellow" class="fa fa-chevron-right"></i>
        <span data-nopre >展開</span>
    </div><div data-nopre class="expand-content" style="overflow-x:auto">🎶Experimental designs involve manipulations and measurements. The manipulations are described by independent variables, and the measurements refer to dependent variables. Every independent variable has at least two levels, and possibly many more. In balanced designs there is one measurement (DV) for each of the levels of the independent variables. Thus, in order to represent the results of an experiment, it is necessary to organize the data so that the measurement for each level of each independent variable can be identified. Data is typically organized either in wide or long-format.
實驗設計包含處理和測量(manipulations and measurements)。處理就是IV,測量就是DV。每個IV可能至少有2個到多個level。在balanced designs 中,IV中的每個LEVEL有一個測量(DV)。
配合上述的實驗結果,資料紀錄的方式有寬(wide)和長(long)兩種格式。</div></div>
<p>寬資料

  


















<div  data-nopre class="table-responsive">
<table data-nopre class="w-25 ms-5">
<thead data-nopre class="">
<tr data-nopre>
<th data-nopre>Subjects</th>
<th data-nopre>L1</th>
<th data-nopre>L2</th>
<th data-nopre>L3</th>
</tr>
</thead>
<tbody data-nopre>
<tr data-nopre>
<td data-nopre>1</td>
<td data-nopre>5</td>
<td data-nopre>5</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>2</td>
<td data-nopre>7</td>
<td data-nopre>6</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>3</td>
<td data-nopre>10</td>
<td data-nopre>8</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>4</td>
<td data-nopre>9</td>
<td data-nopre>10</td>
<td data-nopre>9</td>
</tr>
<tr data-nopre>
<td data-nopre>5</td>
<td data-nopre>9</td>
<td data-nopre>6</td>
<td data-nopre>8</td>
</tr>
</tbody>
</table>

</div>
長資料

  


















<div  data-nopre class="table-responsive">
<table data-nopre class="w-25 ms-5">
<thead data-nopre class="">
<tr data-nopre>
<th data-nopre>Subjects</th>
<th data-nopre>IV</th>
<th data-nopre>DV</th>
</tr>
</thead>
<tbody data-nopre>
<tr data-nopre>
<td data-nopre>1</td>
<td data-nopre>L1</td>
<td data-nopre>5</td>
</tr>
<tr data-nopre>
<td data-nopre>2</td>
<td data-nopre>L1</td>
<td data-nopre>7</td>
</tr>
<tr data-nopre>
<td data-nopre>3</td>
<td data-nopre>L1</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>4</td>
<td data-nopre>L1</td>
<td data-nopre>9</td>
</tr>
<tr data-nopre>
<td data-nopre>5</td>
<td data-nopre>L1</td>
<td data-nopre>9</td>
</tr>
<tr data-nopre>
<td data-nopre>1</td>
<td data-nopre>L2</td>
<td data-nopre>5</td>
</tr>
<tr data-nopre>
<td data-nopre>2</td>
<td data-nopre>L2</td>
<td data-nopre>6</td>
</tr>
<tr data-nopre>
<td data-nopre>3</td>
<td data-nopre>L2</td>
<td data-nopre>8</td>
</tr>
<tr data-nopre>
<td data-nopre>4</td>
<td data-nopre>L2</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>5</td>
<td data-nopre>L2</td>
<td data-nopre>6</td>
</tr>
<tr data-nopre>
<td data-nopre>1</td>
<td data-nopre>L3</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>2</td>
<td data-nopre>L3</td>
<td data-nopre>10</td>
</tr>
<tr data-nopre>
<td data-nopre>3</td>
<td data-nopre>L3</td>
<td data-nopre>6</td>
</tr>
<tr data-nopre>
<td data-nopre>4</td>
<td data-nopre>L3</td>
<td data-nopre>9</td>
</tr>
<tr data-nopre>
<td data-nopre>5</td>
<td data-nopre>L3</td>
<td data-nopre>8</td>
</tr>
</tbody>
</table>

</div> 
長寬資料指的是個體號碼是否有重複。</p>
<p>For each of the following simulations we will be constructing our own sets of data in long format. For each simulation it will be necessary to determine the total number of subjects, the total number of levels for each IV, and the total number of observations of the DV. These constraints will be used to create and organize each of the data sets.</p>
<h2 id="single-factor-anovas-data-simulation-and-analysis">Single Factor ANOVAs: Data-Simulation and Analysis</h2>
<h3 id="simulating-data-for-a-one-way-within-subjects-anova-with-3-levels">Simulating data for a one-way within subjects ANOVA with 3 levels</h3>
<p>打字速度是否隨著教學時間而變化。20個受測者,DV是每分鐘的字數。IV是第1,2,3天3個LEVEL。</p>
<p>產生模擬資料</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">day1 &lt;- rnorm(20, mean = 20, sd = 5)
day2 &lt;- rnorm(20, mean = 30, sd = 5)
day3 &lt;- rnorm(20, mean = 40, sd = 5)

day1[day1 &lt; 0] &lt;- 0 #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏讓負數成為0</span></span>
day2[day2 &lt; 0] &lt;- 0
day3[day3 &lt; 0] &lt;- 0
WPM &lt;- c(day1,day2,day3)
</code></pre>
<p>因為要產生長資料:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">Subjects &lt;- c(seq(1,20), seq(1,20), seq(1,20)) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏 也可以利用seq()函數: Subjects&lt;-rep(seq(1,20),3)</span></span>

Subjects&lt;-factor(Subjects) #<span data-nopre class="codenote nopre">🏷<span data-nopre  class="tooltiptext" >👏因為要進行ANOVA,所以個體變數必須是因子(在R中的對應為factor 類別)</span></span>
</code></pre>
<p>We now have a variable called WPM that represents the DV, and a variable Subjects that represents the subject factor. The remaining factor is the IV for practice. This has three levels, day1, day2, and day3. Given the way we have organized the data in the WPM variable, we know that the first 20 numbers are for day1, the second 20 numbers are for day 2, and the final set of 20 numbers are for day 3. Thus, we need to create a variable with the term day1 listed 20 times, followed by the term day2 listed 20 times, and then the term day3 listed 20 times. It is easy to do this using the function rep.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">rep(&quot;day1&quot;,20)
#&gt;  [1] &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot; &quot;day1&quot;
</code></pre>
<p>The Practice factor can be created in the following way:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">Practice &lt;- c(rep(&quot;day1&quot;,20), rep(&quot;day2&quot;,20), rep(&quot;day3&quot;,20))
</code></pre>
<p>We have now created variables for every aspect of the design (Subjects, Practice, WPM). The next step is to combine these variables into a long-format table. This is done using the data.frame function. Data needs to be converted into a data frame format before using the aov function to compute the ANOVA. Fortunately, this is very easy. Let’s create the data frame and put it into a new variable called AllData</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">AllData &lt;- data.frame(Subjects,Practice,WPM)
</code></pre>
<p>第1個欄位是個體變數(1-20號) 
第2個欄位是The second column should show the Practice variable, with the names of each of the levels repeated 20 times each, and the 第3第3個欄位是每分鐘打字個數。</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">AllData #
</code></pre>
<div data-nopre class="expand">
    <div data-nopre class="expand-label" onclick="vexpand(this)">
        <i data-nopre style="font-size:x-small;color:yellow" class="fa fa-chevron-right"></i>
        <span data-nopre >展開</span>
    </div><div data-nopre class="expand-content" style="overflow-x:auto"><div  data-nopre class="table-responsive">
<table data-nopre class="w-50 m-auto">
<thead data-nopre class="">
<tr data-nopre>
<th data-nopre style="text-align:left">Subjects</th>
<th data-nopre style="text-align:left">Practice</th>
<th data-nopre style="text-align:right">WPM</th>
</tr>
</thead>
<tbody data-nopre>
<tr data-nopre>
<td data-nopre style="text-align:left">1</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">23.93267</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">2</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">26.56774</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">3</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">18.34906</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">4</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">24.72847</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">5</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">15.87122</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">6</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">17.80156</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">7</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">18.81558</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">8</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">21.43063</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">9</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">17.20837</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">10</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">16.30356</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">11</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">15.50422</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">12</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">29.43814</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">13</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">14.03841</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">14</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">18.78427</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">15</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">22.72366</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">16</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">19.32137</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">17</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">20.20619</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">18</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">22.03055</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">19</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">25.62661</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">20</td>
<td data-nopre style="text-align:left">day1</td>
<td data-nopre style="text-align:right">17.10438</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">1</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">28.07132</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">2</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">32.13748</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">3</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">34.29204</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">4</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">29.09682</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">5</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">24.61844</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">6</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">26.59760</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">7</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">24.51737</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">8</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">29.48648</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">9</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">42.25616</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">10</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">31.73995</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">11</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">33.70681</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">12</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">31.84762</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">13</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">35.88310</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">14</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">30.76246</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">15</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">28.30401</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">16</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">45.64188</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">17</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">35.44798</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">18</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">28.38226</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">19</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">28.74083</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">20</td>
<td data-nopre style="text-align:left">day2</td>
<td data-nopre style="text-align:right">28.82634</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">1</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">36.40064</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">2</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">39.35185</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">3</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">42.09603</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">4</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">41.48042</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">5</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">32.77653</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">6</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">37.06247</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">7</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">39.23680</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">8</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">43.31603</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">9</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">29.86623</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">10</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">33.93805</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">11</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">37.58570</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">12</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">46.68936</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">13</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">38.55405</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">14</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">35.34527</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">15</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">35.75756</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">16</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">43.64483</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">17</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">36.46253</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">18</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">37.89225</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">19</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">46.44139</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">20</td>
<td data-nopre style="text-align:left">day3</td>
<td data-nopre style="text-align:right">36.25436</td>
</tr>
</tbody>
</table>
</div>
<p>#</div></div>
<p>The final step is to perform the one-way ANOVA. This will provide a test to determine whether there is a significant difference between the levels of the practice factor. Luckily, once the data has been formatted into a data frame, the ANOVA can be computed in one line of code using the aov function. Just like we did with the hist function, let’s store the results of aov function into a variable called ANOVAresults.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">ANOVAresults &lt;- aov(WPM~Practice + Error(Subjects/Practice), AllData)
</code></pre>
<p>Next, use the summary function to print the results of ANOVA to the terminal.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">summary(ANOVAresults)
#&gt; 
#&gt; Error: Subjects
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)
#&gt; Residuals 19  503.5    26.5               
#&gt; 
#&gt; Error: Subjects:Practice
#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
#&gt; Practice   2   3379  1689.5   87.98 5.49e-15 ***
#&gt; Residuals 38    730    19.2                     
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

model.tables(ANOVAresults,&quot;means&quot;) 
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 30.10493 
#&gt; 
#&gt;  Practice 
#&gt; Practice
#&gt;  day1  day2  day3 
#&gt; 20.29 31.52 38.51
</code></pre>
<p>Here is all the code for the simulation in one complete script:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">day1&lt;-rnorm(20, mean = 20, sd = 5)
day2&lt;-rnorm(20, mean = 30, sd = 5)
day3&lt;-rnorm(20, mean = 40, sd = 5)
day1[day1&lt;0]&lt;-0
day2[day2&lt;0]&lt;-0
day3[day3&lt;0]&lt;-0
WPM&lt;-c(day1,day2,day3)
Subjects&lt;-c(seq(1,20), seq(1,20), seq(1,20))
Subjects&lt;-factor(Subjects)
Practice&lt;-c(rep(&quot;day1&quot;,20), rep(&quot;day2&quot;,20), rep(&quot;day3&quot;,20))
AllData&lt;-data.frame(Subjects,Practice,WPM)
ANOVAresults&lt;-aov(WPM~Practice + Error(Subjects/Practice), AllData)
summary(ANOVAresults)
#&gt; 
#&gt; Error: Subjects
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)
#&gt; Residuals 19  627.3   33.02               
#&gt; 
#&gt; Error: Subjects:Practice
#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
#&gt; Practice   2   4802    2401   96.02 1.39e-15 ***
#&gt; Residuals 38    950      25                     
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
model.tables(ANOVAresults,&quot;means&quot;) 
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 30.02964 
#&gt; 
#&gt;  Practice 
#&gt; Practice
#&gt;  day1  day2  day3 
#&gt; 18.72 30.76 40.60
</code></pre>
<div data-nopre class="expand">
    <div data-nopre class="expand-label" onclick="vexpand(this)">
        <i data-nopre style="font-size:x-small;color:yellow" class="fa fa-chevron-right"></i>
        <span data-nopre >寫緊湊點</span>
    </div><div data-nopre class="expand-content" style="overflow-x:auto"><pre><code class="language-r">WPM&lt;-rnorm(60,c(20,30,40),5)
WPM[WPM&lt;0]&lt;-0
Subjects&lt;-factor(rep(seq(1,20),each=3))
Practice&lt;-rep(c(&quot;day1&quot;,&quot;day2&quot;,&quot;day3&quot;),20)
AllData&lt;-data.frame(Subjects,Practice,WPM)
ANOVAresults&lt;-aov(WPM~Practice + Error(Subjects/Practice), AllData)
summary(ANOVAresults)
model.tables(ANOVAresults,&quot;means&quot;) 
</code></pre>
</div></div>
<h3 id="simulating-data-for-a-one-way-between-subjects-design-with-3-levels">Simulating data for a one-way between subjects design with 3 levels</h3>
<p>Consider the following between-subjects design with 60 subjects. The task is a memory experiment. Participants in the encoding phase read a list of 20 words, and are given a later test to recall as many words from the list as possible. The IV is the amount of time between the encoding phase and the test phase, and termed Delay. Group 1 is given the memory test immediately after reading the word list. Group 2 is given the memory test 1 hour after reading the word list. Group 3 is given the memory test 2 hours after reading the word list. Each group is composed of 20 different subjects. The prediction is that memory recall performance should decrease with longer delays. Group 1 should perform better than Group 2. And Group 2 should perform better than Group 3.</p>
<p>The DV could be the number of words recalled, this number would range between 0 and 20. There are 20 subjects and 2 conditions, so the DV should have 60 observations. The variables for the DV, and Subjects and Delay factors can be constructed in a similar manner to the previous example. The major difference being that the Subjects factor will contain the numbers 1-60, reflecting the fact that 60 different subjects completed the experiment. The following code creates the complete data frame and runs the ANOVA.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">
Recall&lt;-c(rnorm(20,mean=17,sd=3),rnorm(20,mean=15,sd=3),rnorm(20,mean=12, sd=3))
Recall[Recall&gt;20]&lt;-20
Recall[Recall&lt;0]&lt;-0
Subjects&lt;-factor(seq(1,60))
Delay&lt;-c(rep(&quot;Immediate&quot;,20), rep(&quot;1Hour&quot;,20), rep(&quot;2Hour&quot;,20))
AllData&lt;-data.frame(Subjects,Recall,Delay)
ANOVAresults&lt;-aov(Recall~Delay, AllData)
summary(ANOVAresults)
#&gt;             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
#&gt; Delay        2  298.0  148.98   20.64 1.81e-07 ***
#&gt; Residuals   57  411.4    7.22                     
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
model.tables(ANOVAresults,&quot;means&quot;)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 13.89419 
#&gt; 
#&gt;  Delay 
#&gt; Delay
#&gt;     1Hour     2Hour Immediate 
#&gt;    14.098    11.069    16.516
</code></pre>
<h2 id="using-the-aov-function-for-within-or-between-subjects-designs">Using the aov function for within or between-subjects designs</h2>
<p>The aov function is used for within, between and mixed design ANOVAs. The aov formula has the following syntax:</p>
<p>aov(formula,dataframe)
dataframe refers to the name of the variable containing the data. The formula parameter defines the nature of the ANOVA. Here are some examples of the formula for different single and multi-factor between subject designs. The term DV will refer the name of the dependent variable, and IV for the name of the independent variable.</p>
<h3 id="between-subjects-anova-formulas">Between subjects ANOVA formulas</h3>
<ul>
<li>Single-factor design
<ul>
<li><code>aov(DV~IV, dataframe)</code></li>
</ul>
</li>
<li>2 IVs
<ul>
<li><code>aov(DV~IV1*IV2, dataframe)</code></li>
</ul>
</li>
<li>3 IVs
<ul>
<li><code>aov(DV~IV1*IV2*IV3, dataframe)</code></li>
</ul>
</li>
</ul>
<p>The main differences between these formulas are the additional IV variables. Each additional variable is multiplied to the others.</p>
<p>The aov formula changes in an important way for within-subjects designs. This is because within-subjects designs use an error term that incorporates the Subjects variable. This error term needs to be explicitly defined in the aov formula. It is also important that the subjects variable in the dataframe is defined as a factor. Here are some examples:</p>
<h3 id="within-subjects-anova-formulas-all-factors-within">Within subjects ANOVA formulas (all factors within)</h3>
<ul>
<li>Single-factor design
<ul>
<li><code>aov(DV~IV + Error(Subjects/IV), dataframe)</code></li>
</ul>
</li>
<li>2 IVs
<ul>
<li><code>aov(DV~IV1*IV2 + Error(Subjects/IV1*IV2), dataframe)</code></li>
</ul>
</li>
<li>3 IVs
<ul>
<li><code>aov(DV~IV1*IV2*IV3 + Error(Subjects/IV1*IV2*IV3), dataframe)</code></li>
</ul>
</li>
</ul>
<h3 id="mixed-design-anovas-with-between-and-within-factors">Mixed design ANOVAs with between and within factors</h3>
<p>For these examples IVB will refer to between subject variables, and IVW will refer to within subjects variables</p>
<ul>
<li>One between IV and one within IV
<ul>
<li>aov(DV~IVB*IVW + Error(Subjects/IVW), dataframe)</li>
</ul>
</li>
<li>One between IV and two Within IVs
<ul>
<li>aov(DV~IVB<em>IVW1</em>IVW2 + Error(Subjects/(IVW1*IVW2), dataframe)</li>
</ul>
</li>
<li>Two between IVs and two Within IVs
<ul>
<li>aov(DV~IVB1<em>IVB2</em>IVW1<em>IVW2 + Error(Subjects/(IVW1</em>IVW2)+(IVB1*IVB2), dataframe)</li>
</ul>
</li>
</ul>
<p>note: in this last example an additional error term is added for the interaction between the two between subject variables.</p>
<h2 id="simulating-data-for-multi-factor-designs">Simulating data for multi-factor designs</h2>
<h3 id="2x2-between-subjects-design">2x2 between subjects design</h3>
<p>The following code assumes 20 subjects per group (80 total). IV1 has two levels. IV2 has two levels.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">DV&lt;-rnorm(80,c(100,200,300,400),sd=10)
IV1&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=2,20)
IV2&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=1,40)
AllData&lt;-data.frame(DV,IV1,IV2)
ANOVAresults&lt;-aov(DV~IV1*IV2, AllData)
summary(ANOVAresults)
#&gt;             Df Sum Sq Mean Sq  F value Pr(&gt;F)    
#&gt; IV1          1 792525  792525 8502.143 &lt;2e-16 ***
#&gt; IV2          1 200700  200700 2153.089 &lt;2e-16 ***
#&gt; IV1:IV2      1    134     134    1.443  0.233    
#&gt; Residuals   76   7084      93                    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
model.tables(ANOVAresults,&quot;means&quot;)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 248.8962 
#&gt; 
#&gt;  IV1 
#&gt; IV1
#&gt; level1 level2 
#&gt;  149.4  348.4 
#&gt; 
#&gt;  IV2 
#&gt; IV2
#&gt; level1 level2 
#&gt; 198.81 298.98 
#&gt; 
#&gt;  IV1:IV2 
#&gt;         IV2
#&gt; IV1      level1 level2
#&gt;   level1  98.0  200.7 
#&gt;   level2 299.6  397.2
</code></pre>
<h3 id="2x2-within-subjects-designs">2x2 within subjects designs</h3>
<p>The following code assumes 20 subjects participating in each condition. IV1 has two levels. IV2 has two levels.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">Subjects&lt;-factor(rep(seq(1,20),each=4))  
DV&lt;-rnorm(80,c(100,200,300,400),sd=10)
IV1&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=2,20)
IV2&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=1,40)
AllData&lt;-data.frame(DV,IV1,IV2)
ANOVAresults&lt;-aov(DV~IV1*IV2 + Error(Subjects/(IV1*IV2)), AllData)
summary(ANOVAresults)
#&gt; 
#&gt; Error: Subjects
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)
#&gt; Residuals 19   2254   118.6               
#&gt; 
#&gt; Error: Subjects:IV1
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)    
#&gt; IV1        1 753595  753595    6330 &lt;2e-16 ***
#&gt; Residuals 19   2262     119                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Error: Subjects:IV2
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)    
#&gt; IV2        1 211097  211097    2574 &lt;2e-16 ***
#&gt; Residuals 19   1558      82                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Error: Subjects:IV1:IV2
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)
#&gt; IV1:IV2    1    3.6    3.59   0.033  0.858
#&gt; Residuals 19 2071.5  109.03
model.tables(ANOVAresults,&quot;means&quot;)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 250.9521 
#&gt; 
#&gt;  IV1 
#&gt; IV1
#&gt; level1 level2 
#&gt;  153.9  348.0 
#&gt; 
#&gt;  IV2 
#&gt; IV2
#&gt; level1 level2 
#&gt; 199.58 302.32 
#&gt; 
#&gt;  IV1:IV2 
#&gt;         IV2
#&gt; IV1      level1 level2
#&gt;   level1 102.7  205.1 
#&gt;   level2 296.4  399.6
</code></pre>
<h3 id="2x2-mixed-design-1-within-1-between">2x2 mixed design (1 within, 1 between)</h3>
<p>The following code assumes 40 total subjects. 20 participate in each level of IVB, and all participate in each level of IVW. IVB has two levels, IVW has two levels</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">Subjects&lt;-factor(c(rep(seq(1,40),each=2)))
DV&lt;-rnorm(80,c(100,200,300,400),sd=10)
IVB&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=2,20)
IVW&lt;-rep(c(&quot;level1&quot;,&quot;level2&quot;),each=1,40)
AllData&lt;-data.frame(DV,IVB,IVW)
ANOVAresults&lt;-aov(DV~IVB*IVW + Error(Subjects/(IVW)), AllData)
summary(ANOVAresults)
#&gt; 
#&gt; Error: Subjects
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)    
#&gt; IVB        1 803558  803558    7620 &lt;2e-16 ***
#&gt; Residuals 38   4007     105                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Error: Subjects:IVW
#&gt;           Df Sum Sq Mean Sq  F value Pr(&gt;F)    
#&gt; IVW        1 183146  183146 1244.440 &lt;2e-16 ***
#&gt; IVB:IVW    1      2       2    0.017  0.897    
#&gt; Residuals 38   5593     147                    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
model.tables(ANOVAresults,&quot;means&quot;)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 250.7176 
#&gt; 
#&gt;  IVB 
#&gt; IVB
#&gt; level1 level2 
#&gt;  150.5  350.9 
#&gt; 
#&gt;  IVW 
#&gt; IVW
#&gt; level1 level2 
#&gt; 202.87 298.56 
#&gt; 
#&gt;  IVB:IVW 
#&gt;         IVW
#&gt; IVB      level1 level2
#&gt;   level1 102.5  198.5 
#&gt;   level2 303.3  398.6
</code></pre>
<h2 id="power-analysis-and-sample-size-planning-by-monte-carlo-simulation">Power analysis and sample-size planning by Monte Carlo simulation</h2>
<p>The above code blocks show examples of simulating data in a few different designs, and then analyzing the simulated data with an ANOVA. By repeating this process many times for any given design, we can estimate statistical properties of the design that should hold over the long run. For example, how often does the design produce a ‘significant’ (p&lt;.05) effect? This can be estimated by running 1000s of independent simulations, computing and saving the p-value from each simulation, and then determining the proportion of p-values less than .05 from the distribution of simulated p-values. In principle, long-run expectations for any other statistic of a simulated design could be estimated in this way as well. In addition, design simulations can be constructed down to the level of individual trial data for individual subjects, which can aid in sample-size and cell-size planning. Some example monte-carlo simulations are presented below.</p>
<h3 id="monte-carlo-one-sample-t-test-simulation">Monte-Carlo one-sample T-test Simulation</h3>
<p>The following simulates 25 sample means from a normal distribution (mu=100, sd=10), and then conducts a one-sample t-test against the population mean of 100. This is equivalent to simulating the null. The simulation is repeated 1000 times, each time the observed p-value is saved.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">
sims_to_run&lt;-1000
save_p &lt;- vector(length=sims_to_run)

for(i in 1:sims_to_run){
sim_data &lt;- rnorm(25,100,10)
t.out &lt;-t.test(sim_data,mu=100)
save_p[i] &lt;- t.out$p.value
}

hist(save_p)
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-24-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">

proportion_sig&lt;-length(save_p[save_p&lt;.05])/sims_to_run
proportion_sig
#&gt; [1] 0.05
</code></pre>
<p>As expected, the histogram of simulated p-values is roughly uniform, indicating that all possible p-values are equally likely. In other words, chance would be expected to produce p&lt;.05 about 5% of the time. The calculated proportion of significant values was 0.043. In general, as the number of simulated runs increases toward infinity, the estimated parameter should settle on it’s true expected value.</p>
<h3 id="monte-carlo-paired-t-test-simulation">Monte-Carlo paired T-test Simulation</h3>
<p>25 subjects, with expected mean 100 in Condition 1 and mean 110 in Condition 2, with standard deviation 30. This simulation includes a programmed difference of 10, so there is a true effect.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">sims_to_run&lt;-1000
save_p &lt;- vector(length=sims_to_run)

for(i in 1:sims_to_run){
condition_1 &lt;- rnorm(25,100,30)
condition_2 &lt;- rnorm(25,110,30)
t.out &lt;-t.test(condition_1,condition_2,paired=TRUE,var.equal = TRUE)
save_p[i] &lt;- t.out$p.value
}

hist(save_p)
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-25-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">

proportion_sig&lt;-length(save_p[save_p&lt;.05])/sims_to_run
proportion_sig
#&gt; [1] 0.215
</code></pre>
<p>[1] 0.223</p>
<p>The histogram of p-values is skewed left, so this design is more likely to produce p&lt;.05 than not, but the statistical power (or proportion of significant simulations) is only 0.223.</p>
<p>To determine the number of subjects needed to achieve power = .8, you could fiddle with the number of subjects until you find the number, or you could add another loop to run multiple monte carlo simulations with difference numbers of subjects.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">subject_numbers&lt;-c(25,50,75,100,125,150,175,200)

power&lt;-vector(length=length(subject_numbers))
for(subnum in 1:length(subject_numbers)){

  sims_to_run&lt;-1000
  save_p &lt;- vector(length=sims_to_run)
  
  for(i in 1:sims_to_run){
    condition_1 &lt;- rnorm(subject_numbers[subnum],100,30)
    condition_2 &lt;- rnorm(subject_numbers[subnum],110,30)
    t.out &lt;-t.test(condition_1,condition_2,paired=TRUE,var.equal = TRUE)
    save_p[i] &lt;- t.out$p.value
  }
  power[subnum]&lt;-length(save_p[save_p&lt;.05])/sims_to_run
}

power_table&lt;-data.frame(subject_numbers,power)
kable(power_table)
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:right">subject_numbers</th>
<th style="text-align:right">power</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">25</td>
<td style="text-align:right">0.211</td>
</tr>
<tr>
<td style="text-align:right">50</td>
<td style="text-align:right">0.369</td>
</tr>
<tr>
<td style="text-align:right">75</td>
<td style="text-align:right">0.517</td>
</tr>
<tr>
<td style="text-align:right">100</td>
<td style="text-align:right">0.636</td>
</tr>
<tr>
<td style="text-align:right">125</td>
<td style="text-align:right">0.732</td>
</tr>
<tr>
<td style="text-align:right">150</td>
<td style="text-align:right">0.795</td>
</tr>
<tr>
<td style="text-align:right">175</td>
<td style="text-align:right">0.881</td>
</tr>
<tr>
<td style="text-align:right">200</td>
<td style="text-align:right">0.908</td>
</tr>
</tbody>
</table>
<p>subject_numbers	power
25	0.213
50	0.359
75	0.503
100	0.651
125	0.747
150	0.811
175	0.871
200	0.895</p>
<h3 id="monte-carlo-one-way-repeated-measures-simulation">Monte-Carlo One-way Repeated Measures Simulation</h3>
<p>The above simulations estimated individual subject sample means by drawing values directly from distributions. The individual trial data for each subject can also be simulated if desired. This can be useful for design planning as both the number of subjects and cell-size determine the power of the design. Depending on the situation, increasing the number of trials may do more for improving the sensitivity of the design than increasing the number of subjects, or vice-versa. To illustrate, the following example simulates individual trial data for subjects in a Stroop experiment. The retimes package is used to generate RT distributions.</p>
<p>Before simulating an entire experiment it is worth simulating a Stroop effect for a single simulated subject. This shows the variance of Stroop effects given programmed values for the mean difference between congruent and incongruent trials, values of mu, sigma, and tau for the base RT distributions, as well as number of trials.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">library(retimes)
#&gt; Error in library(retimes): 不存在叫 'retimes' 這個名稱的套件
library(ggplot2)

stroop_effects&lt;-c()
n_trials &lt;- 144
sim_mu &lt;- 600
sim_sigma &lt;- 80
sim_tau &lt;- 150
congruency_effect &lt;- 100
for(i in 1:1000){
CongruentRTs &lt;- rexgauss(n_trials,mu=sim_mu,sigma=sim_sigma,tau=sim_tau)
IncongruentRTs &lt;- rexgauss(n_trials,mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)
stroop_effects &lt;- c(stroop_effects,mean(IncongruentRTs)-mean(CongruentRTs))
}
#&gt; Error in rexgauss(n_trials, mu = sim_mu, sigma = sim_sigma, tau = sim_tau): 沒有這個函式 &quot;rexgauss&quot;
qplot(stroop_effects)+xlab(&quot;Simulated Stroop Effects&quot;)+geom_bar(fill=&quot;white&quot;,color=&quot;black&quot;)
</code></pre>

<figure  class="figure text-center d-block w-50 m-auto   ">





    <img src="simulation_1_files/figure-html/unnamed-chunk-27-1.png" class="figure-img w-100 "
         alt="figure"/> <figcaption class="figure-caption">
            figure
        </figcaption>
</figure>

<blockquote>
<p>??? <code>stat_bin()</code> using <code>bins = 30</code>. Pick better value with <code>binwidth</code>.
The histogram shows that under the simulated parameters, the programmed Stroop effect of 100ms can easily take a value -from 50 to 150. The variance in the simulated Stroop effect for a single subject is determined by the variance in the underlying RT distributions for the congruent and incongruent conditions.</p>
</blockquote>
<p>The following simulation expands on the above to model multiple subjects in a Stroop experiment. We start with a minimum number of 10 trials per condition, in an Experiment with 20 subjects, and programmed Stroop effect of 50ms.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">sims_to_run&lt;-100

n_trials &lt;- 10
sim_mu &lt;- 600
sim_sigma &lt;- 80
sim_tau &lt;- 150
congruency_effect &lt;- 50
n_subjects &lt;- 20
save_p&lt;-vector(length=sims_to_run)

for(i in 1:sims_to_run){
  all_subjects&lt;-data.frame()
  for(sub in 1:n_subjects){
    CongruentRTs &lt;- rexgauss(n_trials,mu=sim_mu,sigma=sim_sigma,tau=sim_tau)
    IncongruentRTs &lt;- rexgauss(n_trials,mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)
    temp_subject &lt;- data.frame(subject=rep(sub,n_trials*2),
                               condition=rep(c(&quot;Congruent&quot;,&quot;Incongruent&quot;),each=n_trials),
                               RTs=c(CongruentRTs,IncongruentRTs))
    all_subjects&lt;-rbind(all_subjects,temp_subject)
  }
mean_subject_data&lt;-aggregate(RTs~subject*condition,all_subjects,mean)
aov.out&lt;-summary(aov(RTs~condition+Error(subject/condition),mean_subject_data))
save_p[i]&lt;-aov.out[[3]][[1]][[5]][1]
}
#&gt; Error in rexgauss(n_trials, mu = sim_mu, sigma = sim_sigma, tau = sim_tau): 沒有這個函式 &quot;rexgauss&quot;

hist(save_p)
#&gt; Error in hist.default(save_p): 'x' 必須是數值


proportion_sig&lt;-length(save_p[save_p&lt;.05])/sims_to_run
</code></pre>
<p>Tith these minimum trial counts, the power is 0.26 to detect the Stroop effect. Estimated power will increase with increasing numbers of subjects and/or trials in the simulated design. The last simulation shows how power increases as function of increasing trial counts.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">sims_to_run&lt;-100

n_trials &lt;- c(10,20,30,40,50,60,70)
sim_mu &lt;- 600
sim_sigma &lt;- 80
sim_tau &lt;- 150
congruency_effect &lt;- 50
n_subjects &lt;- 20
save_p&lt;-vector(length=sims_to_run)
proportion_sig&lt;-vector(length=length(n_trials))

for(trials in 1:length(n_trials)){
  for(i in 1:sims_to_run){
    all_subjects&lt;-data.frame()
    for(sub in 1:n_subjects){
      CongruentRTs &lt;- rexgauss(n_trials[trials],mu=sim_mu,sigma=sim_sigma,tau=sim_tau)
      IncongruentRTs &lt;- rexgauss(n_trials[trials],mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)
      temp_subject &lt;- data.frame(subject=rep(sub,n_trials[trials]*2),
                                 condition=rep(c(&quot;Congruent&quot;,&quot;Incongruent&quot;),each=n_trials[trials]),
                                 RTs=c(CongruentRTs,IncongruentRTs))
      all_subjects&lt;-rbind(all_subjects,temp_subject)
    }
    mean_subject_data&lt;-aggregate(RTs~subject*condition,all_subjects,mean)
    aov.out&lt;-summary(aov(RTs~condition+Error(subject/condition),mean_subject_data))
    save_p[i]&lt;-aov.out[[3]][[1]][[5]][1]
  }
  proportion_sig[trials]&lt;-length(save_p[save_p&lt;.05])/sims_to_run
}
#&gt; Error in rexgauss(n_trials[trials], mu = sim_mu, sigma = sim_sigma, tau = sim_tau): 沒有這個函式 &quot;rexgauss&quot;

kable(data.frame(n_trials,proportion_sig))
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:right">n_trials</th>
<th style="text-align:left">proportion_sig</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">10</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">20</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">30</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">40</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">50</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">60</td>
<td style="text-align:left">FALSE</td>
</tr>
<tr>
<td style="text-align:right">70</td>
<td style="text-align:left">FALSE</td>
</tr>
</tbody>
</table>
<h2 id="analysing-data-from-a-file">Analysing data from a file</h2>
<p>This tutorial comes with a folder containing several data files. All of these files are .txt files that you can open and view in any text editor. Each of the files has data formatted in a specific way, called long format. The first line of each file contains headers or names for each of the columns of data in the file. For example, The SingleFactor_Between.txt file contains 61 lines of text. The first few lines should like something like this (except the text file will not include the number signs).</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">AllData[1:5,]
</code></pre>

  


















<div  data-nopre class="table-responsive">
<table data-nopre class="w-50 m-auto">
<thead data-nopre class="">
<tr data-nopre>
<th data-nopre style="text-align:right">DV</th>
<th data-nopre style="text-align:left">IVB</th>
<th data-nopre style="text-align:left">IVW</th>
</tr>
</thead>
<tbody data-nopre>
<tr data-nopre>
<td data-nopre style="text-align:right">103.36478</td>
<td data-nopre style="text-align:left">level1</td>
<td data-nopre style="text-align:left">level1</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:right">196.51718</td>
<td data-nopre style="text-align:left">level1</td>
<td data-nopre style="text-align:left">level2</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:right">305.92203</td>
<td data-nopre style="text-align:left">level2</td>
<td data-nopre style="text-align:left">level1</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:right">390.26036</td>
<td data-nopre style="text-align:left">level2</td>
<td data-nopre style="text-align:left">level2</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:right">92.85307</td>
<td data-nopre style="text-align:left">level1</td>
<td data-nopre style="text-align:left">level1</td>
</tr>
</tbody>
</table>

</div>
<p>The Subjects column refers to individual subjects in the data file. Each number corresponds to a unique subject. The IV1 column refers to the single independent variable or factor in this data file. There are three levels: Group1, Group2, and Group3. If you scroll down the lines of the data file you will see that subjects 1-20 are associated with Group1, subjects 21-40 are associated with Group2, and subjects 41-60 are associated with Group3. The final column DV stands for the dependent variable, and the numbers in this column represent mean values for each subject in each condition.</p>
<h2 id="reading-data-into-r">Reading data into R</h2>
<p>There are several ways to import data into R. We focus on using the read.table function (but see also scan). To use read.table you will need to tell R where it can find your data files. In R studio look at the bottom right panel, and find the “Files” tab. When you click on the “Files” tab you should see the current working directory. Use the file section to navigate to the folder on your computer that contains the data files. When you have succesfully done this you will see the data files listed in the bottom-right window. Now you want to set the current working directoy to this folder (that contains the data files). Choose the option “More”, listed underneath the “files” tab. You should see an option to “set as working directory”. Click this option. Now R will be able to find your data files.</p>
<p>The next step is to input the data file into a variable in R. If you have correctly set the working directory then type the second line of code into the R terminal on the bottom left window of R-studio, then press enter. The first line of code shows how the working directory can be set with a script.</p>
<p>AllData&lt;-read.table(&quot;RFiles/SingleFactor_Between.txt&quot;,header=TRUE,sep=&quot;\t&quot;)
You should now see a variable called AllData appear in the workspace (top right window). If you type AllData into the terminal and press enter, you should see R list your data file in the terminal.</p>
<p>5.11 Running an ANOVA for a single-factor design between-subjects design
We have already used the aov function to conduct ANOVAs on our simulated data sets. The same function is used to anlayse data inputted into R. In this case, the data file that we have inputted is already structured in long-format, and R reads the data in as a dataframe object. So, to conduct the ANOVA we simply need to write the following:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">summary(aov(DV~IV1,AllData))
#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)    
#&gt; IV1          1 803558  803558   325.2 &lt;2e-16 ***
#&gt; Residuals   78 192748    2471                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>
<p>In the above print-out, the Df column refers to degrees of freedom, Sum Sq refers to the sum of squares, Mean Sq refers to Mean squared error, F-value is the F-statistic, and Pr(&gt;F) is the p-value.</p>
<p>We can see that the p-value is .0166, indicating significance. This means that at least one of the three groups is significantly different from the others. However, the ANOVA alone does not tell us either the means of each group, or which ones are significantly different from each other. This requires specific comparisons between levels.</p>
<p>The summary function does not provide descriptive statistics, so we are unable to see the means for each condition. One option to view the means is to use thethe aggregate function.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">aggregate(DV~IV1,AllData,mean)
</code></pre>
<p>
  


















<div  data-nopre class="table-responsive">
<table data-nopre class="w-50 m-auto">
<thead data-nopre class="">
<tr data-nopre>
<th data-nopre style="text-align:left">IV1</th>
<th data-nopre style="text-align:right">DV</th>
</tr>
</thead>
<tbody data-nopre>
<tr data-nopre>
<td data-nopre style="text-align:left">level1</td>
<td data-nopre style="text-align:right">150.4954</td>
</tr>
<tr data-nopre>
<td data-nopre style="text-align:left">level2</td>
<td data-nopre style="text-align:right">350.9397</td>
</tr>
</tbody>
</table>

</div>
It is worth pointing out that although the summary function does not immediately display the means for each condition, it does create a data structure that represents this information. And, the means can be found using model.tables in the following way.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">aovResults&lt;-aov(DV~IV1,AllData)
print(model.tables(aovResults,&quot;means&quot;),digits=6)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 250.7176 
#&gt; 
#&gt;  IV1 
#&gt; IV1
#&gt;  level1  level2 
#&gt; 150.495 350.940
</code></pre>
<p>We see that the mean for Group 1 is numerically smaller than the mean for Group 2, which is numerically smaller than the mean for Group 3. We can conclude, based on the ANOVA, that the largest and smallest means are different from each other, so we know that the mean for Group 1 was significantly smaller than the mean for Group 3. We need to perform a follow-up t-test to determine whether Group 1 is different from Group 2, and yet another test to determine if Group 2 is different from Group 3.</p>
<p>The design is between-subjects, so the appropriate t-test is an independent samples t-test. We can conduct this test comparing groups 1 and 2 using the t.test function as follows:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">t.test(AllData[AllData$IV1==&quot;Group1&quot;,]$DV,AllData[AllData$IV1==&quot;Group2&quot;,]$DV,var.equal=TRUE)
#&gt; Error in t.test.default(AllData[AllData$IV1 == &quot;Group1&quot;, ]$DV, AllData[AllData$IV1 == : not enough 'x' observations
</code></pre>
<p>We see that the p-value is p=0.06831, which is not &lt;.05. So, Group 1 is not significantly different than Group 2.</p>
<p>We can run an additional t-test comparing Group 2 and Group 3 using the following:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">t.test(AllData[AllData$IV1==&quot;Group2&quot;,]$DV,AllData[AllData$IV1==&quot;Group3&quot;,]$DV,var.equal=TRUE)
#&gt; Error in t.test.default(AllData[AllData$IV1 == &quot;Group2&quot;, ]$DV, AllData[AllData$IV1 == : not enough 'x' observations
</code></pre>
<p>Again, we see that the difference is not significant (p=.284). So Group 2 is not significantly different from Group 3.</p>
<h3 id="prettier-results-using-kable-and-broom">Prettier results using kable and broom</h3>
<p>The results of anovas or t-tests aren’t appealing look to at when they are printed to the console, and often look cluttered when printed to a .pdf or .html file using Rmarkdown. The kable function from the package knitr, and the xtable function from the xtable package can help with improving the look and feel of ANOVA and other tables.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">library(knitr)
library(xtable)
aov.out &lt;- summary(aov(DV~IV1,AllData))
kable(xtable(aov.out),format='markdown')
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:right">Df</th>
<th style="text-align:right">Sum Sq</th>
<th style="text-align:right">Mean Sq</th>
<th style="text-align:right">F value</th>
<th style="text-align:right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">IV1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">803558.0</td>
<td style="text-align:right">803557.970</td>
<td style="text-align:right">325.1783</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:left">Residuals</td>
<td style="text-align:right">78</td>
<td style="text-align:right">192748.2</td>
<td style="text-align:right">2471.131</td>
<td style="text-align:right">NA</td>
<td style="text-align:right">NA</td>
</tr>
<tr>
<td style="text-align:left">Df	Sum Sq	Mean Sq	F value	Pr(&gt;F)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">IV1	2	101780.0	50890.02	4.405401	0.0166327</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">Residuals	57	658448.8	11551.73	NA	NA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">The results from t-tests can be prettified using broom</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">library(broom)
kable(tidy(t.test(DV~IV1,AllData[AllData$IV1!=&quot;Group1&quot;,], paired=TRUE)))
#&gt; Error in model.frame.default(formula = DV ~ IV1, data = AllData[AllData$IV1 != : 變數的長度不一樣('IV1')
</code></pre>
<p>estimate	statistic	p.value	parameter	conf.low	conf.high	method	alternative
-33.88101	-1.06247	0.3013409	19	-100.6253	32.86325	Paired t-test	two.sided</p>
<h3 id="writing-up-the-results">Writing up the results</h3>
<p>The preceding section covered the steps of loading a data-file into R. The data-file was for a single-factor between subjects design with 3 levels, and 20 subjects per level. An ANOVA revealed a significant effect, and the post-hoc t-tests showed that the only significant result was between Group 1 and 2. With all of this information in hand it is now possible to write-up a complete results section for this analysis. Here is an example:</p>
<p>Mean reaction times for each subject in each condition were submitted to a one-way ANOVA. The main effect of group was significant, F(2,57) = 4.405, MSE = 11552, p&lt;.016. The mean reaction times were 490 ms, 555 ms, and 589 ms, for groups one, two, and three, respectively. Follow-up comparisons showed that group one was not significantly different from group two, t(38)=1.876, p=.068. Similarly, group 2 was not significantly different from group 3, t(38)=1.086, p=.284.</p>
<p>5.12 Running a between subjects ANOVA for a 2x2 Factorial design
The data file 2x2Factorial_Between.txt contains simulated data for a classic memory experiment performed by Godden &amp; Baddeley (1975). The purpose of their experiment was to test the role of contextual information in guiding memory retrieval. They had different groups of subjects encode a list of words for a later memory test in one of two contexts, either on land or under water (the subjects were expert divers). Thus, the first IV was encoding context (land vs. water). In a later memory test the subjects were asked to recall as many words as possible from the list. For the subjects who encoded the words in the land context, half of the subjects performed the recall test on land, and half performed under water. The same was true for the subjects who encoded the words in the under water context. Thus, the second IV was the context of the memory test (Land vs. Water). The purpose of the experiment was to determine whether memory performance would be better when the encoding and test contexts matched (e.g., encoded and tested on land, or encoded and tested under water), compared to when the encoding and test contexts mismathced (e.g., encoded on land but tested under water, or encoded under water but tested on land).</p>
<p>The file contains simulated data for 80 subjects. There were four total conditions, and twenty subjects completed each condition. For example, 20 subjects encoded on land and tested on land, 20 subjects encoded on land and tested under water, 20 subjects encoded on land tested under water, and 20 subjects encoded under water and tested under water. The design can be described as a 2 (Encoding context: land vs. water) x 2 (Testing context: land vs. water) between subjects experiment. The dependent variable was proportion of words correctly recalled. The proportion ranges from 0 (no words recalled) to 1 (all words correctly recalled).</p>
<p>Let’s load the data file into R, then perform the necessary statistical tests to interpret the results. The final product will be a complete results section.</p>
<p>Load the data into R</p>
<p>AllData&lt;-read.table(&quot;RFiles/2x2Factorial_Between.txt&quot;,header=TRUE,sep=&quot;\t&quot;)
Perform a 2x2 ANOVA Note: Accuracy is the name of the column in the data file representing the DV, so it is used in the aov formula. Similarly, TestContext and EncodingContext are the names of the columns representing the IVs, so they are used in the aov formula.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">summary(aov(Accuracy~TestContext*EncodingContext,AllData))
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>We can see the ANOVA produced two main effects and one interaction. The main effect for test context was not signifcant, and the main effect for encoding context was not significant. However, the interaction between encoding and test context was significant. The p-value is expressed in scientific notation, meaning that 8.79e-13 is really 0.000000000000879. This is definetly p&lt; .05.</p>
<p>The next step is to find the means for each main effect, and the means for the interaction.</p>
<p>The means for main effect of test context can be found as follows:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">aggregate(Accuracy~TestContext,AllData,mean)
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>The means for the main effect of encoding context can be found as follows:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">aggregate(Accuracy~EncodingContext,AllData,mean)
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>The means for the interaction between test and encoding context can be found as follows:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">aggregate(Accuracy~TestContext*EncodingContext,AllData,mean)
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>The ANOVA shows that the only the interaction is significant. The means for the interaction effect are displayed immediately above. There are four means, corresponding to each of the ways that the encoding context is paired with the test context. The next step is to interpret the pattern of this interaction. In some sense, the question here is the same as interpreting a significant result from ANOVA on a single-factor with 4-levels. A significant result in either case indicates that at least one of the means is different from the other three, but the ANOVA itself does not specify which means are different from each other. That is, the ANOVA alone does not explain the pattern of the means.</p>
<p>Inspecting the numbers we see what is known as a cross-over interaction. If these numbers were graphed in a line chart, we would see that the lines would cross-over. Indeed, the pattern of the cross-over interaction is exactly what was predicted. Remember, the main prediction of the study was that memory accuracy should be better when the encoding and test contexts match than when they mismatch. Memory performance was .83 and .77 in the matching conditions (land/land, water/water). Memory performance was .61 and .60 in the mismatching conditions (water/land, land/water). It is important to keep the predictions in mind when conducting the follow-up tests.</p>
<p>There are 6 possible comparisons that can be made to fully explain the interaction pattern. For example, the means between 1&amp;2, 1&amp;3, 1&amp;4, 2&amp;3, 2&amp;4, and 3&amp;4 can all be submitted to separate t-tests. Sometimes it is necessary to conduct all of the possible comparisons, but usually it is only necessary to conduct the comparisons most relevant to the predictions at hand.</p>
<p>Let’s start with the subjects who encoded words on Land. They should have better memory when they were tested on land than under water. The t-test is:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">t.test(Accuracy~TestContext, data=AllData[AllData$EncodingContext==&quot;Land&quot;,], var.equal=TRUE)
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>Next, the subjects who encoded words under water. They should have better memory memory when they were tested under water than on land. The t-test is:</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">t.test(Accuracy~TestContext, data=AllData[AllData$EncodingContext==&quot;Water&quot;,], var.equal=TRUE)
#&gt; Error in eval(predvars, data, env): 找不到物件 'Accuracy'
</code></pre>
<p>These two t-test verify the main predictions of the study. If you look at the original paper, you will see that the authors conducted additional tests to show that there were no significant differences between memory performance in the matching conditions (land/land vs. water/water), and no significant differences between memory performance in the non-matching conditions (land/water vs. water/land).</p>
<h3 id="writing-up-the-results-section">Writing up the results section</h3>
<p>The preceding section produced ANOVA results for a 2x2 between-subjects design, and means for each main effect and interaction, as well as follow-up tests to explain the significant interaction. With all of this information in place it is possible to write-up a complete results section. Here is an example:</p>
<p>The mean proportions of correctly recalled words for each subject in each condition were submitted to a 2 (encoding context: land vs. water) x 2 (test context: land vs. water) between-subjects ANOVA. The main effect of encoding context was not significant, F&lt;1. The main effect of test context not significant, F(1,76) = 1.190, MSE = .011, p = .279. The two-way interaction between encoding and test context was significant, F(1,76) = 73.495, MSE = .011, p &lt; .001 . Planned comparisons showed that for participants who encoded words on land, proportion recall was higher when they tested on land (.83) than under water (.61), t(38) = 7.00, p&lt; .001. Similarly, for participants who encoded words under water, proportion recall was higher when they tested under water (.79) than on land (.60), t(38) = 5.23, p&lt; .001.</p>
<p>Note: The above results section is written with a few guidelines in mind. When a result is not significant some authors decide to simply state that the result was not significant. Some journals may require the author to fully report the F-value, the MSE, and the p-value for all non-significant effects. In the above example, the full report is not given for the first non-significant effect because the F-value was less than 1. In this case, it is often appropriate to simply report that F was less than one. Also notice that the means for the nonsignificant effects were not given. Some journals may require that these means are listed. At the very least it is important that all of the important means can be reconstructed. In this case, the four means from the interaction effect are individually listed; thus, it is is possible for the reader to reconstruct the means for both of the main effects.</p>
<p>5.13 Practice Problems
5.13.1 Single factor design with a within-subjects factor
The datafile is titled SingleFactor_Within.txt</p>
<p>The data file contains simulated data for 20 subjects in a sequence learning task. The dependent variable is ReactionTime. The single independent variable is called Practice, and it has four levels, 1, 2, 3, and 4. Each level represents four different blocks of practicing the sequence. The general prediction is that reaction time should decrease across the four practice blocks. Use R to load the data file and conduct a repeated-measures ANOVA, compute the means for each of the practice blocks, and conduct the necessary paired-samples t-tests. Then write a complete results section for the example data.</p>
<p>To get you started the necessary R commands are listed below</p>
<p>AllData&lt;-read.table(&quot;RFiles/SingleFactor_Within.txt&quot;,header=TRUE,sep=&quot;\t&quot;)
summary(aov(ReactionTime~Practice + Error(as.character(Subjects)/Practice),AllData))
aggregate(ReactionTime~Practice,AllData,mean)
t.test(AllData[AllData$Practice==&quot;Block1&quot;,]$ReactionTime,AllData[AllData$Practice==&quot;Block2&quot;,]$ReactionTime, paired=TRUE,var.equal=TRUE)
note: for the t-test, change the terms Block1 and Block2 to make other comparisons (e.g., Block3 or Block4).</p>
<p>5.13.2 2x2 within-subjects design
The datafile is titled 2x2Factorial_Within.txt</p>
<p>The data file contains simulated for 20 subjects in a Stroop task. In a Stroop task, participants are presented with color words printed in congruent or incongruent ink-colors. For example, the word blue printed in BLUE color is a congruent item. The word red printed in BLUE is an incongruent item. In the standard task, participants are instructed to identify the ink-color and ignore the word. Typically, reactions are faster for congruent than incongruent items. In this experiment, participants completed the Stroop task with two different instructions. In one phase they were presented with congruent and incongruent items, and were told to identify the ink-color and ignore the word, this is called the NameColor condition. In the other phase, participants were presented with congruent and incongruent items, and were told to identify the word and ignore the ink-color, this is called the NameWord condition. The predictions are that RTs should generally be faster for congruent than incongruent trials. Also, RTs should generally be faster for the word naming task than the color naming task. Finally, there should be an interaction between congruency and task, such that the Stroop effect (difference between incongruent and congruent items) is larger for the name color task than the name word task.</p>
<p>There are two IVS. The first IV is Congruency, with the levels Congruent and Incongruent. The second IV is Task, with the levels NameColor and and Name Word. The DV is ReactionTime. Use R to load the data file, then conduct a repeated-measures ANOVA, compute the means for each of the main effects and the interaction, and conduct any necessary paired-sample t-tests. Then write a complete results section for the example data.</p>
<p>To get you started here are the neccessary R commands:</p>
<p>AllData&lt;-read.table(&quot;RFiles/2x2Factorial_Within.txt&quot;,header=TRUE,sep=&quot;\t&quot;)
summary(aov(ReactionTime~Task<em>Congruency + Error(as.character(Subjects)/(Task</em>Congruency)),AllData))
You can also put the results of the aov into a variable</p>
<p>aovResult&lt;-aov(ReactionTime~Task<em>Congruency + Error(as.character(Subjects)/(Task</em>Congruency)),AllData)
Then you can print all of the means for the main effects and interactions using the following:</p>
<p>model.tables(aovResult,&quot;means&quot;) 
5.14 Loading raw-data into R
Using R to analyze the results from real experiments requires that raw data-files are loaded into R and then transformed into a long-format data frame. Depending on how the raw data is formatted this process can be fairly straightforward, or not. The following provides an example of how to load multiple subjects data files into R and then complete an analysis. The example is taken from a Stroop experiment conducted in PsychoPy. Each subject’s data file is saved as separate .csv files (comma separated value). Each .csv file contains the raw data from a 24 trial Stroop experiment with 12 congruent and 12 incongruent items. The data files are already organized in long-format. The first row contains the columns headers, and each remaining row contains the raw data for each trial. The data files are named Subject1.csv, Subject2.csv, and so on.</p>
<p>The following read.table will load a single file into a datafram. However, the working directory must first be set to the location of the file.</p>
<p>Subject1&lt;-read.table(&quot;RFiles/PsychoPyStroop.csv&quot;,header=TRUE,sep=&quot;,&quot;)
The ultimate goal here is to load in all 8 subjects worth of data into a single dataframe. This is done using a for loop in R.</p>
<pre><code class="language-r?lang=r?class=.source?preclass=ms-5">fnames&lt;-c(&quot;RFiles/Subject1.csv&quot;,&quot;RFiles/Subject2.csv&quot;,&quot;RFiles/Subject3.csv&quot;,&quot;RFiles/Subject4.csv&quot;,&quot;RFiles/Subject5.csv&quot;,&quot;RFiles/Subject6.csv&quot;,&quot;RFiles/Subject7.csv&quot;,&quot;RFiles/Subject8.csv&quot;)
AllSubjectData&lt;-data.frame()
for (i in 1:length(fnames)){
  SubjectData&lt;-read.table(fnames[i],header=TRUE,sep=&quot;,&quot;)
  AllSubjectData&lt;-rbind(AllSubjectData,SubjectData)
}
#&gt; Warning in file(file, &quot;rt&quot;): 無法開啟檔案 'RFiles/Subject1.csv' ：No such file or directory
#&gt; Error in file(file, &quot;rt&quot;): 無法開啟連接
CongruencyMeans&lt;-aggregate(KeypressTime.rt~participant*congruency,data=AllSubjectData,mean)
#&gt; Error in eval(predvars, data, env): 找不到物件 'KeypressTime.rt'
ANOVAresults&lt;-aov(KeypressTime.rt~factor(congruency) + Error(as.character(participant)/factor(congruency)),CongruencyMeans)
#&gt; Error in terms.formula(formula, &quot;Error&quot;, data = data): 找不到物件 'CongruencyMeans'
summary(ANOVAresults)
#&gt; 
#&gt; Error: Subjects
#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)    
#&gt; IVB        1 803558  803558    7620 &lt;2e-16 ***
#&gt; Residuals 38   4007     105                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Error: Subjects:IVW
#&gt;           Df Sum Sq Mean Sq  F value Pr(&gt;F)    
#&gt; IVW        1 183146  183146 1244.440 &lt;2e-16 ***
#&gt; IVB:IVW    1      2       2    0.017  0.897    
#&gt; Residuals 38   5593     147                    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
model.tables(ANOVAresults,&quot;means&quot;)
#&gt; Tables of means
#&gt; Grand mean
#&gt;          
#&gt; 250.7176 
#&gt; 
#&gt;  IVB 
#&gt; IVB
#&gt; level1 level2 
#&gt;  150.5  350.9 
#&gt; 
#&gt;  IVW 
#&gt; IVW
#&gt; level1 level2 
#&gt; 202.87 298.56 
#&gt; 
#&gt;  IVB:IVW 
#&gt;         IVW
#&gt; IVB      level1 level2
#&gt;   level1 102.5  198.5 
#&gt;   level2 303.3  398.6
</code></pre>
  </article><div class="collapse fs-6 pt-2" id="qnote-list">
    <div class="d-flex flex-column align-items-stretch flex-shrink-0 bg-white ">
        <span >
            
            <span class="fw-semibold">
                <button  class="btn btn-primary btn-inline" 
                   data-bs-toggle="collapse" data-bs-target="#qnote-edit"><span data-bs-toggle="tooltip" title="加入速記">加</span></button>
                <button id="qnote-gsave" class="btn btn-primary btn-inline" 
                   data-bs-toggle="tooltip" data-bs-placement="left" title="存到硬碟"
                   onclick="qnSaveGoogle()">存</button>
                <label for="qnote-load" class="btn btn-primary btn-inline"  data-bs-toggle="tooltip" data-bs-placement="left" title="從檔案載入">載</label>   
                <input style="display:none" type="file" id="qnote-load" onchange="qnLoadGoogle(this)" />
                <button id="qnote-clear" class="btn btn-primary btn-inline" 
                   data-bs-toggle="tooltip" data-bs-placement="left" title="清除全部速記"
                   onclick="cleanNotes()">清</button>
            </span>
        </span>
        <span class="fw-semibold collapse" id="qnote-edit"> 
            <input type="text" class="txtitle d-block w-100 h-25 " placeholder="抬頭" />
            <textarea class="txtBox  d-block w-100 h-75 " placeholder="本文"></textarea>
            
            <button id="qnote-add-item" onclick="addNote()" class="btn btn-primary">存</button> 
        </span>

    </div>
</div>

<link href="../../css/quicknote.css?1634789915" rel="stylesheet">
<script src="../../js/quicknote.js?1634789915"></script>
<div id="page-guide" class="bg-dark">  
  
    
          
          <a href="../../topic/simulation/poisson%E5%88%86%E9%85%8D.html" 
                   class="btn btn-primary" 
                   data-bs-toggle="tooltip" 
                   data-bs-placement="left" title=Poisson分配>前</a>
                   
          
            <a href="../../topic/simulation/central.html" 
               class="btn btn-primary" data-bs-toggle="tooltip" data-bs-placement="left" 
               title=中央>後</a>            
          
          

  
<script src="../../js/packhtml.js?1634789915"></script>    
<button class="btn btn-primary " onclick="packthis(this)"
data-bs-toggle="tooltip" data-bs-placement="left" title="打包成單一檔案">包</button>
<button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="div#qnote-list">
  <span data-bs-toggle="tooltip" data-bs-placement="left" title="快速註記">速</span></button>
 
</div>
  </div>


  <script src="../../js/featherlight.min.js?1634789915"></script>
  <script src="../../js/featherlight.gallery.min.js?1634789915"></script>
  <link href="../../css/featherlight.min.css?1634789915" rel="stylesheet">
  <link href="../../css/featherlight.gallery.min.css?1634789915" rel="stylesheet">

  <script src="../../js/highlight.pack.js?1634789915"></script>
  
  <script src="../../js/hugohelper.js?1634789915"></script>

  <link href="../../css/rmd.css?1634789915" rel="stylesheet">
  <link href="../../css/mystyle.css?1634789915" rel="stylesheet">    
  <script src='../../js/variant.js?1634789915'></script>

<script>
  
    let idxfile = "\/blogR\/index.json"  
  
</script>
<script src='../../js/localsearch.js?1634789915'></script>
    


  
      
          <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
      
      <script>
          mermaid.initialize({ startOnLoad: true });
      </script>
  

  <script>
    
      MathJax = {
        tex: {
          inlineMath: [['\($', '$\)'], ['\\(', '\\)']],
          displayMath: [['$$','$$']  , ['\\[','\\]']] 
        },
        svg: {
          fontCache: 'global'
        }
      };
      
      
    
      </script>
      <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
        src="https://example.com/mathjax/MathJax.js?config=TeX-AMS_CHTML">
      </script>



<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    jumpto = document.querySelector("#sidebar .active");
     if (jumpto!=null) jumpto.scrollIntoViewIfNeeded(true);
  
  });    
  
  </script>
</body>
</html>