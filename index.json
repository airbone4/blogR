[
{"uri": "https://airbone4.github.io/blogR/rlang/hw/dataset_class.html","title": "è³‡æ–™é›†",
	"tags": [],
	"description": "ç·´ç¿’",
	"content": " â“\n1. è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›è³‡æ–™é›†\n- ğŸ“data()å¯ä»¥åˆ—å‡ºç›®å‰æœ‰ç”šéº¼è³‡æ–™å¯ä»¥ç”¨,ä¹Ÿå¯ä»¥æ”¾å…¥åƒæ•¸,åªåˆ—å‡ºæŸå€‹packageçš„è³‡æ–™é›†ã€‚\n1. å¯«å€‹å‡½æ•¸,åˆ¤æ–·ç›®å‰æˆ‘å€‘è¦çš„è³‡æ–™é›†æ˜¯ä¸æ˜¯å­˜åœ¨\nâ“\n1. è¦çŸ¥é“è³‡æ–™é›†carsçš„æ¬„ä½\n1. åˆ—å‡ºå‰10ç­†è³‡æ–™\n- normal\n- pretty: ğŸ“ å®‰è£DT: install.pacakges(\u0026quot;DT\u0026quot;),åƒè€ƒ ğŸ’£ æœƒç¼ºå¤±å„ç¨®ç¨‹å¼åº«\nhint  data()\n names(cars)\nList of 4 #ğŸ·ğŸ‘è·Ÿæˆ‘å€‘èªªé€™æ˜¯list ,æœ‰4å€‹å…ƒç´  $ title : chr \u0026quot;Data sets\u0026quot; $ header : NULL $ results: chr [1:104, 1:4] # ğŸ·(é€™æ˜¯ä¸€å€‹å­—ä¸²çŸ©é™£,å¯ä»¥å¤§è‡´è³‡æ–™åœ¨é€™è£¡) \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; ... ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 ## ğŸ·(2ç¶­åº¦çš„åç¨±,é€™è£¡å¯ä»¥çœ‹åˆ°æ²’æœ‰ROWåç¨±,ä½†æ˜¯æœ‰æ¬„ä½åç¨±) .. ..$ : NULL .. ..$ : chr [1:4] #ğŸ·(é€™è£¡å¯ä»¥çœ‹å‡ºæ˜¯ä¸€å€‹çŸ©é™£) \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot; $ footer : chr \u0026quot;Use â€˜data(package = .packages(all.available = TRUE))â€™\\nto list the data sets in all *available* packages.\u0026quot; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;packageIQR\u0026quot;  ğŸ“ å®‰è£DT: install.pacakges(\u0026quot;DT\u0026quot;),åƒè€ƒ\n  practice  å±•é–‹ ```r library(DT) #\u0026gt; Warning: package \u0026#39;DT\u0026#39; was built under R version 4.0.3 dn\u0026lt;-data() ss\u0026lt;-dn$results[,\u0026#34;Title\u0026#34;] ds\u0026lt;-data.frame(ss) datatable(ds) ``` ![plot of chunk unnamed-chunk-1](/post/dataset_class_files/figure-html/unnamed-chunk-1-1.png) x \u0026lt;- sample(replace = TRUE, 20, x = c(1:10, NA)) y \u0026lt;- runif(min = 0, max = 1, 20) cor(m = \u0026quot;k\u0026quot;, y = y, u = \u0026quot;p\u0026quot;, x = x)  "},
{"uri": "https://airbone4.github.io/blogR/rlang/hw/hw_filesystem.html","title": "æª”æ¡ˆç³»çµ±",
	"tags": [],
	"description": "ç·´ç¿’",
	"content": " â“ 1  è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›å¥—ä»¶\n View\n åˆ—è¡¨(datatable)\n å¯«å…¥æª”æ¡ˆ(3å€‹æ¬„ä½,å¥—ä»¶åç¨±ã€å¥—ä»¶è·¯å¾‘å’Œå¥—ä»¶ç‰ˆæœ¬,æŒ‰ç…§åç¨±æ’åº)\n å¦‚æœä¸è¦row.names,è€Œä¸”æ¬„ä½åç¨±æ˜¯ä¸­æ–‡ã€‚\n  åˆ†æ\n ä¸»è¦ç‰ˆæœ¬ç¬¬2ç‰ˆçš„æœ‰å¹¾å€‹,æœ‰å“ªäº›?\n å¹³å‡æ¯å€‹å¥—ä»¶æœ‰å¹¾å€‹æª”æ¡ˆ?\npkgs\u0026lt;-installed.packages() str(pkgs) #\u0026gt; chr [1:169, 1:16] \u0026quot;addinStataFast\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; \u0026quot;babynames\u0026quot; ... #\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; ..$ : chr [1:169] \u0026quot;addinStataFast\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; \u0026quot;babynames\u0026quot; ... #\u0026gt; ..$ : chr [1:16] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Version\u0026quot; \u0026quot;Priority\u0026quot; ... # ğŸ·ä¸Šé¢å¯ä»¥çŸ¥é“æ˜¯matrix head(rownames(pkgs),5) #\u0026gt; [1] \u0026quot;addinStataFast\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; \u0026quot;babynames\u0026quot; #\u0026gt; [5] \u0026quot;backports\u0026quot; head(colnames(pkgs),5) #\u0026gt; [1] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Version\u0026quot; \u0026quot;Priority\u0026quot; \u0026quot;Depends\u0026quot;  library(DT) #\u0026gt; Warning: package 'DT' was built under R version 4.0.3 fm\u0026lt;-data.frame(pkgs[,c(1,2,3)]) datatable(fm)    æª”æ¡ˆ write.csv(fm,file=\u0026quot;c:\\temp\\xx.csv\u0026quot;,useB) # ğŸ·ç‚ºç”šéº¼éŒ¯,å¦‚ä½•ä¿®æ­£   è¨»è§£\n 1ï¸âƒ£ è¼¸å‡ºæª”æ¡ˆ,å¸¶æœ‰row.names,åƒæ•¸:row.names å¯ä»¥æ˜¯T,F,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸²åç¨±\nwrite.csv(fm,file=\u0026quot;c:/temp/foo.csv\u0026quot;) #  2ï¸âƒ£\n#ğŸ·ä¸è¦åˆ—åç¨± write.csv(fm,file=\u0026quot;c:/temp/foo1.csv\u0026quot;,row.names=F)  3ï¸âƒ£\n#ğŸ·åˆ©ç”¨`write.table` write.table(x, file = \u0026quot;foo.csv\u0026quot;, sep = \u0026quot;,\u0026quot;, col.names = NA, qmethod = \u0026quot;double\u0026quot;) read.table(\u0026quot;foo.csv\u0026quot;, header = TRUE, sep = \u0026quot;,\u0026quot;, row.names = 1)  colnames(fm)\u0026lt;-c(\u0026quot;å¥—ä»¶,è·¯å¾‘,ç‰ˆæœ¬\u0026quot;) ##ğŸ·ä¿®æ­£:\u0026#34;å¥—ä»¶\u0026#34;,\u0026#34;è·¯å¾‘\u0026#34;,\u0026#34;ç‰ˆæœ¬\u0026#34;  datatable(fm )    # ğŸ·â“æ€æ¨£æŠŠè¡¨æ ¼ä¸­çš„row.nameså»æ‰?  # ğŸ·datatable(fm,rownames=F)   colnames(fm)\u0026lt;-c(\u0026quot;å¥—ä»¶\u0026quot;,\u0026quot;è·¯å¾‘\u0026quot;,\u0026quot;ç‰ˆæœ¬\u0026quot;) datatable(fm,rownames=F )  æ‹¿åˆ°ä¸»è¦ç‰ˆæœ¬ x\u0026lt;-strsplit(fm[,3],\u0026quot;\\\\.\u0026quot;) sapply(x,head,1)  "},
{"uri": "https://airbone4.github.io/blogR/rlang/hw/hw_basic.html","title": "assignment-1",
	"tags": [],
	"description": "assignment",
	"content": " part 1 basic  åƒè€ƒç¨‹å¼ç¢¼,æ•¸å­¸ä¸Š,eæ—¢ç„¶æ˜¯ç´”é‡,é‚£å°±æ˜¯1X1çš„çŸ©é™£ã€‚åœ¨Rä¸­,å¦‚æœ e\u0026lt;-3é‚£éº¼åœ¨Rä¸­åˆ¤æ–·eæ˜¯ä¸æ˜¯ç›¸é‡,æ˜¯ä¸æ˜¯çŸ©é™£?\ne\u0026lt;-3 length(e) #\u0026gt; [1] 1 is.vector(e) # q1: true or false #\u0026gt; [1] TRUE is.matrix(e) # q2: true or false #\u0026gt; [1] FALSE # æŒ‡å®šæ²’æœ‰ä»»ä½•è³‡æ–™çš„å‘é‡ e1\u0026lt;-numeric(0) length(e1) #\u0026gt; [1] 0 is.vector(e) # q3: true or false #\u0026gt; [1] TRUE  å»ºç«‹å‘é‡e21,e22,e23 è§£é‡‹å‡ºç¾çš„è¨Šæ¯\ne21\u0026lt;-1:3 # å‘é‡,å…§å®¹ç‚º[1,2,3] ä¹Ÿå¯ä»¥e2\u0026lt;-seq(1,3),e2\u0026lt;-c(1,2,3) e22\u0026lt;-1:4 e23\u0026lt;-1:6 e21==e23 #\u0026gt; [1] TRUE TRUE TRUE FALSE FALSE FALSE e21==e22 #\u0026gt; Warning in e21 == e22: è¼ƒé•·çš„ç‰©ä»¶é•·åº¦ä¸¦éè¼ƒçŸ­ç‰©ä»¶é•·åº¦çš„å€æ•¸ #\u0026gt; [1] TRUE TRUE TRUE FALSE  \u0026gt; e21==e23 [1] TRUE TRUE TRUE FALSE FALSE FALSE \u0026gt; e21==e22 [1] TRUE TRUE TRUE FALSE Warning message: In e21 == e22 : è¼ƒé•·çš„ç‰©ä»¶é•·åº¦ä¸¦éè¼ƒçŸ­ç‰©ä»¶é•·åº¦çš„å€æ•¸   3.è§£é‡‹ç¬¬2è¡Œalphaçš„é•·åº¦,å¦‚æœåªè¦ä¿æŒå‰3å€‹å…ƒç´ ?\nalpha\u0026lt;-1:10 alpha \u0026lt;- alpha[2 * 1:5]  hint: ä¹Ÿå¯ä»¥length(alpha)\u0026lt;-3 ä½†æ˜¯ä¸å»ºè­°ã€‚\n åˆä½µæˆçŸ©é™£\nåˆ©ç”¨å‰è¿°çš„e21,e22,e23 ,åˆ†åˆ¥è§£é‡‹ä¸‹é¢å…©è¡Œ\nc(e21,e22) #\u0026gt; [1] 1 2 3 1 2 3 4 cbind(e21,e22) #\u0026gt; Warning in cbind(e21, e22): number of rows of result is not a multiple of vector #\u0026gt; length (arg 1) #\u0026gt; e21 e22 #\u0026gt; [1,] 1 1 #\u0026gt; [2,] 2 2 #\u0026gt; [3,] 3 3 #\u0026gt; [4,] 1 4  ç”¢ç”Ÿ5x20çš„äº‚æ•¸çŸ©é™£\n ç‚ºç”šéº¼æœ‰a[\u0026quot;x1\u0026quot;]? é€™é¡Œçš„ç”¨æ„åªæ˜¯è¨˜ä½ç”šéº¼æ˜¯c()å‡½æ•¸ã€‚\na\u0026lt;-c(x=1:2,y=3:4) a[\u0026quot;x1\u0026quot;] # ä¸æ˜¯a[x1]  â“ å›ç­”x2 æ˜¯ç”šéº¼å‹æ…‹\nx1\u0026lt;-list(3,4,5) x2\u0026lt;-c(1,2,x1)   â“ æ€æ¨£æŠŠlist,e.g.x2, è½‰vector ?\nâ“æŠŠå¶æ•¸æ‰¾å‡ºä¾†\nx \u0026lt;- rpois(40, lambda=5)   hint ```r x[x %% 2 == 0] ``` function å¯«ä¸€å€‹matlab çš„çŸ©é™£å‡½æ•¸\nmm\u0026lt;-function(rcnt,ccnt,value){ total\u0026lt;-rcnt*ccnt v\u0026lt;-double(total) v[1:total]\u0026lt;-value return(matrix(v,rcnt,ccnt)) }  å¯«ä¸€å€‹å‡½æ•¸,åˆ¤æ–·ç›®å‰çš„è³‡æ–™å¤¾ä¸­,æœ‰æ²’æœ‰æª”æ¡ˆmm.R\nisExists\u0026lt;-function(afile){ all\u0026lt;-dir() rst\u0026lt;-length(all[all==afile]) return (rst) }  "},
{"uri": "https://airbone4.github.io/blogR/rlang/hw/hw_regexp.html","title": "regexpr",
	"tags": [],
	"description": "assignment",
	"content": " reference cheatsheet\næŠ½å–å­—çµ„ çœ‹çœ‹æ˜¯ä¸æ˜¯#é–‹é ­çš„å­—ä¸²,å¦‚æœæ˜¯çš„è©±è¦ç½®æ›,ä¾‹å¦‚\n\u0026quot;# hello\u0026quot; -\u0026gt;\u0026quot;# hello \u0026quot;\nstr\u0026lt;-\u0026quot;# hello\u0026quot; if(grepl(\u0026quot;^[#]* \u0026quot;,str)) { x\u0026lt;-sub(\u0026quot;(^[#]* )(.*$)\u0026quot;,\u0026quot;\\\\1 \u0026lt;font color='red'\u0026gt; \\\\2 \u0026lt;/font\u0026gt;\u0026quot;,str, perl=TRUE) print(x) } #\u0026gt; [1] \u0026quot;# \u0026lt;font color='red'\u0026gt; hello \u0026lt;/font\u0026gt;\u0026quot;  é¡ä¼¼ä¸Šé¡Œ divtitle\u0026lt;-function (str){ if(grepl(\u0026quot;^[#]* \u0026quot;,str)) { rst\u0026lt;-sub(\u0026quot;(^[#]* )(.*$)\u0026quot;,\u0026quot;\\\\1 \u0026lt;div class='outposix'\u0026gt; \\\\2 \u0026lt;/div\u0026gt;\u0026quot;,str, perl=TRUE) }else{ rst\u0026lt;-paste0(\u0026quot;\u0026lt;div class='outposix'\u0026gt;\u0026quot;,str,\u0026quot;\u0026lt;/div\u0026gt;\u0026quot;) } }  æ¸¬è©¦what1 pattern\u0026lt;-\u0026quot;out\u0026quot; ext\u0026lt;-\u0026quot;oo\u0026quot; list\u0026lt;-list(\u0026quot;out_ä¸­æ–‡_1.oo\u0026quot;,\u0026quot;out_1.oo\u0026quot;,\u0026quot;out_xx_1.oo\u0026quot;) what\u0026lt;-paste0(\u0026quot;(?\u0026lt;=\u0026quot;,pattern,\u0026quot;_).*\u0026quot;,\u0026quot;(?=\\\\.\u0026quot;,ext,\u0026quot;)\u0026quot;); idxlist\u0026lt;-as.integer(stringr::str_extract(list,what)); #\u0026gt; Warning: å¼·åˆ¶è®Šæ›´éç¨‹ä¸­ç”¢ç”Ÿäº† NA idxlist #\u0026gt; [1] NA 1 NA  åŸ·è¡Œçµæœ\n#\u0026gt; Warning: å¼·åˆ¶è®Šæ›´éç¨‹ä¸­ç”¢ç”Ÿäº† NA idxlist #\u0026gt; [1] NA 1 NA   è§£é‡‹ NA, å’Œ\n ç‚ºç”šéº¼?\n  æ¸¬è©¦what2 pattern\u0026lt;-\u0026quot;out\u0026quot; ext\u0026lt;-\u0026quot;oo\u0026quot; list\u0026lt;-list(\u0026quot;out_ä¸­æ–‡_1.oo\u0026quot;,\u0026quot;out_1.oo\u0026quot;,\u0026quot;out_xx_1.oo\u0026quot;,\u0026quot;out_ä¸­æ–‡2_1.oo\u0026quot;) what\u0026lt;-paste0(\u0026quot;(?\u0026lt;=\u0026quot;,pattern,\u0026quot;_).*(\\\\d)+\u0026quot;,\u0026quot;(?=\\\\.\u0026quot;,ext,\u0026quot;)\u0026quot;); r1\u0026lt;-stringr::str_extract(list,what) r1 #\u0026gt; [1] \u0026quot;ä¸­æ–‡_1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;xx_1\u0026quot; \u0026quot;ä¸­æ–‡2_1\u0026quot; stringr::str_extract(r1,\u0026quot;\\\\d$\u0026quot;) #\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;1\u0026quot;  shopping_list \u0026lt;- c(\u0026quot;apples x4\u0026quot;, \u0026quot;bag of flour\u0026quot;, \u0026quot;bag of sugar\u0026quot;, \u0026quot;milk x2\u0026quot;) stringr::str_extract(shopping_list, \u0026quot;\\\\d\u0026quot;) #\u0026gt; [1] \u0026quot;4\u0026quot; NA NA \u0026quot;2\u0026quot;  "},
{"uri": "https://airbone4.github.io/blogR/rlang/demo/citation.html","title": "å¼•ç”¨",
	"tags": [],
	"description": "æš«æ™‚",
	"content": " introduction Goal: Estimate the effect of the price per citation on the number of library subscriptions\n Journals.csv  Journals.csv   initial options(prompt = \u0026quot;R\u0026gt; \u0026quot;, continue = \u0026quot;+ \u0026quot;, width = 64,\ndigits = 4, show.signif.stars = FALSE, useFancyQuotes = FALSE)\nlibrary(\u0026quot;AER\u0026quot;)\nset.seed(1071)\nlibrary(\u0026quot;AER\u0026quot;) #\u0026gt; Warning: package 'AER' was built under R version 4.0.3 #\u0026gt; Loading required package: car #\u0026gt; Warning: package 'car' was built under R version 4.0.3 #\u0026gt; Loading required package: carData #\u0026gt; Warning: package 'carData' was built under R version 4.0.3 #\u0026gt; Loading required package: lmtest #\u0026gt; Warning: package 'lmtest' was built under R version 4.0.3 #\u0026gt; Loading required package: zoo #\u0026gt; Warning: package 'zoo' was built under R version 4.0.3 #\u0026gt; #\u0026gt; Attaching package: 'zoo' #\u0026gt; The following objects are masked from 'package:base': #\u0026gt; #\u0026gt; as.Date, as.Date.numeric #\u0026gt; Loading required package: sandwich #\u0026gt; Warning: package 'sandwich' was built under R version 4.0.3 #\u0026gt; Loading required package: survival #\u0026gt; Warning: package 'survival' was built under R version 4.0.3 data(\u0026quot;Journals\u0026quot;, package = \u0026quot;AER\u0026quot;) #View(Journals) journals \u0026lt;- Journals[, c(\u0026quot;subs\u0026quot;, \u0026quot;price\u0026quot;)] journals$citeprice \u0026lt;- Journals$price/Journals$citations summary(journals) #\u0026gt; subs price citeprice #\u0026gt; Min. : 2.0 Min. : 20.0 Min. : 0.005223 #\u0026gt; 1st Qu.: 52.0 1st Qu.: 134.5 1st Qu.: 0.464495 #\u0026gt; Median : 122.5 Median : 282.0 Median : 1.320513 #\u0026gt; Mean : 196.9 Mean : 417.7 Mean : 2.548455 #\u0026gt; 3rd Qu.: 268.2 3rd Qu.: 540.8 3rd Qu.: 3.440171 #\u0026gt; Max. :1098.0 Max. :2120.0 Max. :24.459459  â“ ç·´ç¿’:\næ”¹æˆdatatable\nplot(log(subs) ~ log(citeprice), data = journals) jour_lm \u0026lt;- lm(log(subs) ~ log(citeprice), data = journals) abline(jour_lm)  â“ what is jour_lm ?\nclass(jour_lm) #\u0026gt; [1] \u0026quot;lm\u0026quot; names(jour_lm) #\u0026gt; [1] \u0026quot;coefficients\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;effects\u0026quot; \u0026quot;rank\u0026quot; #\u0026gt; [5] \u0026quot;fitted.values\u0026quot; \u0026quot;assign\u0026quot; \u0026quot;qr\u0026quot; \u0026quot;df.residual\u0026quot; #\u0026gt; [9] \u0026quot;xlevels\u0026quot; \u0026quot;call\u0026quot; \u0026quot;terms\u0026quot; \u0026quot;model\u0026quot; str(jour_lm) #ğŸ·æ³¨æ„`list of 12`  #\u0026gt; List of 12 #\u0026gt; $ coefficients : Named num [1:2] 4.766 -0.533 #\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; $ residuals : Named num [1:180] -1.185 -0.739 -0.332 -2.725 1.136 ... #\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ... #\u0026gt; $ effects : Named num [1:180] -63.599 -11.222 -0.338 -2.715 1.146 ... #\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; ... #\u0026gt; $ rank : int 2 #\u0026gt; $ fitted.values: Named num [1:180] 3.82 4.82 3.17 3.42 3.43 ... #\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ... #\u0026gt; $ assign : int [1:2] 0 1 #\u0026gt; $ qr :List of 5 #\u0026gt; ..$ qr : num [1:180, 1:2] -13.4164 0.0745 0.0745 0.0745 0.0745 ... #\u0026gt; .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; .. .. ..$ : chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ... #\u0026gt; .. .. ..$ : chr [1:2] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. ..- attr(*, \u0026quot;assign\u0026quot;)= int [1:2] 0 1 #\u0026gt; ..$ qraux: num [1:2] 1.07 1.01 #\u0026gt; ..$ pivot: int [1:2] 1 2 #\u0026gt; ..$ tol : num 1e-07 #\u0026gt; ..$ rank : int 2 #\u0026gt; ..- attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;qr\u0026quot; #\u0026gt; $ df.residual : int 178 #\u0026gt; $ xlevels : Named list() #\u0026gt; $ call : language lm(formula = log(subs) ~ log(citeprice), data = journals) #\u0026gt; $ terms :Classes 'terms', 'formula' language log(subs) ~ log(citeprice) #\u0026gt; .. ..- attr(*, \u0026quot;variables\u0026quot;)= language list(log(subs), log(citeprice)) #\u0026gt; .. ..- attr(*, \u0026quot;factors\u0026quot;)= int [1:2, 1] 0 1 #\u0026gt; .. .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; .. .. .. ..$ : chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. .. .. ..$ : chr \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. ..- attr(*, \u0026quot;term.labels\u0026quot;)= chr \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. ..- attr(*, \u0026quot;order\u0026quot;)= int 1 #\u0026gt; .. ..- attr(*, \u0026quot;intercept\u0026quot;)= int 1 #\u0026gt; .. ..- attr(*, \u0026quot;response\u0026quot;)= int 1 #\u0026gt; .. ..- attr(*, \u0026quot;.Environment\u0026quot;)=\u0026lt;environment: R_GlobalEnv\u0026gt; #\u0026gt; .. ..- attr(*, \u0026quot;predvars\u0026quot;)= language list(log(subs), log(citeprice)) #\u0026gt; .. ..- attr(*, \u0026quot;dataClasses\u0026quot;)= Named chr [1:2] \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; #\u0026gt; .. .. ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; $ model :'data.frame':\t180 obs. of 2 variables: #\u0026gt; ..$ log(subs) : num [1:180] 2.639 4.078 2.833 0.693 4.564 ... #\u0026gt; ..$ log(citeprice): num [1:180] 1.7677 -0.0953 3.0025 2.5294 2.5089 ... #\u0026gt; ..- attr(*, \u0026quot;terms\u0026quot;)=Classes 'terms', 'formula' language log(subs) ~ log(citeprice) #\u0026gt; .. .. ..- attr(*, \u0026quot;variables\u0026quot;)= language list(log(subs), log(citeprice)) #\u0026gt; .. .. ..- attr(*, \u0026quot;factors\u0026quot;)= int [1:2, 1] 0 1 #\u0026gt; .. .. .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; .. .. .. .. ..$ : chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. .. .. .. ..$ : chr \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. .. ..- attr(*, \u0026quot;term.labels\u0026quot;)= chr \u0026quot;log(citeprice)\u0026quot; #\u0026gt; .. .. ..- attr(*, \u0026quot;order\u0026quot;)= int 1 #\u0026gt; .. .. ..- attr(*, \u0026quot;intercept\u0026quot;)= int 1 #\u0026gt; .. .. ..- attr(*, \u0026quot;response\u0026quot;)= int 1 #\u0026gt; .. .. ..- attr(*, \u0026quot;.Environment\u0026quot;)=\u0026lt;environment: R_GlobalEnv\u0026gt; #\u0026gt; .. .. ..- attr(*, \u0026quot;predvars\u0026quot;)= language list(log(subs), log(citeprice)) #\u0026gt; .. .. ..- attr(*, \u0026quot;dataClasses\u0026quot;)= Named chr [1:2] \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; #\u0026gt; .. .. .. ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot; #\u0026gt; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;lm\u0026quot;  â“ è‡ªç”±åº¦åœ¨å“ª?\n æç¤º ```r jour_lm$rank #\u0026gt; [1] 2 ``` æœ€ç°¡å–®çš„å ±å‘Šç”¢ç”Ÿå‡½æ•¸ summary(jour_lm) #\u0026gt; #\u0026gt; Call: #\u0026gt; lm(formula = log(subs) ~ log(citeprice), data = journals) #\u0026gt; #\u0026gt; Residuals: #\u0026gt; Min 1Q Median 3Q Max #\u0026gt; -2.72478 -0.53609 0.03721 0.46619 1.84808 #\u0026gt; #\u0026gt; Coefficients: #\u0026gt; Estimate Std. Error t value Pr(\u0026gt;|t|) #\u0026gt; (Intercept) 4.76621 0.05591 85.25 \u0026lt;2e-16 *** #\u0026gt; log(citeprice) -0.53305 0.03561 -14.97 \u0026lt;2e-16 *** #\u0026gt; --- #\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #\u0026gt; #\u0026gt; Residual standard error: 0.7497 on 178 degrees of freedom #\u0026gt; Multiple R-squared: 0.5573, Adjusted R-squared: 0.5548 #\u0026gt; F-statistic: 224 on 1 and 178 DF, p-value: \u0026lt; 2.2e-16  jour_slm \u0026lt;- summary(jour_lm) class(jour_slm) #\u0026gt; [1] \u0026quot;summary.lm\u0026quot; names(jour_slm) #\u0026gt; [1] \u0026quot;call\u0026quot; \u0026quot;terms\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;coefficients\u0026quot; #\u0026gt; [5] \u0026quot;aliased\u0026quot; \u0026quot;sigma\u0026quot; \u0026quot;df\u0026quot; \u0026quot;r.squared\u0026quot; #\u0026gt; [9] \u0026quot;adj.r.squared\u0026quot; \u0026quot;fstatistic\u0026quot; \u0026quot;cov.unscaled\u0026quot; jour_slm$coefficients #\u0026gt; Estimate Std. Error t value Pr(\u0026gt;|t|) #\u0026gt; (Intercept) 4.7662121 0.05590908 85.24934 2.953913e-146 #\u0026gt; log(citeprice) -0.5330535 0.03561320 -14.96786 2.563943e-33  anova(jour_lm) #\u0026gt; Analysis of Variance Table #\u0026gt; #\u0026gt; Response: log(subs) #\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; log(citeprice) 1 125.93 125.934 224.04 \u0026lt; 2.2e-16 *** #\u0026gt; Residuals 178 100.06 0.562 #\u0026gt; --- #\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 coef(jour_lm) #\u0026gt; (Intercept) log(citeprice) #\u0026gt; 4.7662121 -0.5330535 confint(jour_lm, level = 0.95) #\u0026gt; 2.5 % 97.5 % #\u0026gt; (Intercept) 4.6558822 4.8765420 #\u0026gt; log(citeprice) -0.6033319 -0.4627751  predict(jour_lm, newdata = data.frame(citeprice = 2.11), interval = \u0026quot;confidence\u0026quot;) #\u0026gt; fit lwr upr #\u0026gt; 1 4.368188 4.247485 4.48889 predict(jour_lm, newdata = data.frame(citeprice = 2.11), interval = \u0026quot;prediction\u0026quot;) #\u0026gt; fit lwr upr #\u0026gt; 1 4.368188 2.883746 5.852629  lciteprice \u0026lt;- seq(from = -6, to = 4, by = 0.25) jour_pred \u0026lt;- predict(jour_lm, interval = \u0026quot;prediction\u0026quot;, newdata = data.frame(citeprice = exp(lciteprice))) plot(log(subs) ~ log(citeprice), data = journals) lines(jour_pred[, 1] ~ lciteprice, col = 1) lines(jour_pred[, 2] ~ lciteprice, col = 1, lty = 2) lines(jour_pred[, 3] ~ lciteprice, col = 1, lty = 2)  åƒæ•¸ç‚ºæ¨¡å‹é¡åˆ¥çš„plot() ç”¢ç”Ÿ6ç¨®,é è¨­4ç¨®\n residuals versus fitted values,\n QQ plot for normality,\n scale-location plot,\n standardized residuals versus leverages.\n  å€‹åˆ¥çš„åœ–:ä¾‹å¦‚QQ plot:ã€€plot(jour_lm, which = 2)\npar(mfrow = c(2, 2)) plot(jour_lm)  par(mfrow = c(1, 1)) linearHypothesis(jour_lm, \u0026quot;log(citeprice) = -0.5\u0026quot;) #\u0026gt; Linear hypothesis test #\u0026gt; #\u0026gt; Hypothesis: #\u0026gt; log(citeprice) = - 0.5 #\u0026gt; #\u0026gt; Model 1: restricted model #\u0026gt; Model 2: log(subs) ~ log(citeprice) #\u0026gt; #\u0026gt; Res.Df RSS Df Sum of Sq F Pr(\u0026gt;F) #\u0026gt; 1 179 100.54 #\u0026gt; 2 178 100.06 1 0.48421 0.8614 0.3546  â“ åˆ©ç”¨è³‡æ–™é›† cars : dist ~ speed\n åˆ†åˆ¥çµ¦å‡º speed=12,19,24 çš„ä¿¡è³´å€é–“å’Œé æ¸¬å€é–“\n ç•«åœ–\n  "},
{"uri": "https://airbone4.github.io/blogR/rlang/1_0_requirement.html","title": "1 Requirement",
	"tags": [],
	"description": "è»Ÿé«”ç’°å¢ƒ",
	"content": "æœ‰é—œç³»çµ±  .Renviron åœ¨%USERPROFILE%ä¸­ã€‚ç”¨ä¾†åœ¨Rå•Ÿå‹•ä¹‹å‰,è¨­å®šç³»çµ±çš„ç’°å¢ƒè®Šæ•¸,ä¾‹å¦‚rtoolsçš„ä½ç½®ã€‚åƒè€ƒ\n windows å¹¾å€‹å¸¸ç”¨çš„è³‡æ–™å¤¾\n %USERPROFILE%\n %LOCALAPPDATA%\n %APPDATA%\n ç¯„ä¾‹\n## Example ~/.Renviron on Unix R_LIBS=~/R/library PAGER=/usr/local/bin/less ## Example .Renviron on Windows R_LIBS=C:/R/library MY_TCLTK=\u0026quot;c:/Program Files/Tcl/bin\u0026quot; ## Example of setting R_DEFAULT_PACKAGES (from R CMD check) R_DEFAULT_PACKAGES='utils,grDevices,graphics,stats' # this loads the packages in the order given, so they appear on # the search path in reverse order. ## Example of .Rprofile options(width=65, digits=5) options(show.signif.stars=FALSE) setHook(packageEvent(\u0026quot;grDevices\u0026quot;, \u0026quot;onLoad\u0026quot;), function(...) grDevices::ps.options(horizontal=FALSE)) set.seed(1234) .First \u0026lt;- function() cat(\u0026quot;\\n Welcome to R!\\n\\n\u0026quot;) .Last \u0026lt;- function() cat(\u0026quot;\\n Goodbye!\\n\\n\u0026quot;) ## Example of Rprofile.site local({ # add MASS to the default packages, set a CRAN mirror old \u0026lt;- getOption(\u0026quot;defaultPackages\u0026quot;); r \u0026lt;- getOption(\u0026quot;repos\u0026quot;) r[\u0026quot;CRAN\u0026quot;] \u0026lt;- \u0026quot;http://my.local.cran\u0026quot; options(defaultPackages = c(old, \u0026quot;MASS\u0026quot;), repos = r) ## (for Unix terminal users) set the width from COLUMNS if set cols \u0026lt;- Sys.getenv(\u0026quot;COLUMNS\u0026quot;) if(nzchar(cols)) options(width = as.integer(cols)) # interactive sessions get a fortune cookie (needs fortunes package) if (interactive()) fortunes::fortune() }) ## if .Renviron contains FOOBAR=\u0026quot;coo\\bar\u0026quot;doh\\ex\u0026quot;abc\\\u0026quot;def'\u0026quot; ## then we get # \u0026gt; cat(Sys.getenv(\u0026quot;FOOBAR\u0026quot;), \u0026quot;\\n\u0026quot;) # coo\\bardoh\\exabc\u0026quot;def'   R.home() Sys.getenv(\u0026quot;R_HOME\u0026quot;) éƒ½å¯ä»¥çŸ¥é“å®‰è£çš„ç›®éŒ„\n ç›®å‰çš„è¨­å®š\noptions()  \ré¡¯ç¤ºçµæœ\r#\u0026gt; $add.smooth #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $blogdown.method #\u0026gt; [1] \u0026quot;markdown\u0026quot; #\u0026gt; #\u0026gt; $blogdown.serve_site.startup #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $browserNLdisabled #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $CBoundsCheck #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $check.bounds #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $citation.bibtex.max #\u0026gt; [1] 1 #\u0026gt; #\u0026gt; $continue #\u0026gt; [1] \u0026quot;+ \u0026quot; #\u0026gt; #\u0026gt; $contrasts #\u0026gt; unordered ordered #\u0026gt; \u0026quot;contr.treatment\u0026quot; \u0026quot;contr.poly\u0026quot; #\u0026gt; #\u0026gt; $defaultPackages #\u0026gt; [1] \u0026quot;datasets\u0026quot; \u0026quot;utils\u0026quot; \u0026quot;grDevices\u0026quot; \u0026quot;graphics\u0026quot; \u0026quot;stats\u0026quot; \u0026quot;methods\u0026quot; #\u0026gt; #\u0026gt; $demo.ask #\u0026gt; [1] \u0026quot;default\u0026quot; #\u0026gt; #\u0026gt; $deparse.cutoff #\u0026gt; [1] 60 #\u0026gt; #\u0026gt; $device #\u0026gt; function (width = 7, height = 7, ...) #\u0026gt; { #\u0026gt; grDevices::pdf(NULL, width, height, ...) #\u0026gt; } #\u0026gt; \u0026lt;bytecode: 0x000000001a675208\u0026gt; #\u0026gt; \u0026lt;environment: namespace:knitr\u0026gt; #\u0026gt; #\u0026gt; $device.ask.default #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $digits #\u0026gt; [1] 7 #\u0026gt; #\u0026gt; $echo #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $editor #\u0026gt; [1] \u0026quot;notepad\u0026quot; #\u0026gt; #\u0026gt; $encoding #\u0026gt; [1] \u0026quot;native.enc\u0026quot; #\u0026gt; #\u0026gt; $example.ask #\u0026gt; [1] \u0026quot;default\u0026quot; #\u0026gt; #\u0026gt; $expressions #\u0026gt; [1] 5000 #\u0026gt; #\u0026gt; $help.search.types #\u0026gt; [1] \u0026quot;vignette\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;help\u0026quot; #\u0026gt; #\u0026gt; $help.try.all.packages #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $help_type #\u0026gt; [1] \u0026quot;html\u0026quot; #\u0026gt; #\u0026gt; $HTTPUserAgent #\u0026gt; [1] \u0026quot;R (4.1.1 x86_64-w64-mingw32 x86_64 mingw32)\u0026quot; #\u0026gt; #\u0026gt; $install.packages.compile.from.source #\u0026gt; [1] \u0026quot;interactive\u0026quot; #\u0026gt; #\u0026gt; $internet.info #\u0026gt; [1] 2 #\u0026gt; #\u0026gt; $keep.parse.data #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $keep.parse.data.pkgs #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $keep.source #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $keep.source.pkgs #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $knitr.in.progress \u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ç›®å‰çš„æ–‡ä»¶åœ¨RMDä¸­ç”¢ç”Ÿ \u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt; #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $locatorBell #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $mailer #\u0026gt; [1] \u0026quot;mailto\u0026quot; #\u0026gt; #\u0026gt; $matprod #\u0026gt; [1] \u0026quot;default\u0026quot; #\u0026gt; #\u0026gt; $max.print #\u0026gt; [1] 99999 #\u0026gt; #\u0026gt; $menu.graphics #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $na.action #\u0026gt; [1] \u0026quot;na.omit\u0026quot; #\u0026gt; #\u0026gt; $nwarnings #\u0026gt; [1] 50 #\u0026gt; #\u0026gt; $OutDec #\u0026gt; [1] \u0026quot;.\u0026quot; #\u0026gt; #\u0026gt; $pager #\u0026gt; [1] \u0026quot;internal\u0026quot; #\u0026gt; #\u0026gt; $papersize #\u0026gt; [1] \u0026quot;a4\u0026quot; #\u0026gt; #\u0026gt; $PCRE_limit_recursion #\u0026gt; [1] NA #\u0026gt; #\u0026gt; $PCRE_study #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $PCRE_use_JIT #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $pdfviewer #\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/bin/x64/open.exe\u0026quot; #\u0026gt; #\u0026gt; $pkgType #\u0026gt; [1] \u0026quot;both\u0026quot; #\u0026gt; #\u0026gt; $prompt #\u0026gt; [1] \u0026quot;\u0026gt; \u0026quot; #\u0026gt; #\u0026gt; $repos #\u0026gt; CRAN #\u0026gt; \u0026quot;@CRAN@\u0026quot; #\u0026gt; #\u0026gt; $scipen #\u0026gt; [1] 0 #\u0026gt; #\u0026gt; $show.coef.Pvalues #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $show.error.messages #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $show.signif.stars #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $showErrorCalls #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $str #\u0026gt; $str$strict.width #\u0026gt; [1] \u0026quot;no\u0026quot; #\u0026gt; #\u0026gt; $str$digits.d #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; $str$vec.len #\u0026gt; [1] 4 #\u0026gt; #\u0026gt; $str$list.len #\u0026gt; [1] 99 #\u0026gt; #\u0026gt; $str$deparse.lines #\u0026gt; NULL #\u0026gt; #\u0026gt; $str$drop.deparse.attr #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $str$formatNum #\u0026gt; function (x, ...) #\u0026gt; format(x, trim = TRUE, drop0trailing = TRUE, ...) #\u0026gt; \u0026lt;environment: 0x00000000193f2900\u0026gt; #\u0026gt; #\u0026gt; #\u0026gt; $str.dendrogram.last #\u0026gt; [1] \u0026quot;`\u0026quot; #\u0026gt; #\u0026gt; $stringsAsFactors #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $tikzMetricsDictionary #\u0026gt; [1] \u0026quot;1_0_requirement-tikzDictionary\u0026quot; #\u0026gt; #\u0026gt; $timeout #\u0026gt; [1] 60 #\u0026gt; #\u0026gt; $try.outFile #\u0026gt; A connection with #\u0026gt; description \u0026quot;output\u0026quot; #\u0026gt; class \u0026quot;textConnection\u0026quot; #\u0026gt; mode \u0026quot;wr\u0026quot; #\u0026gt; text \u0026quot;text\u0026quot; #\u0026gt; opened \u0026quot;opened\u0026quot; #\u0026gt; can read \u0026quot;no\u0026quot; #\u0026gt; can write \u0026quot;yes\u0026quot; #\u0026gt; #\u0026gt; $ts.eps #\u0026gt; [1] 1e-05 #\u0026gt; #\u0026gt; $ts.S.compat #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $unzip #\u0026gt; [1] \u0026quot;internal\u0026quot; #\u0026gt; #\u0026gt; $useFancyQuotes #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $verbose #\u0026gt; [1] FALSE #\u0026gt; #\u0026gt; $warn #\u0026gt; [1] 0 #\u0026gt; #\u0026gt; $warning.length #\u0026gt; [1] 1000 #\u0026gt; #\u0026gt; $width #\u0026gt; [1] 80 #\u0026gt; #\u0026gt; $windowsTimeouts #\u0026gt; [1] 100 500     å®‰è£è»Ÿé«” éƒ¨ä»½è»Ÿé«”åˆ—è¡¨\nå¦å¤–æ–¼linux å®‰è£ tidyverseæ™‚éœ€è¦:\nsudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev  install.packages()\ninstall.packages('devtools') install.packages('bookdown') install.packages('rlang') install.packages('tidyr') install.packages('babynames') install.packages('ggplot2') install.packages('sm') install.packages('bindrcpp') install.packages('tidyverse') install.packages('codetools') install.packages('moments') library('devtools') install_github(\u0026quot;Hadley/emo\u0026quot;) install.packages(\u0026quot;blogdown\u0026quot;) ## options(repos = c(CRAN = \u0026quot;https://cran.revolutionanalytics.com\u0026quot;))  å¦‚æœæ˜¯linuxç³»çµ±è¦å…ˆ:\n# sudo visudo # ç„¶å¾ŒåŠ å…¥ # username ALL = NOPASSWD: /fullpath/to/command, /fullpath/to/othercommand # ä¸‹é¢é€™å€‹system éœ€è¦ä¸Šé¢å…©è¡Œ system('sudo apt update;sudo apt upgrade;sudo apt-get install curl') system('sudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev')  \r\rè‡ªå‹•update package update.packages(ask=FALSE) ä¹Ÿå¯ä»¥ï¼Ÿ\nall.packages \u0026lt;- installed.packages() r.version \u0026lt;- paste(version[['major']], '.', version[['minor']], sep = '') for (i in 1:nrow(all.packages)) { package.name \u0026lt;- all.packages[i, 1] package.version \u0026lt;- all.packages[i, 3] if (package.version != r.version) { print(paste('Installing', package.name)) install.packages(package.name) } }  update all available packages\nupdate.packages()\nupdate, without prompts for permission/clarification\nupdate.packages(ask = FALSE)\nRtools åœ¨windowsä¸­å®‰è£å®Œä»¥å¾Œï¼Œåœ¨Rä¸»æ§å°ä¸ŠåŸ·è¡Œ\nwriteLines('PATH=\u0026quot;${RTOOLS40_HOME}\\\\usr\\\\bin;${PATH}\u0026quot;', con = \u0026quot;~/.Renviron\u0026quot;)  é‡å•Ÿå‹•ï¼Œç„¶å¾Œæ¸¬è©¦ä¸‹é¢æŒ‡ä»¤\nSys.which(\u0026quot;make\u0026quot;)  åå®‰è£ åœ¨R consoleä¸­ï¼Œåˆ©ç”¨æŒ‡ä»¤ .libPaths()ï¼Œæˆ–è€…åœ¨shell(terminal)ä¸­åˆ©ç”¨ R -e '.libPaths()' çŸ¥é“å¥—è£è¢«å®‰è£åœ¨å“ªè£¡ï¼Œç„¶å¾Œå¯ä»¥ç§»é™¤æ‰€æœ‰çš„ç›¸é—œå¥—ä»¶\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/2_data_explorer_1.html","title": "2 data explorer 1",
	"tags": [],
	"description": "è³‡æ–™æ¢ç´¢",
	"content": " è³‡æ–™æ¢ç´¢ å¸¸ç”¨å‡½æ•¸  Mean\n Median\n Quartile\n Percentile\n Range\n Interquartile Range\n Box Plot\n Variance\n Standard Deviation\n Covariance\n Correlation Coefficient\n Central Moment\n Skewness\n Kurtosis\nmean(mtcars$mpg)  #\u0026gt; [1] 20.09062  median(mtcars$mpg)  #\u0026gt; [1] 19.2  min(mtcars$mpg)  #\u0026gt; [1] 10.4  max(mtcars$mpg)  #\u0026gt; [1] 33.9  quantile(mtcars$mpg)  #\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 10.400 15.425 19.200 22.800 33.900  quantile(mtcars$mpg,c(0.2))  #\u0026gt; 20% #\u0026gt; 15.2  require(moments)  #\u0026gt; Loading required package: moments  skewness(mtcars$mpg)  #\u0026gt; [1] 0.6404399  kurtosis(mtcars$mpg)  #\u0026gt; [1] 2.799467  x \u0026lt;- rnorm(100) quantile(x, probs = c(0, 0.25, 0.5, 0.75, 1)) # quartile quantile(x, probs = seq(0, 1, by= 0.01)) # decile ecdf(x)   å•é¡Œï¼šecdf()çš„çµæœå’Œquantile()çš„çµæœæ˜¯å¦ä¸€æ¨£ï¼Ÿ\n##åŒ¯å…¥å…¶ä»–æ ¼å¼çš„è³‡æ–™\nå®‰è£package : foreignï¼Œä»¥stata ç‚ºä¾‹(åˆ©ç”¨å…¶ä¸­çš„å‡½æ•¸read.dta())ï¼š\nif (!file.exists('resources/ceosal1.RData')){ ceosal1\u0026lt;-read.dta(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/ceosal1.dta\u0026quot;) save(ceosal1, file='resources/ceosal1.RData') }  ä¾†è‡ªwooldridge çš„è³‡æ–™é›† base cheat sheet\nè³‡æ–™ affairs\nload('resources/affairs.RData') # åŸå§‹è³‡æ–™kidæ˜¯æ•´æ•¸ï¼ŒåŠ å…¥æ¨™ç±¤æˆç‚ºfactor haskids \u0026lt;- factor(affairs$kids,labels=c(\u0026quot;no\u0026quot;,\u0026quot;yes\u0026quot;)) mlab \u0026lt;- c(\u0026quot;very unhappy\u0026quot;,\u0026quot;unhappy\u0026quot;,\u0026quot;average\u0026quot;,\u0026quot;happy\u0026quot;, \u0026quot;very happy\u0026quot;) marriage \u0026lt;- factor(affairs$ratemarr, labels=mlab) # Frequencies for having kids: table(haskids)  #\u0026gt; haskids #\u0026gt; no yes #\u0026gt; 171 430  # Marriage ratings (share): prop.table(table(marriage))  #\u0026gt; marriage #\u0026gt; very unhappy unhappy average happy very happy #\u0026gt; 0.0266223 0.1098170 0.1547421 0.3227953 0.3860233  # Contigency table: counts (display \u0026amp; store in var.) (countstab \u0026lt;- table(marriage,haskids))  #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 3 13 #\u0026gt; unhappy 8 58 #\u0026gt; average 24 69 #\u0026gt; happy 40 154 #\u0026gt; very happy 96 136  # Share within \u0026quot;marriage\u0026quot; (i.e. within a row): prop.table(countstab, margin=1)  #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.1875000 0.8125000 #\u0026gt; unhappy 0.1212121 0.8787879 #\u0026gt; average 0.2580645 0.7419355 #\u0026gt; happy 0.2061856 0.7938144 #\u0026gt; very happy 0.4137931 0.5862069  # Share within \u0026quot;haskids\u0026quot; (i.e. within a column): prop.table(countstab, margin=2)  #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.01754386 0.03023256 #\u0026gt; unhappy 0.04678363 0.13488372 #\u0026gt; average 0.14035088 0.16046512 #\u0026gt; happy 0.23391813 0.35813953 #\u0026gt; very happy 0.56140351 0.31627907  å¦‚æœä¸çŸ¥é“å‡½æ•¸prop.table()\nçœ‹ä¸€ä¸‹è³‡æ–™çµæ§‹\nstr(x\u0026lt;-table(haskids))  #\u0026gt; 'table' int [1:2(1d)] 171 430 #\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 1 #\u0026gt; ..$ haskids: chr [1:2] \u0026quot;no\u0026quot; \u0026quot;yes\u0026quot;  ä¸Šé¢çš„çµæ§‹é¡¯ç¤ºï¼Œ\n int [1:2(1d)] 171 430 : æ•´æ•¸å‘é‡ï¼Œé•·åº¦ç”±1åˆ°2ï¼Œæ˜¯å€‹1ç¶­å‘é‡ã€‚å…ƒç´ 1åˆ°2çš„å…§å®¹åˆ†åˆ¥æ˜¯171,430ã€‚\n å¯ä»¥ç”±dimnames(x)å¾—åˆ°ä¸€å€‹list,è£¡é¢åªæœ‰ä¸€å€‹å…ƒç´ ï¼Œé€™å€‹å…ƒç´ åˆæ˜¯ä¸€å€‹char list(é•·åº¦ç‚º2)ã€‚\nå› æ­¤å¯ä»¥è©¦è©¦çœ‹\nx/sum(x)  #\u0026gt; haskids #\u0026gt; no yes #\u0026gt; 0.2845258 0.7154742   çµæœæ‡‰è©²å’Œprop.table()ä¸€æ¨£ã€‚\né‚£éº¼2 way å‘¢ï¼Ÿ\nä¹Ÿæ˜¯å…ˆçœ‹çµæ§‹ï¼š\nstr(countstab \u0026lt;- table(marriage,haskids))  #\u0026gt; 'table' int [1:5, 1:2] 3 8 24 40 96 13 58 69 154 136 #\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; ..$ marriage: chr [1:5] \u0026quot;very unhappy\u0026quot; \u0026quot;unhappy\u0026quot; \u0026quot;average\u0026quot; \u0026quot;happy\u0026quot; ... #\u0026gt; ..$ haskids : chr [1:2] \u0026quot;no\u0026quot; \u0026quot;yes\u0026quot;  countstab/rowSums(countstab)  #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.1875000 0.8125000 #\u0026gt; unhappy 0.1212121 0.8787879 #\u0026gt; average 0.2580645 0.7419355 #\u0026gt; happy 0.2061856 0.7938144 #\u0026gt; very happy 0.4137931 0.5862069  countstab/colSums(countstab)  #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.01754386 0.03023256 #\u0026gt; unhappy 0.01860465 0.33918129 #\u0026gt; average 0.14035088 0.16046512 #\u0026gt; happy 0.09302326 0.90058480 #\u0026gt; very happy 0.56140351 0.31627907  #??countstab/colsum(countstab)  ceosal1\nload('resources/ceosal1.RData') # sample average: mean(ceosal1$salary)  #\u0026gt; [1] 1281.12  # sample median: median(ceosal1$salary)  #\u0026gt; [1] 1039  #standard deviation: sd(ceosal1$salary)  #\u0026gt; [1] 1372.345  # summary information: summary(ceosal1$salary)  #\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 223 736 1039 1281 1407 14822  # correlation with ROE: cor(ceosal1$salary, ceosal1$roe)  #\u0026gt; [1] 0.1148417  boxplot(ceosal1$roe,horizontal = T) boxplot(ceosal1$roe~ceosal1$consprod)  t-test Manually enter raw data from Wooldridge, Table C.3: SR87\u0026lt;-c(10,1,6,.45,1.25,1.3,1.06,3,8.18,1.67,.98,1,.45, 5.03,8,9,18,.28,7,3.97) SR88\u0026lt;-c(3,1,5,.5,1.54,1.5,.8,2,.67,1.17,.51,.5,.61,6.7, 4,7,19,.2,5,3.83)  Calculate Change (the parentheses just display the results): (Change \u0026lt;- SR88 - SR87)  #\u0026gt; [1] -7.00 0.00 -1.00 0.05 0.29 0.20 -0.26 -1.00 -7.51 -0.50 -0.47 -0.50 #\u0026gt; [13] 0.16 1.67 -4.00 -2.00 1.00 -0.08 -2.00 -0.14  Ingredients to CI formula (avgCh\u0026lt;- mean(Change))  #\u0026gt; [1] -1.1545  (n \u0026lt;- length(Change))  #\u0026gt; [1] 20  (sdCh \u0026lt;- sd(Change))  #\u0026gt; [1] 2.400639  (se \u0026lt;- sdCh/sqrt(n))  #\u0026gt; [1] 0.5367992  (c \u0026lt;- qt(.975, n-1))  #\u0026gt; [1] 2.093024  Confidence intervall: c( avgCh - c*se, avgCh + c*se )  #\u0026gt; [1] -2.27803369 -0.03096631  é©—è­‰\nv.n \u0026lt;- length(Change) v.mean \u0026lt;- sum(Change)/v.n v.std \u0026lt;-sqrt(sum((Change-v.mean)^2)/(v.n-1)) v.se \u0026lt;- v.std/sqrt(v.n) rst\u0026lt;-list(v.n,v.mean,v.std,v.se) rst  #\u0026gt; [[1]] #\u0026gt; [1] 20 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] -1.1545 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 2.400639 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] 0.5367992  ç·´ç¿’ï¼šé»‘ç™½ç¨®ï¼Œç”¨åŒä¸€å€‹CVæ‰¾å·¥ä½œã€‚\naudit\nload('resources/audit.dta') head(audit)  #\u0026gt; w b y #\u0026gt; 1 1 1 0 #\u0026gt; 2 1 1 0 #\u0026gt; 3 1 1 0 #\u0026gt; 4 1 1 0 #\u0026gt; 5 1 1 0 #\u0026gt; 6 0 0 0  yæ˜¯å‰å…©å€‹æ¬„ä½ç›¸æ¸›ã€‚ä»¥ç¬¬1ç­†è³‡æ–™ç‚ºä¾‹ï¼Œå…©å€‹éƒ½æ˜¯1ï¼Œæ²’å·®åˆ¥(y=0)ã€‚\nby hand t statistic for H0: mu=0:\nè‡ªç”±åº¦(d.f.)ç‚º n-1 =240 çš„tåˆ†é…ï¼Œå…¶è‡¨ç•Œå€¼Critical values(å¦‚ä¸‹):\nalpha.one.tailed = c(0.1, 0.05, 0.025, 0.01, 0.005, .001) CV \u0026lt;- qt(1 - alpha.one.tailed, n-1) cbind(alpha.one.tailed, CV)  #\u0026gt; alpha.one.tailed CV #\u0026gt; [1,] 0.100 1.285089 #\u0026gt; [2,] 0.050 1.651227 #\u0026gt; [3,] 0.025 1.969898 #\u0026gt; [4,] 0.010 2.341985 #\u0026gt; [5,] 0.005 2.596469 #\u0026gt; [6,] 0.001 3.124536  by å‡½æ•¸t.test() H0: y=5, H1:y\u0026gt;5, ä¿¡è³´å€é–“0.99\nt.test(y, mu=5, alternative=\u0026quot;greater\u0026quot;, conf.level=0.99)\nåˆ©ç”¨å‡½æ•¸ç®—ï¼š\n# ex.C.3: two-sided CI t.test(audit$y) # ex.C.5 \u0026amp; C.7: 1-sided test: t.test(audit$y, alternative=\u0026quot;less\u0026quot;)  One Sample t-test data: audit$y t = -4.2768, df = 240, p-value = 2.739e-05 alternative hypothesis: true mean is not equal to 0 95 percent confidence interval: -0.1939385 -0.0716217 **èªªæ˜ï¼šmu +/- c.level*(se) è¦‹æ‰‹ç®—ä¾‹ ** sample estimates: mean of x -0.1327801 One Sample t-test data: audit$y t = -4.2768, df = 240, p-value = 1.369e-05 alternative hypothesis: true mean is less than 0 95 percent confidence interval: -Inf -0.08151529 sample estimates: mean of x -0.1327801  åˆ†çµ„ ç›®çš„ï¼šåˆ†çµ„æ±‚çµ±è¨ˆé‡\nå¤§ç¶±æ˜¯ï¼šå…ˆæ¢ç´¢ä¸€ä¸‹æˆ‘å€‘å¯èƒ½ç”¨åˆ°çš„Rèªè¨€æŠ€å·§ï¼Œç„¶å¾Œæ˜¯å¯«æˆå‡½æ•¸ã€‚\næ–¹æ³•1: åˆ©ç”¨ forè¿´åœˆ å¦‚æœä¸åˆ†çµ„\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) summary(dframe)  #\u0026gt; age group #\u0026gt; Min. : 5.212 Min. :1.0 #\u0026gt; 1st Qu.:26.742 1st Qu.:1.0 #\u0026gt; Median :33.212 Median :1.0 #\u0026gt; Mean :29.216 Mean :1.4 #\u0026gt; 3rd Qu.:35.142 3rd Qu.:2.0 #\u0026gt; Max. :36.780 Max. :2.0  data.frame çš„recordç¯©é¸ï¼Œå¯ä»¥åˆ©ç”¨é‚è¼¯å€¼ç´¢å¼•ä¾†ç¯©é¸åˆ†çµ„ï¼Œé€™è£¡çš„ç¯„ä¾‹éƒ½æ˜¯æ±‚å¾—ä¸€çµ„(ä»¥ç¬¬ä¸€åˆ†é¡ç‚ºä¾‹)ï¼š\nft\u0026lt;-factor(dframe$group) gn\u0026lt;-length(levels(ft)) # nlevels(ft) gf\u0026lt;-ft==levels(ft)[1] # ç¬¬ä¸€çµ„ g1\u0026lt;-dframe[gf,] g1  #\u0026gt; age group #\u0026gt; 1 23.0883 1 #\u0026gt; 2 25.8344 1 #\u0026gt; 3 29.4648 1 #\u0026gt; 5 33.6372 1 #\u0026gt; 6 34.9350 1 #\u0026gt; 10 36.7803 1  é™¤äº†ä¸Šé¢çš„ç¯©é¸æ–¹å¼ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨%in%\nft\u0026lt;-factor(dframe$group) gn\u0026lt;-length(levels(ft)) # nlevels(ft) gf\u0026lt;-as.numeric(levels(ft)[1]) # ç¬¬ä¸€çµ„ g1\u0026lt;-dframe[group %in% gf,] # ä¸æ˜¯ gf %in% group rst\u0026lt;-summary(g1) rst[4,1]  #\u0026gt; [1] \u0026quot;Mean :30.62 \u0026quot;  rst[4,2]  #\u0026gt; [1] \u0026quot;Mean :1 \u0026quot;  æœ€å¾Œçš„ç¨‹å¼ç¢¼ï¼š\nft\u0026lt;-factor(dframe$group) rst \u0026lt;- as.list(numeric(nlevels(ft))) names(rst)\u0026lt;-levels(ft) for (gi in levels(ft) ){ gf\u0026lt;-as.numeric(gi) g1\u0026lt;-dframe[group %in% gf,] t\u0026lt;-summary(g1) rst[gi]=t[4,1] } print(rst)  #\u0026gt; $`1` #\u0026gt; [1] \u0026quot;Mean :30.62 \u0026quot; #\u0026gt; #\u0026gt; $`2` #\u0026gt; [1] \u0026quot;Mean :27.105 \u0026quot;  å‡½æ•¸summary()çš„çµæœæ˜¯ä¸€å€‹tableï¼Œä½†æ˜¯è€Œä¸”è£¡é¢çš„å…ƒç´ æ˜¯ã€Œå­—ä¸²ã€ï¼Œä¾‹å¦‚\nage group Min. : 5.212 Min. :1.0 1st Qu.:26.742 1st Qu.:1.0 Median :33.212 Median :1.0 Mean :29.216 Mean :1.4 3rd Qu.:35.142 3rd Qu.:2.0 Max. :36.780 Max. :2.0  ä½†æ˜¯åœ¨å¾ˆå¤šæƒ…æ³ä¸‹ï¼Œæˆ‘å€‘å¸Œæœ›å¯ä»¥è‡ªå·±å¯ä»¥æ§åˆ¶çš„æ ¼å¼ä¾¿æ–¼é€²æ­¥åˆ†æã€‚ä¾‹å¦‚ï¼Œè¦ä¸€å€‹çŸ©é™£ï¼Œæ­¤æ™‚å¯ä»¥åˆ©ç”¨sub()ï¼š\nas.numeric(sub('.*:', '', summary(dframe)[4,1]))\n\r\ræ–¹æ³•2:ã€€å‡½æ•¸aggregate() aggregate(dframe$age, by=list(dframe$group), FUN=mean)  #\u0026gt; Group.1 x #\u0026gt; 1 1 30.62333 #\u0026gt; 2 2 27.10507  aggregate(dframe$age, by=list(dframe$group), FUN=mean)[2]  #\u0026gt; x #\u0026gt; 1 30.62333 #\u0026gt; 2 27.10507  aggregate()å‚³å›data.frameï¼Œè½‰çŸ©é™£åˆ©ç”¨as.matrix()\nç·´ç¿’ï¼š\nä¸Šé¢çš„ç¯„ä¾‹æ˜¯æ¯çµ„æ±‚å¾—ä¸€å€‹å€¼ï¼Œå¦‚æœæ˜¯å¤šå€‹å‘¢ï¼Ÿä¾‹å¦‚åˆ©ç”¨aggregate()æ±‚å¾—æ¯çµ„min,max,median,q25,q75 ?\næ–¹æ³•3: å‡½æ•¸ã€€tapply f1\u0026lt;-function(im) { c(min(im),median(im),mean(im),max(im)) } rst\u0026lt;-tapply(dframe$age,dframe$group,FUN = f1)#çµæœæ˜¯listå…©å€‹å…ƒç´ ï¼Œåˆ†åˆ¥å°æ‡‰f1çš„è¨ˆç®—çµæœ rstm\u0026lt;-unlist(rst) # unlist æœƒæŠŠrst è®Šæˆ1ç¶­å‘é‡ rstm\u0026lt;-matrix(rstm,ncol=2) # hard code2 , try `length(levels(factor(dframe$group)))` rownames(rstm)\u0026lt;-c(\u0026quot;min\u0026quot;,\u0026quot;median\u0026quot;,\u0026quot;mean\u0026quot;,\u0026quot;max\u0026quot;) colnames(rstm)\u0026lt;-paste(\u0026quot;çµ„åˆ¥:\u0026quot;,levels(factor(dframe$group))) rstm  #\u0026gt; çµ„åˆ¥: 1 çµ„åˆ¥: 2 #\u0026gt; min 23.08830 5.21150 #\u0026gt; median 31.55100 33.99865 #\u0026gt; mean 30.62333 27.10507 #\u0026gt; max 36.78030 35.21150  æ–¹æ³•3 åˆ©ç”¨å…¶ä»–å¥—ä»¶ library(dplyr) dt \u0026lt;- data.frame(age=rchisq(20,10), group=sample(1:2,20, rep=T)) grp \u0026lt;- group_by(dt, group) summarise(grp, mean=mean(age), sd=sd(age)) detach(\u0026quot;package:dplyr\u0026quot;, unload=TRUE)  plot é€™è£¡çš„åˆ†çµ„ä¸èƒ½ç”¨ä¹‹å‰çš„hard code ä¸­æåˆ°çš„æ–¹æ³•ï¼Œå› ç‚ºå„çµ„å¯èƒ½æ•¸é‡ä¸åŒã€‚\nv1\u0026lt;-c(1,2,3) v2\u0026lt;-c(4,4) cbind(v1,v2)  #\u0026gt; Warning in cbind(v1, v2): number of rows of result is not a multiple of vector #\u0026gt; length (arg 2)  #\u0026gt; v1 v2 #\u0026gt; [1,] 1 4 #\u0026gt; [2,] 2 4 #\u0026gt; [3,] 3 4  rbind(v1,v2) ç™¼ç”ŸéŒ¯èª¤ï¼Œæ˜¯å¦åªèƒ½ç”¨æ–¼data.frame\n*å•é¡Œ*ï¼š\nå¦‚æœæƒ³è¦åˆä½µå…©å€‹å‘é‡ï¼ŒåŒæ™‚å¦‚æœé•·åº¦ä¸ä¸€æ¨£ï¼Œå°±çŸ­çš„å‘é‡å°±è£œNAè¦æ€éº¼åšï¼Ÿç·´ç¿’å¯«æˆå‡½æ•¸ã€‚\n#\u0026gt; v1 v2 #\u0026gt; [1,] 1 4 #\u0026gt; [2,] 2 4 #\u0026gt; [3,] 3 NA  ç·´ç¿’:\nå·²ç¶“çŸ¥é“boxplot()çš„åƒæ•¸å¦‚æœå‚³é€²çŸ©é™£æˆ–è³‡æ–™é›†ï¼Œå°‡å°æ¯ä¸€å€‹æ¬„ä½ä½œåœ–\nnote:boxplotåƒ y~xå›æ­¸å¼,ä¾‹å¦‚\nboxplot(formula = Ozone ~ Month, # Y ~ X data = airquality, # è³‡æ–™ xlab = \u0026quot;Month\u0026quot;, ylab = \u0026quot;Ozone (ppb)\u0026quot;, col =\u0026quot;red\u0026quot;)  boxplot(matrix(rnorm(100),ncol=2))  ç¾åœ¨è¦åˆ†çµ„å°å¹´é½¡boxplot,è«‹å¯«å‡ºç¨‹å¼ç¢¼ï¼Œè³‡æ–™å¦‚ä¸‹ï¼š\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group)  hint: æ¯çµ„é•·åº¦å¯èƒ½ä¸ä¸€æ¨£ï¼Œéœ€è¦è£œNA\nhint: æœ€ç°¡å–®çš„å¯«æ³• boxplot(age~group)\n FUN.Name æœƒè·‘åˆ°mathch.fun() é€™å€‹å‡½æ•¸ï¼Œè€Œé€™å€‹å‡½æ•¸æ˜¯ç”¨å­—ä¸²æœå°‹\nm2:\nç¾åœ¨æƒ³è¦æŠŠrstè½‰æˆdata.frameã€‚\nå…ˆçœ‹ä¸€ä¸‹ç¤ºç¯„ï¼Œå¦‚ä½•æŠŠlist è½‰æˆ data.frame\n# è§£é‡‹çµæœ,å•stringsAsFactors=F æœ‰ä»€éº¼æ•ˆæœï¼Ÿ test1 \u0026lt;- list( c(a='a',b='b',c='c'), c(a='d',b='e',c='f')) d1\u0026lt;-as.data.frame(test1) d1  #\u0026gt; c.a....a...b....b...c....c.. c.a....d...b....e...c....f.. #\u0026gt; a a d #\u0026gt; b b e #\u0026gt; c c f  # ok test2 \u0026lt;- list(a = c(1, 2, 3), b = c(4, 5, 6)) d2\u0026lt;-as.data.frame(test2) d2  #\u0026gt; a b #\u0026gt; 1 1 4 #\u0026gt; 2 2 5 #\u0026gt; 3 3 6  "},
{"uri": "https://airbone4.github.io/blogR/rlang/2_1_data_explorer_2.html","title": "2.1 data explorer 2",
	"tags": [],
	"description": "è³‡æ–™æ¢ç´¢",
	"content": " age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group)  åˆ†çµ„åˆ—å‡ºsummary:åˆ©ç”¨å‡½æ•¸ age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) mygroup\u0026lt;-function(df,g,idx) { ft\u0026lt;-factor(df$g) gf\u0026lt;-ft==levels(ft)[idx] # ç¬¬ä¸€çµ„ g1\u0026lt;-df[gf,] return(g1) } x\u0026lt;-mygroup(dframe,\u0026quot;group\u0026quot;,1)  å•é¡Œï¼š ç¾åœ¨æŠŠæŸå€‹æ¬„ä½ä¾æ“šåˆ†çµ„ç•«å‡ºboxplot\nA:age\nB:group(1,2)\nä¸è¶³çš„è£œNA,æ¯ä¸€æ¬„æˆç‚ºçŸ©é™£ï¼Œä¾‹å¦‚å…±å…©çµ„ï¼Œé‚£éº¼çŸ©é™£æ¬„ä½å°±æ˜¯2ï¼Œæ¯”æ•¸ç‚ºå„çµ„è³‡æ–™ï¼Œé•·åº¦ä¸å¤ è£œnaï¼Œ\næœ€å¾Œ\nboxplot(mtx)\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) gf\u0026lt;-group==1 g1\u0026lt;-dframe[gf,1] gf\u0026lt;-group==2 g2\u0026lt;-dframe[gf,1] mlen\u0026lt;-max(length(g1),length(g2)) length(g1)\u0026lt;-mlen length(g2)\u0026lt;-mlen mtx\u0026lt;-cbind(g1,g2) boxplot(mtx)  age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) vl\u0026lt;-list() for (i in 1:2){ gf\u0026lt;-group==i g1\u0026lt;-dframe[gf,1] vl[[i]]\u0026lt;-g1 } gn\u0026lt;-sapply(vl,length) gn\u0026lt;-max(gn) vl\u0026lt;-lapply(vl,`length\u0026lt;-`,gn) # è£œNA mtx\u0026lt;-matrix(unlist(vl),nrow=gn) boxplot(mtx)  summary(dframe)\nft\u0026lt;-factor(dframe$group)\ngn\u0026lt;-length(levels(ft)) # nlevels(ft)\ngf\u0026lt;-ft==levels(ft)[1] # ç¬¬ä¸€çµ„\ng1\u0026lt;-dframe[gf,]\nsummary(g1)\ngf\u0026lt;-ft==levels(ft)[2] # ç¬¬ä¸€çµ„\ng2\u0026lt;-dframe[gf,]\nsummary(g2)\nmygroup\u0026lt;-function(df,g,idx)\n{\nft\u0026lt;-factor(df$g)\ngf\u0026lt;-ft==levels(ft)[idx] # ç¬¬ä¸€çµ„\ng1\u0026lt;-df[gf,]\nreturn(g1)\n}\nfor (i in 1:2){\nx\u0026lt;-mygroup(dframe,\u0026quot;group\u0026quot;,i)\nprint(summary(x))\n}\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/3_quickview1.html","title": "3. Quick view 1",
	"tags": [],
	"description": "æ“ä½œ",
	"content": " quick view å¿«é€ŸæŒ‡ä»¤\nç›®å‰æœ‰å“ªäº›è³‡æ–™é›†å¯ä»¥æ¸¬è©¦ data()\nattach()\nä¸€èˆ¬æ˜¯\nlibrary(sample) data(\u0026quot;mydata\u0026quot;)  attach(\u0026quot;mydata\u0026quot;) å°±ä¸ç”¨æ‰“å…¥mydata$æ¬„ä½åç¨±\nå¹¾å€‹å¸¸ç”¨çš„çµ±è¨ˆé‡: x\u0026lt;-c(1,2,3) median(x) mean(x) min(x) sd(x) range(x) diff(x)  è³‡æ–™å‹æ…‹å’Œå…§å®¹ å¯ä»¥å…ˆçœ‹çœ‹è³‡æ–™æè¿° ?mtcars\nmtcars  #\u0026gt; mpg cyl disp hp drat wt qsec vs am gear carb #\u0026gt; Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 #\u0026gt; Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 #\u0026gt; Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 #\u0026gt; Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 #\u0026gt; Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 #\u0026gt; Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1 #\u0026gt; Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4 #\u0026gt; Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2 #\u0026gt; Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2 #\u0026gt; Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4 #\u0026gt; Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4 #\u0026gt; Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3 #\u0026gt; Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3 #\u0026gt; Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3 #\u0026gt; Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4 #\u0026gt; Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4 #\u0026gt; Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4 #\u0026gt; Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1 #\u0026gt; Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2 #\u0026gt; Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1 #\u0026gt; Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1 #\u0026gt; Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2 #\u0026gt; AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2 #\u0026gt; Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4 #\u0026gt; Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2 #\u0026gt; Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1 #\u0026gt; Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2 #\u0026gt; Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2 #\u0026gt; Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4 #\u0026gt; Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6 #\u0026gt; Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8 #\u0026gt; Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2  head(mtcars)  #\u0026gt; mpg cyl disp hp drat wt qsec vs am gear carb #\u0026gt; Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4 #\u0026gt; Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4 #\u0026gt; Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1 #\u0026gt; Hornet 4 Drive 21.4 6 258 110 3.08 3.215 19.44 1 0 3 1 #\u0026gt; Hornet Sportabout 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2 #\u0026gt; Valiant 18.1 6 225 105 2.76 3.460 20.22 1 0 3 1  tail(mtcars)  #\u0026gt; mpg cyl disp hp drat wt qsec vs am gear carb #\u0026gt; Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.7 0 1 5 2 #\u0026gt; Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.9 1 1 5 2 #\u0026gt; Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.5 0 1 5 4 #\u0026gt; Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.5 0 1 5 6 #\u0026gt; Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.6 0 1 5 8 #\u0026gt; Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.6 1 1 4 2  head å‰å¹¾ç­†è³‡æ–™\ntail å¾Œå¹¾ç­†è³‡æ–™\nç·¨è¼¯/ç€è¦½è³‡æ–™ edit(mtcars) data.entry(mtcars) View(mtcars)  å€‹åˆ¥æ¬„ä½ å¦‚æœè¦é¡¯ç¤ºå€‹åˆ¥æ¬„ä½,ä¸€èˆ¬å¯ä»¥æ˜¯mtcars$mpg,ä½†æ˜¯å¦‚æœè¦ç›´æ¥ä½¿ç”¨mpgæ¬„ä½,å¯ä»¥åˆ©ç”¨attach()\nattach(mtcars) mpg  #\u0026gt; [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4 #\u0026gt; [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7 #\u0026gt; [31] 15.0 21.4  è³ªæ€§æ•¸æ“šçš„åˆ†æ æ¬„ä½cylç‚ºè³ªæ€§è®Šæ•¸,å¯ä»¥åˆ©ç”¨tableåˆ†æ\ntable(mtcars$cyl)  #\u0026gt; #\u0026gt; 4 6 8 #\u0026gt; 11 7 14  é »ç‡åœ–\nbarplot(table(mtcars$cyl))  è§£é‡‹ä¸‹é¢å…©å€‹åœ–ç‚ºç”šéº¼ä¸ä¸€æ¨£?\nv\u0026lt;-as.vector(table(mtcars$cyl)) barplot(v)  m\u0026lt;-as.matrix(table(mtcars$cyl)) barplot(m)  ä¸Šé¢å…©å€‹åœ–ä¸ä¸€æ¨£,å› ç‚ºtable()çš„å®šç¾©,æ‰€ä»¥è½‰æˆçŸ©é™£ä»¥å¾Œæ˜¯3x1ã€‚\nx\u0026lt;-c(1,1,1) x1\u0026lt;-as.matrix(x) x2\u0026lt;-as.table(x) x3\u0026lt;-table(x) x1 x2 x3   [,1] [1,] 1 [2,] 1 [3,] 1 # x2 åŸåœ°è½‰ A B C 1 1 1 # x3 : è¨ˆç®—1æœ‰å¹¾å€‹ x 1 3  \r\rbarplot(c(11,7,4))  barplot(mtcars$mpg) barplot(mtcars$cyl)  assignment  \u0026lt;-å’Œ -\u0026gt; æ˜¯ä¸€å° ï¼Œå¯ä»¥å‘å·¦å’Œå‘å³è³¦å€¼\n = æ˜¯å–®å‘çš„ ï¼Œä½œç”¨å’Œ\u0026lt;-åŸºæœ¬ç›¸åŒï¼Œä½†å°å‡½æ•¸ä¸­çš„è®Šæ•¸é€šå¸¸ä½¿ç”¨=\n \u0026lt;\u0026lt;- é€™å€‹æ˜¯å…¨åŸŸè³¦å€¼ ï¼Œè·Ÿè®Šæ•¸çš„ä½œç”¨åŸŸæœ‰é—œï¼Œé–‹ç™¼è‡ªå·±çš„å¥—ä»¶(package)çš„æ™‚å€™,å¸¸ç”¨ã€‚\n##Delete x (if it exists) rm(x)  #\u0026gt; Warning in rm(x): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x'  mean(x = 1:10) #[1] 5.5  #\u0026gt; [1] 5.5  x #Error: object 'x' not found  #\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x'   è§€å¯Ÿä¸Šé¢çš„x,ç¬¬ä¸€è¡ŒæŒ‡ä»¤å¾ç’°å¢ƒä¸­å»æ‰è®Šæ•¸xçš„å®šç¾©ã€‚\nç¬¬2è¡Œä¸­çš„xæ˜¯åœ¨block ä¸­å®šç¾©ï¼Œå› æ­¤åŸ·è¡Œå®Œä»¥å¾Œ,æœƒè¢«æ®ºæ‰ã€‚å› æ­¤ç¬¬ä¸‰è¡ŒæŒ‡ä»¤,å‡ºç¾æ‰¾ä¸åˆ°xçš„æç¤ºã€‚\nå¾Œé¢æ¸¬è©¦\u0026lt;- operator:\nmean(x \u0026lt;- 1:10) # [1] 5.5  #\u0026gt; [1] 5.5  x  #\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10   x # [1] 1 2 3 4 5 6 7 8 9 10\n This time the x variable is declared within the user workspace.\nWhen does the assignment take place ?\nIn the code above, you may be tempted to thin that we â€œassign 1:10 to x, then calculate the mean.\nâ€ This would be true for\n#languages such as C, but it isn â€™t true in R. Consider the following function:\na \u0026lt;- 1 f \u0026lt;- function(a) return(TRUE) f \u0026lt;- f(a \u0026lt;- a + 1); # è¼¸å‡º:TRUE a # çµæœ=1  #\u0026gt; [1] 1  æ³¨æ„ä¸Šé¢açš„å€¼,ä»ç„¶æ˜¯1ã€‚åŸå› æ˜¯å› ç‚ºRçš„ç·¨è­¯å™¨,åœ¨æœ€ä½³åŒ–çš„æ™‚å€™,çŸ¥é“å‡½æ•¸ä¸­æ²’ç”¨åˆ°åƒæ•¸,å› æ­¤æ ¹æœ¬æ²’æœ‰å­˜å–åˆ°è®Šæ•¸a,å› æ­¤ï¼ŒåŸä¾†çš„aæ˜¯ç”šéº¼,aä»ç„¶æ˜¯ç”šéº¼ã€‚\nç°¡å–®è¬›å°±æ˜¯f(a\u0026lt;-a+1)ä¸­çš„a\u0026lt;-a+1 è¢«å»æ‰ä¸æœƒè¢«åŸ·è¡Œ\nf(a\u0026lt;-a+1) =\u0026gt; f()\nrewrite\nf \u0026lt;- function(a) { if (runif(1) \u0026gt; 0.5) TRUE else a } f(a \u0026lt;- a + 1); a # result 2  #\u0026gt; [1] 2   é€™å€‹å‡½æ•¸fç”¨åˆ°äº†åƒæ•¸a,ä½†æ˜¯ç·¨è­¯å™¨é€™æ¬¡æ²’é‚£éº¼è°æ˜,çŸ¥é“ä½¿ç”¨è€…ç”¨aä¾†åšç”šéº¼,é›–ç„¶é€™å€‹å‡½æ•¸çš„bodyä»ç„¶æ²’æœ‰å‹•åˆ°a,ä½†æ˜¯é€™æ¬¡f(a\u0026lt;-a+1)ä¸­çš„a\u0026lt;-a+1 æœƒè¢«åŸ·è¡Œã€‚\n  :::quiz\nç·´ç¿’\n å…ˆå»æ‰ç’°å¢ƒä¸­çš„è®Šæ•¸a,ç„¶å¾Œåœ¨åŸ·è¡Œä¸Šé¢çš„chunk.\n hint: rm(a)\n:::\nf(a \u0026lt;- a + 1); # TRUE a # 2  #\u0026gt; [1] 3  f(a \u0026lt;- a + 1); a #3  #\u0026gt; [1] 4  a\u0026lt;-1; f \u0026lt;- function(a) return(a); invisible(f(a=a+1)) a  #\u0026gt; [1] 1  invisible(f(a\u0026lt;-a+1)) a  #\u0026gt; [1] 2    ä¸Šé¢ç¨‹å¼ä¸­,invisibleå‡½æ•¸åœ¨é€™è£¡çš„èªªæ˜ä¸é‡è¦,åªæ˜¯ç”¨ä¾†éš±è—è¨ˆç®—çµæœã€‚\na\u0026lt;-1; f \u0026lt;- function(a) return(3); invisible(f(a=a+1)) a  #\u0026gt; [1] 1  invisible(f(a\u0026lt;-a+1)) a  #\u0026gt; [1] 1  =ç”¨åœ¨åƒæ•¸æŒ‡æ´¾\nä¾‹å¦‚\nmatrix(1:20, ncol = 4)  #\u0026gt; [,1] [,2] [,3] [,4] #\u0026gt; [1,] 1 6 11 16 #\u0026gt; [2,] 2 7 12 17 #\u0026gt; [3,] 3 8 13 18 #\u0026gt; [4,] 4 9 14 19 #\u0026gt; [5,] 5 10 15 20  ncol  #\u0026gt; function (x) #\u0026gt; dim(x)[2L] #\u0026gt; \u0026lt;bytecode: 0x00000000186f4430\u0026gt; #\u0026gt; \u0026lt;environment: namespace:base\u0026gt;  ç”¢ç”Ÿ5X4çŸ©é™£ã€‚å¦‚æœ\nmatrix(1:20, ncol \u0026lt;- 4)  #\u0026gt; [,1] [,2] [,3] [,4] [,5] #\u0026gt; [1,] 1 5 9 13 17 #\u0026gt; [2,] 2 6 10 14 18 #\u0026gt; [3,] 3 7 11 15 19 #\u0026gt; [4,] 4 8 12 16 20  ncol  #\u0026gt; [1] 4  æœƒç”¢ç”Ÿä¸€å€‹è®Šæ•¸ ncolï¼Œé€™è£¡ç”¢ç”Ÿçš„ç‚º4x5çš„çŸ©é™£ã€‚ç‚ºç”šéº¼?å› ç‚ºé€™è£¡çš„ç¬¬2å€‹åƒæ•¸ncol\u0026lt;-4,æŒ‡æ´¾çµ¦è®Šæ•¸ncol,ç„¶å¾Œé€™å€‹expressionæœƒreturn 4,è€Œ4å°±è¢«ç•¶æˆç¬¬2å€‹åƒæ•¸,ä¹Ÿå°±æ˜¯matrix(1:20, ncol \u0026lt;- 4)ç­‰åŒæ–¼matrix(1:20, 4),ä¹Ÿå°±æ˜¯æŒ‡å®šROWçš„ç¶­åº¦ã€‚\nçµè«–:x\u0026lt;-3 \u0026lt;-æœƒåœ¨å…¨å±€ç”¢ç”Ÿè®Šæ•¸xç„¶å¾ŒæŒ‡æ´¾3\n(x \u0026lt;- 3)  #\u0026gt; [1] 3  #rm(list = ls()) rm(x) ls()  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;f\u0026quot; \u0026quot;m\u0026quot; \u0026quot;ncol\u0026quot; \u0026quot;v\u0026quot;  (x = 3)  #\u0026gt; [1] 3  ls()  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;f\u0026quot; \u0026quot;m\u0026quot; \u0026quot;ncol\u0026quot; \u0026quot;v\u0026quot; \u0026quot;x\u0026quot;  å› ç‚ºxæ˜¯åƒæ•¸åç¨±ä¸æ˜¯è®Šæ•¸,çœ‹mean help\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/3_01_regular_expression.html","title": "3.1 Regular expression syntax",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "åˆ©ç”¨ä¸€äº›ç‰¹æ®Šå­—å…ƒï¼Œä¾‹å¦‚ $ * + . ? [ ] ^ { } | ( ) \\æ§‹æˆRegular expressionsï¼Œç”¨ä¾†åœ¨æ–‡å­—ä¸­è¡¨é”æŸäº›æœå°‹æ¨£å¼çš„èªæ³•ã€‚ é€™è£¡åªæ˜¯ç°¡çŸ­çš„ä»‹ç´¹\nFunctions which work with regular expression patterns  strsplit: split string into substrings at occurances of regexp\n grep: search for a regular expression within a string\n sub: search and then replace an occurance of a regular expression in a strng\n gsub: global search and replace all occurances of a regular expression in a string\n  grep, grepl grep,greplçš„å·®åˆ¥æ˜¯å¾Œè€…ä¸æ”¯æ´åƒæ•¸valueï¼Œä¸”æ¯”å°çš„çµæœå’Œæœå°‹å…§å®¹çš„å€‹æ•¸ç›¸åŒã€‚\nä¸‹é¢çš„ä¾‹å­æ˜¯æ‰¾å‡ºa.cé€™å€‹å­—ä¸²ã€‚\ngrep(\u0026quot;a\\\\.c\u0026quot;, c(\u0026quot;abc\u0026quot;, \u0026quot;a.c\u0026quot;, \u0026quot;bef\u0026quot;))  #\u0026gt; [1] 2  grep(\u0026quot;a\\\\.c\u0026quot;, c(\u0026quot;abc\u0026quot;, \u0026quot;a.c\u0026quot;, \u0026quot;bef\u0026quot;),value=TRUE)  #\u0026gt; [1] \u0026quot;a.c\u0026quot;  grepl(\u0026quot;a\\\\.c\u0026quot;, c(\u0026quot;abc\u0026quot;, \u0026quot;a.c\u0026quot;, \u0026quot;bef\u0026quot;))  #\u0026gt; [1] FALSE TRUE FALSE  åˆå¦ä¸€å€‹ä¾‹å­,æ˜¯åœ¨å­—ä¸²ä¸­å°‹æ‰¾å–®å¼•è™Ÿ,å‡å®šè¦åœ¨åœ‹å®¶ä¸­æ‰¾å°‹æ˜¯å¦æœ‰åç¨±åŒ…å«å–®å¼•è™Ÿçš„åå­—,å¯ä»¥ä½¿ç”¨'\\''\nå•é¡Œ:ç‚ºç”šéº¼ä¸æ˜¯'\\\\''\nEscape sequences æ­£è¦è¡¨é”å¼ä¸­.ä»£è¡¨ä»»æ„å­—å…ƒ,ä½†æ˜¯å¦‚æœæˆ‘å€‘è¦åœ¨å­—ä¸²ä¸­æŸ¥æ‰¾\u0026quot;.\u0026quot;(ä¾‹å¦‚,æª”æ¡ˆåç¨±ä¸­çš„é») çš„æ™‚å€™è¦æ€æ¨£è¡¨ç¤º?ç­”æ¡ˆæ˜¯ä½¿ç”¨é€ƒé€¸å­—å…ƒ\\ã€‚ä½†æ˜¯åœ¨Rèªè¨€ä¸­,æ­£è¦è¡¨é”å¼ï¼Œä¹Ÿæ˜¯ä½¿ç”¨å­—ä¸²ï¼Œå¯æ˜¯åœ¨å­—ä¸²ä¸­,\\æœ¬èº«å°±é€ƒé€¸å­—å…ƒï¼Œå› æ­¤éœ€è¦\\\\.ã€‚\ndot \u0026lt;- \u0026quot;\\\\.\u0026quot; writeLines(dot)  #\u0026gt; \\.  x \u0026lt;- \u0026quot;a\\\\b\u0026quot; writeLines(x)  #\u0026gt; a\\b  é€™è£¡çš„é€ƒé€¸å­—å…ƒåªæ˜¯å­—ä¸²çš„æ¨™æº–ç”¨æ³•,'ä¸æ˜¯æ­£è¦è¡¨é”å¼çš„ç‰¹æ®Šå­—å…ƒã€‚é›»è…¦èªè¨€èªå­—ä¸²çš„æ–¹æ³•æ˜¯æˆå°çš„å¼•è™Ÿ,é€™å€‹æ™‚å€™å¦‚æœå¯«'''é‚£æ˜¯ç”šéº¼æ„æ€?æ‰€ä»¥'\\''å°±æ˜¯å­—ä¸²'çš„æ„æ€ã€‚æ‰€ä»¥ç‚ºç”šéº¼ä¹‹å‰æ˜¯\u0026quot;a\\.c\u0026quot;ä¸­,ç¬¬äºŒå€‹\\æ˜¯è§£è„«æ­£è¦è¡¨é”ä¸­.çš„æ„ç¾©ã€‚è€Œç¬¬ä¸€å€‹æ˜¯\\æ˜¯é€ƒé€¸å­—ä¸²è§£è®€ã€‚\ncountry\u0026lt;-read.delim('resources/country.txt',header=FALSE) names(country)\u0026lt;-\u0026quot;Name\u0026quot; cname \u0026lt;-levels(country$Name) grep('\\'', cname, value = TRUE)  #\u0026gt; character(0)  note:\n- ä¸æ˜¯country.names\u0026lt;-\u0026quot;Name\u0026quot;\nå•é¡Œ:ä¸‹é¢å…©è¡Œæœ‰ç”šéº¼å·®åˆ¥?\ngrep('\\'', country$Name, value = TRUE) grep('\\'', levels(country$Name), value = TRUE)  Hint: levels å‚³å›å”¯ä¸€å€¼\nlevels(factor(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;a\u0026quot;)))  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot;  factor(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;a\u0026quot;))  #\u0026gt; [1] a b a #\u0026gt; Levels: a b  \r\rç·´ç¿’ ç”¢ç”Ÿ3å€‹æª”æ¡ˆ,æª”æ¡ˆåç¨±å«æœ‰cat\nfile.create(c(\u0026quot;xcat1.rmd\u0026quot;, \u0026quot;ycat2.txt\u0026quot;, \u0026quot;zcat3.rmd\u0026quot;))  files\u0026lt;-list.files(\u0026quot;.\u0026quot;) grep(\u0026quot;cat\u0026quot;, files, value = TRUE) grep(\u0026quot;cat\u0026quot;, files, value = FALSE) grepl(\u0026quot;cat\u0026quot;, files)  regexpr, gregexpr regexpr å‡½æ•¸çš„ä½¿ç”¨æ–¹å¼é¡ä¼¼greplã€‚å‚³å›æ•´æ•¸å‘é‡(è¡¨ç¤ºç¬¦åˆä½ç½®ï¼Œå¦‚æœæ‰¾ä¸åˆ°,å‰‡å‚³å›-1),å€‹æ•¸å’Œæ¯”å°å­—ä¸²ä¸²åˆ—ç›¸åŒã€‚é€™å€‹å‘é‡åŒæ™‚æœ‰å±¬æ€§match.length(åƒè€ƒç¯„ä¾‹) .\ns\u0026lt;-\u0026quot;a.b.c.9\u0026quot; regexpr('b',s )  #\u0026gt; [1] 3 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  regexpr('.',s ) # è¦å®šä½ç¬¦è™Ÿã€Œ.ã€,é€™æ˜¯éŒ¯çš„,\\.ä¹ŸéŒ¯  #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  regexpr('\\\\.',s ) # æ­£ç¢º  #\u0026gt; [1] 2 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  regexpr('[.]',s ) # æ­£ç¢º ,ä¸éœ€è¦regexpr('[\\\\.]',s )  #\u0026gt; [1] 2 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  regexpr('\\\\d',s ) # æ­£ç¢º  #\u0026gt; [1] 7 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  x\u0026lt;-regexpr('[0-9]',s ) # æ­£ç¢º attr(x,\u0026quot;match.length\u0026quot;)  #\u0026gt; [1] 1  s\u0026lt;-\u0026quot;a.b.c.9 6 8\u0026quot; x\u0026lt;-regexpr('[0-9]',s ) x  #\u0026gt; [1] 7 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  attr(x,\u0026quot;match.length\u0026quot;)  #\u0026gt; [1] 1  gregexpr() å’Œ regexpr()ä¸€æ¨£,ä¸åŒçš„æ˜¯æœƒåœ¨ç›®æ¨™å­—ä¸²ä¸­æœå°‹æ‰€æœ‰ç¬¦åˆçš„ä½ç½®è€Œä¸æ˜¯åªæ‰¾ç¬¬ä¸€å€‹(g:å…¨å±€)ã€‚ å› æ­¤å‚³å›çš„çµæœå€‹æ•¸é›–ç„¶å’ŒæŸ¥æ‰¾çš„ä¸²åˆ—å…ƒç´ å€‹æ•¸ä¸€æ¨£,ä½†æ˜¯æ¯å€‹å…ƒç´ éƒ½æ˜¯ä¸€å€‹å‘é‡ã€‚å¦‚æœéƒ½æ²’æ‰¾åˆ°,åªæœ‰ä¸€å€‹-1ã€‚\ns\u0026lt;-\u0026quot;a.b.c.9 6 8\u0026quot; gregexpr('[0-9]',s )  #\u0026gt; [[1]] #\u0026gt; [1] 7 9 11 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 1 1 1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  æ•¸é‡ä¿®é£¾è©Quantifiers æŒ‡å®šé‡è¤‡æ¬¡æ•¸.\n *: è‡³å°‘0å€‹ã€‚\n +: è‡³å°‘ä¸€å€‹.\n ?: æœ€å¤šä¸€å€‹.\n {n}: å‰›å¥½nå€‹.\n {n,}: è‡³å°‘nå€‹.\n {n,m}: æ¬¡æ•¸åœ¨ n åˆ° m ä¹‹é–“(åŒ…æ‹¬n,m).\n(strings \u0026lt;- c(\u0026quot;a\u0026quot;, \u0026quot;ab\u0026quot;, \u0026quot;acb\u0026quot;, \u0026quot;accb\u0026quot;, \u0026quot;acccb\u0026quot;, \u0026quot;accccb\u0026quot;))  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;ab\u0026quot; \u0026quot;acb\u0026quot; \u0026quot;accb\u0026quot; \u0026quot;acccb\u0026quot; \u0026quot;accccb\u0026quot;  grep(\u0026quot;ac*b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;ab\u0026quot; \u0026quot;acb\u0026quot; \u0026quot;accb\u0026quot; \u0026quot;acccb\u0026quot; \u0026quot;accccb\u0026quot;  grep(\u0026quot;ac+b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;acb\u0026quot; \u0026quot;accb\u0026quot; \u0026quot;acccb\u0026quot; \u0026quot;accccb\u0026quot;  grep(\u0026quot;ac?b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;ab\u0026quot; \u0026quot;acb\u0026quot;  grep(\u0026quot;ac{2}b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;accb\u0026quot;  grep(\u0026quot;ac{2,}b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;accb\u0026quot; \u0026quot;acccb\u0026quot; \u0026quot;accccb\u0026quot;  grep(\u0026quot;ac{2,3}b\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;accb\u0026quot; \u0026quot;acccb\u0026quot;   ç·´ç¿’:Find all countries with ee in Gapminder using quantifiers.\n#\u0026gt; character(0)  \r\rPosition of pattern within the string  ^: å­—ä¸²é–‹é ­.\n $: å­—ä¸²çµå°¾.\n \\b: å·¦å³éƒ½ç©ºç™½çš„ word.\n \\B: å·¦å³ä¸æ˜¯ç©ºç™½ word.\n(strings \u0026lt;- c(\u0026quot;abcd\u0026quot;, \u0026quot;cdab\u0026quot;, \u0026quot;cabd\u0026quot;, \u0026quot;c abd\u0026quot;))  #\u0026gt; [1] \u0026quot;abcd\u0026quot; \u0026quot;cdab\u0026quot; \u0026quot;cabd\u0026quot; \u0026quot;c abd\u0026quot;  grep(\u0026quot;ab\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abcd\u0026quot; \u0026quot;cdab\u0026quot; \u0026quot;cabd\u0026quot; \u0026quot;c abd\u0026quot;  grep(\u0026quot;^ab\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abcd\u0026quot;  grep(\u0026quot;ab$\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;cdab\u0026quot;  grep(\u0026quot;\\\\bab\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abcd\u0026quot; \u0026quot;c abd\u0026quot;  regexpr(\u0026quot;\\\\bab\u0026quot;, strings)  #\u0026gt; [1] 1 -1 -1 3 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] 2 -1 -1 2 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE  regexpr(\u0026quot;\\\\Bab\u0026quot;, strings)  #\u0026gt; [1] -1 3 2 -1 #\u0026gt; attr(,\u0026quot;match.length\u0026quot;) #\u0026gt; [1] -1 2 2 -1 #\u0026gt; attr(,\u0026quot;index.type\u0026quot;) #\u0026gt; [1] \u0026quot;chars\u0026quot; #\u0026gt; attr(,\u0026quot;useBytes\u0026quot;) #\u0026gt; [1] TRUE   Exercise Find all .txt files in the repository.\n```{r ex_pos, echo = FALSE} grep(\u0026quot;\\\\.txt$\u0026quot;, files, value = TRUE) grep(\u0026quot;[.]txt$\u0026quot;, files, value = TRUE) ```  Operators  .: ä»»æ„å­—å…ƒã€‚\n [...]: ä¾‹å¦‚,[ade] 3å€‹å­—å…ƒå…¶ä¸­ä¸€å€‹ã€‚[a-e],aåˆ°e.\n [^...]: é™¤äº†[]æŒ‡å®šçš„å­—å…ƒï¼Œé[...]çš„æ„æ€ã€‚.\n \\: æŠ‘åˆ¶ä¸‹åˆ—å­—å…ƒåœ¨å­—ä¸²,\u0026quot;\u0026quot;,ä¸­çš„ç‰¹æ®Šæ„æ€ $ * + . ? [ ] ^ { } | ( ) \\, åªæ˜¯åœ¨Rä¸­,å› ç‚º\\åˆæœ‰ç‰¹æ®Šæ„ç¾© ,å› æ­¤å¿…é ˆé›™\\ä¾‹å¦‚ \\\\$ã€‚\n |: æˆ–.\n (...): å­—å…ƒçµ„,æ ¹æ“šå‡ºç¾çš„é †åº,å¯ä»¥ç”¨ \\\\Nè­˜åˆ¥( backreference).\n(strings \u0026lt;- c(\u0026quot;^ab\u0026quot;, \u0026quot;ab\u0026quot;, \u0026quot;abc\u0026quot;, \u0026quot;abd\u0026quot;, \u0026quot;abe\u0026quot;, \u0026quot;ab 12\u0026quot;))  #\u0026gt; [1] \u0026quot;^ab\u0026quot; \u0026quot;ab\u0026quot; \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot; \u0026quot;ab 12\u0026quot;  grep(\u0026quot;ab.\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot; \u0026quot;ab 12\u0026quot;  grep(\u0026quot;ab[c-e]\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot;  grep(\u0026quot;ab[^c]\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot; \u0026quot;ab 12\u0026quot;  grep(\u0026quot;^ab\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;ab\u0026quot; \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot; \u0026quot;ab 12\u0026quot;  grep(\u0026quot;\\\\^ab\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;^ab\u0026quot;  grep(\u0026quot;abc|abd\u0026quot;, strings, value = TRUE)  #\u0026gt; [1] \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot;  gsub(\u0026quot;(ab) 12\u0026quot;, \u0026quot;\\\\1 34\u0026quot;, strings)  #\u0026gt; [1] \u0026quot;^ab\u0026quot; \u0026quot;ab\u0026quot; \u0026quot;abc\u0026quot; \u0026quot;abd\u0026quot; \u0026quot;abe\u0026quot; \u0026quot;ab 34\u0026quot;   note:\nè¦è®“.å¤±æ•ˆï¼Œå¯ä»¥[.]æˆ– \\\\. è¡¨ç¤ºã€‚\nExcercise æ‰¾å‡ºåœ‹åä¸­é–“æœ‰å­—å…ƒi t ä¸¦ä¸”å°‡landçµå°¾çš„å­—ä¸²æ”¹ç‚ºå¤§å¯«ã€‚ä¾‹å¦‚,Finland-\u0026gt;FinLAND\n#\u0026gt; character(0)  Character classes é è¨­å­—å…ƒåˆ†é¡ä¾‹å¦‚ numbers, letters, åˆ†é¡ã€‚\né–‹é ­[: çµå°¾ :] ï¼Œå¦ä¸€ç¨®ç°¡å¯«æ–¹å¼ç‚ºåˆ©ç”¨ \\ ã€‚\n [:digit:] or \\d: æ•¸å­—,ç­‰åŒ [0-9].\n \\D: éæ•¸å­—,ç­‰åŒ [^0-9].\n [:lower:]: å°å¯«,ç­‰åŒ [a-z].\n [:upper:]: å¤§å¯«,ç­‰åŒ [A-Z].\n [:alpha:]: å­—æ¯,ç­‰åŒ [[:lower:][:upper:]] or [A-z].\n [:alnum:]: ç­‰åŒ [[:alpha:][:digit:]] æˆ– [A-z0-9].\n \\w: word characters, equivalent to [[:alnum:]_] or [A-z0-9_].\n \\W: not word, equivalent to [^A-z0-9_].\n [:xdigit:]: hexadecimal digits (base 16), 0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f, equivalent to [0-9A-Fa-f].\n [:blank:]: blank characters, i.e. space and tab.\n [:space:]: space characters: tab, newline, vertical tab, form feed, carriage return, space.\n \\s: space, .\n \\S: not space.\n [:punct:]: punctuation characters, ! \u0026quot; # $ % \u0026amp; ' ( ) * + , - . / : ; \u0026lt; = \u0026gt; ? @ [ \\ ] ^ _ ` { | } ~.\n [:graph:]: graphical (human readable) characters: equivalent to [[:alnum:][:punct:]].\n [:print:]: printable characters, equivalent to [[:alnum:][:punct:]\\\\s].\n [:cntrl:]: control characters, like \\n or \\r, [\\x00-\\x1F\\x7F].\n  Note:\n [:...:] å¿…é ˆå¯«åœ¨ä¸­æ‹¬è™Ÿä¸­, ä¾‹å¦‚ [[:digit:]].\n \\ æ³¨æ„ \\\\d. å’Œ \\tçš„å€åˆ¥ã€‚\n "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_1_4_type_more.html","title": "4.1.4 type more",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " Factors Rä¹Ÿèƒ½æŠŠè³‡æ–™å­˜ç‚ºfactorã€‚\nåœ¨å¤§éƒ¨åˆ†å¯¦é©—ä¸­,æŸäº›è§£é‡‹è®Šæ•¸ç¶“å¸¸æœ‰ä¸åŒç¨‹åº¦çš„æ¸¬è©¦,ç¨±ç‚ºå› å­ã€‚\nå¤§æ„å¦‚ä¸‹ï¼š\n ... includes trials for different levels of some explanatory variable.\nThe different levels are also called factors.\n æ¢ç´¢ä¸€ä¸‹factors fert = c(10,20,20,50,10,20,10,50,20) fert = factor(fert,levels=c(10,20,50),ordered=TRUE)  levels()å¯ä»¥é¡¯ç¤ºfactorçš„æ¨™ç±¤\nè§£é‡‹ï¼š\nlevels(fert) ç”¢ç”Ÿä¸€å€‹ã€Œå­—ä¸²å‘é‡ã€ï¼Œå…§å®¹ç‚º10, 20, 50ï¼Œå¦‚ä¸‹å¯è­‰ï¼š\nstr(levels(fert))  #\u0026gt; chr [1:3] \u0026quot;10\u0026quot; \u0026quot;20\u0026quot; \u0026quot;50\u0026quot;  \r\rlevels(fert)  #\u0026gt; [1] \u0026quot;10\u0026quot; \u0026quot;20\u0026quot; \u0026quot;50\u0026quot;  fert çš„å…§å®¹ï¼Œå¦‚æœå¿½ç•¥æ¨™ç±¤æœ¬èº«ï¼Œå…¶å¯¦å·²ç¶“æ˜¯æ•¸å­—,ä¹Ÿå°±æ˜¯:typeof(fert)=ã€‚\nfert  #\u0026gt; [1] 10 20 20 50 10 20 10 50 20 #\u0026gt; Levels: 10 \u0026lt; 20 \u0026lt; 50  typeof(fert)  #\u0026gt; [1] \u0026quot;integer\u0026quot;  ğŸ’¡ å› æ­¤, attr(x,\u0026quot;levels\u0026quot;)=levels(x)ã€‚\nä¸Šé¢çš„typeof(fert)èªªæ˜¯æ•¸å­—,ä½†æ˜¯å¦‚æœçœŸçš„æŠŠå®ƒç•¶æˆæ•¸å­—å‘é‡,åˆç„¡æ³•åˆ©ç”¨å‡½æ•¸meanè¨ˆç®—å¹³å‡ğŸ’£\nmean(fert)  #\u0026gt; Warning in mean.default(fert): å¼•æ•¸ä¸æ˜¯æ•¸å€¼ä¹Ÿä¸æ˜¯é‚è¼¯å€¼ï¼šå›è¦† NA  #\u0026gt; [1] NA  å¿…é ˆè½‰æ›:\nmean(as.numeric(levels(fert)[fert]))  #\u0026gt; [1] 23.33333  é‚£éº¼æœ€å°å€¼å‘¢?\nmin(fert)  #\u0026gt; [1] 10 #\u0026gt; Levels: 10 \u0026lt; 20 \u0026lt; 50  â“ ç‚ºç”šéº¼ä¸Šé¢çš„æ±‚æœ€å°å¯ä»¥,é€™è£¡åˆä¸è¡Œ?\nfert = c(10,20,20,50,10,20,10,50,20) fert = factor(fert,levels=c(10,20,50) ) min(fert)  #\u0026gt; Error in Summary.factor(structure(c(1L, 2L, 2L, 3L, 1L, 2L, 1L, 3L, 2L: 'min' å°å› å­æ²’æœ‰æ„ç¾©  æ¢ç´¢ a \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;))  é æœŸç­”æ¡ˆæ˜¯factor,okã€‚\nclass(a)  #\u0026gt; [1] \u0026quot;factor\u0026quot;  å› ç‚ºaå·²ç¶“è¢«ç·¨ç¢¼ï¼Œé æœŸæ˜¯numericï¼Œé€™è£¡ç­”æ¡ˆç›´æ¥çµ¦å®šinteger:\ntypeof(a)  #\u0026gt; [1] \u0026quot;integer\u0026quot;  aæ˜¯ä¸€å€‹factor,æ‰€ä»¥a[]ä»£è¡¨açš„ä¸€å€‹å­é›†åˆï¼Œå› æ­¤çµæœçœ‹èµ·ä¾†ä¹Ÿæ˜¯é¡ä¼¼åŸä¾†açš„å‹æ…‹ï¼š\na[1]  #\u0026gt; [1] A #\u0026gt; Levels: A B C  é©—è­‰æ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„è¡¨ç¤ºæ–¹å¼ä¸€æ¨£ï¼š\na  #\u0026gt; [1] A A B A B B C A C #\u0026gt; Levels: A B C  æ‰€ä»¥ï¼Œa,a[]éƒ½æ˜¯é¡å‹ç‚ºfactorçš„è®Šæ•¸ã€‚\næŒ‰ç…§ä¹‹é–“[]å’Œ[[]]çš„è¦å‰‡ï¼Œé€™è£¡æœƒå‡ºç¾ä»€éº¼ï¼Ÿ\na[[1]]  #\u0026gt; [1] A #\u0026gt; Levels: A B C  å‡ºç¾çš„çµæœå’Œa[1]ä¸€æ¨£ï¼Œé€™èªªæ˜äº†ï¼Œaçš„çµæ§‹ä¸æ˜¯list,åˆ©ç”¨str()å‡½æ•¸çœ‹ä¸€ä¸‹ç¢ºèªï¼š\nstr(a)  #\u0026gt; Factor w/ 3 levels \u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;: 1 1 2 1 2 2 3 1 3  ç¸½ä¹‹ï¼Œa[1] a[[1]] éƒ½æ˜¯Factor æ²’æœ‰[ å’Œ [[ çš„åˆ†åˆ¥ã€‚é€™å¾ˆå¥½è¨˜ï¼Œå› ç‚ºé€™å€‹factorä¹Ÿæ˜¯rçš„å…§å»ºè³‡æ–™å‹æ…‹ã€‚\nå…¶ä»–é©—è­‰å¦‚ä¸‹ï¼Œè‡ªè¡Œæ¨æ•²ï¼š\n\n\u0026gt; typeof(a[[1]])\n[1] \u0026quot;integer\u0026quot;\n\u0026gt; typeof(a[1])\n[1] \u0026quot;integer\u0026quot;\n\u0026gt; class(a[[1]])\n[1] \u0026quot;factor\u0026quot;\n\u0026gt; class(a[1])\n[1] \u0026quot;factor\u0026quot;\n\nå¸¸ç”¨ä¾†å’Œtableé…åˆ\ntable(a)  #\u0026gt; a #\u0026gt; A B C #\u0026gt; 4 3 2  åˆ©ç”¨summaryå‡½æ•¸çš„æ™‚å€™,é€™è£¡ä¸å†åˆ—å‡º5å€‹çµ±è¨ˆé‡:\nsummary(a)  #\u0026gt; A B C #\u0026gt; 4 3 2  åˆæœ‰æ–°çš„å•é¡Œäº†ï¼Œåˆ°åº•table(a),summary(a)çš„è³‡æ–™çµæ§‹æ˜¯ä»€éº¼ï¼Ÿ\nstr(table(a))  #\u0026gt; 'table' int [1:3(1d)] 4 3 2 #\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 1 #\u0026gt; ..$ a: chr [1:3] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;  str(summary(a))  #\u0026gt; Named int [1:3] 4 3 2 #\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr [1:3] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;  class(table(a))  #\u0026gt; [1] \u0026quot;table\u0026quot;  class(summary(a))  #\u0026gt; [1] \u0026quot;integer\u0026quot;  åˆä¾†ä¸€å€‹è®“äººç„¡è¨€çš„åœ°æ–¹ï¼Œè¼¸å‡ºæ¨£å­çœ‹èµ·ä¾†å¾ˆåƒï¼Œä½†æ˜¯çµæ§‹ä¸€å€‹æ˜¯é¡åˆ¥tableä¸€å€‹æ˜¯ã€Œæ•´æ•¸å‘é‡ã€ï¼Œç„¶å¾Œæ¯å€‹å…ƒç´ éƒ½æ˜¯å› å­çš„ç™¼ç”Ÿæ¬¡æ•¸ï¼Œå¸¶æœ‰å› å­åå­—ï¼Œé€™è£¡æ˜¯\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;ã€‚\nhw â“æ‰¾å›åŸä¾†é‚„æ²’è¢«factorçš„å‘é‡ã€‚\nx\u0026lt;-c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;) fx\u0026lt;-factor(x) # ç¾åœ¨xæ˜¯ä¸€å€‹factor  ç¾åœ¨å‡å®š,æˆ‘å€‘åªæœ‰fx,è¦æ‰¾å›xçš„å…§å®¹ã€‚\n\r\rğŸ’¡å°±åƒé€™æ¨£:c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;)[c(1,1,2,3,2)] ==\u0026gt; a,a,b,c,b ã€‚\n\rå±•é–‹\r```r\rx\u0026lt;-c(\u0026#34;a\u0026#34;,\u0026#34;b\u0026#34;,\u0026#34;c\u0026#34;)\rfx\u0026lt;-factor(x) # ç¾åœ¨xæ˜¯ä¸€å€‹factor\r#ğŸ’¡\rx\u0026lt;-levels(fx)[fx] #ç¾åœ¨åˆè¢«è½‰å›åŸä¾†çš„x\r``` factor å’Œå‡½æ•¸read.csv() read.csv() é€šå¸¸ç”¢ç”Ÿä¸€å€‹data.frameçš„é¡åˆ¥ã€‚ä½†æ˜¯åœ¨è®€æª”çš„æ™‚å€™ï¼Œå¦‚æœé‡åˆ°å­—ä¸²æ¬„ä½ï¼Œæœƒå°‡å­—ä¸²æ¬„ä½é è¨­è½‰ç‚ºfactoræ¬„ä½ã€‚\nè§€å¯Ÿcarbon dioxide å°æ¨¹æœ¨çš„ç”Ÿé•·é€Ÿç‡ trees91.csv [1^]\né™„ä»¶\n\ré™„ä»¶\r\rJournals.csv\r\rsample1.csv\r\rsample2.csv\r\rsample3.csv\r\rsimple.csv\r\rsmoker.csv\r\rtrees91.csv\r\rwh.csv\r\rwh_chinese.csv\r\r tree = read.csv(\u0026quot;./resources/trees91.csv\u0026quot;, header = TRUE, sep = \u0026quot;,\u0026quot;); attributes(tree)  #\u0026gt; $names #\u0026gt; [1] \u0026quot;C\u0026quot; \u0026quot;N\u0026quot; \u0026quot;CHBR\u0026quot; \u0026quot;REP\u0026quot; \u0026quot;LFBM\u0026quot; \u0026quot;STBM\u0026quot; \u0026quot;RTBM\u0026quot; \u0026quot;LFNCC\u0026quot; #\u0026gt; [9] \u0026quot;STNCC\u0026quot; \u0026quot;RTNCC\u0026quot; \u0026quot;LFBCC\u0026quot; \u0026quot;STBCC\u0026quot; \u0026quot;RTBCC\u0026quot; \u0026quot;LFCACC\u0026quot; \u0026quot;STCACC\u0026quot; \u0026quot;RTCACC\u0026quot; #\u0026gt; [17] \u0026quot;LFKCC\u0026quot; \u0026quot;STKCC\u0026quot; \u0026quot;RTKCC\u0026quot; \u0026quot;LFMGCC\u0026quot; \u0026quot;STMGCC\u0026quot; \u0026quot;RTMGCC\u0026quot; \u0026quot;LFPCC\u0026quot; \u0026quot;STPCC\u0026quot; #\u0026gt; [25] \u0026quot;RTPCC\u0026quot; \u0026quot;LFSCC\u0026quot; \u0026quot;STSCC\u0026quot; \u0026quot;RTSCC\u0026quot; #\u0026gt; #\u0026gt; $class #\u0026gt; [1] \u0026quot;data.frame\u0026quot; #\u0026gt; #\u0026gt; $row.names #\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #\u0026gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 #\u0026gt; [51] 51 52 53 54  names(tree)  #\u0026gt; [1] \u0026quot;C\u0026quot; \u0026quot;N\u0026quot; \u0026quot;CHBR\u0026quot; \u0026quot;REP\u0026quot; \u0026quot;LFBM\u0026quot; \u0026quot;STBM\u0026quot; \u0026quot;RTBM\u0026quot; \u0026quot;LFNCC\u0026quot; #\u0026gt; [9] \u0026quot;STNCC\u0026quot; \u0026quot;RTNCC\u0026quot; \u0026quot;LFBCC\u0026quot; \u0026quot;STBCC\u0026quot; \u0026quot;RTBCC\u0026quot; \u0026quot;LFCACC\u0026quot; \u0026quot;STCACC\u0026quot; \u0026quot;RTCACC\u0026quot; #\u0026gt; [17] \u0026quot;LFKCC\u0026quot; \u0026quot;STKCC\u0026quot; \u0026quot;RTKCC\u0026quot; \u0026quot;LFMGCC\u0026quot; \u0026quot;STMGCC\u0026quot; \u0026quot;RTMGCC\u0026quot; \u0026quot;LFPCC\u0026quot; \u0026quot;STPCC\u0026quot; #\u0026gt; [25] \u0026quot;RTPCC\u0026quot; \u0026quot;LFSCC\u0026quot; \u0026quot;STSCC\u0026quot; \u0026quot;RTSCC\u0026quot;  [1^]: The original spreadsheet is located at http://cdiac.ornl.gov/ftp/ndp061a/trees91.wk1.\nA description of the data file is located at http://cdiac.ornl.gov/ftp/ndp061a/ndp061a.txt .\nfactor å’Œå‡½æ•¸summary() åœ¨CHBRé€™å€‹æ¬„ä½ä¸­,å› ç‚ºä¸å…¨éƒ½æ˜¯æ•¸å­—,å› æ­¤Rè‡ªå‹•å‡å®šé€™æ˜¯ä¸€å€‹factorã€‚\nå› æ­¤é‡å°é€™å€‹æ¬„ä½summary()å‡½æ•¸ä¸æœƒåˆ—å‡º5å€‹çµ±è¨ˆé‡,è€Œæ˜¯åˆ—å‡ºæ¬¡æ•¸è¡¨ã€‚å› ç‚ºï¼Œä¸€æ—¦å‘é‡è½‰ç‚ºä¸€çµ„factors, 5å€‹åŸºæœ¬çµ±è¨ˆé‡ä¸å†æœ‰æ„ç¾©ã€‚\nsummary(tree$CHBR)  #\u0026gt; Length Class Mode #\u0026gt; 54 character character  #ğŸ·åœ¨CHBRé€™å€‹æ¬„ä½ä¸­,å› ç‚ºä¸å…¨éƒ½æ˜¯æ•¸å­—,å› æ­¤Rè‡ªå‹•å‡å®šé€™æ˜¯ä¸€å€‹factorã€‚  ä½†æœ‰äº›æ¬„ä½ä¾‹å¦‚C,ä¹Ÿæ˜¯ä¸€å€‹factorã€‚ä½†æ˜¯,Rèªå®šç‚ºæ•¸å­—,é€™æ™‚å¿…é ˆæ‰‹å‹•è™•ç†ã€‚\nä»¥ä¸‹å°‡ tree$C è½‰ç‚º factor:\ntree$C #ğŸ·é€™æ˜¯1å€‹factor,ä½†æ˜¯è½‰é€²ä¾†çš„æ™‚å€™,è¢«èªå®šç‚ºæ•¸å­—  #\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 #\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4  summary(tree$C)  #\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 1.000 2.000 2.000 2.519 3.000 4.000  tree$C \u0026lt;- factor(tree$C) tree$C  #\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 #\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 #\u0026gt; Levels: 1 2 3 4  summary(tree$C)  #\u0026gt; 1 2 3 4 #\u0026gt; 8 23 10 13  levels(tree$C)  #\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;2\u0026quot; \u0026quot;3\u0026quot; \u0026quot;4\u0026quot;  node: summary() å‡½æ•¸ï¼Œåƒè€ƒtableä¸€ç¯€ã€‚\nbarplot(table(tree$C))  Data Frames ç°¡å–®ä»‹ç´¹ä¸€ä¸‹æ‰‹å‹•å»ºç«‹data.frame 3å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯a,b,f\na \u0026lt;- c(1, 2, 3, 4) b \u0026lt;- c(2, 4, 6, 8) levels \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;)) bubba \u0026lt;- data.frame(first = a, second = b, f = levels) bubba  #\u0026gt; first second f #\u0026gt; 1 1 2 A #\u0026gt; 2 2 4 B #\u0026gt; 3 3 6 A #\u0026gt; 4 4 8 B  summary(bubba)  #\u0026gt; first second f #\u0026gt; Min. :1.00 Min. :2.0 A:2 #\u0026gt; 1st Qu.:1.75 1st Qu.:3.5 B:2 #\u0026gt; Median :2.50 Median :5.0 #\u0026gt; Mean :2.50 Mean :5.0 #\u0026gt; 3rd Qu.:3.25 3rd Qu.:6.5 #\u0026gt; Max. :4.00 Max. :8.0  bubba$first  #\u0026gt; [1] 1 2 3 4  bubba$second  #\u0026gt; [1] 2 4 6 8  bubba$f  #\u0026gt; [1] A B A B #\u0026gt; Levels: A B  data frame çš„å¸¸ç”¨å‡½æ•¸ï¼š  head() - shows first 6 rows\n tail() - shows last 6 rows\n dim() - returns the dimensions of data frame (i.e. number of rows and number of columns)\n nrow() - number of rows\n ncol() - number of columns\n str() - structure of data frame - name, type and preview of data in each column\n names() - shows the names attribute for a data frame, which gives the column names.\n sapply(dataframe, class) - shows the class of each column in the data frame\n  å›åˆ°ä¹‹å‰åˆ©ç”¨read.csvè®€å…¥çš„data.frame : tree\n# é †ä¾¿çœ‹çœ‹çµæ§‹ typeof(tree)  #\u0026gt; [1] \u0026quot;list\u0026quot;  class(tree)  #\u0026gt; [1] \u0026quot;data.frame\u0026quot;  is.data.frame(tree)  #\u0026gt; [1] TRUE  æ—¢ç„¶treeæ˜¯ä¸€å€‹list,é‚£éº¼[]å’Œ[[]]çš„æ‡‰ç”¨å°±å’Œä¹‹å‰è¨è«–çš„ä¸€æ¨£ï¼š\ntree[1]  #\u0026gt; C #\u0026gt; 1 1 #\u0026gt; 2 1 #\u0026gt; 3 1 #\u0026gt; 4 1 #\u0026gt; 5 1 #\u0026gt; 6 1 #\u0026gt; 7 1 #\u0026gt; 8 1 #\u0026gt; 9 2 #\u0026gt; 10 2 #\u0026gt; 11 2 #\u0026gt; 12 2 #\u0026gt; 13 2 #\u0026gt; 14 2 #\u0026gt; 15 2 #\u0026gt; 16 2 #\u0026gt; 17 2 #\u0026gt; 18 2 #\u0026gt; 19 2 #\u0026gt; 20 2 #\u0026gt; 21 2 #\u0026gt; 22 2 #\u0026gt; 23 2 #\u0026gt; 24 2 #\u0026gt; 25 2 #\u0026gt; 26 2 #\u0026gt; 27 2 #\u0026gt; 28 2 #\u0026gt; 29 2 #\u0026gt; 30 2 #\u0026gt; 31 2 #\u0026gt; 32 3 #\u0026gt; 33 3 #\u0026gt; 34 3 #\u0026gt; 35 3 #\u0026gt; 36 3 #\u0026gt; 37 3 #\u0026gt; 38 3 #\u0026gt; 39 3 #\u0026gt; 40 3 #\u0026gt; 41 3 #\u0026gt; 42 4 #\u0026gt; 43 4 #\u0026gt; 44 4 #\u0026gt; 45 4 #\u0026gt; 46 4 #\u0026gt; 47 4 #\u0026gt; 48 4 #\u0026gt; 49 4 #\u0026gt; 50 4 #\u0026gt; 51 4 #\u0026gt; 52 4 #\u0026gt; 53 4 #\u0026gt; 54 4  tree[[1]]  #\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 #\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 #\u0026gt; Levels: 1 2 3 4  class(tree[1]) # data.frame  #\u0026gt; [1] \u0026quot;data.frame\u0026quot;  class(tree[[1]]) # integer  #\u0026gt; [1] \u0026quot;factor\u0026quot;  typeof(tree[1]) # list  #\u0026gt; [1] \u0026quot;list\u0026quot;  typeof(tree$C) # integer  #\u0026gt; [1] \u0026quot;integer\u0026quot;  typeof(tree[[1]]) # integer  #\u0026gt; [1] \u0026quot;integer\u0026quot;  tree[1] æ˜¯ä¸€å€‹list\ntree[[1]] å¤–åœçš„tree[]é¦–å…ˆè¢«è§£è®€ç‚ºlisté¡åˆ¥,ç„¶å¾Œ[1]å‚³åˆ°é¡åˆ¥\n [[ vs [\nç”±typeof,classçœ‹èµ·ä¾†\n[[æŠ½å–listä¸­çš„å…ƒç´ \n[åªæ˜¯åˆ†å‰²list,ä¸­çš„subset\n Tables é™¤äº†data frame ä»¥å¤–,é‚„æœ‰table å¯ä»¥ç”¨ä¾†çµ„ç¹”è³‡æ–™ã€‚\né€™è£¡åªçœ‹æ€æ¨£å»ºç«‹table,åˆ†æçœ‹å…¶ä»–ç« ç¯€ã€‚\nOne Way Tables table()æŒ‡ä»¤:\né€™å€‹æŒ‡ä»¤é€šå¸¸ç”¨ä¾†å»ºç«‹å› å­ä¹‹é–“çš„é—œè¯è¡¨(contingency table)ã€‚åƒæ•¸é€šå¸¸æ˜¯ä¸€å€‹ã€Œå› å­å‘é‡ã€(factor vector)ã€‚\nä¾‹å¦‚å»ºç«‹ä¸€å€‹å–®å› å­é—œè¯è¡¨ï¼ˆone way tableï¼‰:\na \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;)) table_a \u0026lt;- table(a)  table_aï¼š\ntable_a  #\u0026gt; a #\u0026gt; A B C #\u0026gt; 4 3 2  attributeså¯ä»¥çœ‹å‡ºtable_aè£¡é¢æœ‰å“ªäº›å¸¶åå…ƒç´ \nattributes(table_a)  #\u0026gt; $dim #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; $dimnames #\u0026gt; $dimnames$a #\u0026gt; [1] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot; #\u0026gt; #\u0026gt; #\u0026gt; $class #\u0026gt; [1] \u0026quot;table\u0026quot;  summary(table_a)  #\u0026gt; Number of cases in table: 9 #\u0026gt; Number of factors: 1  å°ç…§table(a)ï¼Œç›´æ¥æŠŠfactor è®Šæ•¸ï¼Œä»£å…¥summary()çœ‹ä¸€ä¸‹ï¼Œçµæœæ˜¯æ¬¡æ•¸åˆ†é…è¡¨ï¼ˆå¦‚ä¸‹ï¼‰\ntable(a)  #\u0026gt; a #\u0026gt; A B C #\u0026gt; 4 3 2  summary(a)  #\u0026gt; A B C #\u0026gt; 4 3 2  å•é¡Œï¼šå¦‚æœæˆ‘å€‘çŸ¥é“Aæœ‰4,å€‹,Bæœ‰3å€‹,Cæœ‰2å€‹,èƒ½ä¸èƒ½ç›´æ¥å»ºç«‹table?\n1. å…ˆå»ºç«‹matrix\n2. å†åŠ å…¥æ¬„ä½åç¨±\n3. åˆ©ç”¨å‡½æ•¸as.table()\n# step 1 occur \u0026lt;- matrix(c(4, 3, 2), ncol = 3, byrow = TRUE) occur  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 4 3 2  #step 2 colnames(occur) \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;) occur  #\u0026gt; A B C #\u0026gt; [1,] 4 3 2  #step 3 occur \u0026lt;- as.table(occur) occur  #\u0026gt; A B C #\u0026gt; A 4 3 2  attributes(occur)  #\u0026gt; $dim #\u0026gt; [1] 1 3 #\u0026gt; #\u0026gt; $dimnames #\u0026gt; $dimnames[[1]] #\u0026gt; [1] \u0026quot;A\u0026quot; #\u0026gt; #\u0026gt; $dimnames[[2]] #\u0026gt; [1] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot; #\u0026gt; #\u0026gt; #\u0026gt; $class #\u0026gt; [1] \u0026quot;table\u0026quot;  Two Way Tables é€™å€‹ä¾‹å­ä¸­æœ‰å…©å€‹å•é¡Œ:ç¬¬1å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰â€œNever,â€ â€œSometimes,â€ or â€œAlways.â€\nç¬¬2å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰ â€œYes,â€ â€œNo,â€ or â€œMaybe.â€\nå…©å€‹å•é¡Œåˆ†åˆ¥ä»¥å‘é‡a,bå­˜æ”¾( The set of vectors â€œa,â€ and â€œb,â€ contain the response for each measurement.)\na \u0026lt;- c(\u0026quot;Sometimes\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Never\u0026quot;, \u0026quot;Always\u0026quot;, \u0026quot;Always\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Never\u0026quot;) b \u0026lt;- c(\u0026quot;Maybe\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;Yes\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;No\u0026quot;, \u0026quot;Yes\u0026quot;, \u0026quot;No\u0026quot;) results \u0026lt;- table(a, b) results  #\u0026gt; b #\u0026gt; a Maybe No Yes #\u0026gt; Always 2 0 0 #\u0026gt; Never 0 1 1 #\u0026gt; Sometimes 2 1 1  åœ¨è¡¨æ ¼ä¸­,å¯ä»¥çœ‹åˆ°åŒæ™‚å›ç­” â€œMaybeâ€ â€œSometimesâ€ çš„å€‹æ•¸æœ‰å¹¾å€‹ã€‚\né€™è£¡æ˜¯å¦ä¸€å€‹ç›´æ¥ç”±æˆ‘å€‘çŸ¥é“çš„æ•¸æ“šå»ºç«‹tableçš„ä¾‹å­\nsexsmoke \u0026lt;- matrix(c(70, 120, 65, 140), ncol = 2, byrow = TRUE) rownames(sexsmoke) \u0026lt;- c(\u0026quot;male\u0026quot;, \u0026quot;female\u0026quot;) colnames(sexsmoke) \u0026lt;- c(\u0026quot;smoke\u0026quot;, \u0026quot;nosmoke\u0026quot;) sexsmoke \u0026lt;- as.table(sexsmoke) sexsmoke  #\u0026gt; smoke nosmoke #\u0026gt; male 70 120 #\u0026gt; female 65 140  "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_2_type_post.html","title": "4.2 type post",
	"tags": [],
	"description": "è£œå……",
	"content": " ç›¸é—œæ“ä½œ practice1.R\nå•é¡Œ:æƒ³è¦çŸ¥é“æœ‰ç”šéº¼è³‡æ–™åº«å¯ä»¥ç”¨? ä¾‹å¦‚ï¼Œ æƒ³è¦çŸ¥é“è³‡æ–™åº«è£é¢æœ‰æ²’æœ‰'mtcars'\nhint:\ngrep('pattern',target)\nl\u0026lt;-list('a','b','c') grep('a',l)  #\u0026gt; [1] 1  åˆ©ç”¨æŒ‡ä»¤data()å¯ä»¥åˆ—å‡ºå…§å»ºè³‡æ–™ï¼š\nxx\u0026lt;-data()  xx æ˜¯ç”šéº¼?ç›´æ¥æ‰“å…¥xxä¸¦æ²’æœ‰åƒå…¶ä»–è®Šæ•¸ä¸€æ¨£ï¼Œåœ¨consoleé¡¯ç¤ºå…§å®¹ï¼š\nxx  str(xx)  #\u0026gt; List of 4 #\u0026gt; $ title : chr \u0026quot;Data sets\u0026quot; #\u0026gt; $ header : NULL #\u0026gt; $ results: chr [1:104, 1:4] \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; ... #\u0026gt; ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 #\u0026gt; .. ..$ : NULL #\u0026gt; .. ..$ : chr [1:4] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot; #\u0026gt; $ footer : chr \u0026quot;Use 'data(package = .packages(all.available = TRUE))'\\nto list the data sets in all *available* packages.\u0026quot; #\u0026gt; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;packageIQR\u0026quot;  is.data.frame(xx)  #\u0026gt; [1] FALSE  is.list(xx)  #\u0026gt; [1] TRUE  is.table(xx)  #\u0026gt; [1] FALSE  class(xx)  #\u0026gt; [1] \u0026quot;packageIQR\u0026quot;  class()å‡½æ•¸èªªæ˜xxæ˜¯ä¸€å€‹packageIQRç‰©ä»¶ã€‚str()å¯ä»¥çœ‹å‡ºæ˜¯ä¸€å€‹é•·åº¦ç‚º4çš„listï¼Œå…¶ä¸­resultsæ¨™ç±¤ï¼Œæ˜¯ä¸€å€‹å­—ä¸²çŸ©é™£ï¼Œå¤§å°ç‚º104 x 4ã€‚å…¶ä¸­4å€‹æ¬„ä½çš„åç¨±ç‚ºï¼š\u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot;ï¼ˆå¦‚ä¸‹ï¼‰ï¼š\nhead(xx$results)  #\u0026gt; Package LibPath Item #\u0026gt; [1,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;AirPassengers\u0026quot; #\u0026gt; [2,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;BJsales\u0026quot; #\u0026gt; [3,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;BJsales.lead (BJsales)\u0026quot; #\u0026gt; [4,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;BOD\u0026quot; #\u0026gt; [5,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;CO2\u0026quot; #\u0026gt; [6,] \u0026quot;datasets\u0026quot; \u0026quot;C:/Program Files/R/R-4.0.3/library\u0026quot; \u0026quot;ChickWeight\u0026quot; #\u0026gt; Title #\u0026gt; [1,] \u0026quot;Monthly Airline Passenger Numbers 1949-1960\u0026quot; #\u0026gt; [2,] \u0026quot;Sales Data with Leading Indicator\u0026quot; #\u0026gt; [3,] \u0026quot;Sales Data with Leading Indicator\u0026quot; #\u0026gt; [4,] \u0026quot;Biochemical Oxygen Demand\u0026quot; #\u0026gt; [5,] \u0026quot;Carbon Dioxide Uptake in Grass Plants\u0026quot; #\u0026gt; [6,] \u0026quot;Weight versus age of chicks on different diets\u0026quot;  å¦‚æœè¦ºå¾—æ··äº‚,å¯ä»¥åˆ©ç”¨\nView(xx$results)  å› ç‚ºæ˜¯çŸ©é™£,æ‰€ä»¥ä¸èƒ½ä»¥ã€Œ$ã€å¾—åˆ°Itemçš„å…§å®¹?\nxx$results$Item  #\u0026gt; Error in xx$results$Item: $ operator is invalid for atomic vectors  head(xx$results[,'item'])  #\u0026gt; Error in xx$results[, \u0026quot;item\u0026quot;]: ä¸‹æ¨™è¶…å‡ºé‚Šç•Œ  ç‚ºç”šéº¼éŒ¯èª¤?\nå› ç‚ºå¤§å°å¯«,æ‰€ä»¥æ­£ç¢ºå¯«æ³•ç‚ºï¼š\nhead(xx$results[,'Item'])  #\u0026gt; [1] \u0026quot;AirPassengers\u0026quot; \u0026quot;BJsales\u0026quot; \u0026quot;BJsales.lead (BJsales)\u0026quot; #\u0026gt; [4] \u0026quot;BOD\u0026quot; \u0026quot;CO2\u0026quot; \u0026quot;ChickWeight\u0026quot;  åˆ©ç”¨grep()å¯ä»¥æ‹¿åˆ°mtcarsçš„ä½ç½®ï¼š\nidx\u0026lt;-grep('mtcars',xx$results[,'Item']) idx  #\u0026gt; [1] 72  ç¢ºèª\nxx$results[idx,'Item']  #\u0026gt; Item #\u0026gt; \u0026quot;mtcars\u0026quot;  å¸¸è¦‹éŒ¯èª¤ error l0 \u0026lt;- list(1, c(TRUE, FALSE), c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;)) l0   æ­£ç¢ºå¿µæ³•ï¼š\næ­£ç¢ºå¿µæ³• æŒ‡æ´¾ä¸€å€‹listçµ¦è®Šæ•¸l0ï¼Œè£¡é¢æœ‰ä¸‰å€‹å…ƒç´ ï¼Œç¬¬ä¸€å€‹å…ƒç´ æ˜¯ç´”é‡1ï¼Œç¬¬äºŒå€‹å…ƒç´ æ˜¯é‚è¼¯å‘é‡ï¼Œé•·åº¦ç‚º2ï¼Œå…§å®¹åˆ†åˆ¥æ˜¯TRUE, FALSEï¼Œç¬¬ä¸‰å€‹å…ƒç´ æ˜¯å­—å…ƒå‘é‡ï¼Œé•·åº¦ç‚º3ï¼Œå…§å®¹åˆ†åˆ¥æ˜¯\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;\n names(l1) \u0026lt;- c(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;)   éŒ¯èª¤å¿µæ³•\nè¨­å®šnames(li)ç­‰æ–¼é›†åˆ(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;)\næ­£ç¢ºå¿µæ³•ï¼š\nå°‡l1 é€™å€‹list çš„å‰3å€‹å…ƒç´ åç¨±ï¼Œåˆ†åˆ¥æŒ‡å®šç‚º A,B,C\n error l1$x \u0026lt;- NULL   æ­£ç¢ºå¿µæ³•ï¼š\nåˆªé™¤å…ƒç´ åç‚ºxçš„å…ƒç´ ã€‚\n error l0 \u0026lt;- list(1, c(TRUE, FALSE), c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;)) l1 \u0026lt;- list(x = 1, y = c(TRUE, FALSE), z = c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;)) l1$x l1$y l1$z l1$m   å¿µæ³•\nå»ºç«‹listè®Šæ•¸l1,åç¨±åˆ†åˆ¥æ˜¯x,y,z,å…§å®¹åˆ†åˆ¥æ˜¯.......\nl1$y ç‚ºé‚è¼¯å‘é‡\nl1$z ç‚ºå­—å…ƒå‘é‡\nğŸ·: l1$x === l1[[1]]\n "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_3_type_matrix.html","title": "4.3 type matrix",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " matrix çŸ©é™£çš„å»ºç«‹æœ‰å¤šç¨®æ–¹å¼,å…¶ä¸­ä¸€ç¨®æ˜¯åˆ©ç”¨å‘é‡è½‰å¡«çŸ©é™£ï¼Œå¡«å…¥çš„æ–¹å¼é è¨­æ˜¯ä»¥coumnç‚ºä¸»è¦æ–¹å‘ã€‚\nmatrix(c(1,2,3,4,5,6),2,3) #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 1 3 5 #\u0026gt; [2,] 2 4 6  å•é¡Œ: æ€æ¨£ç”¢ç”Ÿ\n1 2 3\n4 5 6\nçš„çŸ©é™£\ndiag(1, nrow = 5) #\u0026gt; [,1] [,2] [,3] [,4] [,5] #\u0026gt; [1,] 1 0 0 0 0 #\u0026gt; [2,] 0 1 0 0 0 #\u0026gt; [3,] 0 0 1 0 0 #\u0026gt; [4,] 0 0 0 1 0 #\u0026gt; [5,] 0 0 0 0 1  matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow = 3, byrow = TRUE, dimnames = list(c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;))) #\u0026gt; c1 c2 c3 #\u0026gt; r1 1 2 3 #\u0026gt; r2 4 5 6 #\u0026gt; r3 7 8 9  m1 \u0026lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol = 3) rownames(m1) \u0026lt;- c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;) colnames(m1) \u0026lt;- c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;) m1 #\u0026gt; c1 c2 c3 #\u0026gt; r1 1 4 7 #\u0026gt; r2 2 5 8 #\u0026gt; r3 3 6 9  B = matrix( c(2, 4, 3, 1, 5, 7), nrow=3, ncol=2) B #\u0026gt; [,1] [,2] #\u0026gt; [1,] 2 1 #\u0026gt; [2,] 4 5 #\u0026gt; [3,] 3 7  Transpose t(B) #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 2 4 3 #\u0026gt; [2,] 1 5 7  åˆä½µçŸ©é™£ åˆ©ç”¨å‡½æ•¸cbind() å¯ä»¥åˆä½µåŒæ¨£æ©«è¡Œæ•¸ç›®çš„å…©å€‹çŸ©é™£,ä¾‹å¦‚é€™è£¡Cä¹Ÿæ˜¯3å€‹æ©«è¡Œ:\nC = matrix( c(7, 4, 2), nrow=3, ncol=1) C #\u0026gt; [,1] #\u0026gt; [1,] 7 #\u0026gt; [2,] 4 #\u0026gt; [3,] 2  å’ŒBåˆä½µ\ncbind(B, C) #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 2 1 7 #\u0026gt; [2,] 4 5 4 #\u0026gt; [3,] 3 7 2  åŒæ¨£çš„,rbind() ä¹Ÿå¯ä»¥åˆä½µç›´è¡Œæ•¸ç›®ç›¸åŒçš„å…©å€‹çŸ©é™£:\nD = matrix( c(6, 2), nrow=1, ncol=2) D #\u0026gt; [,1] [,2] #\u0026gt; [1,] 6 2 rbind(B, D) #\u0026gt; [,1] [,2] #\u0026gt; [1,] 2 1 #\u0026gt; [2,] 4 5 #\u0026gt; [3,] 3 7 #\u0026gt; [4,] 6 2  å°‡çŸ©é™£è§£æ§‹å›å‘é‡:\nå¯ä»¥åˆ©ç”¨c() æœƒæŠŠçŸ©é™£æ‰€æœ‰çš„ç›´è¡Œéƒ½åˆä½µæˆä¸€å€‹ç›´è¡Œ.\nc(B) #\u0026gt; [1] 2 4 3 1 5 7  unlist ?\nç·´ç¿’:åˆ©ç”¨ä¸Šé¢çš„m1 å›ç­”ä¸‹é¢çš„å•é¡Œ:\nm1[1, 2] m1[1:2, 2:3] m1[1,] m1[,2] m1[1:2,] m1[, 2:3] m1[-1,] m1[,-2] m1[c(\u0026quot;r1\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c3\u0026quot;)] m1[1] m1[9] m1[3:7] m1 \u0026gt; 3 m1[m1 \u0026gt; 3] m1 + m1 m1 - 2*m1 m1 * m1 m1 / m1 m1 ^ 2 m1 %*% m1 t(m1)  solve m2\u0026lt;-cbind(c(14,32),c(32,77)) b\u0026lt;-c(1,1) sm2\u0026lt;-solve(m2) sm2 #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1.4259259 -0.5925926 #\u0026gt; [2,] -0.5925926 0.2592593 solve(m2,b) #\u0026gt; [1] 0.8333333 -0.3333333  m2 %*% sm2 #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1 0 #\u0026gt; [2,] 0 1  "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_3_a_type_matrix.html","title": "4.3-a type matrix",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " matrix çŸ©é™£çš„å»ºç«‹æœ‰å¤šç¨®æ–¹å¼,å…¶ä¸­ä¸€ç¨®æ˜¯åˆ©ç”¨å‘é‡è½‰å¡«çŸ©é™£ï¼Œå¡«å…¥çš„æ–¹å¼é è¨­æ˜¯ä»¥coumnç‚ºä¸»è¦æ–¹å‘ã€‚\nmatrix(c(1,2,3,4,5,6),2,3)  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 1 3 5 #\u0026gt; [2,] 2 4 6  å•é¡Œ: æ€æ¨£ç”¢ç”Ÿ\n1 2 3\n4 5 6\nçš„çŸ©é™£\ndiag(1, nrow = 5)  #\u0026gt; [,1] [,2] [,3] [,4] [,5] #\u0026gt; [1,] 1 0 0 0 0 #\u0026gt; [2,] 0 1 0 0 0 #\u0026gt; [3,] 0 0 1 0 0 #\u0026gt; [4,] 0 0 0 1 0 #\u0026gt; [5,] 0 0 0 0 1  matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow = 3, byrow = TRUE, dimnames = list(c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;)))  #\u0026gt; c1 c2 c3 #\u0026gt; r1 1 2 3 #\u0026gt; r2 4 5 6 #\u0026gt; r3 7 8 9  m1 \u0026lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol = 3) rownames(m1) \u0026lt;- c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;) colnames(m1) \u0026lt;- c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;) m1  #\u0026gt; c1 c2 c3 #\u0026gt; r1 1 4 7 #\u0026gt; r2 2 5 8 #\u0026gt; r3 3 6 9  B = matrix( c(2, 4, 3, 1, 5, 7), nrow=3, ncol=2) B  #\u0026gt; [,1] [,2] #\u0026gt; [1,] 2 1 #\u0026gt; [2,] 4 5 #\u0026gt; [3,] 3 7  Transpose t(B)  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 2 4 3 #\u0026gt; [2,] 1 5 7  åˆä½µçŸ©é™£ åˆ©ç”¨å‡½æ•¸cbind() å¯ä»¥åˆä½µåŒæ¨£æ©«è¡Œæ•¸ç›®çš„å…©å€‹çŸ©é™£,ä¾‹å¦‚é€™è£¡Cä¹Ÿæ˜¯3å€‹æ©«è¡Œ:\nC = matrix( c(7, 4, 2), nrow=3, ncol=1) C  #\u0026gt; [,1] #\u0026gt; [1,] 7 #\u0026gt; [2,] 4 #\u0026gt; [3,] 2  å’ŒBåˆä½µ\ncbind(B, C)  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 2 1 7 #\u0026gt; [2,] 4 5 4 #\u0026gt; [3,] 3 7 2  åŒæ¨£çš„,rbind() ä¹Ÿå¯ä»¥åˆä½µç›´è¡Œæ•¸ç›®ç›¸åŒçš„å…©å€‹çŸ©é™£:\nD = matrix( c(6, 2), nrow=1, ncol=2) D  #\u0026gt; [,1] [,2] #\u0026gt; [1,] 6 2  rbind(B, D)  #\u0026gt; [,1] [,2] #\u0026gt; [1,] 2 1 #\u0026gt; [2,] 4 5 #\u0026gt; [3,] 3 7 #\u0026gt; [4,] 6 2  å°‡çŸ©é™£è§£æ§‹å›å‘é‡:\nå¯ä»¥åˆ©ç”¨c() æœƒæŠŠçŸ©é™£æ‰€æœ‰çš„ç›´è¡Œéƒ½åˆä½µæˆä¸€å€‹ç›´è¡Œ.\nc(B)  #\u0026gt; [1] 2 4 3 1 5 7  unlist ?\nç·´ç¿’:åˆ©ç”¨ä¸Šé¢çš„m1 å›ç­”ä¸‹é¢çš„å•é¡Œ:\nm1[1, 2] m1[1:2, 2:3] m1[1,] m1[,2] m1[1:2,] m1[, 2:3] m1[-1,] m1[,-2] m1[c(\u0026quot;r1\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c3\u0026quot;)] m1[1] m1[9] m1[3:7] m1 \u0026gt; 3 m1[m1 \u0026gt; 3] m1 + m1 m1 - 2*m1 m1 * m1 m1 / m1 m1 ^ 2 m1 %*% m1 t(m1)  solve m2\u0026lt;-cbind(c(14,32),c(32,77)) b\u0026lt;-c(1,1) sm2\u0026lt;-solve(m2) sm2  #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1.4259259 -0.5925926 #\u0026gt; [2,] -0.5925926 0.2592593  solve(m2,b)  #\u0026gt; [1] 0.8333333 -0.3333333  m2 %*% sm2  #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1 0 #\u0026gt; [2,] 0 1  "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_4_type_string_function.html","title": "4.4 type string",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " å­—ä¸²å‡½æ•¸ Ræä¾›çš„å­—ä¸²å‡½æ•¸(ascii)  nchar: string length\n paste: concatenate strings\n substr: substring\n toupper: convert entire string to uppercase\n tolower: convert entire string to lowercase\n chartr: character map replacement (like \u0026quot;tr\u0026quot;)\n strtrimï¼štrunates string\n  nchar, substr, toupper, tolower will accept string vectors as arguments and return vector results.\nstrtrim accepts both a vector of strings and a vector of truncation positions.\n \\': ç­‰åŒæ–¼ \u0026quot;'\u0026quot; .\n \\\u0026quot;: ç­‰åŒæ–¼ '\u0026quot;'.\n \\n: newline.\n \\r: carriage return.\n \\t: tab character.\n   Note: cat() and print() è™•ç†é€ƒé€¸å­—å…ƒçš„æ–¹å¼ä¸ä¸€æ¨£å¦‚æœè¦åœ¨è¢å¹•ä¸Šè§£è®€ä¸Šé¢çš„å­—ä¸²,éœ€è¦çš„æ˜¯ cat().\n print(\u0026quot;a\\nb\u0026quot;) #\u0026gt; [1] \u0026quot;a\\nb\u0026quot; cat(\u0026quot;a\\nb\u0026quot;) #\u0026gt; a #\u0026gt; b  ç¯„ä¾‹ paste æœ€ç°¡å–®çš„ç¯„ä¾‹\npaste0(\u0026quot;x\u0026quot;,\u0026quot;y\u0026quot;,\u0026quot;z\u0026quot;) #\u0026gt; [1] \u0026quot;xyz\u0026quot;  ç¯„ä¾‹\ns1 = c('hello','Copy') s2 = c('john','pen') print(paste(s1,s2,sep=\u0026quot; \u0026quot;,collapse=\u0026quot;-\u0026quot;)) #\u0026gt; \u0026quot;hello john-Copy pen\u0026quot;   s1 s2     hello john   copy pen     åœ–\r\r\rç¯„ä¾‹è§£èªª:\n paste0(c(1,2),c(3,4),collapse='') æœƒæœ‰ç”šéº¼ç­”æ¡ˆ?\n æ€æ¨£å¾—åˆ°\u0026quot;1234\u0026quot;\n  ğŸ’¡ paste0()æ˜¯paste()çš„ç°¡åŒ–ç‰ˆã€‚åŸºæœ¬ä¸Šå°±æ˜¯å­—ä¸²ç›¸é€£,é€™æ™‚ç”¨çš„æ˜¯separator,ä¾‹å¦‚,\u0026quot;a\u0026quot;+sep+\u0026quot;b\u0026quot;,paste0ä¸­çš„sep=\u0026quot;\u0026quot;,å› æ­¤paste0()çš„çµæœç‚º\u0026quot;ab\u0026quot;,å¦‚æœé€£å®Œä»¥å¾Œæ˜¯å‘é‡,ä½†æ˜¯æƒ³è¦è®Šæˆä¸€å€‹å­—ä¸²,å°±å¿…é ˆç”¨åˆ°collapseã€‚\nrst=paste0(c(1,2)) rst # ğŸ·å’Œc(1,2)çš„å·®åˆ¥åªæ˜¯,é€™è£¡æ˜¯å­—ä¸²ã€‚âœ”rst=c(\u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;)=as.character(c(1,2))  #\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;2\u0026quot; length(rst) #\u0026gt; [1] 2 rst=paste0(c(1,2),c(3,4),collapse=\u0026quot;*\u0026quot;) rst #\u0026gt; [1] \u0026quot;13*24\u0026quot; length(rst) #\u0026gt; [1] 1 rst=paste(c(1,2),c(3,4),collapse=\u0026quot;*\u0026quot;) rst #\u0026gt; [1] \u0026quot;1 3*2 4\u0026quot; length(rst) #\u0026gt; [1] 1  ç·´ç¿’ collapse çš„ç¯„ä¾‹,å•ä¸‹é¢çš„ç¨‹å¼çš„åŸ·è¡Œçµæœ\npaste(c('A', 'B', 'C'), 1:7, sep=\u0026quot;-\u0026quot;, collapse=\u0026quot;/\u0026quot;)  æç¤º\r # [1] \u0026quot;A-1/B-2/C-3/A-4/B-5/C-6/A-7\u0026quot;  \ræ‡‰ç”¨ç¯„ä¾‹macro version 1\nx\u0026lt;- \u0026quot;${1} is good\u0026quot; gsub(\u0026quot;\\\\$\\\\{1\\\\}\u0026quot;,\u0026quot;dog\u0026quot;,x) #\u0026gt; [1] \u0026quot;dog is good\u0026quot;  ** version 2 to function**\nmstr\u0026lt;-function (src,mto) { return (gsub(\u0026quot;\\\\$\\\\{1\\\\}\u0026quot;,mto,src)) } x\u0026lt;- \u0026quot;${1} is good\u0026quot; mstr(x,\u0026quot;dog\u0026quot;) #\u0026gt; [1] \u0026quot;dog is good\u0026quot;  misc å‡½æ•¸ get() assign() ç”¨ä¾†åˆ©ç”¨å­—ä¸²è€Œä¸æ˜¯è®Šæ•¸ä¾†å­˜å–ç‰©ä»¶ã€‚è€Œ as.name() å¯ä»¥ç”¨ä¾†å°‡å­—ä¸²è½‰ç‚ºè®Šæ•¸ã€‚\n(å¯ä»¥é…åˆ substitute() å»ºç«‹ expression ç„¶å¾Œeval() ã€‚\nä¾‹å¦‚\nassign(\u0026quot;a\u0026quot;,get(\u0026quot;b\u0026quot;))\nç›¸ç•¶æ–¼\na\u0026lt;-b ã€‚\næ¯”è¼ƒå¸¸è¦‹çš„æ–¹æ³•æ˜¯åˆ©ç”¨list()ï¼Œä¾‹å¦‚\nobj\u0026lt;-list(a=1,b=2) obj[[\u0026quot;a\u0026quot;]]\u0026lt;-otherobj[[\u0026quot;b\u0026quot;]]  æ­¤æ™‚obj[[\u0026quot;a\u0026quot;]] æ˜¯å°å…ƒç´ açš„åƒè€ƒã€‚\næ‡‰ç”¨ strsplit åˆ©ç”¨é€—è™Ÿåˆ†è§£,ç„¶å¾Œæå–KEY,VALUEã€‚\nstr= \u0026quot;cmd=bstable,class=\\\u0026quot;d-block w-50\\\u0026quot;,style=\\\u0026quot;display:none\\\u0026quot;\u0026quot; strsplit(str,\u0026quot;,\u0026quot;) #ğŸ·å¦‚æœstr æ˜¯å­—ä¸²é™£åˆ—,é‚£éº¼Nå€‹å­—ä¸²å°±æœƒæœ‰Nå€‹åˆ†å‰²,é€™è£¡åªæœ‰ä¸€å€‹åˆ†å‰²,å› æ­¤ç”¢ç”Ÿ1å€‹ç¯€é»,é€™å€‹ç¯€é»æ˜¯3å…ƒç´ çš„å­—ä¸²é™£åˆ—ã€‚  #\u0026gt; [[1]] #\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot; \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot; \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot; unlist(strsplit(str,\u0026quot;,\u0026quot;)) # ğŸ·ç”¢ç”Ÿå‘é‡  #\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot; \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot; \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot; as.list(unlist(strsplit(str,\u0026quot;,\u0026quot;))) #\u0026gt; [[1]] #\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot; #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot; #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot;  "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_5_type_vector.html","title": "4.5 type vector",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " vector å‡½æ•¸ç¯„ä¾‹ cbind,rbind x\u0026lt;-runif(5) y\u0026lt;-runif(6) cbind(x,y)  #\u0026gt; Warning in cbind(x, y): number of rows of result is not a multiple of vector #\u0026gt; length (arg 1)  #\u0026gt; x y #\u0026gt; [1,] 0.43924873 0.1709444 #\u0026gt; [2,] 0.74164621 0.9249346 #\u0026gt; [3,] 0.72473924 0.2492189 #\u0026gt; [4,] 0.04998882 0.1531836 #\u0026gt; [5,] 0.40336666 0.1483507 #\u0026gt; [6,] 0.43924873 0.1862884  å‡½æ•¸diff Arguments\n* x: a numeric vector or matrix containing the values to be differenced.\n* lag: an integer indicating which lag to use.\n* differences: an integer indicating the order of the difference.\nä¾‹å¦‚\ndiff(x,lag=d,differences=n)\nx[(1+d):n] - x[1:(n-d)]\nç·´ç¿’: åˆªé™¤å‘é‡ä¸­çš„ä¸€å€‹å…ƒç´  x\u0026lt;-c(1,2,3)  å¦‚ä½•åˆªé™¤xä¸­çš„ç¬¬2å€‹å…ƒç´  ?\nhint:\næ•¸å­—å‘é‡å…ƒç´ çš„åˆªé™¤ ï¼Œä¸èƒ½åƒæ˜¯list[2]\u0026lt;-NULL ï¼Œè«‹å•ä½ çš„è§£æ³•ï¼Ÿ ä¸¦èªªæ˜\nç‰©ä»¶å…ƒç´ çš„åˆªé™¤ï¼Œç°¡å–®ä¸€é»çš„åƒæ˜¯listï¼Œ\nx\u0026lt;-list(1,2,3) x[2]\u0026lt;-NULL x  ä½†æ˜¯å‘é‡å…ƒç´ çš„åˆªé™¤æ²’æœ‰æ·å¾‘\nx\u0026lt;-c(1,2,3) x[2]\u0026lt;-NULL  #\u0026gt; Error in x[2] \u0026lt;- NULL: ç½®æ›çš„é•·åº¦ç‚ºé›¶  å› æ­¤ï¼Œéœ€è¦è®Šé€šçš„è¾¦æ³•\næ–¹æ³•1ï¼š\nx\u0026lt;-c(1,2,3) t\u0026lt;-as.list(x) # note: ä½¿ç”¨list(x)è€Œä¸æ˜¯as.list(x)æœƒæœ‰ä»€éº¼ä¸åŒ t[2]\u0026lt;-NULL x\u0026lt;-unlist(t) x  #\u0026gt; [1] 1 3  æ–¹æ³•2ï¼š\nx\u0026lt;-c(1,2,3) y\u0026lt;-x[-2] x\u0026lt;-y  ç·´ç¿’ï¼šæ”¹ç‚ºå‡½æ•¸\ndelElement\u0026lt;-function(x,idx){ if (is.vector(x)){ t\u0026lt;-as.list(x) t[idx]\u0026lt;-NULL t\u0026lt;-unlist(t) return(t) } else { stop('must be vector') } } x\u0026lt;-c(1,2,3) x\u0026lt;-delElement(x,2) x  #\u0026gt; [1] 1 3  Adding Attributes to Vectors The attributes that you can add to vectors includes names and comments. If we continue with our vector v1 we can see that the vector currently has no attributes:\nv1 \u0026lt;- 8:17 attributes(v1)  #\u0026gt; NULL  We can add names to vectors using two approaches. The first uses names() to assign names to each element of the vector. The second approach is to assign names when creating the vector.\n# assigning names to a pre-existing vector names(v1) \u0026lt;- letters[1:length(v1)] v1  #\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17  attributes(v1)  #\u0026gt; $names #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;  é‚£ï¼Œä»€éº¼æ˜¯names(v1)\nnames(v1)  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;  ä¹Ÿå°±æ˜¯èªªnames()å‡½æ•¸è¿”å›æ¯å€‹å…ƒç´ çš„åå­ï¼Œè€Œattributes()è¿”å›çš„æ˜¯æœ‰ä»€éº¼å±¬æ€§ï¼Œä¹Ÿæ˜¯å‡½æ•¸åç¨±å­—é¢ä¸Šçš„æ„æ€ã€‚ä½†æ˜¯å†ä»”ç´°çœ‹çœ‹ï¼Œå¯ä»¥ç™¼ç¾æŒ‡æ´¾attribute çµ¦\nattributes(v1)\u0026lt;-list(x='',y='',z='') v1  #\u0026gt; [1] 8 9 10 11 12 13 14 15 16 17 #\u0026gt; attr(,\u0026quot;x\u0026quot;) #\u0026gt; [1] \u0026quot;\u0026quot; #\u0026gt; attr(,\u0026quot;y\u0026quot;) #\u0026gt; [1] \u0026quot;\u0026quot; #\u0026gt; attr(,\u0026quot;z\u0026quot;) #\u0026gt; [1] \u0026quot;\u0026quot;  æ¸¬è©¦æ˜¯å¦å¯ä»¥è‡ªè¡ŒåŠ å…¥attributesï¼Œç„¶å¾Œè®“names()å¯ä»¥é‹ä½œï¼Œå¦‚ä¸‹ï¼š\nattributes(v1)\u0026lt;-list(names=letters[1:10]) v1  #\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17  attributes(v1)  #\u0026gt; $names #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;  names(v1)  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;  ä¸Šé¢é€™å€‹ç¨‹å¼æš—ç¤ºäº†ä»€éº¼ï¼Ÿ\n\u0026gt;å‡½æ•¸names()åªæ˜¯attributes()\u0026lt;-çš„ä¸€å€‹ç‰¹ä¾‹ï¼Œæˆ‘å€‘ç¸½æ˜¯å¯ä»¥è‡ªè¡ŒåŠ å…¥ä¸€å€‹å±¬æ€§ï¼Œåç¨±ç‚ºnamesè®“å‡½æ•¸names()å¯ä»¥æŠŠæ¯å€‹å…ƒç´ çš„åç¨±åˆ—å°å‡ºä¾†ã€‚\nå¾Œé¢é€™æ®µç¨‹å¼ç¢¼åªæ˜¯å°ç…§ä¸€ä¸‹ä¹‹å‰æ¯å€‹å…ƒç´ åŠ å…¥åç¨±çš„ä½œæ³•ï¼Œæœ¬èº«æ²’æ„ç¾©ï¼š\n# adding names when creating vectors v2 \u0026lt;- c(name1 = 1, name2 = 2, name3 = 3) v2  #\u0026gt; name1 name2 name3 #\u0026gt; 1 2 3  attributes(v2)  #\u0026gt; $names #\u0026gt; [1] \u0026quot;name1\u0026quot; \u0026quot;name2\u0026quot; \u0026quot;name3\u0026quot;  ä¹Ÿå¯ä»¥åŠ å…¥è¨»è§£ï¼š\ncomment(v1) \u0026lt;- \u0026quot;This is a comment on a vector\u0026quot; v1  #\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17  attributes(v1)  #\u0026gt; $names #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot; #\u0026gt; #\u0026gt; $comment #\u0026gt; [1] \u0026quot;This is a comment on a vector\u0026quot;  "},
{"uri": "https://airbone4.github.io/blogR/rlang/5_filesystem.html","title": "5 File System",
	"tags": [],
	"description": "è®€å–è³‡æ–™",
	"content": " File System æš«æ™‚å­ç›®éŒ„ å‡½æ•¸ tempfile() ä¸æ˜¯å»ºç«‹æ–°æª”æ¡ˆ,è€Œæ˜¯åœ¨ç›®å‰çš„r sessionä¸­éš¨æ©Ÿç”¢ç”Ÿå”¯ä¸€æª”æ¡ˆåç¨±ï¼Œæª”æ¡ˆä½ç½®é è¨­æ˜¯åœ¨æš«æ™‚å­ç›®éŒ„ä¸­ã€‚\nmydirname \u0026lt;- tempfile(pattern = \u0026quot;mydir\u0026quot;) mydirname  #\u0026gt; [1] \u0026quot;C:\\\\Users\\\\linchao\\\\AppData\\\\Local\\\\Temp\\\\RtmpkLukVq\\\\mydir1bb05d806927\u0026quot;  åœ¨è¦–çª—ç³»çµ±ä¸­:\nmydirname\nC:\\Users\\ä½¿ç”¨è€…åç¨±\\AppData\\Local\\Temp\\RtmpSg2qRA\\mydir326845a02140\nExploring file system function file.exists() å¯ä»¥ç”¨ä¾†çŸ¥é“æª”æ¡ˆæ˜¯å¦å­˜åœ¨,\nfunction dir() ç”¨ä¾†çŸ¥é“ç›®å‰æª”æ¡ˆä½ç½®çš„å…§å®¹,ä¾‹å¦‚dir(tempdir())\nCreating of a directory dir.create å»ºç«‹å­ç›®éŒ„\ndir.create(mydirname) file.exists(mydirname) # ä¸Šé¢æŒ‡ä»¤å»ºç«‹çš„å­ç›®éŒ„æ˜¯å¦å­˜åœ¨ dir(tempdir(), full.names = TRUE) #åˆ—å‡ºç›®å‰å­ç›®éŒ„å…§å®¹(å…¨å) file.mtime(mydirname) #å­ç›®éŒ„å»ºç«‹æ™‚é–“,make time  çµæœ\n[1] TRUE [1] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/file87e8755a1876\u0026quot; [2] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/mydir87e86b51384d\u0026quot; [3] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/rs-graphics-0f3f81af-32b7-49c4-a272-ad1a859f222f\u0026quot; [1] \u0026quot;2018-10-25 23:42:51 CST\u0026quot;  Rç³»çµ±æª”æ¡ˆåˆ—è¡¨ å¦‚æœè¦è§€å¯Ÿå®‰è£å¥—ä»¶çš„æª”æ¡ˆä½ç½®,å¯ä»¥ä½¿ç”¨æŒ‡ä»¤\nsystem.file(),é€™å€‹æŒ‡ä»¤å¯ä»¥åˆ—å‡ºå¥—å»ºçš„å…¨è·¯å¾‘ã€‚ä¾‹å¦‚,\nsystem.file(package = \u0026quot;stats\u0026quot;)  [1] \u0026quot;C:/PROGRA~1/R/R-3.5.1/library/stats\u0026quot;\nä¸Šé¢çš„çµæœæ˜¯ä¸€å€‹ç›®éŒ„,å› æ­¤å¯ä»¥åˆ©ç”¨dir()åˆ—å‡ºå¥—ä»¶statsä¸­,æ‰€æœ‰çš„æª”æ¡ˆ\ndir(system.file(package = \u0026quot;stats\u0026quot;))  çµæœ\n[1] \u0026quot;COPYRIGHTS.modreg\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;DESCRIPTION\u0026quot; [4] \u0026quot;help\u0026quot; \u0026quot;html\u0026quot; \u0026quot;INDEX\u0026quot; [7] \u0026quot;libs\u0026quot; \u0026quot;Meta\u0026quot; \u0026quot;NAMESPACE\u0026quot; [10] \u0026quot;R\u0026quot; \u0026quot;SOURCES.ts\u0026quot;  ä¸Šé¢å¯ä»¥çœ‹åˆ°å¥—ä»¶ä¸­åŒ…å«å­ç›®éŒ„demoï¼Œå¦‚æœé‚„è¦æŸ¥çœ‹demoä¸­çš„æª”æ¡ˆå…§å®¹:\ndir(system.file(\u0026quot;demo\u0026quot;, package = \u0026quot;stats\u0026quot;))  [1] \u0026quot;glm.vr.R\u0026quot; \u0026quot;lm.glm.R\u0026quot; \u0026quot;nlm.R\u0026quot; \u0026quot;smooth.R\u0026quot;\nä¸Šé¢åªæœ‰æª”æ¡ˆåç¨±,å¦‚æœè¦çœ‹å…¨è·¯å¾‘ï¼Œå¯ä»¥åˆ©ç”¨åƒæ•¸full.names:\ndir(system.file(\u0026quot;demo\u0026quot;, package = \u0026quot;stats\u0026quot;), full.names = TRUE)  çµæœ\n[1] \u0026quot;/usr/lib64/R/library/stats/demo/glm.vr.R\u0026quot; [2] \u0026quot;/usr/lib64/R/library/stats/demo/lm.glm.R\u0026quot; [3] \u0026quot;/usr/lib64/R/library/stats/demo/nlm.R\u0026quot; [4] \u0026quot;/usr/lib64/R/library/stats/demo/smooth.R\u0026quot;  åˆ†è§£åˆæˆè·¯å¾‘(æª”æ¡ˆ)åç¨± ç”šéº¼æ˜¯è·¯å¾‘åç¨±?ä¸æ˜¯ character string è€Œæ˜¯ system-specific character stringã€‚ä¾‹å¦‚,Rå‡½æ•¸file.path()çš„åŸ·è¡Œçµæœå°±æ˜¯system-specific file names.\nworkingdir \u0026lt;- \u0026quot;projects\u0026quot; projectdir \u0026lt;- \u0026quot;warandpeace\u0026quot; datadir \u0026lt;- \u0026quot;data\u0026quot; file.path(workingdir, projectdir, datadir)  çµæœ\n[1] \u0026quot;projects/warandpeace/data\u0026quot; ä¸Šé¢æ˜¯windows 10ç³»çµ±ä¸Šçš„çµæœ,æ¯”è¼ƒ Linux-based OS,å‰‡ç‚º: [1] \u0026quot;projects/warandpeace/data\u0026quot; æ³¨æ„æ–œç·šéƒ½ä¸€æ¨£ã€‚  Note about Windows åˆ©ç”¨å‡½æ•¸ file.path()åˆ—å‡ºçš„æª”æ¡ˆè·¯å¾‘åˆ†éš”æ˜¯æ–œç·š,è€Œä¸æ˜¯åæ–œç·š (ä¾‹å¦‚for example C:\\Program Files\\R\\R-3.5.1)?\n æ±‚åŠ©æ–‡ä»¶èªª:\nThe components are by default separated by â€˜/â€™ (not â€˜\\â€™) on Windows.\nNote: DOS å’Œ Windows ä¹Ÿæ”¯æ´æ–œç·š.\n ç›¸é—œçš„æŒ‡ä»¤  dir():åŒ…æ‹¬è³‡æ–™å¤¾ã€æª”æ¡ˆåç¨±\n list.files : åƒ…æª”æ¡ˆ\n list.dirs:åƒ…è³‡æ–™å¤¾\n dirname()\n basename()\n å·¥ä½œå€ç›¸é—œ\n getwd()\n setwd()\n   ç¯„ä¾‹\nlist.files(R.home()) #ğŸ”‘ libPaths() å¯ä»¥åˆ—å‡ºå®‰è£å¥—ä»¶çš„ä½ç½® ## Only files starting with a-l or r ## Note that a-l is locale-dependent, but using case-insensitive ## matching makes it unambiguous in English locales dir(\u0026quot;../..\u0026quot;, pattern = \u0026quot;^[a-lr]\u0026quot;, full.names = TRUE, ignore.case = TRUE) list.dirs(R.home(\u0026quot;doc\u0026quot;)) list.dirs(R.home(\u0026quot;doc\u0026quot;), full.names = FALSE)  æ‡‰ç”¨ç¯„ä¾‹ åˆ—å‡ºç›®å‰å·¥ä½œç›®éŒ„ä¸Šçš„æª”æ¡ˆ x \u0026lt;- dir() for (item in x) { print(item) # show(item) }  æˆ–è€…,åƒ…åˆ—å‡ºå‰å¹¾å€‹æª”æ¡ˆ\nx\u0026lt;-dir() head(x)  æª¢æŸ¥åœ¨ç›®å‰çš„å·¥ä½œç›®éŒ„ä¸‹,æ˜¯å¦å­˜åœ¨ä½¿ç”¨è€…å‚³éé€²ä¾†çš„ç›®éŒ„?\nä¾‹å¦‚\nfolderlist\u0026lt;-c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;) checkdir(folderlist)  ğŸ“ åˆ©ç”¨file.exists()\n\r\rè®€æª” åƒ…åƒ…æŸ¥çœ‹æª”æ¡ˆå…§å®¹  æ¸¬è©¦ä¸­æ–‡æª”æ¡ˆçš„æŒ‡ä»¤\n readLines(logf, encoding=\u0026quot;UTF-8\u0026quot;)\n writeLines(å­—ä¸², æª”æ¡ˆåç¨±, useBytes=T)\n   \rå¯ä»¥ç”¨ä¾†ç·´ç¿’çš„æ–‡å­—æª”\r\rJournals.csv\r\rsample1.csv\r\rsample2.csv\r\rsample3.csv\r\rsimple.csv\r\rsmoker.csv\r\rtrees91.csv\r\rwh.csv\r\rwh_chinese.csv\r\r æ³¨æ„æª”æ¡ˆå…§å®¹ç¬¬ä¸€è¡Œä¸æ˜¯è³‡æ–™ã€‚\nfile.show(\u0026quot;resources/wh.csv\u0026quot;)æœƒæ‰“é–‹excel\nä¹Ÿå¯ä»¥åˆ©ç”¨æ®¼å±¤æŒ‡ä»¤:\nsystem(\u0026quot;cat resources/wh.csv\u0026quot;)ï¼Œä½†æ˜¯å¦‚æœå…§å®¹æ˜¯ä¸­æ–‡,é¡¯ç¤ºçµæœæœƒè®Šæˆäº‚ç¢¼ã€‚\ncat(readChar(\u0026quot;resources/wh.csv\u0026quot;, 1e5))  #\u0026gt; Warning in readChar(\u0026quot;resources/wh.csv\u0026quot;, 1e+05): åœ¨é UTF-8 MBCS èªå€ä¸­åªèƒ½ä»¥ä½å…ƒ #\u0026gt; çµ„ç‚ºå–®ä½è®€å–  #\u0026gt; # this is a test file #\u0026gt; height,weight,sex #\u0026gt; 156,56, m #\u0026gt; 167,., f #\u0026gt; 189,70, m #\u0026gt; 180,, f  åˆ©ç”¨useBytes ä¸æœƒå‡ºç¾è­¦å‘Š\ncat(readChar(\u0026quot;resources/wh.csv\u0026quot;, useBytes=TRUE,1e5))  #\u0026gt; # this is a test file #\u0026gt; height,weight,sex #\u0026gt; 156,56, m #\u0026gt; 167,., f #\u0026gt; 189,70, m #\u0026gt; 180,, f  åƒæ•¸æœ‰useBytes,ä½†æ˜¯ä¸ç®¡TRUE/FALSEï¼Œéƒ½æ˜¯ä¸­æ–‡äº‚ç¢¼\nres \u0026lt;- readLines(system.file(\u0026quot;DESCRIPTION\u0026quot;, package=\u0026quot;MASS\u0026quot;)) length(res)  csv ç¯„ä¾‹ rst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, quote=F) # system(\u0026quot;cat myData.csv\u0026quot;) # é€™å€‹ä¸è¡Œ cat(readLines('MyData.csv'), sep = '\\n')  #\u0026gt; height,weight,sex #\u0026gt; 156,56, m #\u0026gt; 167,NA, f #\u0026gt; 189,70, m #\u0026gt; 180,NA, f  cat(readr::read_file(\u0026quot;MyData.csv\u0026quot;))  #\u0026gt; height,weight,sex #\u0026gt; 156,56, m #\u0026gt; 167,NA, f #\u0026gt; 189,70, m #\u0026gt; 180,NA, f  ä¸€èˆ¬çš„é–‹æª”/é—œæª”éç¨‹ å¤§é«”ä¸Šæ¯å€‹èªè¨€çš„é–‹æª”å’Œé—œæª”æ¡ˆçš„éç¨‹ï¼Œéƒ½æœƒåˆ©ç”¨åˆ°ä½œæ¥­ç³»çµ±ï¼Œå› æ­¤æœƒæœ‰é–‹æª”å‹•ä½œï¼Œå¾ä½œæ¥­ç³»çµ±å¾—åˆ°ä¸€å€‹æ•¸å­—ï¼Œé€™è£¡ç¨±ç‚ºæª”æ¡ˆæŒ‡æ¨™ï¼Œç„¶å¾Œåˆ©ç”¨é€™å€‹æŒ‡æ¨™ï¼Œè®€å…¥æ–‡å­—æˆ–å¯«å…¥æ–‡å­—ï¼Œç„¶å¾Œæœ‰ä¸€å€‹é—œé–‰æª”æ¡ˆçš„å‹•ä½œå‘Šè¨´ä½œæ¥­ç³»çµ±ï¼Œè™•ç†æª”æ¡ˆçµæŸã€‚\nåœ¨Rèªè¨€ä¸­ï¼Œé–‹æª”ä¸æ˜¯open(),è€Œæ˜¯fileï¼š\ncon = file(filepath, \u0026quot;r\u0026quot;) é–‹å§‹è®€å¯«æ“ä½œ close(con)  csv read.csv(\u0026quot;filename.csv\u0026quot;, #name of file header = TRUE, #are there column names in 1st row? sep = \u0026quot;,\u0026quot;, #what separates rows? as.is = !stringsAsFactors, #é—œæ‰å­—å…ƒè½‰factor colClasses = NA # to convert everything to character data set to \u0026quot;character\u0026quot; na.string = \u0026quot;NA\u0026quot; # could be \u0026quot;.\u0026quot; for SAS files skip = 0, #è¦è·³éçš„å‰å¹¾è¡Œæ•¸ç›®\u0026gt;0 strip.white = TRUE, #æ“ æ‰ç©ºç™½,ä¾‹å¦‚ \u0026quot; 0.1\u0026quot; = \u0026quot;0.1\u0026quot; fill = TRUE, #fill in rows that have unequal numbers of columns comment.char = \u0026quot;#\u0026quot;, #è¨»è§£ä¸è®€å…¥ stringsAsFactors = FALSE #æ¯”as.is å¸¸ç”¨,é—œæ‰å­—å…ƒè½‰factor )  read.csv()æœ€ç°¡å–®çš„ç”¨æ³•æ˜¯ç›´æ¥çµ¦æª”æ¡ˆåç¨±,ä¾‹å¦‚\nrst = read.csv('resources/wh.csv')  #\u0026gt; Error in read.table(file = file, header = header, sep = sep, quote = quote, : more columns than column names  ä½†æ˜¯wh.csv å‰é¢æœ‰å¹¾è¡Œæ˜¯è¨»è§£\nreadLines('resources/wh.csv',n=3)  #\u0026gt; [1] \u0026quot;# this is a test file\u0026quot; \u0026quot;height,weight,sex\u0026quot; \u0026quot;156,56, m\u0026quot;  å› æ­¤åŠ ä¸Šskip åƒæ•¸\nrst = read.csv('resources/wh.csv',skip=1) head(rst)  #\u0026gt; height weight sex #\u0026gt; 1 156 56 m #\u0026gt; 2 167 . f #\u0026gt; 3 189 70 m #\u0026gt; 4 180 f  ä¹Ÿå¯ä»¥åˆ©ç”¨åƒæ•¸comment.char\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;) head(rst)  #\u0026gt; height weight sex #\u0026gt; 1 156 56 m #\u0026gt; 2 167 . f #\u0026gt; 3 189 70 m #\u0026gt; 4 180 f  ä½†æ˜¯æ³¨æ„åˆ°weighté€™å€‹æ¬„ä½è¢«è½‰ç‚ºå­—ä¸²,å› ç‚ºæœ‰ä¸€å€‹ \u0026quot;.\u0026quot; ã€‚æœ‰äº›å¥—è£è»Ÿé«”çš„CSVè¼¸å‡ºå°‡NAè½‰ç‚º\u0026quot;.\u0026quot;,å› æ­¤\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') head(rst)  #\u0026gt; height weight sex #\u0026gt; 1 156 56 m #\u0026gt; 2 167 NA f #\u0026gt; 3 189 70 m #\u0026gt; 4 180 NA f  write csv  wh.csv\n wh_cgubese.csv\ndata.frame to CSV rst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;) readLines(\u0026quot;MyData.csv\u0026quot;,n=3) # note: readLines()ä¸æ˜¯readline()  #\u0026gt; [1] \u0026quot;\\\u0026quot;\\\u0026quot;,\\\u0026quot;height\\\u0026quot;,\\\u0026quot;weight\\\u0026quot;,\\\u0026quot;sex\\\u0026quot;\u0026quot; \u0026quot;\\\u0026quot;1\\\u0026quot;,156,56,\\\u0026quot; m\\\u0026quot;\u0026quot; #\u0026gt; [3] \u0026quot;\\\u0026quot;2\\\u0026quot;,167,NA,\\\u0026quot; f\\\u0026quot;\u0026quot;   å¦‚æœrow namesä¸è¦å¯«é€²csv,å¯ä»¥åˆ©ç”¨åƒæ•¸ row.names=FALSEã€‚\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE) readLines(\u0026quot;MyData.csv\u0026quot;,n=3)  #\u0026gt; [1] \u0026quot;\\\u0026quot;height\\\u0026quot;,\\\u0026quot;weight\\\u0026quot;,\\\u0026quot;sex\\\u0026quot;\u0026quot; \u0026quot;156,56,\\\u0026quot; m\\\u0026quot;\u0026quot; #\u0026gt; [3] \u0026quot;167,NA,\\\u0026quot; f\\\u0026quot;\u0026quot;  rst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE) readLines(\u0026quot;MyData.csv\u0026quot;,n=3)  è¼¸å‡ºæ˜¯:\n[1] \u0026quot;\\\u0026quot;height\\\u0026quot;,\\\u0026quot;weight\\\u0026quot;,\\\u0026quot;sex\\\u0026quot;\u0026quot;\n[2] \u0026quot;156,56,\\\u0026quot; m\\\u0026quot;\u0026quot;\n[3] \u0026quot;167,NA,\\\u0026quot; f\\\u0026quot;\u0026quot;\nå¯ä»¥çœ‹å‡ºä¾†æ¯ä¸€è¡Œéƒ½æœ‰é›™å¼•è™Ÿè¡¨ç¤ºå­—ä¸²ã€‚\nå°ç…§æ–‡å­—æª”(mData.csv)\n\u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot;\n156,56,\u0026quot; m\u0026quot;\n167,NA,\u0026quot; f\u0026quot;\n189,70,\u0026quot; m\u0026quot;\n180,NA,\u0026quot; f\u0026quot;\n\r\r ä¸Šé¢sidebarä¸­,é¡¯ç¤ºçš„çš„sexæ¬„ä½,å¯ä»¥çœ‹è¦‹\u0026quot; m\u0026quot; ä¹Ÿå°±æ˜¯æœ‰ç©ºç™½,å•åˆ©ç”¨read.csv è®€å…¥æ™‚,æœƒæ˜¯ç”šéº¼æƒ…æ³?\n  \r\rå¦‚æœè¦æŒ‡å®šNAçš„å€¼,å¯ä»¥åˆ©ç”¨æ¬„ä½=\u0026quot;\u0026quot;,å¦å‰‡é å®šæ˜¯NA\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, na=\u0026quot;\u0026quot;) # ğŸ·è¼¸å‡ºçš„æ–‡ä»¶ä¸­,é€™æ¬„æ˜¯ç©ºçš„  cat(readLines(\u0026quot;MyData.csv\u0026quot;), sep = '\\n')  \u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot; 156,56,\u0026quot; m\u0026quot; 167,,\u0026quot; f\u0026quot; 189,70,\u0026quot; m\u0026quot; 180,,\u0026quot; f\u0026quot;  å¦‚æœè¼¸å‡ºæ™‚,å­—ä¸²ä¸è¦é›™å¼•è™Ÿ,å‰‡å¯ä»¥ç”¨quote=FALSE\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') write.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, quote=F) # system(\u0026quot;cat myData.csv\u0026quot;) # é€™å€‹ä¸è¡Œ cat(readLines('MyData.csv'), sep = '\\n')  height,weight,sex 156,56, m 167,NA, f 189,70, m 180,NA, f  å¦‚æœè¦æ›´å¤šçš„è¼¸å‡ºæ§åˆ¶å¯ä»¥åƒè€ƒå¯ä»¥write.table().\nwrite.csv()å‡½æ•¸,å¯¦éš›ä¸Šæœƒå†å‘¼å«write.table()å‡½æ•¸ã€‚ä¾‹å¦‚,æ¬„ä½åç¨±ä¹Ÿä¸è¦è¼¸å‡ºçš„è©±,å¯ä»¥åˆ©ç”¨write.table()ï¼Œè¦è¨­å®šçš„åƒæ•¸å¦‚ä¸‹: sep=â€,â€ å’Œ col.names=FALSE,å‰è€…æ˜¯CSVçš„ä¸»è¦åˆ†éš”å­—å…ƒ,å¾Œè€…å‰‡æ˜¯ä¸è¦æ¬„ä½åç¨±ã€‚\nwrite.table(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, na=\u0026quot;\u0026quot;,col.names=FALSE, sep=\u0026quot;,\u0026quot;) cat(readLines('MyData.csv'), sep = '\\n')  156,56,\u0026quot; m\u0026quot; 167,,\u0026quot; f\u0026quot; 189,70,\u0026quot; m\u0026quot; 180,,\u0026quot; f\u0026quot;  Rèªè¨€çš„æª”æ¡ˆæ ¼å¼ å¦‚æœä¸è€ƒæ…®å­˜æª”æ ¼å¼ï¼Œé‚£éº¼å¯ä»¥åˆ©ç”¨\nsave(v1,v2,...file=\u0026quot;myfile.RData\u0026quot;) ... load(file=\u0026quot;myfie.RData\u0026quot;)  ğŸ“ è§£ç­”\nuserfolder\u0026lt;-?? allfolder\u0026lt;-list.dir() okfolder\u0026lt;-allfolder[dir.exists(userfolder)]  "},
{"uri": "https://airbone4.github.io/blogR/rlang/6_programming_1.html","title": "6. Programming 1",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " programming in R æ¢ä»¶æŒ‡ä»¤ if ä¸€èˆ¬ä¾†è¬›ï¼Œé€šç”¨å¯«æ³•å¦‚ä¸‹ï¼š\nif(åˆ¤æ–·å¼){ æˆåŠŸ }else{ å¤±æ•— }  ä¾‹å¦‚\nå¤šè¡Œå¯«æ³• if(4 \u0026gt; 3){ TRUE }else{ FALSE }  å¦å¤–ï¼Œå¦‚æœå€å¡Šå…§åªæœ‰ä¸€è¡Œ\nif(4 \u0026gt; 3) TRUE else FALSE\nifelseçš„å¯«æ³• ifelse('åˆ¤æ–·å¼','æˆåŠŸ','å¤±æ•—')\nä¾‹å¦‚ï¼Œ\nifelse(4 \u0026gt; 3, T, F)\nswitchçš„å¯«æ³• switch('åˆ¤æ–·å¼',\n'å‹•ä½œ1',\n'å‹•ä½œ2',\n...\n)\n** æŒ‡å®šç¬¬å¹¾è¡Œ **\nswitch(2, 1, 2, #å› ç‚ºåˆ¤æ–·å¼ç‚º2ï¼Œå› æ­¤ï¼ŒåŸ·è¡Œå‹•ä½œ2 3)   ä¹Ÿå¯ä»¥åˆ©ç”¨å­—ä¸²\nswitch(\u0026quot;a\u0026quot;, a = 1, b = 2, c = \u0026quot;why\u0026quot;)  #\u0026gt; [1] 1   é€™å€‹switch ä¸¦ä¸æ˜¯ä¸€å€‹èªæ³•ï¼Œè€Œæ˜¯ä¸€å€‹å‡½æ•¸ï¼ŒåŸç†å¤§æ¦‚æ˜¯ ç¬¬1å€‹åƒæ•¸ä»¥å¾Œçš„æ±è¥¿ï¼Œæœƒè¢«è®Šæˆæ˜¯ä¸€å€‹named listã€‚\nä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­\nalist \u0026lt;-list(a=1,b=2,c=\u0026quot;why\u0026quot;)  ç„¶å¾Œåˆ©ç”¨åˆ¤æ–·å¼ æŸ¥æ‰¾è¦è¿”å›å°æ‡‰çš„å€¼ã€‚\nè¿´åœˆæŒ‡ä»¤ R èªè¨€çš„è¿´åœˆï¼Œå¯ä»¥æ­é… breakå’Œnextï¼Œå‰è€…è·³å‡ºè¿´åœˆï¼Œå¾Œè€…ç¹¼çºŒä¸‹ä¸€å€‹è¿´åœˆã€‚\nfor-loop è¨ˆç®— 1+2+3+4. çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ\nrst \u0026lt;- 0 for(i in c(1:4)){ rst \u0026lt;- rst + i }  while-loop i \u0026lt;- 1 result \u0026lt;- 0 while(i \u0026lt; 5){ rst \u0026lt;- rst + i i \u0026lt;- i + 1 }  repeat-loop i \u0026lt;- 1 rst \u0026lt;- 0 repeat{ if(i \u0026gt; 4) break rst \u0026lt;- rst + i i \u0026lt;- i + 1 }  %in% operator ç¯„ä¾‹ detach_package() è¨è«–å…§å»ºå‡½æ•¸detach_package()\nä½¿ç”¨æ–¹æ³•ï¼š\ndetach_package(vegan) detach_package(\u0026quot;vegan\u0026quot;, TRUE)  æ³¨æ„ä¸€ä¸‹ç¬¬2å€‹ä½¿ç”¨æ–¹å¼ï¼Œç¬¬2å€‹åƒæ•¸`character.only'ï¼š\ndetach_package \u0026lt;- function(pkg, character.only = FALSE) { if(!character.only) #å¦‚æœæ²’æœ‰æŒ‡å®šåƒæ•¸æ˜¯å­—ä¸² { pkg \u0026lt;- deparse(substitute(pkg)) # è½‰å­—ä¸² } search_item \u0026lt;- paste(\u0026quot;package\u0026quot;, pkg, sep = \u0026quot;:\u0026quot;) while(search_item %in% search()) { detach(search_item, unload = TRUE, character.only = TRUE) } }  ç¯„ä¾‹2ï¼š.libPaths() .libPaths  #\u0026gt; function (new) #\u0026gt; { #\u0026gt; if (!missing(new)) { #\u0026gt; new \u0026lt;- Sys.glob(path.expand(new)) #\u0026gt; paths \u0026lt;- c(new, .Library.site, .Library) #\u0026gt; paths \u0026lt;- paths[dir.exists(paths)] #\u0026gt; .lib.loc \u0026lt;\u0026lt;- unique(normalizePath(paths, \u0026quot;/\u0026quot;)) #\u0026gt; } #\u0026gt; else .lib.loc #\u0026gt; } #\u0026gt; \u0026lt;bytecode: 0x00000000177cd6c0\u0026gt; #\u0026gt; \u0026lt;environment: 0x00000000177c8630\u0026gt;  Rèªè¨€çš„ meta è¨ˆç®—ã€‚  assign()\n èªæ³•è§£æï¼šsubstitute(), parse(), deparse()\n è¡¨é”å¼æ§‹é€ ï¼šquote()\n è¡¨é”å¼æ±‚å€¼ï¼ševal(), source()\n è¡¨é”å¼ï¼šexpression()\nparse(text='x\u0026lt;-1+2')  #\u0026gt; expression(x \u0026lt;- 1 + 2)   åœ¨Rä¸­è§£ææœ‰ ä¸‰ç¨®ä¸åŒçš„è®Šç¨®ï¼š\n The read-eval-print loop\n Parsing of text files\n Parsing of character strings\n  read-eval-print æ˜¯è®€å…¥æ–‡æœ¬ï¼Œç„¶å¾Œé€²è¡Œè§£æï¼Œç„¶å¾Œæ±‚å€¼ï¼Œæœ€å¾Œæ‰“å°ï¼Œé€™å€‹å°±æ˜¯æˆ‘å€‘æ—¥å¸¸çœ‹åˆ°çš„å‘½ä»¤è¡Œæ“ä½œã€‚\nè§£ææ–‡ä»¶æ˜¯parseå‡½æ•¸ä¾†å®Œæˆã€‚\nè§£æå­—ç¬¦ä¸²å°±æ˜¯parseä¸­ç”¨textåƒæ•¸ä¾†è¡¨ç¤ºã€‚\ndeparse ç›¸å°æ–¼parse,deparse æŠŠexpression è½‰ç‚ºå­—ä¸²ã€‚\ndeparse(expression(1+2))  #\u0026gt; [1] \u0026quot;expression(1 + 2)\u0026quot;  quote* quote() çš„åƒæ•¸ä¹Ÿæ˜¯expressionï¼Œè¿”å›é¡åˆ¥classï¼Œå¯ä»¥å†çµ¦eval()è¨ˆç®—ã€‚\nquote()çš„åƒæ•¸é›–ç„¶æ˜¯expressionä½†æ˜¯ä¸æœƒé€²è¡Œè¨ˆç®—ï¼Œè€Œæ˜¯tokenåˆ†è§£ã€‚\nquote(1+2)  #\u0026gt; 1 + 2  typeof(quote(1+2))  #\u0026gt; [1] \u0026quot;language\u0026quot;  class(quote(1+2))  #\u0026gt; [1] \u0026quot;call\u0026quot;  eval* parse() å’Œeval() text --\u0026gt;parse()--\u0026gt; expression---\u0026gt;eval()\nquote() å’Œeval() expression --\u0026gt;quote()--\u0026gt; call---\u0026gt;eval()\neval(quote(1+2))  #\u0026gt; [1] 3  ä¸€èˆ¬æ˜¯ç”¨parseå¾å­—ç¬¦ä¸²ï¼ˆæˆ–è€…æ˜¯ç¡¬ç›¤ä¸Šçš„æ–‡ä»¶ï¼‰è§£ææˆä¸€å€‹expressionå°è±¡ï¼Œæ˜¯è¡¨é”å¼åˆ—è¡¨ï¼Œä¸æ˜¯ä¸€å€‹è¡¨é”å¼ã€‚\neval(parse(text=\u0026quot;1+2\u0026quot;))  #\u0026gt; [1] 3  é¦–å…ˆä½¿ç”¨parse()å‡½æ•¸å°‡å­—ç¬¦ä¸²è½‰åŒ–ç‚ºè¡¨é”å¼ï¼ˆexpressionï¼‰ï¼Œè€Œå¾Œä½¿ç”¨eval()å‡½æ•¸å°è¡¨é”å¼æ±‚è§£ã€‚\n?eval # Evaluate an R expression in a specified environment. # Usage # eval(expr, envir = parent.frame(), # enclos = if(is.list(envir) || is.pairlist(envir)) # parent.frame() else baseenv()) # evalq(expr, envir, enclos) # eval.parent(expr, n = 1) # local(expr, envir = new.env())  substitue() å¦‚æœæ²’æœ‰ç¬¬äºŒå€‹åƒæ•¸ï¼Œæ˜¯å¦substitue()==quote()?\n(s.e \u0026lt;- substitute(expression(a + b), list(a = 1))) #\u0026gt; expression(1 + b)  #\u0026gt; expression(1 + b)  (s.s \u0026lt;- substitute( a + b, list(a = 1))) #\u0026gt; 1 + b  #\u0026gt; 1 + b  è¨è«– æ¸¬è©¦ç´€éŒ„ test1\u0026lt;-function (..., list = character() ) { names \u0026lt;- c(as.character(substitute(list(...))[-1L]), list) return (names) } test1(x,y,list=\u0026quot;data\u0026quot;)  #\u0026gt; [1] \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;data\u0026quot;  names \u0026lt;- c(as.character(substitute(list(...))[-1L]), list)\n* list(...) æŠŠå‚³é€²ä¾†çš„åƒæ•¸æ‰“åŒ…æˆlist\n* åœ¨åŸ·è¡Œlist(...)çš„æ™‚å€™ï¼Œå¦‚æœå‚³é€²çš„åƒæ•¸æ˜¯é‚„æ²’æœ‰åˆå€¼çš„è®Šæ•¸ï¼Œæœƒå‡ºéŒ¯ï¼Œå› æ­¤ç”¨substitute()æ‰“åŒ…ã€‚\n+ ç‚ºä»€éº¼ç”¨substitute()å°±ä¸æœƒå‡ºéŒ¯ï¼Œå› ç‚ºå®ƒä¸åŸ·è¡Œé€™å€‹expression(e.g. list(...))ã€‚\n-ç‚ºä»€éº¼å¯ä»¥ä¸åŸ·è¡Œï¼Ÿå› ç‚ºsubstitue()æœ‰æŠŠå®ƒè®ŠæˆåŒ¿åå‡½æ•¸(å’Œcallé€™å€‹é¡åˆ¥æœ‰é—œï¼Œè‡ªæ¨è«–ï¼‰ï¼Œé€™æ¨£ç•¶ç„¶ä¸æœƒæœ‰å•é¡Œã€‚\n-ç‚ºä»€éº¼æœ‰-1L?æ¥çºŒä¹‹å‰çš„æ¨è«–ï¼Œç¬¬ä¸€å€‹å…ƒç´ æ‡‰è©²æ˜¯åŒ¿åå‡½æ•¸çš„å…§å»ºåç¨±ã€‚\næ‰€ä»¥æ•´å€‹å‡½æ•¸ï¼Œå°±æ˜¯æŠŠä½¿ç”¨è€…æ‰€æœ‰çš„åƒæ•¸ï¼Œæ‰“æˆå­—ä¸²å‘é‡ã€‚å¦‚ç¯„ä¾‹çµæœã€‚\nç·´ç¿’  zeros(3,2),ones(2,3)\n  hint:\nsapply(a,function(x) matrix(x,2,2), simplify='array')  zeros\u0026lt;-function (nrow,ncol) { rst\u0026lt;-sapply(c(0),function(x) matrix(x,nrow,ncol),simplify='array') return(rst[,,1]) } x\u0026lt;-zeros(4,5) x  #\u0026gt; [,1] [,2] [,3] [,4] [,5] #\u0026gt; [1,] 0 0 0 0 0 #\u0026gt; [2,] 0 0 0 0 0 #\u0026gt; [3,] 0 0 0 0 0 #\u0026gt; [4,] 0 0 0 0 0  "},
{"uri": "https://airbone4.github.io/blogR/rlang/7_function_1.html","title": "7 Function basic",
	"tags": [],
	"description": "æ’°å¯«R å‡½æ•¸",
	"content": " æ™®é€šå‡½æ•¸ç¯„ä¾‹ fivenum function (x, na.rm = TRUE) { xna \u0026lt;- is.na(x) if (any(xna)) { if (na.rm) x \u0026lt;- x[!xna] else return(rep.int(NA, 5)) } x \u0026lt;- sort(x) n \u0026lt;- length(x) if (n == 0) rep.int(NA, 5) else { n4 \u0026lt;- floor((n + 3)/2)/2 d \u0026lt;- c(1, n4, (n + 1)/2, n + 1 - n4, n) 0.5 * (x[floor(d)] + x[ceiling(d)]) } }  è‡ªå·±å¯«ä¸€å€‹é¡ä¼¼which()çš„å‡½æ•¸ã€‚\r\r\r3å€‹é€—é» (dots) 3å€‹é€—é»å¯ä»¥åˆ©ç”¨?dotsæŸ¥è©¢ã€‚\nç¯„ä¾‹\nf \u0026lt;- function(x, ...) { dots \u0026lt;- list(...) #1 if(length(dots) == 0) return(NULL) cat(\u0026quot;The arguments in ... are\\n\u0026quot;) print(dots) f(...) #2 } f(1,2,3,\u0026quot;a\u0026quot;, list(\u0026quot;monkey\u0026quot;))  operator \u0026lt;\u0026lt;- example\npower \u0026lt;- function(exponent) { function(x) x ^ exponent } square \u0026lt;- power(2) square(2) # -\u0026gt; [1] 4 square(4) # -\u0026gt; [1] 16 cube \u0026lt;- power(3) cube(2) # -\u0026gt; [1] 8 cube(4) # -\u0026gt; [1] 64  closure ox\u0026lt;-function (arg=3) { x\u0026lt;-0 o1\u0026lt;-function(){ x\u0026lt;\u0026lt;-x+arg; } list(go=o1) } obj\u0026lt;-ox(4) obj$go()  example of closure make.accumulator\u0026lt;-function(){ a\u0026lt;-0 function(x) { a\u0026lt;\u0026lt;-a+x a } } f\u0026lt;-make.accumulator() f(1)  #\u0026gt; [1] 1  f(1)  #\u0026gt; [1] 2  f(1)  #\u0026gt; [1] 3  â“ åˆ©ç”¨ä¸Šè¿°è§€å¿µå»ºç«‹ä¸€å€‹è¨ˆæ•¸å™¨ã€‚\nğŸ’¡ ä¾‹å¦‚ç”¢ç”Ÿçš„æª”æ¡ˆå€‹æ•¸ä¸å®š,ä½†æ˜¯æƒ³è¦æ¯æ¬¡é–‹å§‹åŸ·è¡Œçš„æ™‚å€™éƒ½æœ‰ä¸€å€‹å›ºå®šç·¨è™Ÿã€‚\r\r\r\rğŸ‘hint\r```r\rnew_counter \u0026lt;- function() {\ri \u0026lt;- 0\rfunction() {\r# do something useful, then ...\ri \u0026lt;\u0026lt;- i \u0026#43; 1\ri\r}\r}\r``` session è‡ªå·±çš„å‡½æ•¸å­˜æˆæª”æ¡ˆ(ä¾‹å¦‚åç¨±ç‚ºmyfun.R)ä»¥å¾Œ,å¦‚ä½•å‘¼å«?\nåˆ©ç”¨source(\u0026quot;myfun.R\u0026quot;) å¯ä»¥è¼‰å…¥è¨˜æ†¶é«”ä¸­,æ­¤æ™‚åœ¨æ•´é«”å·¥ä½œç’°å¢ƒä¸­å¯ä»¥çœ‹åˆ°å‡½æ•¸å®šç¾©ã€‚\né›¢é–‹å°ˆæ¡ˆçš„æ™‚å€™,å¦‚æœå„²å­˜å·¥ä½œç’°å¢ƒ,å‰‡ä¸‹æ¬¡å¯ä»¥ä¸ç”¨source(),ç›´æ¥å¯ä»¥ä½¿ç”¨ã€‚ä½†æ˜¯åœ¨RMDæª”æ¡ˆä¸­,å› ç‚ºæ¯æ¬¡éƒ½æ˜¯æ–°sessionå› æ­¤,å¿…é ˆè¦å…ˆæ‰¾åœ°æ–¹source(ä¾‹å¦‚åœ¨ç¬¬ä¸€å€‹chunk)ã€‚\r\r\rOOP advance R\nBase objects vs OO objects è¾¨åˆ¥è®Šæ•¸æ˜¯åŸºç¤å‹åˆ¥æˆ–æ˜¯ç‰©ä»¶å‹åˆ¥ï¼Œå¯ä»¥ç°¡å–®åˆ©ç”¨å‡½æ•¸ï¼š is.object():\nåŸºç¤ç‰©ä»¶base object:\nis.object(1:10)  #\u0026gt; [1] FALSE  [1] FALSE\nç‰©ä»¶å°å‘ç‰©ä»¶ OO object\nis.object(mtcars)  #\u0026gt; [1] TRUE  [1] TRUE\nä¸»è¦çš„å€åˆ¥åœ¨æ–¼åŸºæœ¬ç‰©ä»¶æ²’æœ‰class é€™å€‹attribute\nattr(1:10, \u0026quot;class\u0026quot;) # NULL  #\u0026gt; NULL  attr(mtcars, \u0026quot;class\u0026quot;) # [1] \u0026quot;data.frame\u0026quot;  #\u0026gt; [1] \u0026quot;data.frame\u0026quot;  class()é€™å€‹å‡½æ•¸,ä¸è¦‹å¾—ç¸½æ˜¯æœƒå’Œattr()çš„çµæœä¸€è‡´,å› ç‚ºï¼Œå°åŸºæœ¬ç‰©ä»¶è€Œè¨€,å‚³å›çš„æ˜¯å¾Œé¢è¨è«–,è€Œä¸æ˜¯ NULLã€‚\nè®Šæ•¸å±¬æ€§æŸ¥è©¢å‡½æ•¸ names()\ndimnames()\nlength()\ndim(): å„ç¶­åº¦é•·åº¦\nclass() : è®Šæ•¸é¡åˆ¥\ntable()ï¼šå„é¡è³‡æ–™è¨ˆæ•¸\nstr()ï¼šè®Šæ•¸çš„è³‡æ–™çµæ§‹(å…¶å¯¦æ˜¯ä¸€å€‹list)\né€énames()å‡½æ•¸ï¼Œå¯å–å¾—å„ç¨®listå…ƒç´ çš„åç¨±,ä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡æ˜¯é¡¯ç¤ºæ¬„ä½åç¨±\nislandsæ˜¯å…§å»ºè³‡æ–™\nstr(islands)  #\u0026gt; Named num [1:48] 11506 5500 16988 2968 16 ... #\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr [1:48] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; ...  head(names(islands))  #\u0026gt; [1] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; \u0026quot;Axel Heiberg\u0026quot; #\u0026gt; [6] \u0026quot;Baffin\u0026quot;  æ–¹å½¢è³‡æ–™ï¼ˆä¾‹å¦‚ï¼ŒçŸ©é™£ï¼Œtable, data.frame)ï¼Œå¯ä»¥é€édimnames()å‡½æ•¸å¯é¡¯ç¤ºdata.frame æ©«è¡Œå’Œç›´è¡Œçš„åç¨± å…ˆæ©«è¡Œï¼Œç„¶å¾Œç›´è¡Œã€‚\ndimnames(USArrests)  #\u0026gt; [[1]] #\u0026gt; [1] \u0026quot;Alabama\u0026quot; \u0026quot;Alaska\u0026quot; \u0026quot;Arizona\u0026quot; \u0026quot;Arkansas\u0026quot; #\u0026gt; [5] \u0026quot;California\u0026quot; \u0026quot;Colorado\u0026quot; \u0026quot;Connecticut\u0026quot; \u0026quot;Delaware\u0026quot; #\u0026gt; [9] \u0026quot;Florida\u0026quot; \u0026quot;Georgia\u0026quot; \u0026quot;Hawaii\u0026quot; \u0026quot;Idaho\u0026quot; #\u0026gt; [13] \u0026quot;Illinois\u0026quot; \u0026quot;Indiana\u0026quot; \u0026quot;Iowa\u0026quot; \u0026quot;Kansas\u0026quot; #\u0026gt; [17] \u0026quot;Kentucky\u0026quot; \u0026quot;Louisiana\u0026quot; \u0026quot;Maine\u0026quot; \u0026quot;Maryland\u0026quot; #\u0026gt; [21] \u0026quot;Massachusetts\u0026quot; \u0026quot;Michigan\u0026quot; \u0026quot;Minnesota\u0026quot; \u0026quot;Mississippi\u0026quot; #\u0026gt; [25] \u0026quot;Missouri\u0026quot; \u0026quot;Montana\u0026quot; \u0026quot;Nebraska\u0026quot; \u0026quot;Nevada\u0026quot; #\u0026gt; [29] \u0026quot;New Hampshire\u0026quot; \u0026quot;New Jersey\u0026quot; \u0026quot;New Mexico\u0026quot; \u0026quot;New York\u0026quot; #\u0026gt; [33] \u0026quot;North Carolina\u0026quot; \u0026quot;North Dakota\u0026quot; \u0026quot;Ohio\u0026quot; \u0026quot;Oklahoma\u0026quot; #\u0026gt; [37] \u0026quot;Oregon\u0026quot; \u0026quot;Pennsylvania\u0026quot; \u0026quot;Rhode Island\u0026quot; \u0026quot;South Carolina\u0026quot; #\u0026gt; [41] \u0026quot;South Dakota\u0026quot; \u0026quot;Tennessee\u0026quot; \u0026quot;Texas\u0026quot; \u0026quot;Utah\u0026quot; #\u0026gt; [45] \u0026quot;Vermont\u0026quot; \u0026quot;Virginia\u0026quot; \u0026quot;Washington\u0026quot; \u0026quot;West Virginia\u0026quot; #\u0026gt; [49] \u0026quot;Wisconsin\u0026quot; \u0026quot;Wyoming\u0026quot; #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] \u0026quot;Murder\u0026quot; \u0026quot;Assault\u0026quot; \u0026quot;UrbanPop\u0026quot; \u0026quot;Rape\u0026quot;  æ–¹å½¢è³‡æ–™ï¼Œå¯ä»¥é€élength()å‡½æ•¸å¯é¡¯ç¤ºè³‡æ–™é•·åº¦ï¼Œä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡é¡¯ç¤ºæ¬„ä½æ•¸ã€‚\nlength(islands)  #\u0026gt; [1] 48  é€édim() é¡¯ç¤ºæ–¹å½¢è³‡æ–™çš„ã€Œè³‡æ–™ç­†æ•¸ã€å’Œã€Œæ¬„ä½æ•¸ç›®ã€ï¼Œå…ˆã€Œæ©«è¡Œã€ï¼Œå¾Œã€Œç›´è¡Œã€\ndim(USArrests)  #\u0026gt; [1] 50 4  ä½¿ç”¨class()å‡½æ•¸å¯çŸ¥é“è®Šæ•¸é¡åˆ¥\nclass(pi)  #\u0026gt; [1] \u0026quot;numeric\u0026quot;  class(Sys.Date())  #\u0026gt; [1] \u0026quot;Date\u0026quot;  ä½¿ç”¨table()å‡½æ•¸å¯çŸ¥é“å‘é‡ä¸­æ¯å€‹å€¼å‡ºç¾å¹¾æ¬¡\ntable(iris$Species) ##çµ±è¨ˆçµæœ  #\u0026gt; #\u0026gt; setosa versicolor virginica #\u0026gt; 50 50 50  operator %\u0026gt;% %\u0026gt;% ä¸æ˜¯RåŸºç¤å¥—ä»¶\nè€Œæ˜¯å®šç¾©å†å¥—ä»¶ magrittr (CRAN) ä¸”å¸¸è·Ÿ dplyr (CRAN)æ­é…ã€‚\næ„æ€æ˜¯æŠŠå·¦é‚Š(LHS)ç•¶æˆå³é‚Š(RHS)çš„åƒæ•¸ã€‚\nä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­: è³‡æ–™æ¡†iris ç”¨ä¾†ç•¶ head()çš„åƒæ•¸:\nä¹Ÿå°±æ˜¯èªª iris %\u0026gt;% head() ç›¸ç•¶æ–¼ head(iris).\nlibrary(magrittr)\niris %\u0026gt;% head()\nSepal.Length Sepal.Width Petal.Length Petal.Width Species\n1 5.1 3.5 1.4 0.2 setosa\n2 4.9 3.0 1.4 0.2 setosa\n3 4.7 3.2 1.3 0.2 setosa\n4 4.6 3.1 1.5 0.2 setosa\n5 5.0 3.6 1.4 0.2 setosa\n6 5.4 3.9 1.7 0.4 setosa\nç‚ºç”šéº¼éœ€è¦é€™æ¨£ç”¨,ä¸‹é¢æ˜¯ä¸€å€‹ä¾‹å­\niris %\u0026gt;% head() %\u0026gt;% summary()\né¡ä¼¼çš„è§€å¿µ, iris %\u0026gt;% head() %\u0026gt;% summary() ç­‰åŒæ–¼summary(head(iris)).\nä¹Ÿå°±æ˜¯èªª,é¿å…äº†ä½¿ç”¨å·¢ç‹€å‘¼å«ã€‚\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/7_1_apply_family.html","title": "7.1 function - apply family",
	"tags": [],
	"description": "list çš„æ‡‰ç”¨",
	"content": " apply family  å…¶ä»–åƒè€ƒ\n  apply å¯ä»¥è™•ç†çš„å°è±¡åŒ…æ‹¬ çŸ©é™£ã€è³‡æ–™é›†ã€é™£åˆ—(äºŒç¶­ã€å¤šç¶­)ï¼Œå¯ä»¥æŒ‡å®šç›´è¡Œã€æ©«è¡Œã€‚\nå‡½æ•¸å®šç¾©ï¼š\napply(X, MARGIN, FUN, ...)  åƒæ•¸åˆ—è¡¨ï¼š\n X : çŸ©é™£matrixã€è³‡æ–™é›†dataframe ã€é™£åˆ— array\n MARGIN : 1è¡¨ç¤ºæ©«è¡Œï¼Œ2è¡¨ç¤ºç›´è¡Œ\n FUN : the function to be applied\n ... : optional arguments to FUN\n  åœ¨matlab ä¸­,sum(çŸ©é™£,åƒæ•¸2) åƒæ•¸2çš„å¯èƒ½å€¼ç‚º1æˆ–2ï¼Œåˆ†åˆ¥æŒ‡å®šæ¬„ä½åŠ ç¸½æˆ–æ˜¯æ©«è¡ŒåŠ ç¸½,ä½†æ˜¯åœ¨Rä¸­sum(çŸ©é™£),å»æ˜¯æ•´å€‹çŸ©é™£å…ƒç´ çš„åŠ ç¸½ã€‚\nç¯„ä¾‹1: æ©«è¡ŒåŠ ç¸½\nx\u0026lt;-matrix(1,ncol=4,nrow=3);x #\u0026gt; [,1] [,2] [,3] [,4] #\u0026gt; [1,] 1 1 1 1 #\u0026gt; [2,] 1 1 1 1 #\u0026gt; [3,] 1 1 1 1 apply(x,1,sum) #\u0026gt; [1] 4 4 4  ç¯„ä¾‹ï¼š\næœ‰ä¸€å€‹list,è£¡é¢æœ‰2å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯x1,x2,æƒ³è¦åˆ†åˆ¥ç®—å‡ºæ¯å€‹æ¬„ä½çš„æœ€å°å’Œæœ€å¤§\nx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ f1\u0026lt;- function(col) { c(min(col),max(col)) } apply(x,2,f1) #\u0026gt; x1 x2 #\u0026gt; [1,] 3 1 #\u0026gt; [2,] 3 6  ç·´ç¿’ï¼šå¦‚æœç”¨for loop?\nç·´ç¿’ï¼šå“ªç¨®æ–¹å¼æ¯”è¼ƒå¿«ï¼Ÿhint:åˆ©ç”¨ system.time(a function)\nlapplyå‡½æ•¸ å¤§ç¶±ï¼šlapply(),sapply(),vapply() éƒ½åƒæ•¸éƒ½åƒlist æˆ–è€…vectorã€‚\nå‡½æ•¸å®šç¾©ï¼š\nlapply(X, FUN, ...)  åƒæ•¸åˆ—è¡¨ï¼š\n X: listã€vectorã€data.frame\n FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸\n   è¼¸å…¥ è¼¸å‡º     vector list   list list   data.frame list     å‡½æ•¸æ¯”è¼ƒ\n lapply(), sapply()å·®åˆ¥æ˜¯ å‰è€…è¿”å›list,å¾Œè€…è¿”å›matrix;\n sapply(), vapply() å·®åˆ¥æ˜¯ï¼Œå¾Œè€…å¯ä»¥åŠ å…¥row namesã€‚\n  ç¯„ä¾‹:è¨ˆç®—listä¸­çš„æ¯å€‹KEYå°æ‡‰ çš„5å€‹Tukeyåˆ†ä½æ•¸ (minimum, lower-hinge, median, upper-hinge, maximum) ã€‚åˆ©ç”¨fivenum()\nx \u0026lt;- list(a = 1:6, b = rnorm(2,6,8));x #\u0026gt; $a #\u0026gt; [1] 1 2 3 4 5 6 #\u0026gt; #\u0026gt; $b #\u0026gt; [1] -9.147136 -2.963388 lapply(x,fivenum) #\u0026gt; $a #\u0026gt; [1] 1.0 2.0 3.5 5.0 6.0 #\u0026gt; #\u0026gt; $b #\u0026gt; [1] -9.147136 -9.147136 -6.055262 -2.963388 -2.963388  lapply çš„åƒæ•¸å¦‚æœæ˜¯ listã€data.frameï¼Œè¿”å›å’Œåƒæ•¸é•·åº¦åŒæ¨£çš„listçµæ§‹ä½œç‚ºçµæœ(æ¬„ä½æ•¸)ã€‚\nä¾‹å¦‚ï¼Œå‚³å…¥çš„åƒæ•¸æ˜¯data.frame(),å¦‚ä¸‹ï¼Œå°è³‡æ–™é›†çš„æ¯å€‹æ¬„ä½æ±‚å’Œã€‚\nlapply(data.frame(x), sum) #\u0026gt; $a #\u0026gt; [1] 21 #\u0026gt; #\u0026gt; $b #\u0026gt; [1] -36.33157  applyä¸åŒçš„åœ°æ–¹æ˜¯,å¦‚æœåƒæ•¸æ˜¯çŸ©é™£æ²’è¾¦æ³•æŒ‡å®šæ©«è¡Œæˆ–æ˜¯ç›´è¡Œçš„å€åˆ¥,åªèƒ½æ˜¯é€å€‹å…ƒç´ é‹ç®—ã€‚å°±æ˜¯å‰‡æœƒå°æ¯å€‹å…ƒç´ æ±‚å‡½æ•¸å€¼ã€‚\nx \u0026lt;- matrix(rnorm(4,5,10),nrow=2);x #\u0026gt; [,1] [,2] #\u0026gt; [1,] 6.643810 10.360868 #\u0026gt; [2,] 3.969155 4.604168 lapply(x, sum) #\u0026gt; [[1]] #\u0026gt; [1] 6.64381 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 3.969155 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 10.36087 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] 4.604168  sapplyå‡½æ•¸ sapplyå‡½æ•¸åŒ…è£¹äº†ä¸€ä¸Šé¢æåˆ°çš„lapply()ï¼Œè¿”å›å€¼ç‚ºå‘é‡ï¼Œè€Œä¸æ˜¯listå°è±¡ã€‚sapplyå¢åŠ äº†2å€‹åƒæ•¸simplifyå’ŒUSE.NAMESï¼Œ\nå‡½æ•¸å®šç¾©ï¼š\nsapply(X, FUN, ..., simplify=TRUE, USE.NAMES = TRUE)  åƒæ•¸åˆ—è¡¨ï¼š\n X: listã€matrixã€data.frame\n FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸\n simplify: é è¨­ç‚ºT,è¿”ç‚ºå€¼ç‚ºå‘é‡ï¼›å¦‚æœæ˜¯Fæˆlistã€‚? è¨­å®šç‚º\u0026quot;array\u0026quot;æ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„\n USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®\n   è¼¸å…¥ è¼¸å‡º     vector vector,matrix,array,list   list vector,matrix,array,list   data.frame vector,matrix,array,list     simplify=FALSEå’ŒUSE.NAMES=FALSEï¼Œå‰‡ sapplyå‡½æ•¸ ï¼lapplyå‡½æ•¸ã€‚\nå¦‚æœæˆ‘å€‘åˆ©ç”¨å‡½æ•¸unlist é…åˆ lapply çš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°å‘é‡ï¼Œä¾‹å¦‚ï¼š\nunlist(lapply(1:3, function(x) x^2))\n\r\rx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ x #\u0026gt; x1 x2 #\u0026gt; [1,] 3 1 #\u0026gt; [2,] 3 2 #\u0026gt; [3,] 3 3 #\u0026gt; [4,] 3 4 #\u0026gt; [5,] 3 5 #\u0026gt; [6,] 3 6 sapply(x, sum) #çµæœé¡ä¼¼lapply() ğŸ·å°‡é™£åˆ—å…ƒç´ å¸¶å…¥å‡½æ•¸  #\u0026gt; [1] 3 3 3 3 3 3 1 2 3 4 5 6 # data.frame sapply(data.frame(x), sum) #\u0026gt; x1 x2 #\u0026gt; 18 21 # ç¢ºèªè¿”å›é¡åˆ¥ lapply(x, sum) #\u0026gt; [[1]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[5]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[6]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[7]] #\u0026gt; [1] 1 #\u0026gt; #\u0026gt; [[8]] #\u0026gt; [1] 2 #\u0026gt; #\u0026gt; [[9]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[10]] #\u0026gt; [1] 4 #\u0026gt; #\u0026gt; [[11]] #\u0026gt; [1] 5 #\u0026gt; #\u0026gt; [[12]] #\u0026gt; [1] 6 class(lapply(x, sum)) #\u0026gt; [1] \u0026quot;list\u0026quot; sapply(x, sum) #\u0026gt; [1] 3 3 3 3 3 3 1 2 3 4 5 6 class(sapply(x, sum)) #\u0026gt; [1] \u0026quot;numeric\u0026quot; sapply(x, sum, simplify=FALSE, USE.NAMES=FALSE) #\u0026gt; [[1]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[5]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[6]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[7]] #\u0026gt; [1] 1 #\u0026gt; #\u0026gt; [[8]] #\u0026gt; [1] 2 #\u0026gt; #\u0026gt; [[9]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[10]] #\u0026gt; [1] 4 #\u0026gt; #\u0026gt; [[11]] #\u0026gt; [1] 5 #\u0026gt; #\u0026gt; [[12]] #\u0026gt; [1] 6 class(sapply(x, sum, simplify=FALSE, USE.NAMES=FALSE)) #\u0026gt; [1] \u0026quot;list\u0026quot;  ç·´ç¿’ï¼š\nx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)) sapply(x, quantile) #\u0026gt; [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] #\u0026gt; 0% 3 3 3 3 3 3 1 2 3 4 5 6 #\u0026gt; 25% 3 3 3 3 3 3 1 2 3 4 5 6 #\u0026gt; 50% 3 3 3 3 3 3 1 2 3 4 5 6 #\u0026gt; 75% 3 3 3 3 3 3 1 2 3 4 5 6 #\u0026gt; 100% 3 3 3 3 3 3 1 2 3 4 5 6 sapply(2:4, seq) #\u0026gt; [[1]] #\u0026gt; [1] 1 2 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 1 2 3 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 1 2 3 4  è§£é‡‹ä¸Šé¢å‡ºéŒ¯çš„åŸå› ã€‚æç¤º\r hint:\nsapplyçš„èª¿ç”¨å‡½æ•¸lapply()ï¼Œè€Œå·²ç¶“çŸ¥é“lapply()çš„åƒæ•¸æ˜¯çŸ©é™£çš„æ™‚å€™ï¼Œæ¯å€‹å…ƒç´ éƒ½æœƒè¢«å‚³åˆ°å‡½æ•¸ã€‚å› æ­¤æ¬„ä½æœ‰12å€‹ï¼›\nåˆï¼Œæ¯å€‹quantile()å‚³å›5å€‹å…ƒç´ ï¼Œå› æ­¤ï¼Œæ©«è¡Œæœ‰5å€‹ã€‚\næ­£ç¢ºçš„ä½œæ³•æ˜¯ï¼š\nx \u0026lt;- list(x1 = 3, x2 = c(1:6)) sapply(x, quantile) #\u0026gt; x1 x2 #\u0026gt; 0% 3 1.00 #\u0026gt; 25% 3 2.25 #\u0026gt; 50% 3 3.50 #\u0026gt; 75% 3 4.75 #\u0026gt; 100% 3 6.00  \rç¯„ä¾‹ï¼šUSE.NAMES=TRUE\nalist\u0026lt;-list(a=c(1,1,1),b=c(2,2,2),c=c(3,3,3)) f2\u0026lt;-function(x) { mean(alist[[x]]) } sapply(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;),f2,USE.NAMES = T) #\u0026gt; a b c #\u0026gt; 1 2 3  å°æ–¼simplifyç‚ºarrayæ™‚ï¼Œæˆ‘å€‘å¯ä»¥åƒè€ƒä¸‹é¢çš„ä¾‹å­ï¼Œæ§‹å»ºä¸€å€‹ä¸‰ç¶­æ•¸çµ„ï¼Œå…¶ä¸­äºŒå€‹ç¶­åº¦ç‚ºæ–¹é™£ã€‚\na\u0026lt;-1:2 # æŒ‰æ•¸çµ„åˆ†çµ„ sapply(a,function(x) matrix(x,2,2), simplify='array') #\u0026gt; , , 1 #\u0026gt; #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1 1 #\u0026gt; [2,] 1 1 #\u0026gt; #\u0026gt; , , 2 #\u0026gt; #\u0026gt; [,1] [,2] #\u0026gt; [1,] 2 2 #\u0026gt; [2,] 2 2 # é»˜èªæƒ…æ³ï¼Œå‰‡è‡ªå‹•åˆä½µåˆ†çµ„ sapply(a,function(x) matrix(x,2,2)) #\u0026gt; [,1] [,2] #\u0026gt; [1,] 1 2 #\u0026gt; [2,] 1 2 #\u0026gt; [3,] 1 2 #\u0026gt; [4,] 1 2  æ¯”è¼ƒ    Function Arguments Objective Input Output     apply apply(x, MARGIN, FUN) Apply a function to the rows or columns or both Data frame or matrix vector, list, array   lapply lapply(X, FUN) Apply a function to all the elements of the input List, vector or data frame list   sapply sappy(X FUN) Apply a function to all the elements of the input List, vector or data frame vector or matrix    m\u0026lt;-matrix(1:4,4,3);m #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 1 1 1 #\u0026gt; [2,] 2 2 2 #\u0026gt; [3,] 3 3 3 #\u0026gt; [4,] 4 4 4 sapply(1:3, function(x) mean(m[,x])) #\u0026gt; [1] 2.5 2.5 2.5  m\u0026lt;-matrix(1:4,4,3); lapply(1:3, function(x) mean(m[,x])) #\u0026gt; [[1]] #\u0026gt; [1] 2.5 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 2.5 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 2.5  vapplyå‡½æ•¸ vapplyé¡ä¼¼æ–¼sapplyï¼Œæä¾›äº†FUN.VALUEåƒæ•¸ï¼Œç”¨ä¾†æ§åˆ¶è¿”å›å€¼çš„è¡Œåã€‚\nnote: sapply() é…ä¸Šrownames\u0026lt;- å¯ä»¥é”åˆ°ä¸€æ¨£çš„æ•ˆæœã€‚\nå‡½æ•¸å®šç¾©ï¼š\nvapply(X, FUN, FUN.VALUE, ..., USE.NAMES = TRUE)  åƒæ•¸åˆ—è¡¨ï¼š\n X:æ•¸çµ„ã€çŸ©é™£ã€æ•¸æ“šæ¡†\n FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n FUN.VALUE: å¯ä»¥è¨˜ç‚ºå°æ¯ä¸€ç´€éŒ„çµ¦åç¨±(e.g. row.names)\n â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸\n USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®\nx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ x\u0026lt;-data.frame(x) # ä¸èƒ½æ˜¯çŸ©é™£ f1\u0026lt;- function(col) { c(min(col),max(col)) } vapply(x,f1,FUN.VALUE = c(\u0026quot;min\u0026quot;=0,\u0026quot;max\u0026quot;=0)) # FUN.VALUE æ˜¯ä¸€å€‹named vector #\u0026gt; x1 x2 #\u0026gt; min 3 1 #\u0026gt; max 3 6 # vapply(x,f1,FUN.VALUE = c(\u0026quot;min\u0026quot;,\u0026quot;max\u0026quot;)) # éŒ¯èª¤   mapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š\nmapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE,USE.NAMES = TRUE)  åƒæ•¸åˆ—è¡¨ï¼š\n FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š\n MoreArgs: åƒæ•¸åˆ—è¡¨\n SIMPLIFY: æ˜¯å¦è½‰çŸ©é™£ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„\n USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®\n å¦‚æœFun=f(x)ï¼Œå‰‡ mapply(f,a1,a2)çš„åŸ·è¡Œæ˜¯ï¼š\nf(a1), f(a2)\n å¦‚æœFun=f(x,y)ï¼Œå‰‡ mapply(f,a1,a2)çš„åŸ·è¡Œæ˜¯ï¼š\nf(a1, a2)\n  æ¯”å¦‚ï¼Œæ¯”è¼ƒ3å€‹å‘é‡å¤§å°ï¼ŒæŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚\nset.seed(1) # å®šç¾©3å€‹å‘é‡ x\u0026lt;-1:10 y\u0026lt;-5:-4 z\u0026lt;-round(runif(10,-5,5)) # æŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚ mapply(max,x,y,z) #\u0026gt; [1] 5 4 3 4 5 6 7 8 9 10  å†çœ‹ä¸€å€‹ä¾‹å­ï¼Œç”Ÿæˆ4å€‹ç¬¦åˆæ­£æ…‹åˆ†ä½ˆçš„æ•¸æ“šé›†ï¼Œåˆ†åˆ¥å°æ‡‰çš„å‡å€¼å’Œæ–¹å·®ç‚ºc(1,10,100,1000)ã€‚\nset.seed(1) # é•·åº¦ç‚º4 n\u0026lt;-rep(4,4) # mç‚ºå‡å€¼ï¼Œvç‚ºæ–¹å·® m\u0026lt;-v\u0026lt;-c(1,10,100,1000) # ç”Ÿæˆ4çµ„æ•¸æ“šï¼ŒæŒ‰åˆ—åˆ†çµ„ mapply(rnorm,n,m,v) #\u0026gt; [,1] [,2] [,3] [,4] #\u0026gt; [1,] 0.3735462 13.295078 157.57814 378.7594 #\u0026gt; [2,] 1.1836433 1.795316 69.46116 -1214.6999 #\u0026gt; [3,] 0.1643714 14.874291 251.17812 2124.9309 #\u0026gt; [4,] 2.5952808 17.383247 138.98432 955.0664  tapplyå‡½æ•¸ tapplyç”¨æ–¼åˆ†çµ„çš„å¾ªç’°è¨ˆç®—ï¼Œé€šéINDEXåƒæ•¸å¯ä»¥æŠŠæ•¸æ“šé›†Xé€²è¡Œåˆ†çµ„ï¼Œç›¸ç•¶æ–¼group byçš„æ“ä½œã€‚\nå‡½æ•¸å®šç¾©ï¼š\ntapply(X, INDEX, FUN = NULL, ..., simplify = TRUE)  åƒæ•¸åˆ—è¡¨ï¼š\n X: å‘é‡\n INDEX: ç”¨æ–¼åˆ†çµ„çš„ç´¢å¼•\n FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š\n simplify : æ˜¯å¦æ•¸çµ„åŒ–ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„\n  æ¯”å¦‚ï¼Œè¨ˆç®—ä¸åŒå“ç¨®çš„é³¶å°¾èŠ±çš„èŠ±ç“£(iris)é•·åº¦çš„å‡å€¼ã€‚\n# é€šéiris$Specieså“ç¨®é€²è¡Œåˆ†çµ„ tapply(iris$Petal.Length,iris$Species,mean) #\u0026gt; setosa versicolor virginica #\u0026gt; 1.462 4.260 5.552  åˆ†çµ„æ±‚å’Œçš„ç¯„ä¾‹ã€‚\nset.seed(1) x\u0026lt;-1:10 # äº‚è¡“åˆ†æˆ3çµ„ï¼Œåˆ†åˆ¥æ˜¯0,1,2 t\u0026lt;-round(runif(10,1,100)%%2);t #\u0026gt; [1] 1 2 2 1 1 2 1 0 1 1 # å°xé€²è¡Œåˆ†çµ„æ±‚å’Œ tapply(x,t,sum) #\u0026gt; 0 1 2 #\u0026gt; 8 36 11  rapplyå‡½æ•¸ eapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š\neapply(env, FUN, ..., all.names = FALSE, USE.NAMES = TRUE)  ç·´ç¿’ï¼š\n1 æŠŠiris æ¯å€‹æ¬„ä½çš„åŠ ç¸½åˆ—å‡º\niris æœ‰ä¸€å€‹æ¬„ä½æ˜¯factor\nç¯„ä¾‹ å°‡æ¯å€‹rmdæª”æ¡ˆä¸­éœ€è¦çš„å‡½æ•¸åº«åˆ—è¡¨ #setwd(~/directory1/) libs = lapply(list.files(pattern = \u0026quot;\\\\.Rmd$\u0026quot;), function(x){ d = readLines(x) d = d[grepl(\u0026quot;library\\\\(.*\\\\)\u0026quot;, d)] gsub(\u0026quot;library\\\\((.*)\\\\)\u0026quot;, \u0026quot;\\\\1\u0026quot;, d) }) unique(unlist(libs))  note:\ngrepl :ã€€é‚è¼¯å€¼\ngsub :ã€€åªæ‹¿å–library(\u0026quot;å‡½æ•¸åº«åç¨±\u0026quot;)ä¸­çš„\u0026quot;å‡½æ•¸åº«åç¨±\u0026quot;ã€‚\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/9_plot01.html","title": "9. Plot 01",
	"tags": [],
	"description": "åŸºæœ¬ç¹ªåœ–",
	"content": " æé»å’Œåƒè€ƒ Quick R\nbasic ä¸€èˆ¬è¦–çª—ä½œæ¥­ç³»çµ±çš„ç¹ªåœ–ï¼Œæœƒæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶deviceåœ¨é€™å€‹deviceä¸Šï¼Œæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶canvasï¼Œå’Œç¹ªåœ–å·¥å…·ä¾‹å¦‚ï¼Œæ°´å½©ç­†ä¹‹é¡çš„æŠ½è±¡ç‰©ä»¶å¯ä»¥æŒ‡å®šé¡è‰²ï¼Œç·šæ¢ç²—ç´°ç­‰ç­‰ã€‚ åœ¨Rä¸­,å°æ‡‰ä¸Šè¿°ä½œæ¥­ç³»çµ±çš„é—œéµå­—.Devices(paired list)ã€.Device(é•·åº¦ç‚º1)ã€dev.cur(ç›®å‰çš„è£ç½®active device)ã€‚é€™è£¡èªªçš„DeviceæŒ‡çš„æ˜¯è¦–çª—ã€‚åœ¨è¦–çª—è£¡é¢çš„ç•«å¸ƒ,å°±æ˜¯Ræä¾›çš„ç¹ªåœ–å‡½æ•¸è¼¸å‡ºæ‰€åœ¨,ä¾‹å¦‚plot(),hist()ç­‰ç­‰ã€‚\næ‰€ä»¥dev.new() æŒ‡çš„æ˜¯é–‹å•Ÿæ–°è¦–çª—ï¼Œdev.curæ˜¯ç›®å‰è¦–çª—è™Ÿç¢¼,dev.prev()å‰ä¸€å€‹è¦–çª—è™Ÿç¢¼ã€‚\nè€Œplot.new() å‰‡æ˜¯æ–°å¢ç•«å¸ƒã€‚è¦‹ç·´ç¿’\nãŠ™ï¸ æ€æ¨£å¿«é€ŸæŸ¥è©¢ï¼Ÿ\n ??draw\n ?plot : åƒè€ƒå…¶ä¸­çš„plot.default æŸ¥çœ‹åœ–å½¢é¸é …\n  å‡½æ•¸plot() å¯èƒ½æœ€å¸¸ç”¨çš„ç¹ªåœ–å‡½æ•¸å°±æ˜¯plot(),è€Œé€™å€‹å‡½æ•¸æ¯”è¼ƒå¸¸ç”¨çš„é¸é …æœ‰ï¼š\n type: åƒ…åˆ†ä½ˆé»ï¼ˆé è¨­ï¼‰æ˜¯å¦é€£ç·šç­‰åŸºæœ¬æ¨¡æ¿ã€‚\n lty: ç·šæ¢æ¨£å¼line style\n lwd: ç·šæ¢å¯¬åº¦line width\n col:\n pch: mark\n   type description     p points   l lines   o é‡åˆçš„é»å’Œç·šæ®µ   b, c b(both) é»+ç·š,ä¸é‡åˆ (å¦‚æœæ˜¯\u0026quot;c\u0026quot; å‰‡æ²’æœ‰é»)   s, S stair steps   h histogram-like vertical lines   n does not produce any points or lines     è³‡æ–™é» ç¬¦è™Ÿ\nè¨­å®šæ¨£æœ¬é»çš„ç¬¦è™Ÿ,å¯ä»¥ç”¨ pch (\u0026quot;point character\u0026quot;).\npch çš„å€¼é™¤äº†å¾ 0 åˆ° 24 å…±25å€‹ç¬¦è™Ÿå¤–ï¼Œé‚„æœ‰ \u0026quot;*\u0026quot;, \u0026quot;+\u0026quot;, \u0026quot;o\u0026quot;, \u0026quot;@\u0026quot;, \u0026quot;#\u0026quot; å¯ä»¥ç”¨ã€‚\n pch=0 square pch=1 circle pch=2 triangle point up pch=3 plus pch=4 cross pch=5 diamond pch=6 triangle point down pch=7 square cross pch=8 star pch=9 diamond plus pch=10 circle plus pch=11 triangles up and down pch=12 square plus pch=13 circle cross pch=14 square and triangle down pch=15 filled square blue pch=16 filled circle blue pch=17 filled triangle point up blue pch=18 filled diamond blue pch=19 solid circle blue pch=20 bullet (smaller circle) pch=21 filled circle red pch=22 filled square red pch=23 filled diamond red pch=24 filled triangle point up red pch=25 filled triangle point down red  cex è³‡æ–™é»å¤§å°\ncex ç”¨ä¾†æ”¾å¤§æ–‡å­—æˆ–ç¬¦è™Ÿçš„å€æ•¸\nå› æ­¤, cex = 1 is default size\ncex = 1.5 is 150% of default size\ncex = 0.5 is 50% of default size\n[Note : cex.axis --\u0026gt; scales the axis\ncex.lab ---\u0026gt; scales the label\ncex.main --\u0026gt; scales main title\ncex.sub ---\u0026gt; scales the subtitle ]\nç·šæ¢å‹æ…‹\n lty = 0 or lty = \u0026quot;blank\u0026quot; lty = 1 or lty = \u0026quot;solid\u0026quot; lty = 2 or lty = \u0026quot;dashed\u0026quot; lty = 3 or lty = \u0026quot;dotted\u0026quot; lty = 4 or lty = \u0026quot;dotdash\u0026quot; lty = 5 or lty = \u0026quot;longdash\u0026quot; lty = 6 or lty = \u0026quot;twodash\u0026quot;  åƒè€ƒå¾Œç¯€\né¡è‰² col\ncol = \u0026quot;blue\ncol = \u0026quot;red\u0026quot;\ncol å¾Œçš„å€¼,å¯ç”¨colors() ä¾†æŸ¥è©¢é¡è‰²,æœƒå‚³å› 657 ä»£è¡¨é¡è‰²çš„åƒæ•¸ã€‚æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ç”¨16é€²ä½æ•¸å­—ï¼Œä¾‹å¦‚\ncol = \u0026quot;#A9F3BB\u0026quot; ------\u0026gt; colour corresponding to Red=A9, Green=F3, Blue=BB in hexadecimal representation.\n\r\rpar(def.par) #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;cin\u0026quot; #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;cra\u0026quot; #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;csi\u0026quot; #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;cxy\u0026quot; #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;din\u0026quot; #\u0026gt; Warning in par(def.par): ç„¡æ³•è¨­å®šç¹ªåœ–åƒæ•¸ \u0026quot;page\u0026quot;  ç¹ªè£½å‘é‡ ä¸­çš„è³‡æ–™\nx \u0026lt;- c(1,3,4,7,8,9) y \u0026lt;- c(0,3,6,9,7,8) plot(x,y,main='plot(x,y)')  ç¹ªè£½data.frame ä¸­çš„è³‡æ–™\nplot(mtcars$wt, mtcars$mpg) abline(lm(mtcars$mpg~mtcars$wt)) title(\u0026quot;Regression of MPG on Weight\u0026quot;)  å¦‚æœä¸æƒ³è¦æ‰“$å­—è™Ÿ,å‰‡ç”¨attach()\nattach(mtcars) plot(wt, mpg) abline(lm(mpg~wt)) title(\u0026quot;Regression of MPG on Weight\u0026quot;)  plot()å‡½æ•¸ï¼Œæ–°å»ºè¦–çª—ç„¶å¾Œç•«å‡º weight vs. miles per gallon.\nabline() ä¸æœƒé–‹å•Ÿæ–°è¦–çª—åšåœ–ï¼Œabline()çš„èªæ³•å¦‚ä¸‹:\nabline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,coef = NULL, untf = FALSE, â€¦)\nä»£è¡¨çš„æ„æ€æ˜¯ç•«å‡ºä¸€æ¢ç›´ç·ša+bx ï¼Œå…¶ä¸­aä»£è¡¨æˆªè·å¸¸æ•¸ï¼Œbå‰‡æ˜¯æ–œç‡å¸¸æ•¸ã€‚ä¾‹å¦‚\n Y=2X+1ï¼Œå‰‡å°æ‡‰çš„å‡½æ•¸ç‚º abline(a=1,b=2) ã€‚\n abline(h=3),æ°´å¹³ç·š\n abline(v=2) å‚ç›´\n  å‡½æ•¸ç•«åœ–\nx: -pi ~ 2*pi\ny: sin(x)\nplot(sin, -pi, 2*pi)  line() ç¯„ä¾‹ require(stats) # for lowess, rpois, rnorm summary(cars) #\u0026gt; speed dist #\u0026gt; Min. : 4.0 Min. : 2.00 #\u0026gt; 1st Qu.:12.0 1st Qu.: 26.00 #\u0026gt; Median :15.0 Median : 36.00 #\u0026gt; Mean :15.4 Mean : 42.98 #\u0026gt; 3rd Qu.:19.0 3rd Qu.: 56.00 #\u0026gt; Max. :25.0 Max. :120.00 plot(cars) lines(lowess(cars)) #ğŸ·ç–Šä¸Šé¡å¤–çš„ç·šæ¢   \u0026gt; LOWESS, locally weighted scatter plot smoothingã€‚\n\u0026gt; ç›¸é—œé–±è®€\n\u0026gt;\nattach(cars) plot(speed,dist,main=\u0026quot;Stopping Distance\u0026quot;, xlab=\u0026quot;Speed\u0026quot;, ylab=\u0026quot;Distance\u0026quot;, pch=21, bg=2, col=2) lines(lowess(cars, f=.3),col =1) lines(lowess(cars, f=.5),col =4) lines(lowess(cars, f=.1),col =7)  scatterplot() ç¯„ä¾‹ ç¯„ä¾‹\nif(!require(\u0026quot;car\u0026quot;)) install.packages(\u0026quot;car\u0026quot;,repos=\u0026quot;http://cran.us.r-project.org\u0026quot;) # ğŸ·scatterplot åœ¨é€™å€‹å¥—ä»¶ä¸­  #\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šcar #\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šcarData library(car) scatterplot(wt ~ mpg, data = mtcars)   ç¶ ç·š: å›æ­¸ç·š\n ç´…è‰²è™›ç·š:the smoothed conditional spread\n ç´…è‰²å¯¦ç·š:the non-parametric regression smooth\nscatterplot(wt ~ mpg, data = mtcars, smooth = FALSE, grid = FALSE, frame = FALSE)   Histograms å‡½æ•¸hist(x)ï¼šå…¶ä¸­xæ˜¯ä¸€å€‹æ•¸å­—å‘é‡ï¼Œ\n é¸é …freq=FALSE ç”¨ä¾†ç•«å‡º probability densities è€Œä¸æ˜¯æ¬¡æ•¸ frequencies.\n é¸é …ï¼šbreaks= ## å‰‡æ˜¯æ§åˆ¶åˆ†æˆå¹¾ä»½ã€‚\n  Simple Histogram\nhist(mtcars$mpg)  åˆ†æˆ12ä»½ï¼Œé¡è‰²ç´…è‰²ã€‚\nhist(mtcars$mpg, breaks=12, col=\u0026quot;red\u0026quot;)  è‡ªè¡Œçµ¦å®šåˆ†å‰²é»\nhist(mtcars$mpg, breaks=c(4,5,12,50), col=\u0026quot;red\u0026quot;)  Add a Normal Curve Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used.\nx \u0026lt;- mtcars$mpg h\u0026lt;-hist(x, breaks=10, col=\u0026quot;red\u0026quot;, xlab=\u0026quot;Miles Per Gallon\u0026quot;, main=\u0026quot;Histogram with Normal Curve\u0026quot;) xfit\u0026lt;-seq(min(x),max(x),length=40) yfit\u0026lt;-dnorm(xfit,mean=mean(x),sd=sd(x)) yfit \u0026lt;- yfit*diff(h$mids[1:2])*length(x) #ğŸ·length(X)æ˜¯å€‹æ•¸,ä¸æ˜¯é•·åº¦  lines(xfit, yfit, col=\u0026quot;blue\u0026quot;, lwd=2)  hint:\nh: æ¬¡æ•¸åˆ†é…åœ–,åˆ\n$$ pdf = \\frac{æ©Ÿç‡}{é•·åº¦} =\\frac{\\frac{n}{N}}{bin \\quad width} $$\næ‰€ä»¥\n$$ n=pdf\\times N \\times (bin \\quad width) $$\nh #\u0026gt; $breaks #\u0026gt; [1] 10 12 14 16 18 20 22 24 26 28 30 32 34 #\u0026gt; #\u0026gt; $counts #\u0026gt; [1] 2 1 7 3 5 5 2 2 1 0 2 2 #\u0026gt; #\u0026gt; $density #\u0026gt; [1] 0.031250 0.015625 0.109375 0.046875 0.078125 0.078125 0.031250 0.031250 #\u0026gt; [9] 0.015625 0.000000 0.031250 0.031250 #\u0026gt; #\u0026gt; $mids #\u0026gt; [1] 11 13 15 17 19 21 23 25 27 29 31 33 #\u0026gt; #\u0026gt; $xname #\u0026gt; [1] \u0026quot;x\u0026quot; #\u0026gt; #\u0026gt; $equidist #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; attr(,\u0026quot;class\u0026quot;) #\u0026gt; [1] \u0026quot;histogram\u0026quot;  Kernel Density Plot æ ¸å¯†åº¦ç•«åœ–(Kernal density plots) ç”¨ä¾†è§€å¯Ÿä¸€å€‹è®Šé‡ï¼Œæ¯”è¼ƒæœ‰æœ‰æ•ˆç‡ï¼ŒæŒ‡ä»¤å¦‚ï¼šplot(density(x)) å…¶ä¸­x æ˜¯ä¸€å€‹æ•¸å­—å‘é‡ã€‚\nd \u0026lt;- density(mtcars$mpg) # returns the density data plot(d) # plots the results  Filled Density Plot d \u0026lt;- density(mtcars$mpg) plot(d, main=\u0026quot;Kernel Density of Miles Per Gallon\u0026quot;) polygon(d, col=\u0026quot;red\u0026quot;, border=\u0026quot;blue\u0026quot;)  å¤šå€‹åœ–å’Œç–Šåœ– å‚»ç“œæŒ‡ä»¤ä¾‹å¦‚ (plot, hist, boxplot, etc.)åŸºæœ¬ä¸Šæœƒé–‹å•Ÿæ–°è¦–çª—ï¼Œç„¶å¾Œç•«åœ–,è€Œline(),scatterplot()å‰‡æ˜¯ç–Šåœ–ã€‚é€™è£¡å¦å¤–çœ‹çœ‹å¹¾ç¨®è‡ªè¡Œæ§åˆ¶çš„æ–¹æ³•ï¼š\nå¤šè¦–çª—(multiple windows)ã€çµ„åˆåœ–(combining figure) å’Œç–Šåœ–(overlay)è¨è«–ã€‚\nå¤šè¦–çª— é–‹å¤šè¦–çª—çš„æ–¹æ³•æ ¹æ“šOSè€Œä¸åŒï¼Œå¦‚ä¸‹ï¼š\n   Function Platform     windows() Windows   X11() Unix   quartz() Mac    è¦é—œé–‰è¦–çª—ï¼Œå¯ä»¥ç”¨å‡½æ•¸dev.off()\nå¦‚æœè¦çŸ¥é“ç›®å‰çš„è¦–çª—æ˜¯é‚£ä¸€å€‹ï¼Œå¯ä»¥åƒè€ƒ dev.cur()ã€‚\nNote:\nå¦‚æœç›®å‰æœ‰å¤šå€‹åœ–çª—ï¼Œå‰‡ä¸€ç›´å‘¼å«é€™å€‹å‡½æ•¸dev.off()ï¼Œæœƒä¾æ¬¡é—œé–‰è¦–çª—ï¼Œç›´åˆ°å‡½æ•¸å‚³å›NULLã€‚\né©—è­‰ä¸Šé¢çš„èªªæ³•å¯ä»¥åˆ©ç”¨\nhist(mtcars$mpg) dev.cur() #\u0026gt; png #\u0026gt; 2 hist(mtcars$mpg) dev.cur() #\u0026gt; png #\u0026gt; 2 dev.off() #\u0026gt; null device #\u0026gt; 1  â“ä¸Šé¢çš„ç¯„ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°åœ–è£ç½®çš„ç·¨è™Ÿéƒ½æ˜¯2ï¼Œä¹Ÿå°±æ˜¯å¤šå€‹åœ–åœ¨ä¸€å€‹è¦–çª—ä¸Šã€‚é€™æ˜¯å› ç‚ºåœ¨Rmakdownä¸­,è¦–çª—éƒ½æ˜¯é è¨­çš„è£ç½®,æ–¹ä¾¿æ•´åˆåˆ°æœ€å¾Œçš„æ–‡ä»¶ä¸­,å¦‚æœåœ¨rscriptä¸­,å‰‡dev.cur()æœƒé¡¯ç¤ºå…©å€‹ç·¨è™Ÿã€‚\nè¨è«–ä¸‹é¢çš„è¼¸å‡ºçµæœï¼Œï¼š\næ¯”è¼ƒç¨‹å¼ç¢¼åœ¨rmarkdownå’Œconsoleä¸­åŸ·è¡Œçš„çµæœï¼Ÿ\nif(.Platform$OS.type==\u0026quot;windows\u0026quot;) windows() else X11() hist(mtcars$mpg) dev.cur() if(.Platform$OS.type==\u0026quot;windows\u0026quot;) windows() else X11() hist(mtcars$mpg) dev.cur()  æç¤º\r åœ¨rscriptâœ”ä¸­åŸ·è¡Œæ­£å¸¸ã€‚\râ›³**æ¸¬è©¦,ç·´ç¿’**  plot.new() # åŒä¸€å€‹è¦–çª—ï¼Œæ–°å¢åœ–å±¤ dev.new() #æ–°è¦–çª— plot(1:1) dev.new() plot(2,2) dev.set(dev.prev()) # go back to first title(main=\u0026quot;test dev 1\u0026quot;) dev.set(dev.next()) # go to second title(main=\u0026quot;test dev 2\u0026quot;)  åˆä½µ Plots par() about par()\nåŒæ™‚é¡¯ç¤ºå¤šå€‹plotçš„çµæœï¼Œå¯ä»¥åˆ©ç”¨å‡½æ•¸par() or layout( )ã€‚\nå‡½æ•¸par( )çš„é¸é …æœ‰ï¼š\nmfrow=c(nrows, ncols) å¡«plotçš„æ–¹å‘ç‚ºæ©«è¡Œ(matrix flow by row)ã€‚\nmfcol=c(nrows, ncols) å¡«å…¥çš„æ–¹å‘ç‚ºç›´è¡Œã€‚\nåœ¨consoleåŸ·è¡Œ(èª²å ‚åŸ·è¡Œ)\ndef.par\u0026lt;-par() # ğŸ·å°‡ç›®å‰çš„åƒæ•¸å­˜åˆ°def.par  def.par$mfrow def.par\u0026lt;-par(mfrow=c(1,3)) def.par$mfrow par()$mfrow # ç›®å‰çš„è¨­å®š par(def.par) # é‚„åŸ  x\u0026lt;-par() æœƒæŠŠç›®å‰çš„åƒæ•¸æ‹¿å‡ºå­˜åˆ°è®Šæ•¸xã€‚ å¦‚æœpar() æ”¾äº†åƒæ•¸,æœƒåœ¨è¨­å®šå®Œæ–°åƒæ•¸ä»¥å¾Œï¼Œå‚³å›èˆŠç´€éŒ„(ä¸€å€‹åŸå› æ˜¯,ä¾¿æ–¼ä»¥å¾Œå†é‚„åŸ)ã€‚åœ¨é€™å€‹éç¨‹ä¸­ï¼Œæœ‰äº›åƒæ•¸æ˜¯ç„¡æ³•ä¿®æ”¹çš„ï¼Œå› æ­¤\nop \u0026lt;- par(no.readonly = TRUE) # ğŸ·opç¾åœ¨æ”¾çš„æ˜¯æ‰€æœ‰å¯ä»¥ä¿®æ”¹çš„åƒæ•¸å’Œåƒæ•¸å€¼ã€‚  ... (æ“ä½œ) par(op) # ğŸ·é‡è¨­   no.readonly=Tæ˜¯èªªä¸è¦å”¯è®€åƒæ•¸\r\r\râ›³ç·šæ¢å½¢å¼`type`çš„å¹¾ç¨®åŸºæœ¬é¡å‹ç¯„ä¾‹  x \u0026lt;- c(1,3,4,7,8,9) y \u0026lt;- c(0,3,6,9,7,8) par(mfrow=c(2,3)) plot(x,y,main='plot(x,y)',color=\u0026quot;red\u0026quot;) #\u0026gt; Warning in plot.window(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in plot.xy(xy, type, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in axis(side = side, at = at, labels = labels, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ª #\u0026gt; åœ–åƒæ•¸ #\u0026gt; Warning in axis(side = side, at = at, labels = labels, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ª #\u0026gt; åœ–åƒæ•¸ #\u0026gt; Warning in box(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in title(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ plot(x,y,type=\u0026quot;l\u0026quot;,main=\u0026quot;plot(x,y,type='l')\u0026quot;,color=\u0026quot;green\u0026quot;) #\u0026gt; Warning in plot.window(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in plot.xy(xy, type, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in axis(side = side, at = at, labels = labels, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ª #\u0026gt; åœ–åƒæ•¸ #\u0026gt; Warning in axis(side = side, at = at, labels = labels, ...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ª #\u0026gt; åœ–åƒæ•¸ #\u0026gt; Warning in box(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ #\u0026gt; Warning in title(...): \u0026quot;color\u0026quot; ä¸æ˜¯ä¸€å€‹ç¹ªåœ–åƒæ•¸ plot(x,y,type=\u0026quot;b\u0026quot;,main=\u0026quot;plot(x,y,type='b')\u0026quot;) plot(x,y,type=\u0026quot;o\u0026quot;,main=\u0026quot;plot(x,y,type='o')\u0026quot;) plot(x,y,type=\u0026quot;s\u0026quot;,main=\u0026quot;plot(x,y,type='s')\u0026quot;) plot(x,y,type=\u0026quot;h\u0026quot;,main=\u0026quot;plot(x,y,type='h')\u0026quot;)  ç¯„ä¾‹\nattach(mtcars) par(mfrow=c(2,2)) plot(wt,mpg, main=\u0026quot;Scatterplot of wt vs. mpg\u0026quot;) plot(wt,disp, main=\u0026quot;Scatterplot of wt vs disp\u0026quot;) hist(wt, main=\u0026quot;Histogram of wt\u0026quot;) boxplot(wt, main=\u0026quot;Boxplot of wt\u0026quot;)  # attach(mtcars) par(mfrow=c(1,3)) hist(wt) hist(mpg) hist(disp) #dev.off()  note:\npar(mar) åˆ—å‡ºmargin\npar(mar=c(1,1,1,1)) æ›´å‹•margin\nplot.new()å¸¸ç™¼ç”Ÿçš„éŒ¯èª¤ : figure margins too large\næœ‰å…©å€‹åŸå› ï¼š1 æ˜¯ç•«å¸ƒéå° 2ï¼Œç•¶å‰ç•«å¸ƒçš„ä¸Šä¸‹å·¦å³è·é›¢éå¤§\né€™è£¡çœ‹çœ‹å¦‚ä½•è§£ç¬¬äºŒå€‹ç™¼ç”ŸåŸå› \né»˜èªçš„ç•«å¸ƒä¸Šé‚Šæ¬¾çš„è·é›¢ç‚ºï¼š\né è¨­ç‚º c(5, 4, 4, 2) + 0.1. å°æ‡‰ c(bottom, left, top, right)ï¼Œä¹Ÿå°±æ˜¯é †æ™‚é‡ï¼Œç”±ä¸‹åˆ°å³çµæŸä¸€åœˆã€‚\næˆ‘å€‘å¯ä»¥å°‡å…¶è¨­ç½®ç‚º0ï¼ŒåŒæ™‚å°‡ç›®å‰çš„è¨­å®šç´€éŒ„ï¼Œå¾Œé¢ç¨‹å¼çš„ç¬¬ä¸€è¡Œ\nop \u0026lt;- par(mar = rep(0, 4)) # op æœƒç´€éŒ„ä¹‹å‰çš„margin = 5.1 4.1 4.1 2.1 plot.new() # ç•«åœ– par(op) # æ”¹å›åŸå…ˆçš„margin  \r\ræ˜¯ä¸æ˜¯æœ‰éœ€è¦å¯«å€‹æ–°å‡½æ•¸ï¼Œç”¨ä¾†é‡è¨­è£ç½®åƒæ•¸ï¼Ÿ\nä¸‹é¢é€™å€‹å‡½æ•¸resetPar()ç”¢ç”Ÿæ–°çš„é‡è¨­åƒæ•¸,ç”¨ä¾†å°‡deviceå›å¾©æˆåŸå…ˆçš„è¨­å®šå€¼:\nä¸»è¦çœ‹é€™ä¸€è¡Œ:par(no.readonly = TRUE)ã€‚\næ„æ€æ˜¯èªªï¼Œä¸è¦å‚³å› readonlyçš„è¨­å®šã€‚\nresetPar \u0026lt;- function() { dev.new() #é‡æ–°é–‹å§‹ä¸€å€‹è£ç½® op \u0026lt;- par(no.readonly = TRUE)#å› ç‚ºæ˜¯æ–°çš„ï¼Œæ‰€ä»¥è£¡é¢çš„è¨­å®šéƒ½æ˜¯é è¨­å€¼ dev.off()# åªæ˜¯æŠŠä¹‹å‰çš„æ–°è£ç½®é—œæ‰ op # å‚³å›é è¨­å€¼ } # ä½¿ç”¨æ–¹æ³• par(resetPar)  æè¦\npar() # view current settings opar \u0026lt;- par() # make a copy of current settings par(col.lab=\u0026quot;red\u0026quot;) # red x and y labels hist(mtcars$mpg) # create a plot with these new settings par(opar) #å›å¾©åŸä¾†çš„è¨­å®š  \r\ræ›´å¤šçš„åœ–å½¢æ§åˆ¶: åœ¨æ•£ä½ˆåœ–ä¸­åŠ å…¥boxplot\n# windowsåœ–çš„åº§æ¨™ï¼Œå·¦ä¸‹è§’(0,0)å³ä¸Šè§’(1,1) par(mar=rep(2,4)) #è¨­å®šmargin par(fig=c(0,0.8,0,0.8)) #ğŸ·Xè»¸å¾0åˆ°0.8,Yè»¸ä¹Ÿæ˜¯ã€‚å› æ­¤ï¼Œå·¦ä¸‹(0,0)å³ä¸Š(0.8,0.8) # ğŸ·å·¦ä¸‹(x1,y1)å³ä¸Š(x2,y2) =\u0026gt; c(x1,x2,y1,y2)  plot(mtcars$wt, mtcars$mpg, xlab=\u0026quot;Car Weight\u0026quot;,ylab=\u0026quot;Miles Per Gallon\u0026quot;) par(fig=c(0,0.8,0.55,1), new=TRUE) #ğŸ·åŒä¸€å€‹åœ–,å› ç‚ºæ²’æœ‰è¨­å®šdev.new  boxplot(mtcars$wt, horizontal=TRUE, axes=FALSE) par(fig=c(0.65,1,0,0.8),new=TRUE) boxplot(mtcars$mpg, axes=FALSE) mtext(\u0026quot;Enhanced Scatterplot\u0026quot;, side=3, outer=TRUE, line=-3)  RMD ä¸­çš„åœ– ä¸¦æ’é¡¯ç¤ºåœ–å½¢(åƒè€ƒ):\n```{r out.width=c('50%', '50%') , fig.show='hold'} boxplot(1:10) plot(rnorm(10)) ```  åŸ·è¡Œçµæœ\r\r\rç·´ç¿’ ç·´ç¿’1\nè®“ä¸‹é¢å…©å€‹åœ–é‡ç–Š\nboxplot(mtcars$wt, axes=FALSE) par(new=TRUE) boxplot(mtcars$mpg, axes=FALSE)  ç·´ç¿’2\nè®“disp,mpg çš„histogram ç–Šåœ¨ä¸€èµ·:\nç·´ç¿’3\næ¸¬è©¦é€™ç¯‡æ–‡ç« \nlayout() å‡½æ•¸ layout( ) çš„ä½¿ç”¨æ–¹æ³•ç‚º layout(mat) å…¶ä¸­\nmat çš„å…ƒç´ ç”¨ä¾†æŒ‡å®šåœ–å½¢è™Ÿç¢¼ã€‚ä¾‹å¦‚åˆ†æˆ4å€‹æ ¼å­,é †åºç‚ºå·¦å³ä¸Šä¸‹(byrow=TRUE)\nå¦‚layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) å°æ‡‰å¦‚ä¸‹è¡¨\n         1 1   2 3    # One figure in row 1 and two figures in row 2 #attach(mtcars) layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) hist(wt) hist(mpg) hist(disp) #dev.off()  åœ¨layout()å‡½æ•¸ä¸­ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹åœ–å½¢å¤§å°ï¼Œå…¶åƒæ•¸ ç‚ºï¼š\nwidths= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨column å¯¬åº¦\nheights= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨row é«˜åº¦\nnote:Relative widths are specified with numeric values. Absolute widths (in centimetres) are specified with the lcm() function.\nç–Šåœ– æœ‰äº›ç¹ªåœ–æŒ‡ä»¤çš„é¸é …ï¼Œå¯ä»¥åˆ©ç”¨add=Tã€‚\nğŸ’¥ plotæŒ‡ä»¤ä¸æ”¯æ´add=T\ncurve( dnorm(x,0,1), -5 , 5, lwd=1, lty=1) curve( dnorm(x,0,2), add=TRUE, lwd=2, lty=2) curve( dnorm(x,0,3) , add=TRUE, lwd=3, lty=3) # Add the legend legend( \u0026quot;topright\u0026quot;,c(\u0026quot;sigma=1\u0026quot;,\u0026quot;sigma=2\u0026quot;,\u0026quot;sigma=3\u0026quot;) , lwd=1:3, lty=1:3)  åˆ†çµ„ç•«åœ– Comparing Groups VIA Kernal Density The sm.density.compare( ) function in the sm package allows you to superimpose the kernal density plots of two or more groups. The format is sm.density.compare(x, factor) where x is a numeric vector and factor is the grouping variable.\nCompare MPG distributions for cars with 4,6, or 8 cylinders library(sm) attach(mtcars) #create value labels cyl.f \u0026lt;- factor(cyl, levels= c(4,6,8), labels = c(\u0026quot;4 cylinder\u0026quot;, \u0026quot;6 cylinder\u0026quot;, \u0026quot;8 cylinder\u0026quot;)) #plot densities sm.density.compare(mpg, cyl, xlab=\u0026quot;Miles Per Gallon\u0026quot;) title(main=\u0026quot;MPG Distribution by Car Cylinders\u0026quot;) #add legend via mouse click colfill\u0026lt;-c(2:(2+length(levels(cyl.f)))) legend(locator(1), levels(cyl.f), fill=colfill)  "},
{"uri": "https://airbone4.github.io/blogR/rlang/11_00_sampling.html","title": "11. sampling",
	"tags": [],
	"description": "åŸºæœ¬æŠ½æ¨£",
	"content": " Sample and Distribution 01 N\u0026lt;-100 pop\u0026lt;-rnorm(N,5,2) rndno\u0026lt;-as.integer(runif(N)*N)+1 smp\u0026lt;-pop[rndno] ss\u0026lt;-summary(smp) s1\u0026lt;-hist(smp) rug(quantile(smp), col=2, lwd=2.5) plot(s1$mids,s1$density,type=\u0026quot;s\u0026quot;) #quiz:barplot?? s2\u0026lt;-hist(pop) plot(s1,col=\u0026quot;red\u0026quot;) lines(s2,col=\u0026quot;blue\u0026quot;)  å…§å»ºéš¨æ©ŸæŠ½æ¨£ å‡½æ•¸sample(x,n,replace=FALSE ).\nå…¶ä¸­xç‚ºè¦æŠ½å–çš„å‘é‡, nç‚ºæ¨£æœ¬å®¹é‡. replace é è¨­ç‚ºfalse\n no replacement, ç­‰æ©Ÿç‡:\n  ä¾‹å¦‚å¾52å¼µæ’²å…‹ç‰Œä¸­æŠ½å–5å¼µ:\nsample(1:52, 5) #\u0026gt; [1] 19 46 43 21 41   replacement:\nä¾‹å¦‚æ‹‹ä¸€æšå‡å‹»çš„ç¡¬å¹£10æ¬¡\nsample(c(\u0026quot;H\u0026quot;, \u0026quot;T\u0026quot;), 10, replace=T) #\u0026gt; [1] \u0026quot;T\u0026quot; \u0026quot;T\u0026quot; \u0026quot;H\u0026quot; \u0026quot;H\u0026quot; \u0026quot;T\u0026quot; \u0026quot;T\u0026quot; \u0026quot;T\u0026quot; \u0026quot;H\u0026quot; \u0026quot;T\u0026quot; \u0026quot;T\u0026quot;   ç·´ç¿’:ä¸€æ£µéª°å­æ“²10æ¬¡å¯è¡¨ç¤ºç‚º:\n3) ä¸ç­‰å¯èƒ½çš„éš¨æ©ŸæŠ½æ¨£:\nsample(x, n, replace=TRUE, prob=y)\nprob=yæŒ‡å®šxä¸­å…ƒç´ å‡ºç¾çš„æ¦‚ç‡, å‘é‡yèˆ‡xç­‰é•·åº¦. ä¾‹å¦‚ä¸€å¨ƒå¨ƒæ©Ÿå–å‡ºæˆåŠŸçš„æ¦‚ç‡ç‚º0.6, é‚£éº¼10æ¬¡çš„è©¦é©—ç‚º:\nsample(c(\u0026quot;sucess\u0026quot;, \u0026quot;fail\u0026quot;), 10, replace=T, prob=c(0.6,0.4)) #\u0026gt; [1] \u0026quot;sucess\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;sucess\u0026quot; #\u0026gt; [9] \u0026quot;sucess\u0026quot; \u0026quot;sucess\u0026quot;  æ’åˆ—çµ„åˆèˆ‡æ¦‚ç‡çš„è¨ˆç®— ä¾‹ å¾ä¸€å‰¯52å¼µæ’²å…‹ä¸­å–4å¼µ, æ±‚ä»¥ä¸‹äº‹ä»¶çš„æ¦‚ç‡:\n1. æŠ½å–çš„4å¼µä¾æ¬¡ç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡;\n2. ä¸€æ¬¡æŠ½å–4å¼µç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡.\nè§£\n1) æŠ½å–çš„4å¼µæ˜¯æœ‰æ¬¡åºçš„, å› æ­¤ä½¿ç”¨æ’åˆ—ä¾†æ±‚è§£. æ‰€æ±‚çš„äº‹ä»¶(è¨˜ç‚ºA)æ¦‚ç‡ç‚º ($P(A)=\\frac{1}{52 \\times 51 \\times 50 \\times 49}$)\nåˆ©ç”¨Rå‡½æ•¸\n1/prod(52:49) #\u0026gt; [1] 1.539077e-07   æ²’æœ‰æ¬¡åºçš„, å¯ä»¥ä½¿ç”¨çµ„åˆæ•¸ä¾†æ±‚è§£.\n  $$ P(B)=\\frac{1}{(52,4)} $$\nå…¶ä¸­ ($(n,m)=\\frac{n!}{m!(n-m)!}$),å¯ä»¥åˆ©ç”¨å‡½æ•¸choose(),ä¾‹å¦‚\n1/choose(52,4) #\u0026gt; [1] 3.693785e-06  distribution æ¨™æº–è¡¨æ ¼ä¸Šä¸‹æ²’æœ‰ç·šæ¢,å·¦å³æœ‰\n   åç¨± Rå‡½æ•¸ é¸é …     beta beta shape1, shape2   binomial binom size, prob   Cauchy cauchy location=0, scale=1   chi-sqaured ($\\chi^2$) chisq df, ncp   exponential exp rate   Fisher (F) f df1, df2, ncp   gamma gamma shape, scale=1   geometric geom prob   hypergeometric hyper m, n, k   lognormal lnorm meanlog=0, sdlog=1   logistic logis location=0, scale=1   multinomial multinom size, prob   normal norm mean=0, sd=1   negative binomial nbinom size, prob   Poisson pois lambda   Studentâ€™s (t) t df   uniform unif min=0, max=1   Weibull weibull shape, scale=1   Wilcoxonâ€™s statistics wilcox m, n    signrank n    å°æ–¼æ‰€çµ¦çš„åˆ†ä½ˆåç¨±ï¼Œæœ‰å››é¡ã€‚\nä»¥funcç‚ºä¾‹ï¼Œ å››é¡å‡½æ•¸çš„å°æ‡‰ç‚º:\n1. ã€Œdã€æ¦‚ç‡å¯†åº¦å‡½æ•¸: dfunc(x, p1, p2, ...), xç‚ºæ•¸å€¼å‘é‡;\n1. ã€Œpã€(ç´¯ç©)åˆ†ä½ˆå‡½æ•¸: pfunc(q, p1, p2, ...), qç‚ºæ•¸å€¼å‘é‡;\n1. ã€Œqã€åˆ†ä½æ•¸å‡½æ•¸: qfunc(p, p1, p2, ...), pç‚ºç”±æ¦‚ç‡æ§‹æˆçš„å‘é‡;\n1. ã€Œrã€éš¨æ©Ÿæ•¸å‡½æ•¸: rfunc(n, p1, p2, ...), nç‚ºç”Ÿæˆæ•¸æ“šçš„å€‹æ•¸\né€™å››é¡å‡½æ•¸çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯æœ‰è¦å¾‹çš„: å½¢ç‚ºdfuncçš„å‡½æ•¸ç‚ºxï¼Œpfuncçš„å‡½æ•¸ç‚ºqï¼Œqfuncçš„å‡½æ•¸ç‚ºpï¼Œrfuncçš„å‡½æ•¸ç‚ºn\nnote:\n(ä½†rhyperå’Œrwilcoxæ˜¯ç‰¹ä¾‹ï¼Œä»–å€‘çš„ç¬¬ä¸€å€‹åƒæ•¸ç‚ºnn).\néä¸­å¿ƒåƒæ•¸(non-centrality parameter)åƒ…å°CDFå’Œ\nå°‘æ•¸å…¶å®ƒå¹¾å€‹å‡½æ•¸æœ‰æ•ˆ.\n$$ \\frac{{\\sum\\limits_{i = 1}^n {{x_i} - n\\mu } }}{{\\sqrt {n{\\sigma ^2}} }} \\sim N(0,1) $$\n$$ \\bar X = \\frac{{\\sum_{i = 1}^n {{x_i} } }}{n} \\sim N(\\mu, \\sigma^2/n) $$\nuniform a~b\n$$\\mu = (a+b)/2$$\n$$\\sigma^2=\\frac{(b-a)^2}{12} $$\ndataçš„æ¯ä¸€å€‹ROWæœ‰sample size (=i=column)\nå…±1000æ¬¡(=N=row)\nN=1000 i=3 #sample size mu=0.5 sigma=1/sqrt(12) data\u0026lt;-matrix(runif(i*N),ncol=i) rs\u0026lt;-rowSums(data) rs\u0026lt;-rs/i z\u0026lt;-(rs-mu)/(sigma/sqrt(i)) hist(z) lines(density(z), col = 'red', lwd = 3) x\u0026lt;-z curve(dnorm(x), col = 'blue', lwd = 3, lty = 3, add = T) rug(sample(z,100))  limite.central \u0026lt;- function (r = runif, distpar = c(0, 1), m = .5, s = 1 / sqrt(12), n = c(1, 3, 10, 30), N = 1000) { for (i in n) { if (length(distpar) == 2) { x \u0026lt;-matrix(r(i * N, distpar[1], distpar[2]), nc = i) } else { x \u0026lt;-matrix(r(i * N, distpar), nc = i) } x \u0026lt;-(apply(x, 1, sum) - i * m) / (sqrt(i) * s) hist(x, col = 'light blue', probability = T, main = paste(\u0026quot;n=\u0026quot;, i), ylim = c(0, max(.4, density(x) $y))) lines(density(x), col = 'red', lwd = 3) curve(dnorm(x), col = 'blue', lwd = 3, lty = 3, add = T) if (N \u0026gt; 100) { rug(sample(x, 100)) } else { rug(x) } } } op \u0026lt;- par(mfrow=c(2,2)) limite.central(rbinom, distpar=c(10 ,0.1), m=1, s=0.9) par(op)   apply(x,1,sum) ç¬¬2å€‹åƒæ•¸1è¡¨ç¤ºrow æ–¹å‘,å¦‚æœæ˜¯2è¡¨ç¤ºcolumn å’Œmatlab ç›¸åã€‚\n  "},
{"uri": "https://airbone4.github.io/blogR/rlang/13_0_eco_01_intro.html","title": "13. Econometrics",
	"tags": [],
	"description": "åŸºæœ¬è¨ˆé‡",
	"content": " package recommended package foreign å¯ä»¥ç”¨ä¾†å°å…¥å¤–éƒ¨è³‡æ–™ä¾‹å¦‚ï¼Œ\n* stata çš„è³‡æ–™ dta,\n* SPSS\n* SAS\n* Systat\n* Mini tab . mtp\nåˆ©ç”¨foreignè®€å…¥stata çš„è³‡æ–™æª”ï¼š\nrequire(foreign)  #\u0026gt; Loading required package: foreign  affairs\u0026lt;- read.dta(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/affairs.dta\u0026quot;) save(affairs,file='./resources/affairs.RData')  æ¸¬è©¦\nrm(affairs) load('./resources/affairs.RData') head(affairs)  #\u0026gt; id male age yrsmarr kids relig educ occup ratemarr naffairs affair vryhap #\u0026gt; 1 4 1 37 10.0 0 3 18 7 4 0 0 0 #\u0026gt; 2 5 0 27 4.0 0 4 14 6 4 0 0 0 #\u0026gt; 3 6 1 27 1.5 0 3 18 4 4 3 1 0 #\u0026gt; 4 11 0 32 15.0 1 1 12 1 4 0 0 0 #\u0026gt; 5 12 0 27 4.0 1 3 17 1 5 3 1 1 #\u0026gt; 6 16 1 57 15.0 1 5 18 6 5 0 0 1 #\u0026gt; hapavg avgmarr unhap vryrel smerel slghtrel notrel #\u0026gt; 1 1 0 0 0 0 1 0 #\u0026gt; 2 1 0 0 0 1 0 0 #\u0026gt; 3 1 0 0 0 0 1 0 #\u0026gt; 4 1 0 0 0 0 0 0 #\u0026gt; 5 0 0 0 0 0 1 0 #\u0026gt; 6 0 0 0 1 0 0 0  "},
{"uri": "https://airbone4.github.io/blogR/rlang/14_00_sim_1.html","title": "14. simulation 1",
	"tags": [],
	"description": "åŸºæœ¬æ¨¡æ“¬",
	"content": " basic dnorm : PDF\npnorm : CDF\nqnorm : inverse CDF\nrnorm : random\ncdf z_scores \u0026lt;- seq(-3, 3, by = .1) pvalues \u0026lt;- pnorm(z_scores) # Now we'll plot these values plot(pvalues, # Plot where y = values and x = index of the value in the vector xaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis type = \u0026quot;l\u0026quot;, # Make it a line plot main = \u0026quot;cdf of the Standard Normal\u0026quot;, xlab= \u0026quot;Quantiles\u0026quot;, ylab=\u0026quot;Probability Density\u0026quot;) # These commands label the x-axis axis(1, at=which(pvalues == pnorm(-2)), labels=round(pnorm(-2), 2)) axis(1, at=which(pvalues == pnorm(-1)), labels=round(pnorm(-1), 2)) axis(1, at=which(pvalues == pnorm(0)), labels=c(.5)) axis(1, at=which(pvalues == pnorm(1)), labels=round(pnorm(1), 2)) axis(1, at=which(pvalues == pnorm(2)), labels=round(pnorm(2), 2))  ğŸ‘\naxisä¸‹å·¦ä¸Šåˆ(1,2,3,4)\nç¬¬2å€‹åƒæ•¸ç”¨çš„æ˜¯è¦é¡¯ç¤ºçš„è™Ÿç¢¼å€¼,å°æ¨£æ¯å€‹æ¨£æœ¬é»ã€‚\nå¦‚æœæ˜¯x,y ploté€™å€‹axis()ç„¡ä½œç”¨,é€™è£¡åªç”¨åˆ°Yã€‚\npdf z_scores \u0026lt;- seq(-3, 3, by = .1) dvalues \u0026lt;- dnorm(z_scores) plot(dvalues, # Plot where y = values and x = index of the value in the vector xaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis type = \u0026quot;l\u0026quot;, # Make it a line plot main = \u0026quot;pdf of the Standard Normal\u0026quot;, xlab= \u0026quot;Z-score\u0026quot;) # These commands label the x-axis axis(1, at=which(dvalues == dnorm(0)), labels=c(0)) axis(1, at=which(dvalues == dnorm(1)), labels=c(-1, 1)) axis(1, at=which(dvalues == dnorm(2)), labels=c(-2, 2))  pnorm pnorm(2) ## [1] 0.9772499  #\u0026gt; [1] 0.9772499  pnorm(2, mean = 5, sd = 3) ## [1] 0.1586553  #\u0026gt; [1] 0.1586553  pnorm(2, mean = 5, sd = 3, lower.tail = FALSE)  #\u0026gt; [1] 0.8413447  compare oldpar \u0026lt;- par() par(mfrow=c(1,2)) z_scores \u0026lt;- seq(-3, 3, by = .1) pvalues \u0026lt;- pnorm(z_scores) quantiles \u0026lt;- seq(0, 1, by = .05) qvalues \u0026lt;- qnorm(quantiles) # Plot the z_scores plot(qvalues, type = \u0026quot;l\u0026quot;, # We want a line graph xaxt = \u0026quot;n\u0026quot;, # No x-axis xlab=\u0026quot;Probability Density\u0026quot;, ylab=\u0026quot;Z-scores\u0026quot;) # Same pnorm plot from before plot(pvalues, # Plot where y = values and x = index of the value in the vector xaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis type = \u0026quot;l\u0026quot;, # Make it a line plot main = \u0026quot;cdf of the Standard Normal\u0026quot;, xlab= \u0026quot;Quantiles\u0026quot;, ylab=\u0026quot;Probability Density\u0026quot;) # These commands label the x-axis axis(1, at=which(pvalues == pnorm(-2)), labels=round(pnorm(-2), 2)) axis(1, at=which(pvalues == pnorm(-1)), labels=round(pnorm(-1), 2)) axis(1, at=which(pvalues == pnorm(0)), labels=c(.5)) axis(1, at=which(pvalues == pnorm(1)), labels=round(pnorm(1), 2)) axis(1, at=which(pvalues == pnorm(2)), labels=round(pnorm(2), 2))   qnorm(0.95) ?\n ä¸€å€‹æ¨™æº–å·®å äº†ä½”äº†å¤šå°‘ç™¾åˆ†æ¯”?\n  \r\r\rhint\r1. zscore of 95 percent 1. percent\u0026lt;-pnorm(1)-pnorm(-1) simulate 1    èº«é«˜ å¥³ç”Ÿ ç”·ç”Ÿ      1 0   å¹³å‡ 180 170   æ¨™æº–å·® 10 10    fn_num\u0026lt;-100 fh\u0026lt;-rnorm(fn_num,180,10) fm\u0026lt;-rnorm(200-fn_num,170,10) height\u0026lt;-c(fh,fm) sex\u0026lt;-c(rep(1,fn_num),rep(0,200-fn_num)) r1\u0026lt;-tapply(height, sex,mean) r1  #\u0026gt; 0 1 #\u0026gt; 169.6954 180.7886  fn_num_set\u0026lt;-sample(1:199,1000,replace=T) #å…ˆæŠ½å‡ºfemaleçš„å€‹æ•¸ rst\u0026lt;-matrix(rep(0,2000),ncol=2) #æ¯ä¸€æ¬¡æŠ½æ¨£ç”·ç”Ÿ/å¥³ç”Ÿçš„å¹³å‡å€¼ for(idx in 1:1000) { fn_num \u0026lt;-fn_num_set[idx] fh\u0026lt;-rnorm(fn_num,180,10) fm\u0026lt;-rnorm(200-fn_num,170,10) height\u0026lt;-c(fh,fm) sex\u0026lt;-c(rep(1,fn_num),rep(0,200-fn_num)) r1\u0026lt;-tapply(height, sex,mean) rst[idx,1]=r1[1] rst[idx,2]=r1[2] } summary(rst)  #\u0026gt; V1 V2 #\u0026gt; Min. :159.9 Min. :169.3 #\u0026gt; 1st Qu.:169.3 1st Qu.:179.3 #\u0026gt; Median :170.0 Median :180.0 #\u0026gt; Mean :170.0 Mean :180.0 #\u0026gt; 3rd Qu.:170.7 3rd Qu.:180.7 #\u0026gt; Max. :193.6 Max. :193.4  ä¸‹é¢é€™å€‹,å¥½åƒåœ¨rmarkdown ç•«ä¸å‡ºä¾†\nunknown reason !!\nalist\u0026lt;-list(rst[,1],rst[,2]) dinfo\u0026lt;-lapply(alist,density) t1\u0026lt;-sapply(dinfo,function(item){range(item$x)}) rx\u0026lt;-range(t1) t2\u0026lt;-sapply(dinfo,function(item){range(item$y)}) ry\u0026lt;-range(t2) plot(dinfo[[1]], xlim = rx, ylim = ry, main = \u0026quot;\u0026quot;) for(i in 1:length(dinfo)) { lines(dinfo[[i]], xlim = rx, ylim = ry, col = i) }  è½‰å‡½æ•¸\nç¸½é«”è€Œè¨€ï¼Œè½‰æˆå‡½æ•¸çš„è€ƒæ…®å°±æ˜¯å¦‚ä½•é¿å…hard codingã€‚\nplot.multi.density\u0026lt;-function (alist) { dinfo\u0026lt;-lapply(alist,density)#æ¯çµ„è³‡æ–™ï¼Œæ±‚density # æ¯çµ„è³‡æ–™çš„xç¯„åœ t1\u0026lt;-sapply(dinfo,function(item){range(item$x)}) rx\u0026lt;-range(t1) # æ¯çµ„è³‡æ–™çš„yç¯„åœ t2\u0026lt;-sapply(dinfo,function(item){range(item$y)}) ry\u0026lt;-range(t2) plot(dinfo[[1]],xlim = rx, ylim = ry, main = \u0026quot;\u0026quot;) for(i in 1:length(dinfo)) { lines(dinfo[[i]],xlim = rx, ylim = ry, col = i) } }  è¨è«–ï¼šä¸Šé¢å‡½æ•¸çš„é™åˆ¶ï¼Ÿ\nç¬¬ä¸€å€‹é™åˆ¶ï¼Œå…ˆçœ‹çœ‹æœ‰æ²’æœ‰é è¨­çµ„åˆ¥\nå•é¡Œï¼šå¦‚æœè¦åŠ ä¸Šå€åŸŸé¡è‰²ï¼Ÿ\nç°¡å–®ä¸€é»çš„è©±ï¼Œå¯ä»¥ç”¨é¸é …type=\u0026quot;h\u0026quot;, (plot, lineå…©å€‹å‡½æ•¸éƒ½åƒ)\næ‡‰ç”¨è‡ªå·±çš„å‡½æ•¸\nalist\u0026lt;-list(rst[,1],rst[,2]) plot.multi.density(alist)  ä¸Šé¢çš„å‡½æ•¸ï¼Œé è¨­åƒæ•¸æ˜¯å‚³å…¥ä½¿ç”¨è€…æŒ‡å®šçš„listï¼Œè£¡é¢æœ‰ä½¿ç”¨è€…æŒ‡å®šçš„çµ„åˆ¥\nä½†æ˜¯å¦‚æœå› ç‚ºéœ€è¦ï¼Œç™¼ç¾å‚³å…¥çŸ©é™£æ¯”è¼ƒæ–¹ä¾¿ï¼ˆä¾‹å¦‚æ¯ä¸€å€‹æ¬„ä½ä»£è¡¨æ¯ä¸€çµ„çš„æ¨¡æ“¬çµæœï¼Œé‚£æ¨£æ€æ¨£é¿å…hard coding?\nelist\u0026lt;-vector(\u0026quot;list\u0026quot;,ncol(rst))#æŒ‡å®šå¤§å°çš„list,å¦‚æœç©ºé›†åˆelist\u0026lt;-list() for(i in 1:ncol(rst)){ elist[[i]]\u0026lt;-rst[,i] #æ³¨æ„é›™æ‹¬è™Ÿ }  ä¹‹å‰æœ‰æéï¼Œå¤§éƒ¨åˆ†çš„æ–‡ä»¶éƒ½æ˜¯èªªå–®/é›™æ‹¬è™Ÿçš„å·®åˆ¥æ˜¯å‰è€…æ‹¿åˆ°çš„ä»ç„¶æ˜¯list,å¾Œè€…æ‹¿åˆ°çš„æ˜¯å…§å®¹ã€‚\nä½†æ˜¯ä»¥ç¨‹å¼èªè¨€çš„çœ¼å…‰ä¾†çœ‹ï¼Œæˆ‘å€‘å…ˆèªªå‡¡æ˜¯é™£åˆ—ï¼Œå…¶å…ƒç´ çš„å‹æ…‹éƒ½åªèƒ½æ”¾ä¸€æ¨£ï¼ˆä¹Ÿå°±æ˜¯å¤§å°å›ºå®šï¼‰ï¼Œä½†æ˜¯ç¾åœ¨listçš„å…ƒç´ å‹æ…‹å¯ä»¥ä¸å–®ä¸€ï¼Œå› æ­¤ï¼Œç·¨è­¯å™¨ç„¡æ³•çŸ¥é“å¦‚ä½•æŒ‡æ´¾å¤§å°ï¼Œè§£æ±ºè¾¦æ³•å°±æ˜¯æ¯ä¸€å€‹å…ƒç´ å…¶å¯¦éƒ½æ˜¯ä¸€å€‹æŒ‡æ¨™ã€‚\nï¼ˆtodo: éœ€è¦ä¸€å€‹åœ–ï¼‰\r\r\råˆ©ç”¨å¥—ä»¶sm The sm package also includes a way of doing multiple density plots. The data must be in a data frame.\nlibrary(sm)  #\u0026gt; Warning: package 'sm' was built under R version 4.0.5  #\u0026gt; Package 'sm', version 2.2-5.6: type help(sm) for summary information  rstdf\u0026lt;-data.frame(rst) colnames(rstdf)\u0026lt;-c(\u0026quot;male\u0026quot;,\u0026quot;female\u0026quot;) sm.density.compare(rstdf$male, rstdf$female) # Add a legend (the color numbers start from 2 and go up) #legend(\u0026quot;topright\u0026quot;, levels(data$cond), fill=2+(0:nlevels(data$cond)))  sm ç¯„ä¾‹ sm.density.compare(iris$Sepal.Length, iris$Species, xlab=\u0026quot;Species\u0026quot;) title(main=\u0026quot;Distributions of Species\u0026quot;)  x \u0026lt;- seq(from = 110, to = 174, by = 0.5) y1 \u0026lt;- dnorm(x, mean = 145, sd = 9) y2 \u0026lt;- dnorm(x, mean = 138, sd = 8) plot(x, y1, type=\u0026quot;l\u0026quot;, lwd=2, col=\u0026quot;red\u0026quot;, main=\u0026quot;Systolic Blood Pressure Before and After Treatment\u0026quot;, xlab = \u0026quot;Systolic Blood Pressure (mmHg)\u0026quot;, ylab = \u0026quot;Frequency\u0026quot;, yaxt=\u0026quot;n\u0026quot;, xlim = c(110, 175), ylim = c(0, 0.05)) lines(x, y2) polygon(c(110,x,175),c(0,y2,0), col=\u0026quot;firebrick3\u0026quot;, border = \u0026quot;black\u0026quot;) polygon(c(117,x,175),c(0,y1,0), col=\u0026quot;dodgerblue4\u0026quot;, border = \u0026quot;black\u0026quot;) ylab=c(seq(from=0, to=175, by=25)) y=c(seq(from=0, to=0.05, length.out = 8)) axis(2,at=y,labels=ylab, las=1)#ä¸‹å·¦ï¼ˆ2ï¼‰ï¼Œåœ¨yå‘é‡ä¸Šæ¨™ylab,las æ–‡å­—å’Œåº§æ¨™çš„è§’åº¦ text(x = 120, y = 0.045, \u0026quot;- Pre-Treatment BP\u0026quot;, col = \u0026quot;dodgerblue4\u0026quot;, cex = 0.9) text(x = 120, y = 0.04, \u0026quot; - Post-Treatment BP\u0026quot;, col = \u0026quot;firebrick3\u0026quot;, cex = 0.9) points(109, 0.0445, pch = 15, col = \u0026quot;dodgerblue4\u0026quot;) points(109, 0.0395, pch = 15, col = \u0026quot;firebrick3\u0026quot;)  å…¶ä»–æ¸¬è©¦\nx \u0026lt;- seq(-2, 2, 0.05) y1 \u0026lt;- pnorm(x) y2 \u0026lt;- pnorm(x,1,1) plot(x,y1,type=\u0026quot;l\u0026quot;,col=\u0026quot;red\u0026quot;) lines(x,y2,col=\u0026quot;green\u0026quot;)  plot( x, y1, type=\u0026quot;l\u0026quot;, col=\u0026quot;red\u0026quot; ) par(new=TRUE) plot( x, y2, type=\u0026quot;l\u0026quot;, col=\u0026quot;green\u0026quot; )  note: add=TRUE æœ‰æ™‚å€™ä¸ä½œç”¨ï¼Œä¾‹å¦‚plot\nhist( y1 ,col=\u0026quot;red\u0026quot; ) hist( y2, add=TRUE,col=\u0026quot;blue\u0026quot; )  "},
{"uri": "https://airbone4.github.io/blogR/rlang/11_environments.html","title": "11 Environments",
	"tags": [],
	"description": "é€²éš",
	"content": "åƒè€ƒ\nhttps://holtzy.github.io/Pimp-my-rmd/\nIntroduction The environment is the data structure that powers scoping. ç›¸é—œæ¦‚å¿µ:lexical scoping, namespaces, and R6 classesã€‚\né€™å€‹æ–‡ä»¶éœ€è¦\ndevtools::install_github(\u0026quot;tidyverse/rlang\u0026quot;)\nQuiz If you can answer the following questions correctly, you already know the most important topics in this chapter. You can find the answers at the end of the chapter in answers.\n List at least three ways that an environment is different to a list.\n What is the parent of the global environment? What is the only environment that doesn't have a parent?\n What is the enclosing environment of a function? Why is it important?\n How do you determine the environment from which a function was called?\n How are \u0026lt;- and \u0026lt;\u0026lt;- different?\n  Outline  Environment basics introduces you to the basic properties of an environment and shows you how to create your own.\n Recursing over environments provides a function template for computing with environments, illustrating the idea with a useful function.\n Explicit environments briefly discusses three places where environments are useful data structures for solving other problems.\n  Prerequisites é€™å€‹ç« ç¯€åˆ©ç”¨äº†å¥—ä»¶rlangè£¡çš„å‡½æ•¸ï¼Œä¾†æ¢ç´¢ç’°å¢ƒç‰©ä»¶ã€‚\nåœ¨rlangå¥—ä»¶ä¸­,env_å‡½æ•¸æ˜¯è¨­è¨ˆç”¨ä¾†å’Œpipeä¸€èµ·å·¥ä½œçš„,é€™è£¡ä¸æ·±å…¥ã€‚\nglobal_env()å’Œglobalenv()çš„åŸ·è¡Œçµæœä¸€æ¨£ã€‚\n.GlobalEnv   #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  globalenv()   #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  global_env()   #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  .BaseNamespaceEnv   #\u0026gt; \u0026lt;environment: namespace:base\u0026gt;  current_env() #   #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  \r\råŸºæœ¬ åŸºæœ¬ä¸Šä¸€å€‹ environment é¡ä¼¼åç¨±ä¸²åˆ—(named list),ä½†æ˜¯æœ‰4å€‹ä¾‹å¤–:\n åç¨±å”¯ä¸€(å°±æ˜¯è®Šæ•¸å”¯ä¸€)\n åç¨±æ²’æœ‰é †åºé—œä¿‚\n æœƒæœ‰ä¸€å€‹parent\n ç•¶æ”¹è®Šçš„æ™‚å€™,ä¸æœƒè‡ªå‹•è¤‡è£½ (Environments are not copied when modified).\n  åˆ†åˆ¥æ¢ç´¢ä¸Šé¢å››é»:\næè¦ è¦å»ºç«‹environment, ä½¿ç”¨ rlang::env(). é¡ä¼¼ä½¿ç”¨list(),ä¹Ÿæ˜¯ä¸€çµ„åç¨±-å€¼çš„é…å°ã€‚:\ne1 \u0026lt;- env( a = FALSE, b = \u0026quot;a\u0026quot;, c = 2.3, d = 1:3 )  å»ºç«‹environmentç‰©ä»¶,åˆ©ç”¨å‡½æ•¸ new.env() ä¸ç”¨ç®¡åƒæ•¸ hash å’Œ sizeã€‚æ³¨æ„ä¸èƒ½åˆ©ç”¨\u0026lt;-åŒæ™‚å®šç¾©å’Œå»ºç«‹ parameters; ä¾‹å¦‚,\ne1 \u0026lt;- env( a \u0026lt;- FALSE ) # error\r\r\renvironmentç‰©ä»¶å¯ä»¥æƒ³æˆæ˜¯ä¸€å€‹è¢‹å­,æˆ–æ˜¯namesé›†åˆã€‚å› ç‚ºæ²’æœ‰æ¬¡åºé—œä¿‚\n\rå°±åƒåœ¨ names and values, è¨è«–çš„,é€™å€‹ç‰©ä»¶æ˜¯åƒè€ƒç‚ºåŸºç¤.(in C concept) ä¸æœƒæœ‰copy on modifyingã€‚è€Œä¸”,ç’°å¢ƒç‰©ä»¶å¯ä»¥è‡ªå·±æŒ‡å‘è‡ªå·±(recursion)\ne1$d \u0026lt;- e1  \ræ²’æœ‰æŒ‡æ´¾çš„ç’°å¢ƒè®Šæ•¸,åªæœƒé¡¯ç¤ºè¨˜æ†¶é«”ä½å€:\ne1  #\u0026gt; \u0026lt;environment: 0x000000001a1c5598\u0026gt;  è¦çŸ¥é“å…§å®¹å¯ä»¥ä½¿ç”¨ env_print() :\nenv_print(e1)  #\u0026gt; \u0026lt;environment: 000000001A1C5598\u0026gt; #\u0026gt; parent: \u0026lt;environment: global\u0026gt; #\u0026gt; bindings: #\u0026gt; * a: \u0026lt;lgl\u0026gt; #\u0026gt; * b: \u0026lt;chr\u0026gt; #\u0026gt; * c: \u0026lt;dbl\u0026gt; #\u0026gt; * d: \u0026lt;env\u0026gt;  æƒ³è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›binding(åç¨±-å€¼ é…å°)å¯ä»¥åˆ©ç”¨ env_names()\nenv_names(e1)  #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot;  è¦åˆ—å‡ºç’°å¢ƒä¸‹çš„ç¹«çµï¼Œåœ¨R 3.2.0 ä»¥ä¸Š,å¯ä»¥ä½¿ç”¨å‡½æ•¸names() ,ä¹‹å‰çš„ç‰ˆæœ¬å‰‡æ˜¯ ls(), ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ls çš„åƒæ•¸ all.names å…§è¨­æ˜¯ FALSE å› æ­¤.é–‹é ­çš„çœ‹ä¸åˆ°ã€‚.\r\r\rImportant environments å¦å¤–åƒè€ƒ [Special environments]ã€‚\ncurrent_env() å¯ä»¥çŸ¥é“ç›®å‰ç¨‹å¼ç¢¼çš„åŸ·è¡Œç’°å¢ƒã€‚ä¾‹å¦‚,ç•¶æˆ‘å€‘äº’å‹•åŸ·è¡ŒRCODEçš„æ™‚å€™,ç’°å¢ƒé€šå¸¸æ˜¯ ç¸½é«”ç’°å¢ƒ,æˆ–è€…ç”±å‡½æ•¸global_env()å¯ä»¥å¾—åˆ°ã€‚é€™å€‹ç¸½é«”ç’°å¢ƒæœ‰æ™‚å€™å°±å«\u0026quot;workspace\u0026quot;ï¼ŒåŒæ™‚,é€™ä¹Ÿæ˜¯å‡½æ•¸å¤–é¢æ‰€æœ‰äº’å‹•è¨ˆç®—ç™¼ç”Ÿçš„åœ°æ–¹ã€‚\nç’°å¢ƒç‰©ä»¶çš„æ¯”è¼ƒä¸èƒ½ç”¨==,åªèƒ½ç”¨å‡½æ•¸identical()ã€‚\nidentical(global_env(), current_env())  #\u0026gt; [1] TRUE  global_env() == current_env()  #\u0026gt; Error in global_env() == current_env(): åªæœ‰åŸºå…ƒæˆ–ä¸²åˆ—é¡å‹æ‰èƒ½åšæ¯”è¼ƒ (1)   globalenv() å’Œ.GlobalEnv: æ‹¿åˆ°global environmentandã€‚\n environment():æ‹¿åˆ°ç›®å‰çš„ç’°å¢ƒ\n  global environment çš„åç¨±ç‚º R_GlobalEnv ã€‚\nglobal_env()  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  current_env()  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  .GlobalEnv  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  \r\rParents æ¯ä¸€å€‹ç’°å¢ƒç‰©ä»¶éƒ½æœ‰ä¸€å€‹ parentã€‚ parent ä¹Ÿä¸€å€‹ç’°å¢ƒç‰©ä»¶ã€‚åœ¨æ–¹å¡Šåœ–ä¸­,parentä»¥è—è‰²åœˆè¡¨ç¤º,ä¸¦ç”¨ç®­é ­æŒ‡å‘å¦ä¸€å€‹ç’°å¢ƒç‰©ä»¶ã€‚\né€™å€‹parentç”¨ä¾†å»ºç«‹ lexical scoping: å¦‚æœnameæ²’æœ‰åœ¨æŸå€‹ç’°å¢ƒç‰©ä»¶æ‰¾åˆ°,Ræœƒé‡è¤‡çš„åœ¨parentä¸­æ‰¾ã€‚\nå‡½æ•¸env()å¯ä»¥ç”¨ä¾†å»ºç«‹ä¸€å€‹æ²’æœ‰åå­—çš„ç’°å¢ƒ\nYou can set the parent environment by supplying an unnamed argument to env(). If you don't supply it, it defaults to the current environment.\ne2a \u0026lt;- env(d = 4, e = 5) e2b \u0026lt;- env(e2a, a = 1, b = 2, c = 3)  \r\re2bçš„parent ç‚ºe2a,e2aæ²’æœ‰parentã€‚\nå‡½æ•¸ env_parent()å¯ä»¥ç”¨ä¾†æ‰¾å‡ºæŸå€‹ç’°å¢ƒç‰©ä»¶çš„parent:\nenv_parent(e2b)  #\u0026gt; \u0026lt;environment: 0x000000001a79fb30\u0026gt;  env_parent(e2a)  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  parent.env() === env_parent()\r\r\ræ‰€æœ‰çš„ç’°å¢ƒç‰©ä»¶ä¸­åªæœ‰ä¸€å€‹åç¨±ç‚ºR_EmptyEnvçš„ç‰©ä»¶æ²’æœ‰parent(ç”¨ç©ºå¿ƒè—è‰²è¡¨ç¤º):\ne2c \u0026lt;- env(empty_env(), d = 4, e = 5) e2d \u0026lt;- env(e2c, a = 1, b = 2, c = 3)  \remptyenv() === empty_env()\r\r\rè©¦åœ–åˆ©ç”¨å‡½æ•¸env_parent()æ‰¾ç©ºç’°å¢ƒç‰©ä»¶çš„parentæœƒç™¼ç”ŸéŒ¯èª¤:\nenv_parent(empty_env())  #\u0026gt; Error: The empty environment has no parent  å‡½æ•¸ env_parents()å¯ä»¥æ‰¾å‡ºç›®å‰ç’°å¢ƒç‰©ä»¶çš„æ‰€æœ‰ç¥–å…ˆ:é€™å€‹å‡½æ•¸æœƒç¹¼çºŒç›´åˆ°é‡ä¸Šglobal environment æˆ–æ˜¯ç©ºç’°å¢ƒç‰©ä»¶ã€‚ä¸Šè¿°éç¨‹å¯ä»¥åˆ©ç”¨lastç’°å¢ƒç‰©ä»¶æ§åˆ¶ã€‚\nenv_parents(e2b)  #\u0026gt; [[1]] \u0026lt;env: 000000001A79FB30\u0026gt; #\u0026gt; [[2]] $ \u0026lt;env: global\u0026gt;  env_parents(e2d)  #\u0026gt; [[1]] \u0026lt;env: 00000000199A7800\u0026gt; #\u0026gt; [[2]] $ \u0026lt;env: empty\u0026gt;  å¯ä»¥åˆ©ç”¨Use parent.env() æ‰¾åˆ°ç’°å¢ƒçš„parentï¼Œä½†æ˜¯baseä¸­æ²’æœ‰å¯ä»¥æ‰¾å‡ºæ‰€æœ‰ç¥–å…ˆçš„å‡½æ•¸ã€‚\r\r\rGetting and setting å­˜å–ç’°å¢ƒä¸­å…ƒç´ çš„æ–¹æ³•å’Œlisté¡ä¼¼:ä½¿ç”¨ $ å’Œ [[:\ne3 \u0026lt;- env(x = 1, y = 2) e3$x  #\u0026gt; [1] 1  e3$z \u0026lt;- 3 e3[[\u0026quot;z\u0026quot;]]  #\u0026gt; [1] 3  ä½†æ˜¯ä¸èƒ½ä½¿ç”¨ [[ +æ•¸å­—ç´¢å¼•,ä¹Ÿä¸èƒ½å–®ç¨ä½¿ç”¨ [:\ne3[[1]]  #\u0026gt; Error in e3[[1]]: å–å­é›†ç’°å¢ƒæ™‚çš„å¼•æ•¸ä¸æ­£ç¢º  e3[c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)]  #\u0026gt; Error in e3[c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)]: 'environment' é¡å‹çš„ç‰©ä»¶ç„¡æ³•å…·æœ‰å­é›†åˆ  ç•¶ç’°å¢ƒä¸­çš„ç¹«çµä¸å­˜åœ¨æ™‚(ç°¡å–®é»,å°±æ˜¯è®Šæ•¸ä¸å­˜åœ¨æ™‚)$ å’Œ [[ æœƒå‚³å› NULL ä½†ä¸æœƒå¼•ç™¼éŒ¯èª¤,å¦‚æœè¦æœ‰éŒ¯èª¤è­¦å‘Š,å‰‡åˆ©ç”¨ env_get() :\ne3$xyz  #\u0026gt; NULL  env_get(e3, \u0026quot;xyz\u0026quot;)  #\u0026gt; Error in env_get(e3, \u0026quot;xyz\u0026quot;): ç¼ºå°‘å¼•æ•¸ \u0026quot;default\u0026quot;ï¼Œä¹Ÿæ²’æœ‰é è¨­å€¼  ç•¶ç¹«çµä¸å­˜åœ¨,ä½†æ˜¯æƒ³è¦æœ‰é è¨­å€¼å‚³å›æ™‚,å¯ä»¥åˆ©ç”¨åƒæ•¸ default .\nenv_get(e3, \u0026quot;xyz\u0026quot;, default = NA)  #\u0026gt; [1] NA  å¦æœ‰å…©ç¨®æ–¹å¼å¯ä»¥åœ¨ç’°å¢ƒç‰©ä»¶åŠ å…¥ç¹«çµ:\n env_poke()[^poke] takes a name (as string) and a value:\nenv_poke(e3, \u0026quot;a\u0026quot;, 100) e3$a  #\u0026gt; [1] 100  [^poke]: You might wonder why rlang has env_poke() instead of env_set().\nThis is for consistency: _set() functions return a modified copy;\n_poke() functions modify in place.\n env_bind() allows you to bind multiple values:\nenv_bind(e3, a = 10, b = 20) env_names(e3)  #\u0026gt; [1] \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;z\u0026quot; \u0026quot;a\u0026quot; \u0026quot;b\u0026quot;   env_has(): æ˜¯å¦ç’°å¢ƒä¸­æœ‰ç¹«çµ\nenv_has(e3, \u0026quot;a\u0026quot;)  #\u0026gt; a #\u0026gt; TRUE  ä¸èƒ½åƒæ˜¯listä¸­åˆªé™¤å…ƒç´ çš„æ–¹å¼(æŒ‡æ´¾NULLçµ¦å…ƒç´ )ï¼Œè€Œå¿…é ˆä½¿ç”¨ env_unbind():\ne3$a \u0026lt;- NULL env_has(e3, \u0026quot;a\u0026quot;)  #\u0026gt; a #\u0026gt; TRUE  env_unbind(e3, \u0026quot;a\u0026quot;) env_has(e3, \u0026quot;a\u0026quot;)  #\u0026gt; a #\u0026gt; FALSE  å¾ä¸€å€‹ç‰©ä»¶Unbinding è§£é™¤åç¨±ï¼Œä¸¦ä¸æœƒåˆªé™¤ç‰©ä»¶ï¼Œæ˜¯å¦åˆªé™¤ç‰©ä»¶æ˜¯ garbage collectorçš„å·¥ä½œ.ã€‚å¯ä»¥åƒè€ƒ GC.\nSee get(), assign(), exists(), and rm(). These are designed interactively for use with the current environment, so working with other environments is a little clunky. Also beware the inherits argument: it defaults to TRUE meaning that the base equivalents will inspect the supplied environment and all its ancestors.\r\r\rAdvanced bindings There are two more exotic variants of env_bind():\n env_bind_exprs() creates delayed bindings, which are evaluated the first time they are accessed. Behind the scenes, delayed bindings create promises, so behave in the same way as function arguments.\nenv_bind_exprs(current_env(), b = {Sys.sleep(1); 1})  #\u0026gt; Warning: `env_bind_exprs()` is deprecated as of rlang 0.3.0. #\u0026gt; Please use `env_bind_lazy()` instead. #\u0026gt; This warning is displayed once per session.  system.time(print(b))  #\u0026gt; [1] 1  #\u0026gt; user system elapsed #\u0026gt; 0.00 0.00 1.01  system.time(print(b))  #\u0026gt; [1] 1  #\u0026gt; user system elapsed #\u0026gt; 0 0 0  Delayed bindings are used to implement autoload(), which makes R behave\nas if the package data is in memory, even though it's only loaded from\ndisk when you ask for it.\n env_bind_fns() creates active bindings which are re-computed every time they're accessed:\nenv_bind_fns(current_env(), z1 = function(val) runif(1))  #\u0026gt; Warning: `env_bind_fns()` is deprecated as of rlang 0.3.0. #\u0026gt; Please use `env_bind_active()` instead. #\u0026gt; This warning is displayed once per session.  z1  #\u0026gt; [1] 0.8735626  z1  #\u0026gt; [1] 0.7209108  The argument to the function allows you to also override behaviour when the variable is set:\nenv_bind_fns(current_env(), z2 = function(val) { if (missing(val)) { 2 } else { stop(\u0026quot;Don't touch z2!\u0026quot;, call. = FALSE) } }) z2  #\u0026gt; [1] 2  z2 \u0026lt;- 3  #\u0026gt; Error: Don't touch z2!   See ?delayedAssign() and ?makeActiveBinding().\r\r\rExercises  List three ways in which an environment differs from a list.\n Create an environment as illustrated by this picture.\n\r Create a pair of environments as illustrated by this picture.\n\r Explain why e[[1]] and e[c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;)] don't make sense when e is\nan environment.\n Create a version of env_poke() that will only bind new names, never\nre-bind old names. Some programming languages only do this, and are known\nas single assignment languages.\n  Recursing over environments If you want to operate on every ancestor of an environment, it's often convenient to write a recursive function. This section shows you how, applying your new knowledge of environments to write a function that given a name, finds the environment where() that name is defined, using R's regular scoping rules.\nThe definition of where() is straightforward. It has two arguments: the name to look for (as a string), and the environment in which to start the search. (We'll learn why caller_env() is a good default in calling environments.)\nwhere \u0026lt;- function(name, env = caller_env()) { if (identical(env, empty_env())) { # Base case stop(\u0026quot;Can't find \u0026quot;, name, call. = FALSE) } else if (env_has(env, name)) { # Success case env } else { # Recursive case where(name, env_parent(env)) } }  3å€‹æƒ…æ³:\n The base case: åˆ°é”empty environment æ²’æœ‰parentç„¡æ³•ç¹¼çºŒ,æ‰€ä»¥ä¸Ÿå‡ºerror.\n The successful case: åœ¨envä¸­æ‰¾åˆ°name ï¼ŒæˆåŠŸ,æ‰€ä»¥å‚³å›envã€‚.\n The recursive case: åœ¨envä¸­æ‰¾ä¸åˆ°,ç¹¼çºŒåœ¨parentä¸­æ‰¾ã€‚.\n  These three cases are illustrated with these three examples:\nwhere(\u0026quot;yyy\u0026quot;)  #\u0026gt; Error: Can't find yyy  x \u0026lt;- 5 where(\u0026quot;x\u0026quot;)  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  where(\u0026quot;mean\u0026quot;)  #\u0026gt; \u0026lt;environment: base\u0026gt;  æƒ³åƒæœ‰å…©å€‹ç’°å¢ƒç‰©ä»¶(å¦‚åœ–):\ne4a \u0026lt;- env(empty_env(), a = 1, b = 2) e4b \u0026lt;- env(e4a, x = 10, a = 11)  \r where(a, e4a) will find a in e4a.\n where(\u0026quot;b\u0026quot;, e4a) doesn't find b in e4a, so it looks in its parent, e4b, and finds it there.\n where(\u0026quot;c\u0026quot;, e4a) looks in e4a, then e4b, then hits the empty environment and throws an error.\n  It's natural to work with environments recursively, so where() provides a useful template. Removing the specifics of where() shows the structure more clearly:\nf \u0026lt;- function(..., env = caller_env()) { if (identical(env, empty_env())) { # base case } else if (success) { # success case } else { # recursive case f(..., env = env_parent(env)) } }  Iteration vs recursion ä¹Ÿå¯ä»¥ç”¨è¿­ä»£çš„æ–¹å¼\nf2 \u0026lt;- function(..., env = caller_env()) { while (!identical(env, empty_env())) { if (success) { # success case return() } # inspect parent env \u0026lt;- env_parent(env) } # base case }  \r\rExercises  Modify where() to return all environments that contain a binding for\nname. Carefully think through what type of object the function will\nneed to return.\n Write a function called fget() that finds only function objects. It\nshould have two arguments, name and env, and should obey the regular\nscoping rules for functions: if there's an object with a matching name\nthat's not a function, look in the parent. For an added challenge, also\nadd an inherits argument which controls whether the function recurses up\nthe parents or only looks in one environment.\n  Special environments é€™è£¡è¨è«– package environments. ç„¶å¾Œæ¢è¨ç•¶å‡½æ•¸å»ºç«‹æ™‚,ç¶å…¥å‡½æ•¸çš„å‡½æ•¸ç’°å¢ƒã€‚é‚„æœ‰ç•¶å‡½æ•¸è¢«å‘¼å«æ™‚çš„åŸ·è¡Œç’°å¢ƒ(ephemeral)ã€‚\nå¥—è£ç’°å¢ƒä¸»è¦æ˜¯çœ‹é€™äº›ç’°å¢ƒå¦‚ä½•æ”¯æ´namespacesã€‚åŒæ™‚,namespaceè®“packageæ¯æ¬¡è¼‰å…¥çš„æ™‚å€™,éƒ½æœ‰ä¸€æ¨£çš„è¡Œç‚º,è€Œä¸å”®å…¶ä»–packagesè¼‰å…¥å…ˆå¾Œçš„å½±éŸ¿ã€‚\nå¥—ä»¶ç’°å¢ƒå’Œæœå°‹è·¯å¾‘ æ¯å€‹å¥—ä»¶ç¶“ç”±library() æˆ– require() æ¥å…¥æˆç‚ºç¸½é«”ç’°å¢ƒçš„parentã€‚è€Œæœ€å¾Œä¸€å€‹æ¥å…¥çš„å¥—ä»¶,å‰‡æ˜¯ç¸½é«”ç’°å¢ƒçš„ç¬¬ä¸€å€‹parent:\nload å’Œ attachä¸ä¸€æ¨£ï¼Œç•¶æˆ‘å€‘ä½¿ç”¨requireæˆ– libraryçš„æ™‚å€™,æˆ‘å€‘åšçš„æ˜¯attach ã€‚å°±æ˜¯åœ¨ç›®å‰(ä½¿ç”¨è€…)ç’°å¢ƒä¸²åˆ—ä¸­åŠ å…¥æˆ‘å€‘åˆ©ç”¨libraryè¼‰å…¥çš„ç‰©ä»¶.\n attaching and .onAttach\n thus means that a package is attached to the user space aka the global environment\n usually this is done via library(pkg) and\n you can use normal fun() syntax\n  loading and .onLoad\n thus means that package is (in any way) made available to the current R-session\n (e.g. by loading/attaching another package that depends on it or by using pkg::fun() syntax the first time)\n though you will not find functions in the global environment\n you can use pkg::fun()\n   \r\rä¾‹å¦‚æ‰¾å‡ºç¸½é«”ç’°å¢ƒçš„parent\nenv_parent(global_env())  #\u0026gt; \u0026lt;environment: package:rlang\u0026gt; #\u0026gt; attr(,\u0026quot;name\u0026quot;) #\u0026gt; [1] \u0026quot;package:rlang\u0026quot; #\u0026gt; attr(,\u0026quot;path\u0026quot;) #\u0026gt; [1] \u0026quot;C:/Users/linchao/Documents/R/win-library/4.0/rlang\u0026quot;  æ‰¾åˆ°æ˜¯æœ€è¿‘ä¸€æ¬¡,ä½¿ç”¨æŒ‡ä»¤library(packageA),è£¡é¢é€™å€‹packageAã€‚ä»¥æ­¤é¡æ¨,ä¸‹é¢æ‰¾å‡ºåœ¨packageAä¹‹å‰çš„å¥—ä»¶ç’°å¢ƒã€‚\nenv_parent(env_parent(global_env()))  #\u0026gt; \u0026lt;environment: package:stats\u0026gt; #\u0026gt; attr(,\u0026quot;name\u0026quot;) #\u0026gt; [1] \u0026quot;package:stats\u0026quot; #\u0026gt; attr(,\u0026quot;path\u0026quot;) #\u0026gt; [1] \u0026quot;C:/Program Files/R/R-4.0.3/library/stats\u0026quot;  å¦‚æœä¸€å±¤ä¸€å±¤parentå›æœ”,å°±å¯ä»¥åˆ°æ¯å€‹å¥—ä»¶è¢«æ¥å…¥çš„é †åº,é€™ä¹Ÿæ˜¯RåŸ·è¡Œä¸­æœƒç”¨åˆ°çš„ search path å› ç‚ºé€™äº›ç’°å¢ƒçš„æ‰€æœ‰ç‰©ä»¶éƒ½å¯ä»¥ç¶“ç”± top-level interactive workspaceæ‰¾åˆ°ã€‚\nsearch_envs()  #\u0026gt; [[1]] $ \u0026lt;env: global\u0026gt; #\u0026gt; [[2]] $ \u0026lt;env: package:rlang\u0026gt; #\u0026gt; [[3]] $ \u0026lt;env: package:stats\u0026gt; #\u0026gt; [[4]] $ \u0026lt;env: package:graphics\u0026gt; #\u0026gt; [[5]] $ \u0026lt;env: package:grDevices\u0026gt; #\u0026gt; [[6]] $ \u0026lt;env: package:utils\u0026gt; #\u0026gt; [[7]] $ \u0026lt;env: package:datasets\u0026gt; #\u0026gt; [[8]] $ \u0026lt;env: package:methods\u0026gt; #\u0026gt; [[9]] $ \u0026lt;env: Autoloads\u0026gt; #\u0026gt; [[10]] $ \u0026lt;env: package:base\u0026gt;  å‡½æ•¸ search()å¯ä»¥æ‰¾å‡ºç’°å¢ƒç‰©ä»¶çš„åç¨±ã€‚\r\r\ræœ€å¾Œå…©å€‹ç’°å¢ƒç‰©ä»¶éƒ½ä¸€æ¨£:\n Autoloads ç’°å¢ƒç‰©ä»¶,åˆ©ç”¨ delayed bindingsä¾†ç¯€çœè¨˜æ†¶é«”ï¼Œä¹Ÿå°±æ˜¯åœ¨éœ€è¦çš„æ™‚å€™æ‰è¼‰å…¥(loading)packageä¸­çš„ç‰©ä»¶(ä¾‹å¦‚å¤§å‹è³‡æ–™é›†)ã€‚\n base environment, package:base æˆ–ç°¡ç¨± base, æ˜¯base å¥—è£çš„ç’°å¢ƒç‰©ä»¶ã€‚ç”¨ä¾† è¼‰å…¥å…¶ä»–å¥—è£(bootstrap)ã€‚åˆ©ç”¨å‡½æ•¸ base_env()å­˜å–.\n  åˆ©ç”¨åœ–å‹è¡¨ç¤º:\n\rç•¶åˆ©ç”¨ library() attachå…¶ä»–å¥—ä»¶çš„æ™‚å€™, ç¸½é«”ç’°å¢ƒçš„parenté¦¬ä¸Šæ”¹è®Š:\n\rThe function environment ç•¶å‡½æ•¸è¢«å»ºç«‹çš„æ™‚å€™,ç¾æœ‰çš„ç’°å¢ƒæœƒè¢«ç¹«çµã€‚ç¨±ç‚ºfunction environment, ä¸»è¦ç”¨ä¾†æ”¯æ´lexical scoping. åœ¨é›»è…¦èªè¨€ä¸­,ç•¶å‡½æ•¸ç´€éŒ„å®ƒå€‘çš„é‹ä½œç’°å¢ƒæ™‚,æˆ‘å€‘èªªé€™å€‹å‡½æ•¸å±¬æ–¼ closuresã€‚,é€™ä¹Ÿæ˜¯ç‚ºç”šéº¼é€™å€‹å­—çœ¼ç¶“å¸¸åœ¨Rèªè¨€ä¸­å‡ºç¾ã€‚.\nåˆ©ç”¨å‡½æ•¸ fn_env()å¯ä»¥å¾—åˆ°å‡½æ•¸çš„ç’°å¢ƒç‰©ä»¶:\ny \u0026lt;- 1 f \u0026lt;- function(x) x + y fn_env(f)  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  ä¸€æ¨£åˆ©ç”¨å‡½æ•¸ environment(f) å¯ä»¥æ‰¾åˆ°å‡½æ•¸ fçš„ç’°å¢ƒ.\r\r\råœ¨åœ–å½¢ä¸­,å‡½æ•¸è¢«ç•«æˆé¡ä¼¼å­å½ˆ,è€Œå½ˆé ­çš„éƒ¨åˆ†ç¹«çµç’°å¢ƒã€‚\n\råœ¨é€™å€‹æ¡ˆä¾‹ä¸­,f()ç¹«çµçš„ç’°å¢ƒç‰©ä»¶,å°±æ˜¯ç¹«çµåç¨±fçš„ç’°å¢ƒã€‚ä½†ä¸¦ä¸ä¸€å®šç¸½æ˜¯é€™æ¨£ï¼Œä¾‹å¦‚åœ¨ä¸‹ä¸€å€‹ä¾‹å­ä¸­,gè¢«ç¹«çµåœ¨æ–°ç’°å¢ƒç‰©ä»¶eä¸­ã€‚ä½†æ˜¯å‡½æ•¸g()ç¹«çµçš„æ˜¯global environmentã€‚é€™ä¹‹é–“çš„åˆ†åˆ¥æ˜¯æˆ‘å€‘å¦‚ä½•æ‰¾åˆ°gå’Œgå¦‚ä½•æ‰¾åˆ°ä»–çš„è®Šæ•¸ã€‚\ne \u0026lt;- env() e$g \u0026lt;- function() 1  \rNamespaces åœ¨ä¸Šé¢çš„åœ–å½¢ä¸­,æˆ‘å€‘å·²ç¶“çŸ¥é“å¥—ä»¶çš„parentæœƒéš¨è‘—ä¹‹å‰å¥—ä»¶è¼‰å…¥çš„é †åºä¸åŒè€Œä¸åŒã€‚é€™å°±å°è‡´Rç¨‹å¼è¨­è¨ˆè€…å¿…é ˆä¿è­‰å€‹åˆ¥å¥—ä»¶ä¸Šå¦‚æœä½¿ç”¨åˆ¥çš„å¥—ä»¶çš„å‡½æ•¸ï¼Œå¿…é ˆæ˜¯åŸå§‹ç›®çš„çš„é‚£ä¸€å€‹ã€‚namespaces å°±æ˜¯ç‚ºæ­¤ç›®çš„è€Œç”¢ç”Ÿ: æ¯å€‹å¥—ä»¶å¿…é ˆçš„ä½¿ç”¨å¿…é ˆä¸€è‡´,è€Œä¸ç®¡ä½¿ç”¨è€…å¦‚ä½•è¼‰å…¥å¥—ä»¶.\nä»¥ sd()ç‚ºä¾‹å­:\nsd  #\u0026gt; function (x, na.rm = FALSE) #\u0026gt; sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), #\u0026gt; na.rm = na.rm)) #\u0026gt; \u0026lt;bytecode: 0x0000000021a5b210\u0026gt; #\u0026gt; \u0026lt;environment: namespace:stats\u0026gt;  sd() å¿…é ˆä½¿ç”¨å‡½æ•¸ var(), å› æ­¤é€™å€‹var()åˆ°åº•ä¾†è‡ª global environment,é‚„æ˜¯å…¶ä»–æ¥å…¥(attached)çš„å¥—ä»¶çš„é€™ç¨®å•é¡Œå¿…é ˆé¿å…ã€‚ R avoids this problem by taking advantage of the function vs. binding environment described above.\næ¯å€‹å¥—ä»¶ä¸­çš„å‡½æ•¸å’Œä¸€å°ç’°å¢ƒç‰©ä»¶æœ‰é—œ:å¥—ä»¶ç’°å¢ƒ(ä¹‹å‰å­¸åˆ°çš„)é‚„æœ‰ namespace ç’°å¢ƒç‰©ä»¶ã€‚\n package environment: æ˜¯å¥—ä»¶çš„å¤–éƒ¨ä»‹é¢ï¼Œé€™æ˜¯Rä½¿ç”¨è€…å¦‚ä½•åœ¨æ¥å…¥çš„å¥—ä»¶ä¸­å°‹æ‰¾å‡½æ•¸çš„åœ°æ–¹(æˆ–è€…å¯ä»¥åˆ©ç”¨ ::) package enviromnent çš„parent ç”±æœå°‹è·¯å¾‘æ±ºå®š(å¯ä»¥åˆ©ç”¨search()çŸ¥é“)æ±ºå®š(ä¹Ÿå°±æ˜¯è¼‰å…¥çš„é †åº)\n namespace environment:æ˜¯å¥—ä»¶çš„å…§éƒ¨ä»‹é¢ã€‚package environment æ§åˆ¶æˆ‘å€‘å¦‚ä½•æ‰¾åˆ°å‡½æ•¸,è€Œnamespace environmentæ§åˆ¶å‡½æ•¸å¦‚ä½•æ‰¾åˆ°è®Šæ•¸ã€‚\n  åœ¨package environmentçš„æ¯å€‹ç¹«çµä¹Ÿå¯ä»¥åœ¨namespace environmentä¸­æ‰¾åˆ°ã€‚é€™æ¨£å¯ä»¥ç¢ºä¿æ¯å€‹å‡½æ•¸å¯ä»¥ä½¿ç”¨å¥—ä»¶ä¸­çš„å…¶ä»–å‡½æ•¸ã€‚ä½†æ˜¯æœ‰äº›ç¹«çµåªèƒ½åœ¨namespace ä¸­æ‰¾åˆ°(ä¾‹å¦‚å…§éƒ¨æˆ–éè¼¸å‡ºç‰©ä»¶),é€™ç¨®å…§éƒ¨ç‰©ä»¶é€šå¸¸æ˜¯ç”¨ä¾†éš±è—ä¸€äº›ç¹ç‘£çš„ä¸”ä¸éœ€è¦çµ¦ä½¿ç”¨è€…çœ‹åˆ°çš„ç´°ç¯€ã€‚;\n\ræ¯å€‹namespace environment æœ‰ä¸€æ¨£çš„ç¥–é›†åˆ:\n æ¯å€‹namespaceæœ‰ imports çš„ç’°å¢ƒç‰©ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¥—ä»¶ä¸­ç”¨åˆ°çš„æ‰€æœ‰å‡½æ•¸ç¹«çµã€‚è€Œæ‰€è¬‚è¼¸å…¥ç’°å¢ƒå¯¦éš›ç”±å¥—è£é–‹ç™¼äººå“¡åœ¨æª”æ¡ˆNAMESPACEæŒ‡å®š\n æ˜ç¢ºçš„è¼¸å…¥æ¯å€‹baseå‡½æ•¸,å¾ˆç¹ç‘£,æ‰€ä»¥Rç›´æ¥è¨­å®šimport enviromentçš„parentæ˜¯base *namespae*[^1]ã€‚\n  The base namespace contains the same bindings as the base environment, but it has different parent.\r\r\r base namespace çš„parentæ˜¯ç¸½é«”ç’°å¢ƒ(#global environment).åƒè€ƒä¸‹åœ–,é€™ç¨®è¨­è¨ˆå°è‡´åœ¨import environmentä¸­æ‰¾ä¸åˆ°ç¹«çµæ™‚,æœƒé–‹å§‹å†ç¸½é«”ç’°å¢ƒä¸­å°‹æ‰¾,è€Œä¹‹å‰æéç¸½é«”ç’°å¢ƒé€šå¸¸æ˜¯äº’å‹•ç’°å¢ƒä¸‹åç¨±æœå°‹çš„é–‹å§‹è·¯å¾‘,é€™ä¹Ÿå°è‡´æœå°‹çš„æ–¹å¼å—åˆ°å¥—ä»¶è¼‰å…¥é †åºçš„å½±éŸ¿ã€‚å› æ­¤,Ræä¾›äº†äº†R CMD checkä¾†è­¦å‘Šæ­¤ç¨®æƒ…æ³çš„ç™¼ç”Ÿã€‚(é›–ç„¶æœ‰éº»ç…©,ä½†æ˜¯ç”±æ–¼S3 æ–¹æ³•çš„dispatch é—œä¿‚,æ­¤ç¨®æ–¹å¼ä»ç„¶ç•™è‘—)\n  \rç¶œåˆä¸Šè¿°,å¯ä»¥å¾—åˆ°ä¸‹åœ–::\n\ræ‰€ä»¥ç•¶ sd() æœå°‹var çš„å€¼çš„æ™‚å€™,æœå°‹é †åºæ˜¯å—åˆ°é–‹ç™¼è€…çš„æŒ‡å®š(åœ¨æª”æ¡ˆNAMESPACEåˆ©ç”¨import)ï¼Œè€Œä¸æœƒå—åˆ°å¥—è£ä½¿ç”¨è€…çš„å½±éŸ¿ã€‚é€™æ¨£ä¿è­‰æ¯æ¬¡å¥—ä»¶ç¨‹å¼ç¢¼åŸ·è¡Œçš„æ™‚å€™,éƒ½ä¸€æ¨£,è€Œä¸æœƒå—åˆ°ä¸€èˆ¬ä½¿ç”¨è€…è¼‰å…¥å¥—ä»¶çš„é †åºè€Œå½±éŸ¿ã€‚\næ³¨æ„åœ¨packageå’Œnamespaceå…©ç¨®ç’°å¢ƒä¹‹é–“æ²’æœ‰ç›´æ¥çš„é€£çµ.é€£çµæ˜¯ç”±*å‡½æ•¸ç’°å¢ƒ*å®šç¾©ã€‚\nExecution environments execution environment. ä¸‹é¢çš„å‡½æ•¸ç¬¬ä¸€æ¬¡åŸ·è¡Œçš„æ™‚å€™æœƒå‚³å›ç”šéº¼?ç¬¬2æ¬¡å‘¢?\ng \u0026lt;- function(x) { if (!env_has(current_env(), \u0026quot;a\u0026quot;)) { message(\u0026quot;Defining a\u0026quot;) a \u0026lt;- 1 } else { a \u0026lt;- a + 1 } a }  å†ä¸€æ¬¡åˆ©ç”¨ä¸‹é¢çš„èª¿ç”¨,ç¢ºèªä½ çš„ç­”æ¡ˆ:\ng(10)  #\u0026gt; Defining a  #\u0026gt; [1] 1  g(10)  #\u0026gt; Defining a  #\u0026gt; [1] 1  g(11)  #\u0026gt; Defining a  #\u0026gt; [1] 1  é€™å€‹å‡½æ•¸æ¯æ¬¡åŸ·è¡Œéƒ½å‚³å›ğŸ’¯ä¸€æ¨£çš„ç­”æ¡ˆ,åƒè€ƒ a fresh start. æ¯æ¬¡å‡½æ•¸è¢«èª¿ç”¨çš„æ™‚å€™,ä¸€å€‹æ–°çš„ç’°å¢ƒéƒ½æœƒè¢«å»ºç«‹ä¾†ä¸»å°åŸ·è¡Œã€‚é€™ç¨®ç’°å¢ƒç¨±ç‚º*åŸ·è¡Œç’°å¢ƒ*ã€‚è€Œ*åŸ·è¡Œç’°å¢ƒ*çš„parentç‚º function environment.\nç”¨å¦ä¸€å€‹ç°¡å–®é»çš„ä¾‹å­èªªæ˜.\n(åœ–ä¸­,åŸ·è¡Œç’°å¢ƒçš„parenté–“æ¥è¡¨ç¤º:ç¶“ç”±å‡½æ•¸ç’°å¢ƒ).\nh \u0026lt;- function(x) { # 1. a \u0026lt;- 2 # 2. x + a } y \u0026lt;- h(1) # 3.  \råŸ·è¡Œç’°å¢ƒ(execution environment)çŸ­æš«å­˜åœ¨,ç•¶å‡½æ•¸åŸ·è¡Œå®Œç•¢é€šå¸¸æœƒè¢«GCã€‚åœ¨å¹¾ç¨®æƒ…æ³ä¸‹,æœƒåœ¨è¨˜æ†¶é«”å­˜åœ¨æ¯”è¼ƒä¹…,ç¬¬ä¸€ç¨®æ˜¯å›å‚³çµ¦å¦ä¸€å€‹è®Šæ•¸:\nh2 \u0026lt;- function(x) { a \u0026lt;- x * 2 current_env() } e \u0026lt;- h2(x = 10) env_print(e)  #\u0026gt; \u0026lt;environment: 00000000225203C8\u0026gt; #\u0026gt; parent: \u0026lt;environment: global\u0026gt; #\u0026gt; bindings: #\u0026gt; * a: \u0026lt;dbl\u0026gt; #\u0026gt; * x: \u0026lt;dbl\u0026gt;  fn_env(h2)  #\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;  Another way to capture it is to return an object with a binding to that environment, like a function. The following example illustrates that idea with a function factory, plus(). We use that factory to create a function called plus_one().\nThere's a lot going on in the diagram because the enclosing environment of plus_one() is the execution environment of plus().\nplus \u0026lt;- function(x) { function(y) x + y } plus_one \u0026lt;- plus(1) plus_one  #\u0026gt; function(y) x + y #\u0026gt; \u0026lt;environment: 0x00000000228ead20\u0026gt;  \rWhat happens when we call plus_one()? Its execution environment will have the captured execution environment of plus() as its parent:\nplus_one(2)  #\u0026gt; [1] 3  \rYou'll learn more about function factories in functional programming.\nExercises  How is search_envs() different to env_parents(global_env())?\n Draw a diagram that shows the enclosing environments of this function:\nf1 \u0026lt;- function(x1) { f2 \u0026lt;- function(x2) { f3 \u0026lt;- function(x3) { x1 + x2 + x3 } f3(3) } f2(2) } f1(1)  Write an enhanced version of str() that provides more information\nabout functions. Show where the function was found and what environment\nit was defined in.\n  The call stack é‚„æœ‰å¦ä¸€ç¨®ç’°å¢ƒç¨±ç‚º caller environment, å¯ä»¥ç¶“ç”± rlang::caller_env()å­˜å–ã€‚. This provides the environment from which the function was called, and hence varies based on how the function is called, not how the function was created. As we saw above this is a useful default whenever you write a function that takes an environment as an argument.\nparent.frame() is equivalent to caller_env(); just note that it returns an environment, not a frame.\r\r\rTo fully understand the caller environment we need to discuss two related concepts: the call stack, which is made up of frames. Executing a function creates two types of context. You've learned about one already: the execution environment is a child of the function environment, which is determined by where the function was created. There's another type of context created by where the function was called: this is called the call stack.\nThere are also a couple of small wrinkles when it comes to custom evaluation. See environments vs. frames for more details.\nSimple call stacks Let's illustrate this with a simple sequence of calls: f() calls g() calls h().\nf \u0026lt;- function(x) { g(x = 2) } g \u0026lt;- function(x) { h(x = 3) } h \u0026lt;- function(x) { stop() }  The way you most commonly see a call stack in R is by looking at the traceback() after an error has occured:\nf(x = 1) #\u0026gt; Error: traceback() #\u0026gt; 4: stop() #\u0026gt; 3: h(x = 3) #\u0026gt; 2: g(x = 2) #\u0026gt; 1: f(x = 1)  Instead of stop() + traceback() to understand the call stack, we're going to use lobstr::cst() to print out the call stack tree:\nh \u0026lt;- function(x) { lobstr::cst() } f(x = 1) #\u0026gt; ??? #\u0026gt; ??îœ¿?Â€f(x = 1) #\u0026gt; ??îœ¿?Â€g(x = 2) #\u0026gt; ??îœ¿?Â€h(x = 3) #\u0026gt; ??îœ¿?Â€lobstr::cst()  This shows us that cst() was called from h(), which was called from g(), which was called from f(). Note that the order is the opposite from traceback(). As the call stacks get more compliated, I think it's easier to understand the sequence of calls if you start from the beginning, rather than the end (i.e. f() calls g(); rather than g() was called by f()).\nLazy evaluation The call stack above is simple - while you get a hint that there's some tree-like structure involved, everything happens on a single branch. This is typical of a call stack when all arguments are eagerly evaluated.\nLet's create a more complicated example that involves some lazy evaluation. We'll create a sequence of functions, a(), b(), c(), that pass along an argument x.\na \u0026lt;- function(x) b(x) b \u0026lt;- function(x) c(x) c \u0026lt;- function(x) x a(f()) #\u0026gt; ??? #\u0026gt; ??î°§?Â€a(f()) #\u0026gt; ??? ??îœ¿?Â€b(x) #\u0026gt; ??? ??îœ¿?Â€c(x) #\u0026gt; ??îœ¿?Â€f() #\u0026gt; ??îœ¿?Â€g(x = 2) #\u0026gt; ??îœ¿?Â€h(x = 3) #\u0026gt; ??îœ¿?Â€lobstr::cst()  x is lazily evaluated so this tree gets two branches. In the first branch a() calls b(), then b() calls c(). The second branch starts when c() evaluates its argument x. This argument is evaluated in a new branch because the environment in which it is evaluated is the global environment, not the environment of c().\nFrames Each element of the call stack is a frame1, also known as an evaluation context.\nThe frame is an extremely important internal data structure, and R code can only access a small part of the data structure because it's so critical. A frame has three main components that are accessible from R:\n An expression (labelled with expr) giving the function call. This is\nwhat traceback() prints out.\n An environment (labelled with env), which is typically the execution\nenvironment of a function. There are two main exceptions: the environment of\nthe global frame is the global environment, and calling eval() also\ngenerates frames, where the environment can be anything.\n A parent, the previous call in the call stack (shown by a grey arrow).\n  \r(To focus on the calling environments, I have omitted the bindings in the global environment from f, g, and h to the respective function objects.)\nThe frame also holds exit handlers created with on.exit(), restarts and handlers for the condition system, and which context to return() to when a function completes. These are important for the internal operation of R, but are not directly accessible.\nDynamic scope Looking up variables in the calling stack rather than in the enclosing environment is called dynamic scoping. Few languages implement dynamic scoping (Emacs Lisp is a notable exception.) This is because dynamic scoping makes it much harder to reason about how a function operates: not only do you need to know how it was defined, you also need to know the context in which it was called. Dynamic scoping is primarily useful for developing functions that aid interactive data analysis. It is one of the topics discussed in non-standard evaluation.\nExercises  Write a function that lists all the variables defined in the environment\nin which it was called. It should return the same results as ls().\n  As data structures As well as powering scoping, environments are also useful data structures in their own right because they have reference semantics. There are three common problems that they can help solve:\n Avoiding copies of large data. Since environments have reference semantics,\nyou'll never accidentally create a copy. This makes it a useful vessel for\nlarge objects. Bare environments are not that pleasant to work with;\nI recommend using R6 objects instead. Learn more in [R6].\n Managing state within a package. Explicit environments are useful in\npackages because they allow you to maintain state across function calls.\nNormally, objects in a package are locked, so you can't modify them\ndirectly. Instead, you can do something like this:\nmy_env \u0026lt;- new.env(parent = emptyenv()) my_env$a \u0026lt;- 1 get_a \u0026lt;- function() { my_env$a } set_a \u0026lt;- function(value) { old \u0026lt;- my_env$a my_env$a \u0026lt;- value invisible(old) }  Returning the old value from setter functions is a good pattern because\nit makes it easier to reset the previous value in conjunction with\non.exit() (see more in on exit).\n As a hashmap. A hashmap is a data structure that takes constant, O(1),\ntime to find an object based on its name. Environments provide this\nbehaviour by default, so can be used to simulate a hashmap. See the\nCRAN package hash for a complete development of this idea.\n  \u0026lt;\u0026lt;- The ancestors of an environment have an important relationship to \u0026lt;\u0026lt;-. The regular assignment arrow, \u0026lt;-, always creates a variable in the current environment. The deep assignment arrow, \u0026lt;\u0026lt;-, never creates a variable in the current environment, but instead modifies an existing variable found by walking up the parent environments.\nx \u0026lt;- 0 f \u0026lt;- function() { x \u0026lt;\u0026lt;- 1 } f() x  #\u0026gt; [1] 1  If \u0026lt;\u0026lt;- doesn't find an existing variable, it will create one in the global environment. This is usually undesirable, because global variables introduce non-obvious dependencies between functions. \u0026lt;\u0026lt;- is most often used in conjunction with a closure, as described in Closures.\nExercises  What does this function do? How does it differ from \u0026lt;\u0026lt;- and why\nmight you prefer it?\nrebind \u0026lt;- function(name, value, env = caller_env()) { if (identical(env, empty_env())) { stop(\u0026quot;Can't find `\u0026quot;, name, \u0026quot;`\u0026quot;, call. = FALSE) } else if (env_has(env, name)) { env_poke(env, name, value) } else { rebind(name, value, env_parent(env)) } } rebind(\u0026quot;a\u0026quot;, 10)  #\u0026gt; Error: Can't find `a`  a \u0026lt;- 5 rebind(\u0026quot;a\u0026quot;, 10) a  #\u0026gt; [1] 10   Quiz answers  There are four ways: every object in an environment must have a name;\norder doesn't matter; environments have parents; environments have\nreference semantics.\n The parent of the global environment is the last package that you\nloaded. The only environment that doesn't have a parent is the empty\nenvironment.\n The enclosing environment of a function is the environment where it\nwas created. It determines where a function looks for variables.\n Use caller_env() or parent.frame().\n \u0026lt;- always creates a binding in the current environment; \u0026lt;\u0026lt;-\nrebinds an existing name in a parent of the current environment.\n  term global environment :ç¸½é«”ç’°å¢ƒ package environments imports environment  NB: ?environment uses frame in a different sense: \u0026quot;Environments consist of a frame, or collection of named objects, and a pointer to an enclosing environment.\u0026quot;. We avoid this sense of frame, which comes from S, because it's very specific and not widely used in base R. For example, the \u0026quot;frame\u0026quot; in parent.frame() is an execution context, not a collection of named objects.\r[return]  "},
{"uri": "https://airbone4.github.io/blogR/rlang/1_1_%E5%9F%B7%E8%A1%8C.html","title": "1_1_åŸ·è¡Œ",
	"tags": [],
	"description": "1_1_run",
	"content": "\rå±•é–‹\rargs   echo $PATH #\u0026gt; /usr/local/bin:/usr/bin:/bin:/opt/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/c/progra~1/git/cmd:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_1_1_type_basic.html","title": "4.1.1 type basic",
	"tags": [],
	"description": "ä¸»è¦ä»‹ç´¹åŸºæœ¬èªæ³•",
	"content": " åŸºæœ¬æ“ä½œ  æ“ä½œé€šå¸¸å’Œè³‡æ–™çµæ§‹ç›¸é—œ,å¯ä»¥åƒè€ƒ è³‡æ–™çµæ§‹\n åœ¨Rèªè¨€ä¸­,å‹æ…‹ä¸é ˆç¶“éå®£å‘Š(declared)ã€‚ ä¸€å€‹è®Šæ•¸çš„å‹æ…‹ç¶“ç”±assignmentçš„éç¨‹æ±ºå®š,å³\u0026lt;-å³é‚Šçš„R-Objectsã€‚ä¹Ÿå°±æ˜¯åœ¨æŒ‡æ´¾è®Šæ•¸å€¼çš„æ™‚å€™,åŒæ™‚æ±ºå®šäº†å‹æ…‹ã€‚\nåŸºæœ¬çš„ R-objectæœ‰ âˆ’\n Vectors\n Lists\n Matrices\n Arrays\n Factors\n Data Frames\n  æœ€ç°¡å–®çš„æ˜¯vectorç‰©ä»¶,atomic vector æœ‰6ç¨®data types(æœ‰æ™‚ä¹Ÿå«åš 6 å€‹classes)\n   Data Type Example     Logical TRUE, FALSE   Numeric 1.3, 5, 99   Integer 3L, 24L, 0L   Complex 5 + 4i   Character 'b' , \u0026quot;good\u0026quot;, \u0026quot;TRUE\u0026quot;, '23.4'   Raw \u0026quot;Hello\u0026quot; is stored as 48 65 6c 6c 6f    æ•¸å­—(3ç¨®),é‚è¼¯,å­—å…ƒ(2ç¨®)\nv \u0026lt;- TRUE print(class(v)) #\u0026gt; [1] \u0026quot;logical\u0026quot; v \u0026lt;- 23.5 print(class(v)) #\u0026gt; [1] \u0026quot;numeric\u0026quot; v \u0026lt;- 2L print(class(v)) #\u0026gt; [1] \u0026quot;integer\u0026quot; v \u0026lt;- 2+5i print(class(v)) #\u0026gt; [1] \u0026quot;complex\u0026quot; v \u0026lt;- \u0026quot;TRUE\u0026quot; print(class(v)) #\u0026gt; [1] \u0026quot;character\u0026quot; v \u0026lt;- charToRaw(\u0026quot;Hello\u0026quot;) print(class(v)) #\u0026gt; [1] \u0026quot;raw\u0026quot;  æŒ‡æ´¾ é›–ç„¶ä¹Ÿå¯ä»¥ç”¨=ä½†æ˜¯ï¼ŒRçš„è¨­è¨ˆæ˜¯ä½¿ç”¨\u0026lt;-ã€‚\na \u0026lt;- 3  a\u0026lt;-3æ˜¯ä¸€å€‹æŒ‡æ´¾çš„æ•˜è¿°å¥,ä¸æœƒå›é¥‹è³‡è¨Šåˆ°è¢å¹•ä¸Šã€‚å¦‚æœè¦çŸ¥é“açš„å…§å®¹æ˜¯ç”šéº¼,å°±æ‰“å…¥a æˆ–è€…(a\u0026lt;-3)\na #\u0026gt; [1] 3 (a\u0026lt;-3) #\u0026gt; [1] 3  ä¸€èˆ¬çš„æ•¸å­¸å‡½æ•¸\nb \u0026lt;- sqrt(a * a + 5) b #\u0026gt; [1] 3.741657  åœ¨sessionä¸­çš„å¦‚æœè¦åˆ—å‡ºå·²ç¶“å®šç¾©éçš„è®Šæ•¸,å¯ä»¥åˆ©ç”¨ls\nls() #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;v\u0026quot;  æŒ‰ç…§Rçš„èªªæ˜,ç­‰è™Ÿåªèƒ½ç”¨åœ¨top level,æˆ–æ˜¯å‡½æ•¸åƒæ•¸çš„æŒ‡å®šã€‚\nåƒè€ƒ\nâ€¹function_nameâ€º(â€¹argnameâ€º = â€¹valueâ€º, â€¦) â€¹function_nameâ€º(â€¹argsâ€º, â€¹argnameâ€º = â€¹valueâ€º, â€¦)  é‹ç®— å››å‰‡é‹ç®— åƒè€ƒå¯¦éš›æ“ä½œ\nLogical Another important data type is the logical type. There are two predefined variables, TRUE and FALSE:\na = TRUE typeof(a) #\u0026gt; [1] \u0026quot;logical\u0026quot; b = FALSE typeof(b) #\u0026gt; [1] \u0026quot;logical\u0026quot;  Rèªè¨€å¸¸ç”¨é‚è¼¯é‹ç®—å­    operator èªªæ˜     \u0026lt; less than   \u0026gt; great than   \u0026lt;= less than or equal   \u0026gt;= greater than or equal   == equal to   != not equal to   | entry wise or   || or   ! not   \u0026amp; entry wise and   \u0026amp;\u0026amp; and   xor(a,b) exclusive or    ç¯„ä¾‹ï¼šä¸åŒçš„é‹ç®—å­ï¼Œåœ¨å€‹åˆ¥å…ƒç´ å’Œæ•´å€‹å‘é‡çš„é‹ç®—çµæœä¸ä¸€æ¨£ï¼š\na = c(TRUE, FALSE) b = c(FALSE, FALSE) a | b #\u0026gt; [1] TRUE FALSE a || b #\u0026gt; [1] TRUE xor(a, b) #\u0026gt; [1] TRUE FALSE  a||b åªæ¯”å°a,bä¸­çš„ç¬¬ä¸€å€‹å…ƒç´ ã€‚å› æ­¤åªæœ‰å€‹é•·åº¦ã€‚\n\u0026amp; å’Œ | æ¯”å°å…ƒç´ ,å‚³å›é•·åº¦ç‚ºå¤§å°æœ€é•·çš„é‚£å€‹ã€‚\n0ç‚ºFALSE,è€Œå…¶ä»–æ•¸å­—ç‚ºTRUEã€‚\nx \u0026lt;- c(TRUE,FALSE,0,6) y \u0026lt;- c(FALSE,TRUE,FALSE,TRUE) !x x\u0026amp;y x\u0026amp;\u0026amp;y x|y x||y  æç¤º\r \u0026gt; x \u0026lt;- c(TRUE,FALSE,0,6) #\u0026gt; [1] 1 0 0 6 \u0026gt; y \u0026lt;- c(FALSE,TRUE,FALSE,TRUE) #\u0026gt; [1] FALSE TRUE FALSE TRUE \u0026gt; !x #\u0026gt; [1] FALSE TRUE TRUE FALSE \u0026gt; x\u0026amp;y #\u0026gt; [1] FALSE FALSE FALSE TRUE \u0026gt; x\u0026amp;\u0026amp;y #\u0026gt; [1] FALSE \u0026gt; x|y #\u0026gt; [1] TRUE TRUE FALSE TRUE \u0026gt; x||y #\u0026gt; [1] TRUE  \r \u0026lt;-, \u0026lt;\u0026lt;-, = å‘å·¦æŒ‡æ´¾å€¼ã€‚\n -\u0026gt;, -\u0026gt;\u0026gt; å‘å³æŒ‡æ´¾å€¼ã€‚\n  å¤§éƒ¨åˆ†æƒ…æ³ä¸‹\u0026lt;- å’Œ = åœ¨ç›¸åŒçš„ç’°å¢ƒä¸‹ç­‰åƒ¹ã€‚\nè€Œ\u0026lt;\u0026lt;- ç”¨ä¾†æŒ‡æ´¾å€¼çµ¦è¦ªä»£ç’°å¢ƒä¸‹çš„è®Šæ•¸ã€‚\né‚è¼¯å‡½æ•¸ is.family å‡½æ•¸ï¼Œå¯ä»¥ç”¨ä¾†åˆ¤å®šè®Šæ•¸æ˜¯ä»€éº¼å‹æ…‹ï¼Œå‚³å›çœŸå‡å€¼ï¼Œä¾‹å¦‚\na = c(1, 2, 3) is.numeric(a) #\u0026gt; [1] TRUE is.factor(a) #\u0026gt; [1] FALSE  å‡½æ•¸identical(a,b)\na,b æ˜¯å¦ç›¸ç­‰,æ¯”è¼ƒçš„æ˜¯é™¤äº†a,bçš„å…§å®¹ä»¥å¤–,ğŸ’¡é‚„æœ‰a b çš„å‹æ…‹ã€‚ä¾‹å¦‚ï¼Œidentical(1,as.integer(1)) çµæœæ˜¯F,å› ç‚º å‰è€…æ˜¯double,å¾Œè€…æ˜¯æ•´æ•¸ã€‚\nA \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;D\u0026quot;) B \u0026lt;- A C \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;E\u0026quot;) identical(A,C) #\u0026gt; [1] FALSE  identical å…è¨±åªæ¯”è¼ƒæœ‰æ•ˆä½æ•¸ã€‚\nå‡½æ•¸which()å“ªäº›å…ƒç´ ä¸ä¸€è‡´\nwhich(A != C) #\u0026gt; [1] 2 4  å‡½æ•¸all()\nall(A==B) #\u0026gt; [1] TRUE all(A==C) #\u0026gt; [1] FALSE  which(),all()è£¡é¢çš„åƒæ•¸å…¶å¯¦éƒ½æ˜¯é‚è¼¯å‘é‡ã€‚\r\r\rè¨»è§£ï¼šä½†æ˜¯Rèªè¨€çš„å‘é‡é‹ç®—ï¼Œæ¶‰åŠè‡ªå‹•å¡«å……å¾ªç’°ï¼Œå› æ­¤æ³¨æ„ä¸‹é¢çš„è¨ˆç®—çµæœ\nD \u0026lt;- c(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;) E \u0026lt;- c(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;) all(D==E) #\u0026gt; [1] TRUE all(length(D)==length(E)) \u0026amp;\u0026amp; all(D==E) #\u0026gt; [1] FALSE  ç·´ç¿’ï¼š\nå°‡ä¸Šé¢å¯èƒ½é€ æˆèª¤åˆ¤çš„æƒ…æ³ï¼Œå¯«æˆå‡½æ•¸å…ˆåˆ¤æ–·æ˜¯å¦é•·åº¦ç›¸ç­‰ï¼Œç„¶å¾Œåˆ¤æ–·å…ƒç´ ç›¸ç­‰ï¼Œå¯ä»¥å’Œidentical()æ¯”è¼ƒã€‚\na \u0026lt;- character(0)\nidentical(a, character(0)) # returns TRUE\nidentical(a, \u0026quot;\u0026quot;) # returns FALSE\nidentical(a, numeric(0)) # returns also FALSE\nhint: åˆ©ç”¨length\n\r\rå¯¦æ•¸çš„æ¯”è¼ƒ x \u0026lt;- seq(0, 1, by = 0.2) y \u0026lt;- seq(0, 1, by = 0.2) y[4] #\u0026gt; [1] 0.6 x[3] #\u0026gt; [1] 0.4 1 - x[3] #\u0026gt; [1] 0.6 y[4] == 1 - x[3] #\u0026gt; [1] FALSE y[4] \u0026gt; 1 - x[3] #\u0026gt; [1] TRUE ## note: all.equal(y[4], 1 - x[3]) #\u0026gt; [1] TRUE ## Q: what is the result of : 1-0.4 ==0.6  0.1+0.2 == 0.3 #\u0026gt; [1] FALSE all.equal(0.1+0.2,0.3) #\u0026gt; [1] TRUE  nx1\u0026lt;-numeric(0) nx2\u0026lt;-3 is.null(nx1) # F,å› ç‚ºnx1æ˜¯ç©ºå‘é‡(é•·åº¦ç‚º0çš„æ•¸å­—å‘é‡) #\u0026gt; [1] FALSE is.na(nx1) # logical(0),æ¯å€‹å…ƒç´ æª¢æŸ¥æ˜¯ä¸æ˜¯NA,ä½†æ˜¯ç¾åœ¨æ˜¯ç©ºå‘é‡,æ‰€ä»¥çµæœæ˜¯logical(0) #\u0026gt; logical(0) typeof(nx1) # double #\u0026gt; [1] \u0026quot;double\u0026quot; typeof(nx2) # double #\u0026gt; [1] \u0026quot;double\u0026quot; length(nx1) # 0 #\u0026gt; [1] 0 length(nx2) # 1 #\u0026gt; [1] 1  ç”šéº¼æ™‚å€™ç”¨åˆ°is.nullæç¤º\r config \u0026lt;- list() is.null(config$name) #\u0026gt; [1] TRUE  \rvector åˆ©ç”¨cå‡½æ•¸ï¼Œå¯ä»¥ä½¿ç”¨vectorå­˜æ”¾ä¸€å€‹ä»¥ä¸Šçš„æ•¸å­—ã€‚\na = c(1, 2, 3, 4, 5) a1 = 1:5  æœ‰é—œlistçš„é‹ç®—:åŠ æ¸›ä¹˜é™¤ç­‰ç­‰\na = c(1, 2, 3, 4, 5) a+1 #\u0026gt; [1] 2 3 4 5 6  mean(a) #\u0026gt; [1] 3 var(a) #\u0026gt; [1] 2.5 summary(a) #\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 1 2 3 3 4 5  note:\nå°æ¯”stata sum a æŒ‡ä»¤,summary(a) è¿”å›çš„æ˜¯ä¸€å€‹tableç‰©ä»¶ã€‚å¯ä»¥æŒ‡æ´¾çµ¦è®Šæ•¸,å› æ­¤è¨ˆç®—çµæœå¯ä»¥ç¶“ç”±è®Šæ•¸(é¡åˆ¥ç‚ºtable)å­˜å–ã€‚\nlistçš„å…ƒç´ ,åˆ©ç”¨ä¸­æ‹¬è™Ÿ\na = 2:6 a[1] #\u0026gt; [1] 2 a[2] #\u0026gt; [1] 3 a[0] #\u0026gt; integer(0) a[6] #\u0026gt; [1] NA  åœ¨Rä¸­,çš„æœ€å°çš„ç´¢å¼•å€¼ç‚º1base.å¦‚æœçµ¦ç´¢å¼•ç‚º0,å¯ä»¥çŸ¥é“è³‡æ–™æ˜¯å¦è¢«æ’åºã€‚ è¶…å‡ºç´¢å¼•ç¯„åœå¾—åˆ°\u0026quot;NAã€‚\na=2:6 x = a[6]  å¦‚ä½•åˆ¤æ–·æ˜¯å¦NA\nx == NA #\u0026gt; [1] NA  ä¸Šé¢çš„æ¯”è¼ƒæ²’æœ‰æ„ç¾©,å’ŒNAçš„ä»»ä½•é‹ç®—éƒ½æ˜¯NA\nr = x == NA r #\u0026gt; [1] NA  çµè«–:ä»»ä½•è®Šæ•¸å’ŒNAé‹ç®—,çµæœé‚„æ˜¯NA\nå¦ä¸€ç¨®æ–¹æ³•\nprint(x == NA) #\u0026gt; [1] NA  å¦‚ä½•åˆ¤æ–·NA ? is.na()\nis.na(a[6]) #\u0026gt; [1] TRUE  \r\råˆå§‹åŒ–å‘é‡,å¯ä»¥åˆ©ç”¨a\u0026lt;-10 æˆ–æŒ‡å®šnumeric(double)å‹æ…‹\na \u0026lt;- numeric(10) a #\u0026gt; [1] 0 0 0 0 0 0 0 0 0 0  å¦‚æœæƒ³è¦çŸ¥åˆ°è®Šæ•¸çš„è³‡æ–™å‹åˆ¥,åˆ©ç”¨å‡½æ•¸typeof()\ntypeof()å‡½æ•¸å›å‚³çš„çµæœæ˜¯\u0026quot;å­—ä¸²\u0026quot;\ntypeof(a) # çµæœæ˜¯\u0026quot;double\u0026quot; #\u0026gt; [1] \u0026quot;double\u0026quot; s = typeof(a) s #\u0026gt; [1] \u0026quot;double\u0026quot; typeof(s) #çµæœæ˜¯ \u0026quot;character\u0026quot; #\u0026gt; [1] \u0026quot;character\u0026quot;  å­—ä¸²  åƒè€ƒ\n å»ºç«‹å­—ä¸² å¯ä»¥æ˜¯ é›™å¼•è™Ÿä¸­\u0026quot; æˆ– å–®å¼•è™Ÿä¸­'ã€‚\nå­—ä¸²ä¸­å¦‚æœæœ‰é›™å¼•è™Ÿ,æˆ–å–®å¼•è™Ÿï¼Œå‰‡å¦‚ä¸‹è¡¨ç¤º:\n\u0026quot;'é€™å€‹'ä¾†è‡ª'é‚£å€‹'\u0026quot;\na \u0026lt;- \u0026quot;hello\u0026quot; a #\u0026gt; [1] \u0026quot;hello\u0026quot; typeof(a) #[1] \u0026quot;character\u0026quot; #\u0026gt; [1] \u0026quot;character\u0026quot; is.vector(a) #[1] TRUE #\u0026gt; [1] TRUE  åˆ©ç”¨å‡½æ•¸:character() é€™å€‹å‡½æ•¸çš„åƒæ•¸ç‚ºæ•´æ•¸,å»ºç«‹ä¸€å€‹vector(ä¸æ˜¯list),è£¡é¢çš„å…ƒç´ éƒ½æ˜¯ç©ºå­—ä¸²,ä¾‹å¦‚character(5)ã€‚\n# è®Šæ•¸exåˆå§‹åŒ–ç‚ºcharacter vector,åƒçœ‹å¾Œé¢çš„è¨è«– (ex \u0026lt;- character(0)) #\u0026gt; character(0) is.null(ex) #ğŸ·ä¸æ˜¯null,é€™æ˜¯ä¸€å€‹æŒ‡æ¨™  #\u0026gt; [1] FALSE length(ex) #\u0026gt; [1] 0 class(ex) #\u0026gt; [1] \u0026quot;character\u0026quot; # å¦‚æœå‰›å‰›æ²’æœ‰è¨­å®šex \u0026lt;- character(0),é€™è£¡æœƒç™¼ç”ŸéŒ¯èª¤ (ex[1] \u0026lt;- \u0026quot;first\u0026quot;) #\u0026gt; [1] \u0026quot;first\u0026quot; # check its length again length(ex) #\u0026gt; [1] 1 (ex[4] \u0026lt;- \u0026quot;fourth\u0026quot;) # ğŸ·ç´¢å¼•å¯ä»¥ç”¨è·³çš„:  #\u0026gt; [1] \u0026quot;fourth\u0026quot; length(ex) #\u0026gt; [1] 4 typeof(ex) #\u0026gt; [1] \u0026quot;character\u0026quot; ex #\u0026gt; [1] \u0026quot;first\u0026quot; NA NA \u0026quot;fourth\u0026quot;  è·³éçš„ç´¢å¼•,å…§å®¹è‡ªå‹•ç‚ºNA.\nç©ºå­—ä¸² å¼•è™Ÿå…§é€£ç©ºç™½éƒ½æ²’æœ‰çš„å­—ä¸²:\n(æ¯”è¼ƒä¸Šé¢åˆ©ç”¨character(5)å¯ä»¥å»ºç«‹5å€‹å…ƒç´ ç‚ºç©ºå­—ä¸²çš„vectorã€‚)\n# empty string empty_str \u0026lt;- \u0026quot;\u0026quot; empty_str #\u0026gt; [1] \u0026quot;\u0026quot; # class class(empty_str) #\u0026gt; [1] \u0026quot;character\u0026quot;  æ¢è¨character(0) å‰é¢èªªcharacter(2),å¯ä»¥å‚³å›é•·åº¦2,æ¯å€‹å…ƒç´ éƒ½æ˜¯ç©ºç™½å­—ä¸²\u0026quot;\u0026quot;çš„å‘é‡,é‚£éº¼character(0)æ˜¯ç”šéº¼?\né™¤äº†å‰é¢æåˆ°çš„è®Šæ•¸åˆå§‹åŒ–ç‚ºå‘é‡(ä¹Ÿè¨±å¯ä»¥èªªæ˜¯å‘é‡å®£å‘Š)\nä¾‹å¦‚,æ•´æ•¸ä¹Ÿæ˜¯é€™æ¨£\nzz\u0026lt;-integer(0) zz[4]=6 zz #\u0026gt; [1] NA NA NA 6  é€™è£¡åˆ©ç”¨åˆ†åˆ¥ä½¿ç”¨typeof, str,class,iså°character(0)åšä¸€äº›æ¸¬è©¦:\nex1\u0026lt;-character(0) ex2\u0026lt;-\u0026quot;\u0026quot; typeof(ex1) # ğŸ·éƒ½æ˜¯å‘é‡  #\u0026gt; [1] \u0026quot;character\u0026quot; typeof(ex2) #\u0026gt; [1] \u0026quot;character\u0026quot;  å‡½æ•¸str()ç”¨ä¾†é¡¯ç¤ºRç‰©ä»¶çš„çµæ§‹:\nstr(ex1) #\u0026gt; chr(0) str(ex2) #ğŸ·å‰é¢çœ‹èµ·ä¾†éƒ½æ˜¯å‘é‡,ä½†æ˜¯é€™è£¡æœ‰æ›´å¤šè³‡è¨Š chr(0),\u0026#34;\u0026#34;  #\u0026gt; chr \u0026quot;\u0026quot;  class(ex1) #\u0026gt; [1] \u0026quot;character\u0026quot; class(ex2) #\u0026gt; [1] \u0026quot;character\u0026quot;  is.list(ex1) #\u0026gt; [1] FALSE is.list(ex2) #\u0026gt; [1] FALSE  ğŸ‘¹ ä¸€å€‹å­—å…ƒä¹Ÿæ˜¯å‘é‡ã€‚\nis.vector(ex1) #\u0026gt; [1] TRUE is.vector(ex2) #\u0026gt; [1] TRUE  length(ex1) #\u0026gt; [1] 0 length(ex2) #\u0026gt; [1] 1  is.null(ex1) #\u0026gt; [1] FALSE is.null(ex2) #\u0026gt; [1] FALSE is.na(ex1) #\u0026gt; ğŸ·logical(0) èªªé€™æ˜¯é‚è¼¯å‘é‡,ä½†æ˜¯é•·åº¦0  #\u0026gt; logical(0) is.na(ex2) #\u0026gt; FALSE #\u0026gt; [1] FALSE  æœ€å¾Œ,é€™å…©å€‹æ˜¯ä¸æ˜¯ç›¸ç­‰\nex1==ex2 #\u0026gt; logical(0)  å­—ä¸²å’Œvector  åœ¨EXCELä¸­ï¼Œvector ä¸€èˆ¬æŒ‡çš„æ˜¯åªæ”¾å…ƒç´ ç‚ºæ•¸å­—çš„é™£åˆ—(array);è€Œé™£åˆ—æ˜¯å¯ä»¥å­˜æ•¸å­—å’Œæ–‡å­—çš„å€åŸŸã€‚tableæ˜¯æœ‰æ¬„ä½çš„é™£åˆ—ã€‚\nä½†æ˜¯åœ¨Rèªè¨€ä¸­,vector åªæ˜¯å…ƒç´ å‹æ…‹ç›¸åŒå³å¯ã€‚\n a \u0026lt;- \u0026quot;hello\u0026quot; a #\u0026gt; [1] \u0026quot;hello\u0026quot; typeof(a) #\u0026gt; [1] \u0026quot;character\u0026quot;  b \u0026lt;- c(\u0026quot;hello\u0026quot;, \u0026quot;there\u0026quot;) b #\u0026gt; [1] \u0026quot;hello\u0026quot; \u0026quot;there\u0026quot; b[1] #\u0026gt; [1] \u0026quot;hello\u0026quot; typeof(b) #\u0026gt; [1] \u0026quot;character\u0026quot;  (a = character(5)) # ç”¢ç”Ÿ5å€‹ç©ºå­—ä¸² #\u0026gt; [1] \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; (b = letters[1:4]) # æ³¨æ„,lettersä¸æ˜¯å‡½æ•¸ #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; letters #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot; \u0026quot;k\u0026quot; \u0026quot;l\u0026quot; \u0026quot;m\u0026quot; \u0026quot;n\u0026quot; \u0026quot;o\u0026quot; \u0026quot;p\u0026quot; \u0026quot;q\u0026quot; \u0026quot;r\u0026quot; \u0026quot;s\u0026quot; #\u0026gt; [20] \u0026quot;t\u0026quot; \u0026quot;u\u0026quot; \u0026quot;v\u0026quot; \u0026quot;w\u0026quot; \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;z\u0026quot; typeof(letters) #\u0026gt; [1] \u0026quot;character\u0026quot; class(letters) #\u0026gt; [1] \u0026quot;character\u0026quot;  å› ç‚ºcå‡½æ•¸çš„é‹ç®—çµæœç‚ºvector,å› æ­¤ä¸‹ä¾‹ä¸­,å…¶å…ƒç´ éƒ½æ˜¯å­—ä¸²\n(a\u0026lt;-c(\u0026quot;d\u0026quot;,4,TRUE)) #\u0026gt; [1] \u0026quot;d\u0026quot; \u0026quot;4\u0026quot; \u0026quot;TRUE\u0026quot;  å•é¡Œ:\næ€æ¨£çŸ¥é“ræ˜¯ç©ºé›†åˆ?\ny \u0026lt;- letters[1:3] z \u0026lt;- letters[4:6] r\u0026lt;-intersect(y,z) r #\u0026gt; character(0) is.na(r) #\u0026gt; logical(0) length(r) #\u0026gt; [1] 0  å¦å¤–,ç•¶vectoræœ‰å¤šå€‹å­—ä¸²,è€Œä½¿ç”¨ç´¢å¼•0çš„æ™‚å€™,ä¹Ÿæœƒå‡ºç¾ character(0),ä¾‹å¦‚:\nstring \u0026lt;- c('sun', 'sky', 'clouds') string[0] #\u0026gt; character(0)  vector ç›¸é—œçš„é‹ç®— é€£çºŒæ•¸å­—å¯ä»¥åˆ©ç”¨æ“ä½œå…ƒ:,ä¾‹å¦‚:\nx \u0026lt;- 1:7; x y \u0026lt;- 2:-2; y  æ¯”è¼ƒè¤‡é›œçš„åºåˆ—å¯ä»¥åˆ©ç”¨å‡½æ•¸ seq() ,ä¾‹å¦‚\nseq(1, 3, by=0.2) # specify step size #\u0026gt; [1] 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 seq(1, 5, length.out=4) # specify length of the vector #\u0026gt; [1] 1.000000 2.333333 3.666667 5.000000  ç·´ç¿’ç¯„ä¾‹ Q1. a,a1,a2 å±¬æ–¼ç”šéº¼å‹æ…‹\na = 1:4 a1 = c(1, 2, 3, 4) a2 = numeric(4)  A1\nQ2:a3çš„é•·åº¦æ˜¯ç”šéº¼?2,æˆ–6\na1\u0026lt;-c(1,2,3) a2\u0026lt;-c(2,3,4) a3\u0026lt;-c(a1,a2)  HINT:\na1\na2\na3;length(a3)\nå¦‚ä½•å­˜å–vectorä¸­çš„å…ƒç´  å…ƒç´ ç´¢å¼•å¯ä»¥åˆ©ç”¨ logical, integer or character vector.\nå¦‚æœåˆ©ç”¨æ•´æ•¸ç´¢å¼•,å‰‡å¾1é–‹å§‹.ä½†æ˜¯,å¦‚æœç´¢å¼•å€¼çµ¦çš„æ˜¯è² æ•¸(ä¾‹å¦‚-2),å‰‡é™¤äº†2è™Ÿå…ƒç´ ä»¥å¤–,éƒ½æœƒè¢«å‚³å›ã€‚ä½†æ˜¯ä¸èƒ½åŒæ™‚æœ‰æ­£è² ã€‚åŒæ™‚,æµ®é»æ•¸æœƒè¢«truncatedã€‚\n\u0026gt; x [1] 0 2 4 6 8 10 \u0026gt; x[3] # access 3rd element [1] 4 \u0026gt; x[c(2, 4)] # access 2nd and 4th element [1] 2 6 \u0026gt; x[-1] # access all but 1st element [1] 2 4 6 8 10 \u0026gt; x[c(2, -4)] # ä¸èƒ½æ··åˆæ­£è²  Error in x[c(2, -4)] : only 0's may be mixed with negative subscripts \u0026gt; x[c(2.4, 3.54)] # real numbers are truncated to integers [1] 2 4  ç¯©é¸ ç¯©é¸é™£åˆ—ä¸­çš„å…ƒç´ ã€‚ä¾‹å¦‚\n\u0026gt; x[c(TRUE, FALSE, FALSE, TRUE)] [1] -3 3 \u0026gt; x[x \u0026lt; 0] # filtering vectors based on conditions [1] -3 -1 \u0026gt; x[x \u0026gt; 0] [1] 3  åˆ©ç”¨å­—ä¸²( character vector) ä½œç‚ºç´¢å¼• æ¯å€‹å…ƒç´ å¯ä»¥æœ‰åç¨±:\n\u0026gt; x \u0026lt;- c(\u0026quot;first\u0026quot;=3, \u0026quot;second\u0026quot;=0, \u0026quot;third\u0026quot;=9) \u0026gt; x #\u0026gt; first second third #\u0026gt; 3 0 9 \u0026gt; class(x) # æ³¨æ„:ä¸æ˜¯list #\u0026gt; [1] \u0026quot;numeric\u0026quot; \u0026gt; names(x) #\u0026gt; [1] \u0026quot;first\u0026quot; \u0026quot;second\u0026quot; \u0026quot;third\u0026quot; \u0026gt; x[\u0026quot;second\u0026quot;] #\u0026gt; second #\u0026gt; 0 \u0026gt; x[c(\u0026quot;first\u0026quot;, \u0026quot;third\u0026quot;)] #\u0026gt; first third #\u0026gt; 3 9  a\u0026lt;-c(x=1:2,y=3:4) a[\u0026quot;x1\u0026quot;] # ä¸æ˜¯a[x1] #\u0026gt; x1 #\u0026gt; 1  â“ a[\u0026quot;x1\u0026quot;]å“ªè£¡ä¾†çš„x1?æç¤º\r ```\n\u0026gt; a\n#\u0026gt; x1 x2 y1 y2\n#\u0026gt; 1 2 3 4\n\u0026gt; names(a)\n\u0026gt; # [1] \u0026quot;x1\u0026quot; \u0026quot;x2\u0026quot; \u0026quot;y1\u0026quot; \u0026quot;y2\u0026quot;\r[] å’Œ[[]]çš„å·®åˆ¥:\nåŸä¾†çš„typeæ˜¯ç”šéº¼(ä¾‹å¦‚,list æˆ–vector),[]åªæ˜¯è¿”å›å­é›†åˆ(ä»ç„¶æ˜¯listæˆ–vector),ä½†æ˜¯[[]]å‰‡æ˜¯è¿”å›å…§å®¹.\n\u0026gt; x \u0026lt;- c(a = 1, b = 2, c = 3) \u0026gt; x[\u0026quot;a\u0026quot;] #\u0026gt; a #\u0026gt; 1 \u0026gt; x[[\u0026quot;a\u0026quot;]] #\u0026gt; [1] 1 \u0026gt; x[1] #\u0026gt; a #\u0026gt; 1 \u0026gt; x[[1]] #\u0026gt; [1] 1  å’Œlistçš„å€åˆ¥æ˜¯\n $\n ä¸å¿…æœ‰\u0026quot;\u0026quot;\na1\u0026lt;-list(x=1:2,y=3:4) a1$x #\u0026gt; [1] 1 2   \r\rHow to modify a vector in R? We can modify a vector using the assignment operator.\nWe can use the techniques discussed above to access specific elements and modify them.\nIf we want to truncate the elements, we can use reassignments.\n\u0026gt; x #\u0026gt; [1] -3 -2 -1 0 1 2 \u0026gt; x[2] \u0026lt;- 0; x # modify 2nd element #\u0026gt; [1] -3 0 -1 0 1 2 \u0026gt; x[x\u0026lt;0] \u0026lt;- 5; x # modify elements less than 0 #\u0026gt; [1] 5 0 5 0 1 2 \u0026gt; x \u0026lt;- x[1:4]; x # truncate x to first 4 elements #\u0026gt; [1] 5 0 5 0  How to delete a Vector? We can delete a vector by simply assigning a NULL to it.\n\u0026gt; x #\u0026gt; [1] -3 -2 -1 0 1 2 \u0026gt; x \u0026lt;- NULL \u0026gt; x #\u0026gt; NULL \u0026gt; x[4] #\u0026gt; NULL  å‹æ…‹æ“ä½œ åˆ¤å®šå‹æ…‹ is family is.numeric(), is.integer(), and is.double()\nå‹æ…‹è½‰æ› as family a\u0026lt;-c(TRUE,FALSE) as.numeric(a) #\u0026gt; [1] 1 0 an\u0026lt;-as.logical(a) an #\u0026gt; [1] TRUE FALSE  assignment ç·´ç¿’\nhw1\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/4_1_2_type%E7%B7%B4%E7%BF%92.html","title": "4.1.2_typeç·´ç¿’",
	"tags": [],
	"description": "4_1_1_typeç·´ç¿’",
	"content": "åœ¨Rä¸­,options()ç¶“å¸¸ç”¨ä¾†è¨­å®šç¸½é«”è®Šæ•¸,ä¾‹å¦‚å¥—ä»¶blogdownå¯ä»¥è¨­å®šoptions(blogdown.method = 'custom')ã€‚\nå¦‚æœæƒ³è¦çŸ¥é“ç›®å‰çš„è¨­å®šæƒ…æ³,å¯ä»¥ä¸‹æŒ‡ä»¤options()ï¼Œä¾‹å¦‚\noptions() # ğŸ·è¨»è§£é€™æ˜¯åœ¨è¦–çª—ä¸‹åŸ·è¡Œçš„çµæœ   \r`options()`çš„åŸ·è¡Œçµæœ\r$add.smooth [1] TRUE $blogdown.author [1] \u0026quot;\u0026quot; $blogdown.ext [1] \u0026quot;.md\u0026quot; $blogdown.filename.pre_processor [1] NA $blogdown.files_filter [1] NA $blogdown.generator [1] NA $blogdown.hugo.args [1] NA $blogdown.hugo.dir [1] NA $blogdown.hugo.server [1] NA $blogdown.hugo.version [1] \u0026quot;0.84.4\u0026quot; $blogdown.initial_files [1] NA $blogdown.knit.on_save [1] TRUE $blogdown.knit.serve_site [1] NA (...çœç•¥...) $warning.length [1] 1000 $width [1] 80 $windowsTimeouts [1] 100 500   å¦‚ä¸Šå¯ä»¥çŸ¥é“æœ‰ä¸€å¤§ä¸²åˆ—è¡¨,å¦‚æœæˆ‘åªæƒ³çŸ¥é“å¥—ä»¶blogdownçš„è¨­å®šåˆ—è¡¨ï¼Œè¦æ€æ¨£åš?\nä¹Ÿå°±æ˜¯æ€æ¨£ç¯©é¸å‡ºæˆ‘è¦çš„è¨­å®š?\n è§£æ³•1:åˆ©ç”¨grep(),grepl()\n è§£æ³•2:sapply , ä¹Ÿæ˜¯ç”¨åˆ°grep() ä¸èƒ½ç”¨ %in%\n  å¯ä»¥åƒè€ƒé€™è£¡\næç¤º\r  è§£æ³•1\nolist\u0026lt;-options() # list okey\u0026lt;-names(olist) # vector # \u0026quot;blogdown\u0026quot; %in% okey idx\u0026lt;-grep(\u0026quot;blogdown\u0026quot;,okey) olist[idx] #\u0026gt; $blogdown.hugo.version #\u0026gt; [1] \u0026quot;0.84.4\u0026quot; #\u0026gt; #\u0026gt; $blogdown.knit.on_save #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $blogdown.method #\u0026gt; [1] \u0026quot;markdown\u0026quot; #\u0026gt; #\u0026gt; $blogdown.serve_site.startup #\u0026gt; [1] FALSE  è§£æ³•2:çœ‹ä¸€ä¸‹ç‚ºç”šéº¼ä¸èƒ½ç”¨ %in%\nolist\u0026lt;-options() # list okey\u0026lt;-names(olist) # vector rst \u0026lt;- sapply(okey,function(item){\u0026quot;blogdown\u0026quot; %in% unlist(strsplit(item,\u0026quot;\\\\.\u0026quot;)) }) olist[rst] #\u0026gt; $blogdown.hugo.version #\u0026gt; [1] \u0026quot;0.84.4\u0026quot; #\u0026gt; #\u0026gt; $blogdown.knit.on_save #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; $blogdown.method #\u0026gt; [1] \u0026quot;markdown\u0026quot; #\u0026gt; #\u0026gt; $blogdown.serve_site.startup #\u0026gt; [1] FALSE    è§£é‡‹é€™è¡Œ:\nrst \u0026lt;- sapply(okey,function(item){\u0026quot;blogdown\u0026quot; %in% unlist(strsplit(item,\u0026quot;\\\\.\u0026quot;)) })\n \\\\.è€Œä¸æ˜¯åªæœ‰.\n strsplit()åŸ·è¡Œçš„çµæœæ˜¯ä¸€å€‹listè€Œåˆ†é›¢çš„å…ƒç´ åœ¨ç¬¬ä¸€å€‹nodeæ‰€ä»¥,ç”¨unlist\n %in%çš„ç”¨æ³•\n   v=c(\u0026quot;1.2\u0026quot;,\u0026quot;1.3\u0026quot;) \u0026quot;1\u0026quot; %in% v #\u0026gt; [1] FALSE  \râ›³è¨»è§£ â“åœ¨ä¸»æ§å°ä¸Šçš„æ¯”è¼ƒå¤š,ä½†æ˜¯åœ¨rmarkdown chunkåªæœ‰çœ‹åˆ°å¹¾å€‹,å› ç‚ºåœ¨rmarkdownä¸­æ²’æœ‰è¼‰å…¥blogdownå¥—ä»¶ã€‚\n"},
{"uri": "https://airbone4.github.io/blogR/rlang/4_1_3_type_list.html","title": "4.1.3 type list",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "List Lists æ˜¯ä¸€å€‹Rç‰©ä»¶ã€‚å…¶å…ƒç´ å…§å®¹å¯ä»¥æ˜¯ä¸åŒå‹æ…‹,ä¾‹å¦‚ numbers, strings, vectors,matrix æˆ–è€…æ˜¯å¦ä¸€å€‹ listï¼Œç”šè‡³æ˜¯å‡½æ•¸ã€‚\nå»ºç«‹ List å‡½æ•¸list() å¯ä»¥å»ºç«‹list.\nlist()ä¸­çš„åƒæ•¸ç”¨é€—é»éš”é–‹,å¹¾å€‹åƒæ•¸å°±å¹¾å€‹Nodeã€‚\nlist_data \u0026lt;- list(\u0026quot;Red\u0026quot;, \u0026quot;Green\u0026quot;, c(21,32,11), TRUE, 51.23, 119.1) print(list_data)  #\u0026gt; [[1]] #\u0026gt; [1] \u0026quot;Red\u0026quot; #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] \u0026quot;Green\u0026quot; #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 21 32 11 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] TRUE #\u0026gt; #\u0026gt; [[5]] #\u0026gt; [1] 51.23 #\u0026gt; #\u0026gt; [[6]] #\u0026gt; [1] 119.1  çµ¦ä¸²åˆ—ä¸­çš„æ¯å€‹å…ƒç´ å‘½å listä¸­çš„å…ƒç´ å¯ä»¥å‘½å,ç„¶å¾Œç¶“ç”±åç¨±å­˜å–ã€‚\n#å»ºç«‹ä¸²åˆ—,å…¶ä¸­çš„åŸç´ æœ‰å‘é‡,çŸ©é™£,å’Œä¸€å€‹ä¸²åˆ— list_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(\u0026quot;green\u0026quot;,12.3)) # çµ¦æ¯å€‹NODEå‘½å names(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;) #Show the list. print(list_data)  #\u0026gt; $`1st Quarter` #\u0026gt; [1] \u0026quot;Jan\u0026quot; \u0026quot;Feb\u0026quot; \u0026quot;Mar\u0026quot; #\u0026gt; #\u0026gt; $A_Matrix #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 3 5 -2 #\u0026gt; [2,] 9 1 8 #\u0026gt; #\u0026gt; $`A Inner list` #\u0026gt; $`A Inner list`[[1]] #\u0026gt; [1] \u0026quot;green\u0026quot; #\u0026gt; #\u0026gt; $`A Inner list`[[2]] #\u0026gt; [1] 12.3  å¸¶åçš„vectorå’Œlist ,ç™½è©±æ–‡æ„æ€å°±æ˜¯å°‡æ¯å€‹å…ƒç´ å‘½åã€‚\nx=c(1,2,3) names(x)\u0026lt;-c('a','b','c') x  #\u0026gt; a b c #\u0026gt; 1 2 3   \né€™è£¡è¨è«–ä¸€ä¸‹ç‚ºç”šéº¼åœ¨Rèªè¨€å …æŒ\u0026lt;-è€Œä¸æ˜¯=çš„ä¸€å€‹åŸå› \nä¸€èˆ¬çš„ç¨‹å¼èªè¨€,ä¸æœƒç”¨åˆ°é€™ç¨®æ–‡æ³•,ä¾‹å¦‚,åœ¨å…¶ä»–ç¨‹å¼èªè¨€ä¸­,ç›´è¦ºä¸Šæ‡‰è©²æ˜¯æœ‰ä¸€å€‹names(),ç„¶å¾Œç”¨æ³•å¦‚ä¸‹:\nnames(x,c('a','b','c') )  ğŸ‘¹å› æ­¤\u0026lt;-ä¸é¡ä¼¼æŒ‡æ´¾,è€Œæ˜¯é¡ä¼¼æµå‘æŸå€‹ç‰©ä»¶çš„å±¬æ€§ã€‚\n\r\r  names()çš„åƒæ•¸å¦‚æœæ˜¯matrix,è¢«å‘½åçš„å°±æ˜¯æ¬„ä½(ç›´è¡Œ)æˆ–æ˜¯ç´€éŒ„(æ©«è¡Œ)?ç­”æ¡ˆæ˜¯ä»¥ä¸Šçš†é .è€Œæ˜¯çµ¦æ¯å€‹å…ƒç´ å‘½åã€‚\nx\u0026lt;-matrix(runif(9),nrow=3) names(x)\u0026lt;-c('a','b','c') x  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 0.2418582 0.9307930 0.88989298 #\u0026gt; [2,] 0.4308953 0.9658296 0.06133088 #\u0026gt; [3,] 0.7975235 0.4329790 0.60921991 #\u0026gt; attr(,\u0026quot;names\u0026quot;) #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; NA NA NA NA NA NA  names \u0026amp; matrix\r\r\rrownames(x)\u0026lt;-c('x','y','z') print(x,row.names=T)  #\u0026gt; [,1] [,2] [,3] #\u0026gt; x 0.2418582 0.9307930 0.88989298 #\u0026gt; y 0.4308953 0.9658296 0.06133088 #\u0026gt; z 0.7975235 0.4329790 0.60921991 #\u0026gt; attr(,\u0026quot;names\u0026quot;) #\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; NA NA NA NA NA NA  åœ–\r\r\râ“å•:åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­xæ˜¯ä¸€å€‹çŸ©é™£,x[\u0026quot;a\u0026quot;]æœƒå‚³å›ç”šéº¼?\nğŸ“ å¿…é ˆæ˜¯x[[\u0026quot;a\u0026quot;]]å‚³å›çš„æ‰æ˜¯ç´”é‡,å¦å‰‡ä»ç„¶æ˜¯ä¸€å€‹list\nä½†æ˜¯åœ¨data.frameçš„çµæ§‹ä¸­,names()\u0026lt;- çµ¦å®šçš„æ˜¯æ¬„ä½åç¨±\nxd\u0026lt;-data.frame(x) names(xd)\u0026lt;-c('a','b','c') xd  #\u0026gt; a b c #\u0026gt; x 0.2418582 0.9307930 0.88989298 #\u0026gt; y 0.4308953 0.9658296 0.06133088 #\u0026gt; z 0.7975235 0.4329790 0.60921991  å­˜å– List å…ƒç´  # 3å€‹å…ƒç´ ,åˆ†åˆ¥æ˜¯list, matrix, list list_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(\u0026quot;green\u0026quot;,12.3)) # çµ¦åç¨± names(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;) # Access the first element of the list. print(list_data[1])  #\u0026gt; $`1st Quarter` #\u0026gt; [1] \u0026quot;Jan\u0026quot; \u0026quot;Feb\u0026quot; \u0026quot;Mar\u0026quot;  # Access the thrid element. As it is also a list, all its elements will be printed. print(list_data[3])  #\u0026gt; $`A Inner list` #\u0026gt; $`A Inner list`[[1]] #\u0026gt; [1] \u0026quot;green\u0026quot; #\u0026gt; #\u0026gt; $`A Inner list`[[2]] #\u0026gt; [1] 12.3  # Access the list element using the name of the element. print(list_data$A_Matrix)  #\u0026gt; [,1] [,2] [,3] #\u0026gt; [1,] 3 5 -2 #\u0026gt; [2,] 9 1 8  list å…ƒç´ çš„å­˜å–å¯ä»¥æ˜¯[[]] æˆ– $ ä¾‹å¦‚x[[\u0026quot;a\u0026quot;]], x$aã€‚\nä¸€å€‹ä¸»è¦åˆ†åˆ¥æ˜¯,listä¸­çš„è™Ÿç¢¼ç´¢å¼•,ä¹Ÿæ˜¯åç¨±,ä¾‹å¦‚,å‘é‡çŸ©é™£éƒ½å¯ä»¥æ˜¯x[1]æ‹¿åˆ°ç´”é‡,ä½†æ˜¯list x[1]æ‹¿åˆ°çš„ä»ç„¶æ˜¯listã€‚\r\r\rè™•ç†list å…ƒç´  listçš„åŠ å…¥å’Œåˆªé™¤,åªèƒ½åœ¨å°¾ç«¯ï¼Œä½†æ˜¯æ›´æ”¹è³‡æ–™ä¸å—é™åˆ¶ã€‚\n# Create a list containing a vector, a matrix and a list. list_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(\u0026quot;green\u0026quot;,12.3)) # Give names to the elements in the list. names(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;) # åŠ å…¥å…ƒç´  list_data[4] \u0026lt;- \u0026quot;New element\u0026quot; print(list_data[4])  #\u0026gt; [[1]] #\u0026gt; [1] \u0026quot;New element\u0026quot;  # ğŸ”‘ç§»é™¤æœ€å¾Œä¸€å€‹å…ƒç´  list_data[4] \u0026lt;- NULL # Print the 4th Element. print(list_data[4])  #\u0026gt; $\u0026lt;NA\u0026gt; #\u0026gt; NULL  # Update the 3rd Element. list_data[3] \u0026lt;- \u0026quot;updated element\u0026quot; print(list_data[3])  #\u0026gt; $`A Inner list` #\u0026gt; [1] \u0026quot;updated element\u0026quot;  Merging Lists You can merge many lists into one list by placing all the lists inside one list() function.\n# Create two lists. list1 \u0026lt;- list(1,2,3) list2 \u0026lt;- list(\u0026quot;Sun\u0026quot;,\u0026quot;Mon\u0026quot;,\u0026quot;Tue\u0026quot;) # Merge the two lists. merged.list \u0026lt;- c(list1,list2) # Print the merged list. print(merged.list)  #\u0026gt; [[1]] #\u0026gt; [1] 1 #\u0026gt; #\u0026gt; [[2]] #\u0026gt; [1] 2 #\u0026gt; #\u0026gt; [[3]] #\u0026gt; [1] 3 #\u0026gt; #\u0026gt; [[4]] #\u0026gt; [1] \u0026quot;Sun\u0026quot; #\u0026gt; #\u0026gt; [[5]] #\u0026gt; [1] \u0026quot;Mon\u0026quot; #\u0026gt; #\u0026gt; [[6]] #\u0026gt; [1] \u0026quot;Tue\u0026quot;  â“ åœ¨å¤§éƒ¨åˆ†ç¨‹å¼èªè¨€ä¸­,å‘é‡çš„æ„æ€,åªè¦å…ƒç´ åŒå‹æ…‹å°±è¡Œã€‚åˆï¼Œæˆ‘å€‘å·²ç¶“çŸ¥é“,å‡½æ•¸cå¯ä»¥ç”¢ç”Ÿå‘é‡ã€‚ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­,åˆ©ç”¨cå°‡å…©å€‹list åˆä½µ,æˆ‘å€‘æŒ‰ç…§å¤§éƒ¨åˆ†ç¨‹å¼èªè¨€çš„è§€å¿µçŸ¥é“,æ—¢ç„¶å…ƒç´ éƒ½æ˜¯ç›¸åŒå‹æ…‹(éƒ½æ˜¯list),é‚£å°±æ˜¯2å€‹å…ƒç´ ï¼Œä½†æ˜¯ç¾åœ¨æ˜¯6å€‹,ç‚ºç”šéº¼?\nğŸ‘ å‡½æ•¸c()æ˜¯ä¸€å€‹å¤šå‹å‡½æ•¸(ç‰©ä»¶èªè¨€ä¸­çš„è¬›æ³•å°±æ˜¯æ ¹æ“šåƒæ•¸çš„ä¸åŒ,è€Œæœ‰ä¸åŒçš„çµæœ)ã€‚é€™è£¡çš„çµæœæ˜¯6å€‹å…ƒç´ ã€‚æ¯å€‹å…ƒç´ éƒ½æ˜¯list(è­‰æ˜:list)ã€‚\n\r\r â“å¦‚æœè¦2å€‹?\n ğŸ“ é‚£å°±æ˜¯merged.list2\u0026lt;-list(list1,list2)ã€‚\n  â“ merge.list\u0026lt;-c(x,y) ä¸­çš„mergeæ˜¯ä¸æ˜¯ç‰©ä»¶çš„æ„æ€?\n ğŸ‘ ä¸æ˜¯ã€‚åªæ˜¯å€‹åˆæ³•çš„è®Šæ•¸ã€‚\n   \r\râ“ å¯«ä¸€å€‹å‡½æ•¸,åˆä½µå…©å€‹list,ä½†æ˜¯è¦æ±‚å…©å€‹listä¸­æœ‰åŒåçš„å…ƒç´ å¿…é ˆæ˜¯ç¬¬2å€‹ä¸­çš„åç¨±ã€‚ä¾‹å¦‚ list(a=1,b=2,c=3), list(b=4) åˆä½µå¾Œè®Šæˆ a=1,b=4,c=3ã€‚\nğŸ“\nmerge_list = function(x, y) { x[names(y)] = y x }  \r\rList è½‰ Vector å‡½æ•¸ unlist()\n# Create lists. list1 \u0026lt;- list(1:5) # ğŸ·ä¸æ˜¯ç”¢ç”Ÿ5å€‹NODELçš„ä¸²åˆ—,è€Œæ˜¯å…ˆç”¢ç”Ÿ5å€‹å…ƒç´ çš„å‘é‡,ç„¶å¾Œæ”¾åˆ°ç¬¬ä¸€å€‹ç¯€é»  print(list1)  #\u0026gt; [[1]] #\u0026gt; [1] 1 2 3 4 5  list2 \u0026lt;-list(10:14) print(list2)  #\u0026gt; [[1]] #\u0026gt; [1] 10 11 12 13 14  # Convert the lists to vectors. v1 \u0026lt;- unlist(list1) v2 \u0026lt;- unlist(list2) print(v1)  #\u0026gt; [1] 1 2 3 4 5  print(v2)  #\u0026gt; [1] 10 11 12 13 14  # Now add the vectors result \u0026lt;- v1+v2 print(result)  #\u0026gt; [1] 11 13 15 17 19  â“ å¦‚æœæ˜¯listä¸­çš„å…§å®¹æœ‰ä¸ä¸€æ¨£çš„å‹æ…‹å‘¢?ä¾‹å¦‚\nx\u0026lt;-list(\u0026quot;a\u0026quot;,1) y\u0026lt;-unlist(x) typeof (y)  #\u0026gt; [1] \u0026quot;character\u0026quot;  \r\ræ¯”è¼ƒvector, listä¸­,å­—ä¸²çš„å•é¡Œ  Q length()å‡½æ•¸å¯ä»¥çŸ¥é“vector,list çš„é•·åº¦,ä½†æ˜¯ç‚ºç”šéº¼length(\u0026quot;hello\u0026quot;)çš„é•·åº¦æ˜¯1?\na\u0026lt;-c(\u0026quot;hello\u0026quot;,\u0026quot;r\u0026quot;) length(a) #ğŸ’¡  #\u0026gt; [1] 2  length(a[1]) #ğŸ’¡  #\u0026gt; [1] 1  length(a[[1]]) #ğŸ’¡  #\u0026gt; [1] 1  nchar(a[1]) #ğŸ”‘  #\u0026gt; [1] 5  length(\u0026quot;hello\u0026quot;) #â“  #\u0026gt; [1] 1   åœ–\r\r\r Q\na\u0026lt;-list(\u0026quot;hello\u0026quot;,\u0026quot;r\u0026quot;) length(a)  #\u0026gt; [1] 2  length(a[1])  #\u0026gt; [1] 1  length(a[[1]])  #\u0026gt; [1] 1  typeof(\u0026quot;xxx\u0026quot;) #ğŸ’¡  #\u0026gt; [1] \u0026quot;character\u0026quot;  typeof(1) #ğŸ’¡  #\u0026gt; [1] \u0026quot;double\u0026quot;  typeof(1L) #ğŸ’¡  #\u0026gt; [1] \u0026quot;integer\u0026quot;   ä¸Šé¢å…©å€‹ç­”æ¡ˆçš„å•é¡Œ,å’ŒRæ€æ¨£å»ºç«‹å­—ä¸²æœ‰é—œ\nğŸ“ç¸½ä¹‹,å­—ä¸²é•·åº¦å‡½æ•¸ğŸ”‘nchar()ã€‚\ndata set build in List of pre-loaded data data()  Loading a built-in R data\ndata(mtcars)  nrow(mtcars)  #\u0026gt; [1] 32  ncol(mtcars)  #\u0026gt; [1] 11  ç·´ç¿’ æ‹¿å…ƒç´  [ å¤§æ¦‚æ¶µè“‹äº†æ‰€æœ‰å­˜å–å…ƒç´ çš„æ–¹æ³•åƒè€ƒ\nâ“å¦‚æœè³‡æ–™å¦‚ä¸‹,\n\u0026gt; data V1 V2 1 12.448 13.919 2 22.242 4.606 3 24.509 0.176  å‰‡ä¸‹é¢æŒ‡ä»¤åˆ†åˆ¥æ‹¿åˆ°ç”šéº¼?\ndata[1,1] data[1,\u0026quot;V1\u0026quot;] data$V1[1] data[[1]][1] data[[\u0026quot;V1\u0026quot;]][1] "},
{"uri": "https://airbone4.github.io/blogR/rlang/4_4_1_json.html","title": "4.4.1 json",
	"tags": [],
	"description": "4.4.1 json",
	"content": "if(!require(\u0026quot;rjson\u0026quot;)){ install.packages(\u0026quot;rjson\u0026quot;) } #\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šrjson x \u0026lt;- list( alpha = 1:5, beta = \u0026quot;Bravo for nonthing\u0026quot;, gamma = list(a=1:3, b=NULL), delta = c(TRUE, FALSE) ) json \u0026lt;- toJSON( x ) hugocmd(\u0026quot;expand\u0026quot; ,'title=\u0026quot;\u0026quot; incode=true') #\u0026gt; \rå±•é–‹\rjson# \u0026lt;span class=\u0026#34;codenote nopre\u0026#34;\u0026gt;ğŸ·\u0026lt;span class=\u0026#34;tooltiptext\u0026#34; \u0026gt; ä½ å¥½ \u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\r#\u0026gt; [1] \u0026#34;{\\\u0026#34;alpha\\\u0026#34;:[1,2,3,4,5],\\\u0026#34;beta\\\u0026#34;:\\\u0026#34;Bravo for nonthing\\\u0026#34;,\\\u0026#34;gamma\\\u0026#34;:{\\\u0026#34;a\\\u0026#34;:[1,2,3],\\\u0026#34;b\\\u0026#34;:null},\\\u0026#34;delta\\\u0026#34;:[true,false]}\u0026#34;\rhugocmd(m=\u0026#34;expand\u0026#34; ,end=T)\r#\u0026gt;  fromJSON( json ) #\u0026gt; $alpha #\u0026gt; [1] 1 2 3 4 5 #\u0026gt; #\u0026gt; $beta #\u0026gt; [1] \u0026quot;Bravo for nonthing\u0026quot; #\u0026gt; #\u0026gt; $gamma #\u0026gt; $gamma$a #\u0026gt; [1] 1 2 3 #\u0026gt; #\u0026gt; $gamma$b #\u0026gt; NULL #\u0026gt; #\u0026gt; #\u0026gt; $delta #\u0026gt; [1] TRUE FALSE "},
{"uri": "https://airbone4.github.io/blogR/rlang/9_1_plot02.html","title": "9.1 Plot more",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": " æ›´å¤šç¹ªåœ– ç¹ªåœ–å€ä¸­çš„å­—ä¸² å‡½æ•¸ text() åœ¨ç¹ªåœ–å€å¡«å…¥å­—ä¸²,ç°¡åŒ–çš„æŒ‡ä»¤å¦‚ä¸‹:\ntext(x, y, labels)\nx and y: æ–‡å­—åº§æ¨™;\nlabels: ä¾‹å¦‚ \u0026quot;a label\u0026quot;\npos: ä¸‹å·¦ä¸Šå³ï¼Œ1234\ncex: æ”¾å¤§å€æ•¸ï¼Œä¾‹å¦‚ï¼Œ0.65ã€‚\nç¯„ä¾‹ :\nd\u0026lt;-head(mtcars) plot(d[,'wt'], d[,'mpg'], main=\u0026quot;Milage vs. Car Weight\\n~~~~~~~~~~~~~~~~~~~\u0026quot;, xlab=\u0026quot;Weight\u0026quot;, ylab=\u0026quot;Miles/(US) gallon\u0026quot;, pch=19, col=\u0026quot;darkgreen\u0026quot;) text(d[,'wt'], d[,'mpg'], row.names(d), cex=1,pos=3,col=\u0026quot;red\u0026quot;)  åœ¨åœ–å½¢marginä¸­å¡«å…¥æ–‡å­— mtext(text, side=3)\ntext : ä¾‹å¦‚\u0026quot;a label\u0026quot;\nside : å“ªä¸€å´ :\né †æ™‚é‡\n1: ä¸‹\n2: å·¦\n3: ä¸Š\n4: åˆ\nç¯„ä¾‹ :\nplot(1:10, 1:10, main=\u0026quot;mtext(...) examples\\n~~~~~~~~~~~\u0026quot;) mtext(\u0026quot;Magic function\u0026quot;, side=3)  Add mathematical annotation to a plot plot(1:10, 1:10, main=\u0026quot;text(...) examples\\n~~~~~~~~~~~\u0026quot;) text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y)) text(7, 4, expression(bar(x) == sum(frac(x[i], n), i==1, n)))  å‡½æ•¸ç•«åœ– eq = function(x){x*x} plot(eq(1:1000), type='l')  å•é¡Œæ˜¯å¦‚æœxåº§æ¨™çš„å¢åŠ ä¸æ˜¯1å–®ä½?\nx\u0026lt;-seq(1,10,0.1) y\u0026lt;-exp(x) x\u0026lt;-y eq = function(x){x*x} plot(x,eq(x), type='l')  plot()çš„åƒæ•¸å¯ä»¥æ˜¯y æˆ–å…©å€‹åƒæ•¸(x,y),ä½†æ˜¯å‡½æ•¸curv()çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯expr,ä¸æ˜¯yã€‚\nãŠ™ï¸ å¦‚æœä¸æŒ‡å®šfrom,to,æˆ–è€…add=T,å…§å®šæ˜¯å¾0åˆ°1ã€‚\neq = function(x){x*x} curve(eq, from=1, to=50, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)   â“1 è§£é‡‹ä¸‹é¢å…©å€‹ç¨‹å¼å€å¡Šç‚ºä½•éŒ¯èª¤?å¦‚ä½•ä¿®æ­£?\neq = function(x){x*x} y\u0026lt;-eq(1:50) curve(y, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;) #\u0026gt; Error in y(x): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;y\u0026quot;  â“2ä¸‹é¢çš„éŒ¯èª¤?\neq = function(x){x*x} z\u0026lt;-1:50 curve(eq(z), xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)   Error in curve(eq(z), xlab = \"x\", ylab = \"y\") : 'expr' must be a function, or a call or an expression containing 'x'\nğŸ’¯ä¸Šé¢çš„eq() (ãŠ™ï¸ é€™å€‹åƒæ•¸æœƒè¢«è½‰æˆexpression è€Œé€™å€‹è¡¨é”å¼éœ€è¦symbol x),è€Œå‡½æ•¸ä¸­çš„è®Šæ•¸å¦‚æœæ˜¯zå°±æ‰¾ä¸åˆ°ç„¶å¾Œç™¼ç”ŸéŒ¯èª¤ã€‚\nsolution:\ncurve(eq(z),xname=\u0026quot;z\u0026quot;, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)  plot example æ­£å¸¸\npolyred = curve(dnorm(x), xlim = c(-4,4)) polygon(polyred$x, polyred$y, col = \u0026quot;red\u0026quot;)  â“ è§£é‡‹ä¸‹é¢å…©å€‹,ç¬¬ä¸€å€‹æ˜¯éŒ¯çš„\nâŒ é€™ä¸æ˜¯æˆ‘å€‘è¦çš„åœ–\neq = function(x){x*x} y\u0026lt;-eq(1:50) curve(eq, 1,50,xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;,lwd=5,col=\u0026quot;yellow\u0026quot;) polygon(1:50,y,lty=2,col=\u0026quot;red\u0026quot;)  â­•\neq = function(x){x*x} y\u0026lt;-eq(1:50) curve(eq, 1,50,xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;,lwd=5,col=\u0026quot;yellow\u0026quot;) polygon(c(1:50,50),c(y,0),lty=2,col=\u0026quot;red\u0026quot;)  ğŸ’¯ ç¬¬ä¸€å€‹é»å’Œæœ€å¾Œä¸€å€‹é»æœƒé€£åœ¨ä¸€èµ·ã€‚ç„¶å¾Œå¡«è‰²ã€‚\nrug set.seed(3) x \u0026lt;- rbeta(150, 3, 25) #png(\u0026quot;rug.png\u0026quot;) hist(x) rug(quantile(x)[2:4], col=2, lwd=2.5) # é è¨­æ˜¯ \u0026quot;0%\u0026quot; \u0026quot;25%\u0026quot; \u0026quot;50%\u0026quot; \u0026quot;75%\u0026quot; \u0026quot;100%\u0026quot;  set.seed(3) x \u0026lt;- rbeta(150, 3, 25) #png(\u0026quot;rug.png\u0026quot;) hist(x) abline(v= quantile(x)[2:4],lty=\u0026quot;dotted\u0026quot;,col=\u0026quot;red\u0026quot; ) xpos= quantile(x)[2:4] text(xpos[1],0, \u0026quot;25%\u0026quot;) text(xpos[2],0, \u0026quot;50%\u0026quot;) text(xpos[3],0, \u0026quot;75%\u0026quot;)  ç·´ç¿’ par(mfrow=c(2,2)) plot(dnorm(x),xlim=c(-4,4)) plot(pnorm(x),xlim=c(-4,4)) plot(qnorm(x),xlim=c(-4,4)) plot(rnorm(x),xlim=c(-4,4))  åœ–å½¢å­˜æª” å¯ä»¥åˆ©ç”¨menuå­˜æª”ï¼Œä¾‹å¦‚File -\u0026gt; Save As.\nä¹Ÿå¯ä»¥åˆ©ç”¨å‡½æ•¸ï¼š\n Function Output to     pdf(\u0026quot;mygraph.pdf\u0026quot;) pdf file   win.metafile(\u0026quot;mygraph.wmf\u0026quot;) windows metafile   png(\u0026quot;mygraph.png\u0026quot;) png file   jpeg(\u0026quot;mygraph.jpg\u0026quot;) jpeg file   bmp(\u0026quot;mygraph.bmp\u0026quot;) bmp file   postscript(\u0026quot;mygraph.ps\u0026quot;) postscript file    \n# Give the chart file a name. png(file = \u0026quot;scatterplot_matrices.png\u0026quot;) # Plot the matrices between 4 variables giving 12 plots. # One variable with 3 others and total 4 variables. pairs(~wt+mpg+disp+cyl,data = mtcars, main = \u0026quot;Scatterplot Matrix\u0026quot;) # Save the file. dev.off()  "},
{"uri": "https://airbone4.github.io/blogR/rlang/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1.html","title": "ä½œæ¥­ç³»çµ±",
	"tags": ["ç’°å¢ƒè®Šæ•¸"],
	"description": "ä½œæ¥­ç³»çµ±",
	"content": "print(Sys.setenv(R_TEST = \u0026quot;testit\u0026quot;, \u0026quot;A+C\u0026quot; = 123)) # `A+C` could also be used #\u0026gt; [1] TRUE TRUE Sys.getenv(\u0026quot;R_TEST\u0026quot;) #\u0026gt; [1] \u0026quot;testit\u0026quot; Sys.unsetenv(\u0026quot;R_TEST\u0026quot;) # on Unix-alike may warn and not succeed Sys.getenv(\u0026quot;R_TEST\u0026quot;, unset = NA) #\u0026gt; [1] NA  rlang::last_trace()\nå®‰è£çš„æ™‚å€™,å‡ºç¾æ‰¾ä¸åˆ°repos,å¯ä»¥å¦‚ä¸‹,é€™æ¨£ä¸ç”¨ç¬¬äºŒæ¬¡å®šç¾©\nr = getOption(\u0026quot;repos\u0026quot;) r[\u0026quot;CRAN\u0026quot;] = \u0026quot;http://cran.us.r-project.org\u0026quot; options(repos = r) "},
{"uri": "https://airbone4.github.io/blogR/economics/mc_%E5%9F%BA%E6%9C%AC.html","title": "MC_åŸºæœ¬",
	"tags": [],
	"description": "MC_åŸºæœ¬",
	"content": "äº‚æ•¸ # Sample from a standard normal RV with sample size n=5: rnorm(5) # A different sample from the same distribution: rnorm(5) # Set the seed of the random number generator and take two samples: set.seed(6254137) rnorm(5) rnorm(5) # Reset the seed to the same value to get the same samples again: set.seed(6254137) rnorm(5) rnorm(5)  æŠ½æ¨£ rbinom(10,1,0.5) # Bernouli rnorm(10) # normal  é‡è¤‡æŠ½æ¨£\n# Set the random seed set.seed(123456) # initialize ybar to a vector of length r=10000 to later store results: r \u0026lt;- 10000 ybar \u0026lt;- numeric(r) # repeat r times: for(j in 1:r) { # Draw a sample and store the sample mean in pos. j=1,2,... of ybar: sample \u0026lt;- rnorm(100,10,2) ybar[j] \u0026lt;- mean(sample) }  çµæœåˆ†æ\n# The first 20 of 10000 estimates: ybar[1:20] # Simulated mean: mean(ybar) # Simulated variance: var(ybar) # Simulated density: plot(density(ybar)) curve( dnorm(x,10,sqrt(.04)), add=TRUE,lty=2)  æ¨¡æ“¬ä¼°è¨ˆ # Set the random seed set.seed(123456) # Draw a sample given the population parameters sample \u0026lt;- rnorm(100,10,2) # Estimate the population mean with the sample average mean(sample) #\u0026gt; [1] 10.03364 # Draw a different sample and estimate again: sample \u0026lt;- rnorm(100,10,2) mean(sample) #\u0026gt; [1] 9.913197 # Draw a third sample and estimate again: sample \u0026lt;- rnorm(100,10,2) mean(sample) #\u0026gt; [1] 10.21746  æ¨¡æ“¬æ¨è«– # Set the random seed set.seed(123456) # initialize vectors to later store results: r \u0026lt;- 10000 CIlower \u0026lt;- numeric(r); CIupper \u0026lt;- numeric(r) pvalue1 \u0026lt;- numeric(r); pvalue2 \u0026lt;- numeric(r) # repeat r times: for(j in 1:r) { # Draw a sample sample \u0026lt;- rnorm(100,10,2) # test the (correct) null hypothesis mu=10: testres1 \u0026lt;- t.test(sample,mu=10) # store CI \u0026amp; p value: CIlower[j] \u0026lt;- testres1$conf.int[1] CIupper[j] \u0026lt;- testres1$conf.int[2] pvalue1[j] \u0026lt;- testres1$p.value # test the (incorrect) null hypothesis mu=9.5 \u0026amp; store the p value: pvalue2[j] \u0026lt;- t.test(sample,mu=9.5)$p.value } # Test results as logical value reject1\u0026lt;-pvalue1\u0026lt;=0.05; reject2\u0026lt;-pvalue2\u0026lt;=0.05 table(reject1) #\u0026gt; reject1 #\u0026gt; FALSE TRUE #\u0026gt; 9492 508 table(reject2) #\u0026gt; reject2 #\u0026gt; FALSE TRUE #\u0026gt; 3043 6957 "},
{"uri": "https://airbone4.github.io/blogR/economics/mpg.html","title": "mpg",
	"tags": [],
	"description": "mpg",
	"content": "ggplot ex  åƒè€ƒ\nlibrary(ggplot2) ggplot(midwest, aes(x=area, y=poptotal)) + geom_point()   ex library(ggplot2) ex1 \u0026lt;- ggplot(mtcars) ex1 \u0026lt;- ex1 + aes(x = mpg, y = wt) ex1 \u0026lt;- ex1 + geom_point() summary(ex1) #\u0026gt; data: mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb [32x11] #\u0026gt; mapping: x = ~mpg, y = ~wt #\u0026gt; faceting: \u0026lt;ggproto object: Class FacetNull, Facet, gg\u0026gt; #\u0026gt; compute_layout: function #\u0026gt; draw_back: function #\u0026gt; draw_front: function #\u0026gt; draw_labels: function #\u0026gt; draw_panels: function #\u0026gt; finish_data: function #\u0026gt; init_scales: function #\u0026gt; map_data: function #\u0026gt; params: list #\u0026gt; setup_data: function #\u0026gt; setup_params: function #\u0026gt; shrink: TRUE #\u0026gt; train_scales: function #\u0026gt; vars: function #\u0026gt; super: \u0026lt;ggproto object: Class FacetNull, Facet, gg\u0026gt; #\u0026gt; ----------------------------------- #\u0026gt; geom_point: na.rm = FALSE #\u0026gt; stat_identity: na.rm = FALSE #\u0026gt; position_identity ex1 # ğŸ·é€™è£¡æ‰æœ‰åœ–å‡ºä¾†   éƒ¨åˆ†ä¿®æ”¹: åªæ”¹è®Šé¡è‰²\nex1 + geom_point(aes(colour = factor(cyl))) #ğŸ·ç”¨æ±½ç¼¸å€’é¡è‰²   éƒ¨åˆ†ä¿®æ”¹: åªæ”¹è®ŠYè»¸\nex1 + geom_point(aes(y = disp))  åˆªé™¤\naes(y = NULL) #\u0026gt; Aesthetic mapping: #\u0026gt; * `y` -\u0026gt; NULL ex1  mpg library(ggplot2) # First rows of data of data set mpg: head(mpg) #\u0026gt; # A tibble: 6 x 11 #\u0026gt; manufacturer model displ year cyl trans drv cty hwy fl class #\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; #\u0026gt; 1 audi a4 1.8 1999 4 auto(l5) f 18 29 p compa~ #\u0026gt; 2 audi a4 1.8 1999 4 manual(m5) f 21 29 p compa~ #\u0026gt; 3 audi a4 2 2008 4 manual(m6) f 20 31 p compa~ #\u0026gt; 4 audi a4 2 2008 4 auto(av) f 21 30 p compa~ #\u0026gt; 5 audi a4 2.8 1999 6 auto(l5) f 16 26 p compa~ #\u0026gt; 6 audi a4 2.8 1999 6 manual(m5) f 18 26 p compa~ ggplot() + geom_point( data=mpg, mapping=aes(x=displ, y=hwy) ) ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_smooth() #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'  ggplot(mpg, aes(displ, hwy)) + geom_point(color=gray(0.5)) + geom_smooth(color=\u0026quot;black\u0026quot;) #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'  ggplot(mpg, aes(displ, hwy)) + geom_point( aes(color=class) ) + geom_smooth(color=\u0026quot;black\u0026quot;) + scale_color_grey() #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'  ggplot(mpg, aes(displ, hwy)) + geom_point( aes(color=class, shape=class) ) + geom_smooth(color=\u0026quot;black\u0026quot;) + scale_color_grey() + scale_shape_manual(values=1:7) #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'  ggplot(mpg, aes(displ, hwy, color=class, shape=class)) + geom_point() + geom_smooth(se=FALSE) + scale_color_grey() + scale_shape_manual(values=1:7) #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x' #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : span too small. fewer data values than degrees of freedom. #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : pseudoinverse used at 5.6935 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : neighborhood radius 0.5065 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : reciprocal condition number 0 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : There are other near singularities as well. 0.65044 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : pseudoinverse used at 4.008 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : neighborhood radius 0.708 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : reciprocal condition number 0 #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = #\u0026gt; parametric, : There are other near singularities as well. 0.25  "},
{"uri": "https://airbone4.github.io/blogR/economics/%E5%89%8D%E7%BD%AE.html","title": "å‰ç½®æº–å‚™",
	"tags": [],
	"description": "data",
	"content": "install.packages(\u0026quot;wooldridge\u0026quot;) install.packages(\u0026quot;rio\u0026quot;) # more install.packages(\u0026quot;WDI\u0026quot;) install.packages(\u0026quot;dplyr\u0026quot;) install.packages(\u0026quot;ggplot\u0026quot;)  ç·´ç¿’è³‡æ–™çš„å¹¾ç¨®è¼‰å…¥è³‡æ–™çš„æ–¹æ³•\ndata(affairs, package='wooldridge') # Version 2: Adjust path affairs2 \u0026lt;- rio::import(\u0026quot;~/data/wooldridge/affairs.dta\u0026quot;) # Version 3: Change working directory setwd(\u0026quot;~/data/wooldridge\u0026quot;) affairs3 \u0026lt;- rio::import(\u0026quot;affairs.dta\u0026quot;) # Version 4: directly load from internet affairs4 \u0026lt;- rio::import(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/affairs.dta\u0026quot;)  ä»¥å¥—ä»¶è¼‰å…¥ç‚ºä¾‹\ndata(affairs, package='wooldridge') # è¨ˆç®—å¹³å‡ mean(affairs$naffairs) #\u0026gt; [1] 1.455907  ä¸€èˆ¬è³‡æ–™è™•ç† - è®€ã€è½‰ã€ç®—ã€å¯« # Define one x vector for all: year \u0026lt;- c(2008,2009,2010,2011,2012,2013) # Define a matrix of y values: product1\u0026lt;-c(0,3,6,9,7,8); product2\u0026lt;-c(1,2,3,5,9,6); product3\u0026lt;-c(2,4,4,2,3,2) sales_mat \u0026lt;- cbind(product1,product2,product3) rownames(sales_mat) \u0026lt;- year # The matrix looks like this: sales_mat #\u0026gt; product1 product2 product3 #\u0026gt; 2008 0 1 2 #\u0026gt; 2009 3 2 4 #\u0026gt; 2010 6 3 4 #\u0026gt; 2011 9 5 2 #\u0026gt; 2012 7 9 3 #\u0026gt; 2013 8 6 2 # Create a data frame and display it: sales \u0026lt;- as.data.frame(sales_mat) sales #\u0026gt; product1 product2 product3 #\u0026gt; 2008 0 1 2 #\u0026gt; 2009 3 2 4 #\u0026gt; 2010 6 3 4 #\u0026gt; 2011 9 5 2 #\u0026gt; 2012 7 9 3 #\u0026gt; 2013 8 6 2 # save data frame as RData file (in the current working directory) save(sales, file = \u0026quot;oursalesdata.RData\u0026quot;) # remove data frame \u0026quot;sales\u0026quot; from memory rm(sales) # Does variable \u0026quot;sales\u0026quot; exist? exists(\u0026quot;sales\u0026quot;) #\u0026gt; [1] FALSE # Load data set (in the current working directory): load(\u0026quot;oursalesdata.RData\u0026quot;) # Does variable \u0026quot;sales\u0026quot; exist? exists(\u0026quot;sales\u0026quot;) #\u0026gt; [1] TRUE sales #\u0026gt; product1 product2 product3 #\u0026gt; 2008 0 1 2 #\u0026gt; 2009 3 2 4 #\u0026gt; 2010 6 3 4 #\u0026gt; 2011 9 5 2 #\u0026gt; 2012 7 9 3 #\u0026gt; 2013 8 6 2 # averages of the variables: colMeans(sales) #\u0026gt; product1 product2 product3 #\u0026gt; 5.500000 4.333333 2.833333  basic statistic 1 - pnorm(2,4,3) + pnorm(-2,4,3) #\u0026gt; [1] 0.7702576 # Using the transformation: pnorm(2/3) - pnorm(-2/3) #\u0026gt; [1] 0.4950149 # Working directly with the distribution of X: pnorm(6,4,3) - pnorm(2,4,3) #\u0026gt; [1] 0.4950149  table # load data set data(affairs, package='wooldridge') # Generate \u0026quot;Factors\u0026quot; to attach labels haskids \u0026lt;- factor(affairs$kids,labels=c(\u0026quot;no\u0026quot;,\u0026quot;yes\u0026quot;)) mlab \u0026lt;- c(\u0026quot;very unhappy\u0026quot;,\u0026quot;unhappy\u0026quot;,\u0026quot;average\u0026quot;,\u0026quot;happy\u0026quot;, \u0026quot;very happy\u0026quot;) marriage \u0026lt;- factor(affairs$ratemarr, labels=mlab) # Frequencies for having kids: table(haskids) #\u0026gt; haskids #\u0026gt; no yes #\u0026gt; 171 430 # Marriage ratings (share): prop.table(table(marriage)) #\u0026gt; marriage #\u0026gt; very unhappy unhappy average happy very happy #\u0026gt; 0.0266223 0.1098170 0.1547421 0.3227953 0.3860233 # Contigency table: counts (display \u0026amp; store in var.) (countstab \u0026lt;- table(marriage,haskids)) #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 3 13 #\u0026gt; unhappy 8 58 #\u0026gt; average 24 69 #\u0026gt; happy 40 154 #\u0026gt; very happy 96 136 # Share within \u0026quot;marriage\u0026quot; (i.e. within a row): prop.table(countstab, margin=1) #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.1875000 0.8125000 #\u0026gt; unhappy 0.1212121 0.8787879 #\u0026gt; average 0.2580645 0.7419355 #\u0026gt; happy 0.2061856 0.7938144 #\u0026gt; very happy 0.4137931 0.5862069 # Share within \u0026quot;haskids\u0026quot; (i.e. within a column): prop.table(countstab, margin=2) #\u0026gt; haskids #\u0026gt; marriage no yes #\u0026gt; very unhappy 0.01754386 0.03023256 #\u0026gt; unhappy 0.04678363 0.13488372 #\u0026gt; average 0.14035088 0.16046512 #\u0026gt; happy 0.23391813 0.35813953 #\u0026gt; very happy 0.56140351 0.31627907  data frame # Define one x vector for all: year \u0026lt;- c(2008,2009,2010,2011,2012,2013) # Define a matrix of y values: product1\u0026lt;-c(0,3,6,9,7,8); product2\u0026lt;-c(1,2,3,5,9,6); product3\u0026lt;-c(2,4,4,2,3,2) sales_mat \u0026lt;- cbind(product1,product2,product3) rownames(sales_mat) \u0026lt;- year # The matrix looks like this: sales_mat #\u0026gt; product1 product2 product3 #\u0026gt; 2008 0 1 2 #\u0026gt; 2009 3 2 4 #\u0026gt; 2010 6 3 4 #\u0026gt; 2011 9 5 2 #\u0026gt; 2012 7 9 3 #\u0026gt; 2013 8 6 2 # Create a data frame and display it: sales \u0026lt;- as.data.frame(sales_mat) sales #\u0026gt; product1 product2 product3 #\u0026gt; 2008 0 1 2 #\u0026gt; 2009 3 2 4 #\u0026gt; 2010 6 3 4 #\u0026gt; 2011 9 5 2 #\u0026gt; 2012 7 9 3 #\u0026gt; 2013 8 6 2  ç·´ç¿’ Wdi library(WDI) wdi_raw \u0026lt;- WDI(indicator=c(\u0026quot;SP.DYN.LE00.FE.IN\u0026quot;), start = 1960, end = 2014) # ğŸ·WDI æ˜¯ä¸€å€‹å‡½æ•¸,wdi_rawæ˜¯ä¸€å€‹data.frame  # ä¸è¦ç›´æ¥é¡¯ç¤ºæ‰€æœ‰è³‡æ–™,å¤ªé•· head(wdi_raw,n=10) #\u0026gt; iso2c country SP.DYN.LE00.FE.IN year #\u0026gt; 1 ZH Africa Eastern and Southern 63.74479 2014 #\u0026gt; 2 ZH Africa Eastern and Southern 63.01116 2013 #\u0026gt; 3 ZH Africa Eastern and Southern 62.19697 2012 #\u0026gt; 4 ZH Africa Eastern and Southern 61.31294 2011 #\u0026gt; 5 ZH Africa Eastern and Southern 60.37721 2010 #\u0026gt; 6 ZH Africa Eastern and Southern 59.40726 2009 #\u0026gt; 7 ZH Africa Eastern and Southern 58.42882 2008 #\u0026gt; 8 ZH Africa Eastern and Southern 57.47517 2007 #\u0026gt; 9 ZH Africa Eastern and Southern 56.57331 2006 #\u0026gt; 10 ZH Africa Eastern and Southern 55.75485 2005 #tail(wdi_raw)  descriptive statistics data(ceosal1, package='wooldridge') # class(ceosal1) = data.frame # sample average: mean(ceosal1$salary) #\u0026gt; [1] 1281.12 # sample median: median(ceosal1$salary) #\u0026gt; [1] 1039 #standard deviation: sd(ceosal1$salary) #\u0026gt; [1] 1372.345 # summary information: summary(ceosal1$salary) #\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 223 736 1039 1281 1407 14822 # correlation with ROE: cor(ceosal1$salary, ceosal1$roe) #\u0026gt; [1] 0.1148417  tæª¢å®š # data for the scrap rates examples: SR87\u0026lt;-c(10,1,6,.45,1.25,1.3,1.06,3,8.18,1.67,.98,1,.45,5.03,8,9,18,.28, 7,3.97) SR88\u0026lt;-c(3,1,5,.5,1.54,1.5,.8,2,.67,1.17,.51,.5,.61,6.7,4,7,19,.2,5,3.83) Change \u0026lt;- SR88 - SR87 # Ingredients to CI formula (avgCh\u0026lt;- mean(Change)) # Changeçš„å¹³å‡ #\u0026gt; [1] -1.1545 (n \u0026lt;- length(Change)) #\u0026gt; [1] 20 (sdCh \u0026lt;- sd(Change)) # Changeçš„æ¨™æº–å·® #\u0026gt; [1] 2.400639 (se \u0026lt;- sdCh/sqrt(n)) # æ¨™æº–èª¤ #\u0026gt; [1] 0.5367992 (c \u0026lt;- qt(.975, n-1)) #quantile of t dist #\u0026gt; [1] 2.093024 # avgChçš„95%ä¿¡è³´å€é–“ c( avgCh - c*se, avgCh + c*se ) #\u0026gt; [1] -2.27803369 -0.03096631 # t statistic for H0: mu=0: (t \u0026lt;- avgCh/se) #\u0026gt; [1] -2.150711 # p value (p \u0026lt;- pt(t,n-1)) # ğŸ·p(probabilityæ©Ÿç‡) â• tåˆ†é… = pt  #\u0026gt; [1] 0.02229063  æˆ–æ˜¯ç›´æ¥ä½¿ç”¨å‡½æ•¸,å°ç…§å¦‚ä¸‹\n# two-sided CI t.test(Change) #\u0026gt; #\u0026gt; One Sample t-test #\u0026gt; #\u0026gt; data: Change #\u0026gt; t = -2.1507, df = 19, p-value = 0.04458 #\u0026gt; alternative hypothesis: true mean is not equal to 0 #\u0026gt; 95 percent confidence interval: #\u0026gt; -2.27803369 -0.03096631 #\u0026gt; sample estimates: #\u0026gt; mean of x #\u0026gt; -1.1545 # 1-sided test: t.test(Change, alternative=\u0026quot;less\u0026quot;) #\u0026gt; #\u0026gt; One Sample t-test #\u0026gt; #\u0026gt; data: Change #\u0026gt; t = -2.1507, df = 19, p-value = 0.02229 #\u0026gt; alternative hypothesis: true mean is less than 0 #\u0026gt; 95 percent confidence interval: #\u0026gt; -Inf -0.2263028 #\u0026gt; sample estimates: #\u0026gt; mean of x #\u0026gt; -1.1545  ç·´ç¿’ç¯„ä¾‹ data(audit, package='wooldridge') # two-sided CI t.test(audit$y) # 1-sided test: t.test(audit$y, alternative=\u0026quot;less\u0026quot;)  ä¿¡è³´å€é–“ data(audit, package='wooldridge') # Ingredients to CI formula (avgy\u0026lt;- mean(audit$y)) #\u0026gt; [1] -0.1327801 (n \u0026lt;- length(audit$y)) #\u0026gt; [1] 241 (sdy \u0026lt;- sd(audit$y)) #\u0026gt; [1] 0.4819709 (se \u0026lt;- sdy/sqrt(n)) #\u0026gt; [1] 0.03104648 (c \u0026lt;- qnorm(.975)) # ğŸ·q â• å¸¸æ…‹(norm) = qnorm  #\u0026gt; [1] 1.959964 # 95% Confidence intervall: avgy + c * c(-se,+se) #\u0026gt; [1] -0.19363006 -0.07193011 # 99% Confidence intervall: avgy + qnorm(.995) * c(-se,+se) #\u0026gt; [1] -0.21275051 -0.05280966  # t statistic for H0: mu=0: (t \u0026lt;- avgy/se) #-4.276816 #\u0026gt; [1] -4.276816 # p value (p \u0026lt;- pt(t,240)) #\u0026gt; [1] 1.369271e-05 # Critical values for t distribution with n-1=240 d.f.: alpha.one.tailed = c(0.1, 0.05, 0.025, 0.01, 0.005, .001) CV \u0026lt;- qt(1 - alpha.one.tailed, n-1) # ğŸ·q â• tåˆ†é… = qt  cbind(alpha.one.tailed, CV) #\u0026gt; alpha.one.tailed CV #\u0026gt; [1,] 0.100 1.285089 #\u0026gt; [2,] 0.050 1.651227 #\u0026gt; [3,] 0.025 1.969898 #\u0026gt; [4,] 0.010 2.341985 #\u0026gt; [5,] 0.005 2.596469 #\u0026gt; [6,] 0.001 3.124536  plot basic plot curve(dnorm(x,0,1),-10,10,lwd=1,lty=1) curve(dnorm(x,0,2),-10,10,add=TRUE,lwd=1,lty=1) #ğŸ·ç–Šåœ–  curve(dnorm(x,0,3),-10,10,add=TRUE,lwd=1,lty=1)  histogram data(ceosal1, package='wooldridge') # Extract ROE to single vector ROE \u0026lt;- ceosal1$roe # Subfigure (a): histogram (counts) hist(ROE) # Subfigure (b): histogram (densities, explicit breaks) hist(ROE, breaks=c(0,5,10,20,30,60) )  ggplot2 library(ggplot2) head(mpg) #\u0026gt; # A tibble: 6 x 11 #\u0026gt; manufacturer model displ year cyl trans drv cty hwy fl class #\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; #\u0026gt; 1 audi a4 1.8 1999 4 auto(l5) f 18 29 p compa~ #\u0026gt; 2 audi a4 1.8 1999 4 manual(m5) f 21 29 p compa~ #\u0026gt; 3 audi a4 2 2008 4 manual(m6) f 20 31 p compa~ #\u0026gt; 4 audi a4 2 2008 4 auto(av) f 21 30 p compa~ #\u0026gt; 5 audi a4 2.8 1999 6 auto(l5) f 16 26 p compa~ #\u0026gt; 6 audi a4 2.8 1999 6 manual(m5) f 18 26 p compa~ ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_smooth() #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'  "},
{"uri": "https://airbone4.github.io/blogR/topic/experiment/central.html","title": "ä¸­å¤®",
	"tags": [],
	"description": "åŒ…æ‹¬ä¸­å¤®æ¥µé™",
	"content": " R Markdown å“¡å·¥çš„è–ªæ°´åˆ†é…ï¼Œåš´é‡æ‡·ç–‘ä¸æ˜¯å¸¸æ…‹åˆ†é…\n100: -\u0026gt;\n mu\u0026lt;-100\n sd\u0026lt;-100\n se(stander error) \u0026lt;- /sd/sqrt(100)\n  1.96\n-1.96/se , /mu , 1.96 /se\nboot strapping\næŠŠæˆ‘å€‘å¾—åˆ°çš„100å€‹æ¨£æœ¬ï¼Œé‡è¤‡æŠ½1000ï¼Œ(æ¯æ¬¡å¿…é ˆæŠ½100å€‹)ç„¶å¾Œå¾—åˆ°1000å€‹å¹³å‡\nmu,sd\npercentile(2.5) , mu, percentile(97.5)\nN\u0026lt;-10 metasample\u0026lt;-rnorm(N,5,2) bmu\u0026lt;-numeric(1000) for(i in 1:1000){ rndno\u0026lt;-as.integer(runif(N)*N)+1 smp\u0026lt;-metasample[rndno] bmu[i]\u0026lt;-mean(smp) } p\u0026lt;-density(bmu) plot(p) qq\u0026lt;-quantile(bmu) rug(qq,col=\u0026quot;red\u0026quot;)  qq #\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 2.956123 4.972385 5.370682 5.739111 6.897819  N\u0026lt;-100 metasample\u0026lt;-rnorm(N,5,2) bmu\u0026lt;-numeric(1000) for(i in 1:1000){ rndno\u0026lt;-as.integer(runif(N)*N)+1 smp\u0026lt;-metasample[rndno] bmu[i]\u0026lt;-mean(smp) } p\u0026lt;-density(bmu) plot(p) qq\u0026lt;-quantile(bmu) rug(qq,col=\u0026quot;red\u0026quot;)  qq #\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 4.813307 5.265694 5.383897 5.521531 5.898978  N\u0026lt;-100 metasample\u0026lt;-rnorm(N,5,2) hinfo\u0026lt;-hist(metasample) lx\u0026lt;-seq(min(metasample),max(metasample),length=100) ly\u0026lt;-dnorm(lx,mean(metasample),sd(metasample)) sy\u0026lt;-ly*(diff(lx)[1])*N lines(lx,sy,col=\u0026quot;blue\u0026quot;)  N\u0026lt;-100 metasample\u0026lt;-rnorm(N,5,2) hinfo\u0026lt;-hist(metasample) ly\u0026lt;-dnorm(hinfo$mids,mean(metasample),sd(metasample)) sy\u0026lt;-ly*(diff(hinfo$mids)[1])*N lines(hinfo$mids,sy,col=\u0026quot;blue\u0026quot;)  "},
{"uri": "https://airbone4.github.io/blogR/topic/interesting.html","title": "interesting",
	"tags": [],
	"description": "",
	"content": " seems interesting  è‡ªå‹•åŒ–\n  "}]
