[
{"uri": "/blogR//rlang/hw/dataset_class.html","title": "è³‡æ–™é›†",
	"tags": [],
	"description": "ç·´ç¿’",
	"content": "\r\r\r\r\râ“\n è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›è³‡æ–™é›†   ğŸ“data()å¯ä»¥åˆ—å‡ºç›®å‰æœ‰ç”šéº¼è³‡æ–™å¯ä»¥ç”¨,ä¹Ÿå¯ä»¥æ”¾å…¥åƒæ•¸,åªåˆ—å‡ºæŸå€‹packageçš„è³‡æ–™é›†ã€‚   å¯«å€‹å‡½æ•¸,åˆ¤æ–·ç›®å‰æˆ‘å€‘è¦çš„è³‡æ–™é›†æ˜¯ä¸æ˜¯å­˜åœ¨  â“\n è¦çŸ¥é“è³‡æ–™é›†carsçš„æ¬„ä½ åˆ—å‡ºå‰10ç­†è³‡æ–™   normal pretty: ğŸ“ å®‰è£DT: install.pacakges(â€œDTâ€),åƒè€ƒ ğŸ’£ æœƒç¼ºå¤±å„ç¨®ç¨‹å¼åº«  hint  data() names(cars)  List of 4 #ğŸ·ğŸ‘è·Ÿæˆ‘å€‘èªªé€™æ˜¯list ,æœ‰4å€‹å…ƒç´ \r$ title : chr \u0026quot;Data sets\u0026quot;\r$ header : NULL\r$ results: chr [1:104, 1:4] # ğŸ·(é€™æ˜¯ä¸€å€‹å­—ä¸²çŸ©é™£,å¯ä»¥å¤§è‡´è³‡æ–™åœ¨é€™è£¡) \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; ...\r..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2 ## ğŸ·(2ç¶­åº¦çš„åç¨±,é€™è£¡å¯ä»¥çœ‹åˆ°æ²’æœ‰ROWåç¨±,ä½†æ˜¯æœ‰æ¬„ä½åç¨±) .. ..$ : NULL .. ..$ : chr [1:4] #ğŸ·(é€™è£¡å¯ä»¥çœ‹å‡ºæ˜¯ä¸€å€‹çŸ©é™£) \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot;\r$ footer : chr \u0026quot;Use â€˜data(package = .packages(all.available = TRUE))â€™\\nto list the data sets in all *available* packages.\u0026quot;\r- attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;packageIQR\u0026quot;\r ğŸ“ å®‰è£DT: install.pacakges(â€œDTâ€),åƒè€ƒ  practice \rå±•é–‹\r``` r\rlibrary(DT)\rdn\u0026lt;-data()\rss\u0026lt;-dn$results[,\u0026#34;Title\u0026#34;]\rds\u0026lt;-data.frame(ss)\rdatatable(ds)\r```\r\u0026lt;div id=\u0026quot;htmlwidget-1\u0026quot; style=\u0026quot;width:100%;height:auto;\u0026quot; class=\u0026quot;datatables html-widget\u0026quot;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script type=\u0026quot;application/json\u0026quot; data-for=\u0026quot;htmlwidget-1\u0026quot;\u0026gt;{\u0026quot;x\u0026quot;:{\u0026quot;filter\u0026quot;:\u0026quot;none\u0026quot;,\u0026quot;vertical\u0026quot;:false,\u0026quot;data\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;2\u0026quot;,\u0026quot;3\u0026quot;,\u0026quot;4\u0026quot;,\u0026quot;5\u0026quot;,\u0026quot;6\u0026quot;,\u0026quot;7\u0026quot;,\u0026quot;8\u0026quot;,\u0026quot;9\u0026quot;,\u0026quot;10\u0026quot;,\u0026quot;11\u0026quot;,\u0026quot;12\u0026quot;,\u0026quot;13\u0026quot;,\u0026quot;14\u0026quot;,\u0026quot;15\u0026quot;,\u0026quot;16\u0026quot;,\u0026quot;17\u0026quot;,\u0026quot;18\u0026quot;,\u0026quot;19\u0026quot;,\u0026quot;20\u0026quot;,\u0026quot;21\u0026quot;,\u0026quot;22\u0026quot;,\u0026quot;23\u0026quot;,\u0026quot;24\u0026quot;,\u0026quot;25\u0026quot;,\u0026quot;26\u0026quot;,\u0026quot;27\u0026quot;,\u0026quot;28\u0026quot;,\u0026quot;29\u0026quot;,\u0026quot;30\u0026quot;,\u0026quot;31\u0026quot;,\u0026quot;32\u0026quot;,\u0026quot;33\u0026quot;,\u0026quot;34\u0026quot;,\u0026quot;35\u0026quot;,\u0026quot;36\u0026quot;,\u0026quot;37\u0026quot;,\u0026quot;38\u0026quot;,\u0026quot;39\u0026quot;,\u0026quot;40\u0026quot;,\u0026quot;41\u0026quot;,\u0026quot;42\u0026quot;,\u0026quot;43\u0026quot;,\u0026quot;44\u0026quot;,\u0026quot;45\u0026quot;,\u0026quot;46\u0026quot;,\u0026quot;47\u0026quot;,\u0026quot;48\u0026quot;,\u0026quot;49\u0026quot;,\u0026quot;50\u0026quot;,\u0026quot;51\u0026quot;,\u0026quot;52\u0026quot;,\u0026quot;53\u0026quot;,\u0026quot;54\u0026quot;,\u0026quot;55\u0026quot;,\u0026quot;56\u0026quot;,\u0026quot;57\u0026quot;,\u0026quot;58\u0026quot;,\u0026quot;59\u0026quot;,\u0026quot;60\u0026quot;,\u0026quot;61\u0026quot;,\u0026quot;62\u0026quot;,\u0026quot;63\u0026quot;,\u0026quot;64\u0026quot;,\u0026quot;65\u0026quot;,\u0026quot;66\u0026quot;,\u0026quot;67\u0026quot;,\u0026quot;68\u0026quot;,\u0026quot;69\u0026quot;,\u0026quot;70\u0026quot;,\u0026quot;71\u0026quot;,\u0026quot;72\u0026quot;,\u0026quot;73\u0026quot;,\u0026quot;74\u0026quot;,\u0026quot;75\u0026quot;,\u0026quot;76\u0026quot;,\u0026quot;77\u0026quot;,\u0026quot;78\u0026quot;,\u0026quot;79\u0026quot;,\u0026quot;80\u0026quot;,\u0026quot;81\u0026quot;,\u0026quot;82\u0026quot;,\u0026quot;83\u0026quot;,\u0026quot;84\u0026quot;,\u0026quot;85\u0026quot;,\u0026quot;86\u0026quot;,\u0026quot;87\u0026quot;,\u0026quot;88\u0026quot;,\u0026quot;89\u0026quot;,\u0026quot;90\u0026quot;,\u0026quot;91\u0026quot;,\u0026quot;92\u0026quot;,\u0026quot;93\u0026quot;,\u0026quot;94\u0026quot;,\u0026quot;95\u0026quot;,\u0026quot;96\u0026quot;,\u0026quot;97\u0026quot;,\u0026quot;98\u0026quot;,\u0026quot;99\u0026quot;,\u0026quot;100\u0026quot;,\u0026quot;101\u0026quot;,\u0026quot;102\u0026quot;,\u0026quot;103\u0026quot;,\u0026quot;104\u0026quot;],[\u0026quot;Monthly Airline Passenger Numbers 1949-1960\u0026quot;,\u0026quot;Sales Data with Leading Indicator\u0026quot;,\u0026quot;Sales Data with Leading Indicator\u0026quot;,\u0026quot;Biochemical Oxygen Demand\u0026quot;,\u0026quot;Carbon Dioxide Uptake in Grass Plants\u0026quot;,\u0026quot;Weight versus age of chicks on different diets\u0026quot;,\u0026quot;Elisa assay of DNase\u0026quot;,\u0026quot;Daily Closing Prices of Major European Stock Indices, 1991-1998\u0026quot;,\u0026quot;Determination of Formaldehyde\u0026quot;,\u0026quot;Hair and Eye Color of Statistics Students\u0026quot;,\u0026quot;Harman Example 2.3\u0026quot;,\u0026quot;Harman Example 7.4\u0026quot;,\u0026quot;Pharmacokinetics of Indomethacin\u0026quot;,\u0026quot;Effectiveness of Insect Sprays\u0026quot;,\u0026quot;Quarterly Earnings per Johnson \u0026amp;amp; Johnson Share\u0026quot;,\u0026quot;Level of Lake Huron 1875-1972\u0026quot;,\u0026quot;Intercountry Life-Cycle Savings Data\u0026quot;,\u0026quot;Growth of Loblolly pine trees\u0026quot;,\u0026quot;Flow of the River Nile\u0026quot;,\u0026quot;Growth of Orange Trees\u0026quot;,\u0026quot;Potency of Orchard Sprays\u0026quot;,\u0026quot;Results from an Experiment on Plant Growth\u0026quot;,\u0026quot;Reaction Velocity of an Enzymatic Reaction\u0026quot;,\u0026quot;Road Casualties in Great Britain 1969-84\u0026quot;,\u0026quot;Pharmacokinetics of Theophylline\u0026quot;,\u0026quot;Survival of passengers on the Titanic\u0026quot;,\u0026quot;The Effect of Vitamin C on Tooth Growth in Guinea Pigs\u0026quot;,\u0026quot;Student Admissions at UC Berkeley\u0026quot;,\u0026quot;Road Casualties in Great Britain 1969-84\u0026quot;,\u0026quot;UK Quarterly Gas Consumption\u0026quot;,\u0026quot;Accidental Deaths in the US 1973-1978\u0026quot;,\u0026quot;Violent Crime Rates by US State\u0026quot;,\u0026quot;Lawyers' Ratings of State Judges in the US Superior Court\u0026quot;,\u0026quot;Personal Expenditure Data\u0026quot;,\u0026quot;Distances Between European Cities and Between US Cities\u0026quot;,\u0026quot;Death Rates in Virginia (1940)\u0026quot;,\u0026quot;Internet Usage per Minute\u0026quot;,\u0026quot;The World's Telephones\u0026quot;,\u0026quot;Ability and Intelligence Tests\u0026quot;,\u0026quot;Passenger Miles on Commercial US Airlines, 1937-1960\u0026quot;,\u0026quot;New York Air Quality Measurements\u0026quot;,\u0026quot;Anscombe's Quartet of 'Identical' Simple Linear Regressions\u0026quot;,\u0026quot;The Joyner-Boore Attenuation Data\u0026quot;,\u0026quot;The Chatterjee-Price Attitude Data\u0026quot;,\u0026quot;Quarterly Time Series of the Number of Australian Residents\u0026quot;,\u0026quot;Body Temperature Series of Two Beavers\u0026quot;,\u0026quot;Body Temperature Series of Two Beavers\u0026quot;,\u0026quot;Speed and Stopping Distances of Cars\u0026quot;,\u0026quot;Chicken Weights by Feed Type\u0026quot;,\u0026quot;Mauna Loa Atmospheric CO2 Concentration\u0026quot;,\u0026quot;Student's 3000 Criminals Data\u0026quot;,\u0026quot;Yearly Numbers of Important Discoveries\u0026quot;,\u0026quot;Smoking, Alcohol and (O)esophageal Cancer\u0026quot;,\u0026quot;Conversion Rates of Euro Currencies\u0026quot;,\u0026quot;Conversion Rates of Euro Currencies\u0026quot;,\u0026quot;Distances Between European Cities and Between US Cities\u0026quot;,\u0026quot;Old Faithful Geyser Data\u0026quot;,\u0026quot;Monthly Deaths from Lung Diseases in the UK\u0026quot;,\u0026quot;Freeny's Revenue Data\u0026quot;,\u0026quot;Freeny's Revenue Data\u0026quot;,\u0026quot;Freeny's Revenue Data\u0026quot;,\u0026quot;Infertility after Spontaneous and Induced Abortion\u0026quot;,\u0026quot;Edgar Anderson's Iris Data\u0026quot;,\u0026quot;Edgar Anderson's Iris Data\u0026quot;,\u0026quot;Areas of the World's Major Landmasses\u0026quot;,\u0026quot;Monthly Deaths from Lung Diseases in the UK\u0026quot;,\u0026quot;Luteinizing Hormone in Blood Samples\u0026quot;,\u0026quot;Longley's Economic Regression Data\u0026quot;,\u0026quot;Annual Canadian Lynx trappings 1821-1934\u0026quot;,\u0026quot;Monthly Deaths from Lung Diseases in the UK\u0026quot;,\u0026quot;Michelson Speed of Light Data\u0026quot;,\u0026quot;Motor Trend Car Road Tests\u0026quot;,\u0026quot;Average Yearly Temperatures in New Haven\u0026quot;,\u0026quot;Average Monthly Temperatures at Nottingham, 1920-1939\u0026quot;,\u0026quot;Classical N, P, K Factorial Experiment\u0026quot;,\u0026quot;Occupational Status of Fathers and their Sons\u0026quot;,\u0026quot;Annual Precipitation in US Cities\u0026quot;,\u0026quot;Quarterly Approval Ratings of US Presidents\u0026quot;,\u0026quot;Vapor Pressure of Mercury as a Function of Temperature\u0026quot;,\u0026quot;Locations of Earthquakes off Fiji\u0026quot;,\u0026quot;Random Numbers from Congruential Generator RANDU\u0026quot;,\u0026quot;Lengths of Major North American Rivers\u0026quot;,\u0026quot;Measurements on Petroleum Rock Samples\u0026quot;,\u0026quot;Student's Sleep Data\u0026quot;,\u0026quot;Brownlee's Stack Loss Plant Data\u0026quot;,\u0026quot;Brownlee's Stack Loss Plant Data\u0026quot;,\u0026quot;Brownlee's Stack Loss Plant Data\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;US State Facts and Figures\u0026quot;,\u0026quot;Monthly Sunspot Data, from 1749 to \u0026amp;#34;Present\u0026amp;#34;\u0026quot;,\u0026quot;Yearly Sunspot Data, 1700-1988\u0026quot;,\u0026quot;Monthly Sunspot Numbers, 1749-1983\u0026quot;,\u0026quot;Swiss Fertility and Socioeconomic Indicators (1888) Data\u0026quot;,\u0026quot;Yearly Treering Data, -6000-1979\u0026quot;,\u0026quot;Diameter, Height and Volume for Black Cherry Trees\u0026quot;,\u0026quot;Populations Recorded by the US Census\u0026quot;,\u0026quot;Topographic Information on Auckland's Maunga Whau Volcano\u0026quot;,\u0026quot;The Number of Breaks in Yarn during Weaving\u0026quot;,\u0026quot;Average Heights and Weights for American Women\u0026quot;]],\u0026quot;container\u0026quot;:\u0026quot;\u0026lt;table class=\u0026amp;#34;display\u0026amp;#34;\u0026gt;\\n \u0026lt;thead\u0026gt;\\n \u0026lt;tr\u0026gt;\\n \u0026lt;th\u0026gt; \u0026lt;/th\u0026gt;\\n \u0026lt;th\u0026gt;ss\u0026lt;/th\u0026gt;\\n \u0026lt;/tr\u0026gt;\\n \u0026lt;/thead\u0026gt;\\n\u0026lt;/table\u0026gt;\u0026quot;,\u0026quot;options\u0026quot;:{\u0026quot;order\u0026quot;:[],\u0026quot;autoWidth\u0026quot;:false,\u0026quot;orderClasses\u0026quot;:false,\u0026quot;columnDefs\u0026quot;:[{\u0026quot;orderable\u0026quot;:false,\u0026quot;targets\u0026quot;:0}]}},\u0026quot;evals\u0026quot;:[],\u0026quot;jsHooks\u0026quot;:[]}\u0026lt;/script\u0026gt;\nx \u0026lt;- sample(replace = TRUE, 20, x = c(1:10, NA))\ry \u0026lt;- runif(min = 0, max = 1, 20)\rcor(m = \u0026quot;k\u0026quot;, y = y, u = \u0026quot;p\u0026quot;, x = x)\r "},
{"uri": "/blogR//rlang/hw/hw_basic.html","title": "assignment-1",
	"tags": [],
	"description": "assignment",
	"content": "part 1 basic  åƒè€ƒç¨‹å¼ç¢¼,æ•¸å­¸ä¸Š,eæ—¢ç„¶æ˜¯ç´”é‡,é‚£å°±æ˜¯1X1çš„çŸ©é™£ã€‚åœ¨Rä¸­,å¦‚æœ e\u0026lt;-3é‚£éº¼åœ¨Rä¸­åˆ¤æ–·eæ˜¯ä¸æ˜¯ç›¸é‡,æ˜¯ä¸æ˜¯çŸ©é™£?  e\u0026lt;-3\rlength(e)\r#\u0026gt; [1] 1\ris.vector(e) # q1: true or false\r#\u0026gt; [1] TRUE\ris.matrix(e) # q2: true or false\r#\u0026gt; [1] FALSE\r# æŒ‡å®šæ²’æœ‰ä»»ä½•è³‡æ–™çš„å‘é‡\re1\u0026lt;-numeric(0)\rlength(e1)\r#\u0026gt; [1] 0\ris.vector(e) # q3: true or false\r#\u0026gt; [1] TRUE\r å»ºç«‹å‘é‡e21,e22,e23 è§£é‡‹å‡ºç¾çš„è¨Šæ¯  e21\u0026lt;-1:3 # å‘é‡,å…§å®¹ç‚º[1,2,3] ä¹Ÿå¯ä»¥e2\u0026lt;-seq(1,3),e2\u0026lt;-c(1,2,3)\re22\u0026lt;-1:4\re23\u0026lt;-1:6\re21==e23\r#\u0026gt; [1] TRUE TRUE TRUE FALSE FALSE FALSE\re21==e22\r#\u0026gt; Warning in e21 == e22: è¼ƒé•·çš„ç‰©ä»¶é•·åº¦ä¸¦éè¼ƒçŸ­ç‰©ä»¶é•·åº¦çš„å€æ•¸\r#\u0026gt; [1] TRUE TRUE TRUE FALSE\r \u0026gt; e21==e23\r[1] TRUE TRUE TRUE FALSE FALSE FALSE\r\u0026gt; e21==e22\r[1] TRUE TRUE TRUE FALSE\rWarning message:\rIn e21 == e22 : è¼ƒé•·çš„ç‰©ä»¶é•·åº¦ä¸¦éè¼ƒçŸ­ç‰©ä»¶é•·åº¦çš„å€æ•¸\r 3.è§£é‡‹ç¬¬2è¡Œalphaçš„é•·åº¦,å¦‚æœåªè¦ä¿æŒå‰3å€‹å…ƒç´ ?\nalpha\u0026lt;-1:10\ralpha \u0026lt;- alpha[2 * 1:5]\r hint: ä¹Ÿå¯ä»¥length(alpha)\u0026lt;-3 ä½†æ˜¯ä¸å»ºè­°ã€‚\nåˆä½µæˆçŸ©é™£ åˆ©ç”¨å‰è¿°çš„e21,e22,e23 ,åˆ†åˆ¥è§£é‡‹ä¸‹é¢å…©è¡Œ  c(e21,e22)\r#\u0026gt; [1] 1 2 3 1 2 3 4\rcbind(e21,e22)\r#\u0026gt; Warning in cbind(e21, e22): number of rows of result is not a multiple of vector\r#\u0026gt; length (arg 1)\r#\u0026gt; e21 e22\r#\u0026gt; [1,] 1 1\r#\u0026gt; [2,] 2 2\r#\u0026gt; [3,] 3 3\r#\u0026gt; [4,] 1 4\r  ç”¢ç”Ÿ5x20çš„äº‚æ•¸çŸ©é™£\n  ç‚ºç”šéº¼æœ‰a[\u0026quot;x1\u0026quot;]? é€™é¡Œçš„ç”¨æ„åªæ˜¯è¨˜ä½ç”šéº¼æ˜¯c()å‡½æ•¸ã€‚\n  a\u0026lt;-c(x=1:2,y=3:4)\ra[\u0026quot;x1\u0026quot;] # ä¸æ˜¯a[x1]\r â“ å›ç­”x2 æ˜¯ç”šéº¼å‹æ…‹\nx1\u0026lt;-list(3,4,5)\rx2\u0026lt;-c(1,2,x1)  â“ æ€æ¨£æŠŠlist,e.g.x2, è½‰vector ?\nâ“æŠŠå¶æ•¸æ‰¾å‡ºä¾†\nx \u0026lt;- rpois(40, lambda=5)\r \rhint\r```r\rx[x %% 2 == 0]\r```\rfunction å¯«ä¸€å€‹matlab çš„çŸ©é™£å‡½æ•¸\nmm\u0026lt;-function(rcnt,ccnt,value){\rtotal\u0026lt;-rcnt*ccnt\rv\u0026lt;-double(total)\rv[1:total]\u0026lt;-value\rreturn(matrix(v,rcnt,ccnt))\r}\r å¯«ä¸€å€‹å‡½æ•¸,åˆ¤æ–·ç›®å‰çš„è³‡æ–™å¤¾ä¸­,æœ‰æ²’æœ‰æª”æ¡ˆmm.R\nisExists\u0026lt;-function(afile){\rall\u0026lt;-dir()\rrst\u0026lt;-length(all[all==afile])\rreturn (rst)\r}\r "},
{"uri": "/blogR//rlang/hw/hw_regexp.html","title": "regexpr",
	"tags": [],
	"description": "assignment",
	"content": "reference cheatsheet\næŠ½å–å­—çµ„ çœ‹çœ‹æ˜¯ä¸æ˜¯#é–‹é ­çš„å­—ä¸²,å¦‚æœæ˜¯çš„è©±è¦ç½®æ›,ä¾‹å¦‚ \u0026quot;# hello\u0026quot; -\u0026gt;\u0026quot;# hello \u0026quot;\nstr\u0026lt;-\u0026quot;# hello\u0026quot;\rif(grepl(\u0026quot;^[#]* \u0026quot;,str)) {\rx\u0026lt;-sub(\u0026quot;(^[#]* )(.*$)\u0026quot;,\u0026quot;\\\\1 \u0026lt;font color='red'\u0026gt; \\\\2 \u0026lt;/font\u0026gt;\u0026quot;,str, perl=TRUE)\rprint(x)\r}\r#\u0026gt; [1] \u0026quot;# \u0026lt;font color='red'\u0026gt; hello \u0026lt;/font\u0026gt;\u0026quot;\r é¡ä¼¼ä¸Šé¡Œ divtitle\u0026lt;-function (str){\rif(grepl(\u0026quot;^[#]* \u0026quot;,str)) {\rrst\u0026lt;-sub(\u0026quot;(^[#]* )(.*$)\u0026quot;,\u0026quot;\\\\1 \u0026lt;div class='outposix'\u0026gt; \\\\2 \u0026lt;/div\u0026gt;\u0026quot;,str, perl=TRUE)\r}else{\rrst\u0026lt;-paste0(\u0026quot;\u0026lt;div class='outposix'\u0026gt;\u0026quot;,str,\u0026quot;\u0026lt;/div\u0026gt;\u0026quot;)\r}\r}\r æ¸¬è©¦what1 pattern\u0026lt;-\u0026quot;out\u0026quot;\rext\u0026lt;-\u0026quot;oo\u0026quot;\rlist\u0026lt;-list(\u0026quot;out_ä¸­æ–‡_1.oo\u0026quot;,\u0026quot;out_1.oo\u0026quot;,\u0026quot;out_xx_1.oo\u0026quot;)\rwhat\u0026lt;-paste0(\u0026quot;(?\u0026lt;=\u0026quot;,pattern,\u0026quot;_).*\u0026quot;,\u0026quot;(?=\\\\.\u0026quot;,ext,\u0026quot;)\u0026quot;);\ridxlist\u0026lt;-as.integer(stringr::str_extract(list,what));\r#\u0026gt; Warning: å¼·åˆ¶è®Šæ›´éç¨‹ä¸­ç”¢ç”Ÿäº† NA\ridxlist\r#\u0026gt; [1] NA 1 NA\r åŸ·è¡Œçµæœ\n#\u0026gt; Warning: å¼·åˆ¶è®Šæ›´éç¨‹ä¸­ç”¢ç”Ÿäº† NA\ridxlist\r#\u0026gt; [1] NA 1 NA\r  è§£é‡‹ NA, å’Œ ç‚ºç”šéº¼?  æ¸¬è©¦what2 pattern\u0026lt;-\u0026quot;out\u0026quot;\rext\u0026lt;-\u0026quot;oo\u0026quot;\rlist\u0026lt;-list(\u0026quot;out_ä¸­æ–‡_1.oo\u0026quot;,\u0026quot;out_1.oo\u0026quot;,\u0026quot;out_xx_1.oo\u0026quot;,\u0026quot;out_ä¸­æ–‡2_1.oo\u0026quot;)\rwhat\u0026lt;-paste0(\u0026quot;(?\u0026lt;=\u0026quot;,pattern,\u0026quot;_).*(\\\\d)+\u0026quot;,\u0026quot;(?=\\\\.\u0026quot;,ext,\u0026quot;)\u0026quot;);\rr1\u0026lt;-stringr::str_extract(list,what)\rr1\r#\u0026gt; [1] \u0026quot;ä¸­æ–‡_1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;xx_1\u0026quot; \u0026quot;ä¸­æ–‡2_1\u0026quot;\rstringr::str_extract(r1,\u0026quot;\\\\d$\u0026quot;)\r#\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;1\u0026quot; \u0026quot;1\u0026quot;\r shopping_list \u0026lt;- c(\u0026quot;apples x4\u0026quot;, \u0026quot;bag of flour\u0026quot;, \u0026quot;bag of sugar\u0026quot;, \u0026quot;milk x2\u0026quot;)\rstringr::str_extract(shopping_list, \u0026quot;\\\\d\u0026quot;)\r#\u0026gt; [1] \u0026quot;4\u0026quot; NA NA \u0026quot;2\u0026quot;\r "},
{"uri": "/blogR//rlang/hw/hw_filesystem.html","title": "æª”æ¡ˆç³»çµ±",
	"tags": [],
	"description": "ç·´ç¿’",
	"content": "\r\r\r\r\r\r\r\r\r\r\r\r\r\r\râ“ 1   è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›å¥—ä»¶\n View åˆ—è¡¨(datatable) å¯«å…¥æª”æ¡ˆ(3å€‹æ¬„ä½,å¥—ä»¶åç¨±ã€å¥—ä»¶è·¯å¾‘å’Œå¥—ä»¶ç‰ˆæœ¬,æŒ‰ç…§åç¨±æ’åº) å¦‚æœä¸è¦row.names,è€Œä¸”æ¬„ä½åç¨±æ˜¯ä¸­æ–‡ã€‚    åˆ†æ\n ä¸»è¦ç‰ˆæœ¬ç¬¬2ç‰ˆçš„æœ‰å¹¾å€‹,æœ‰å“ªäº›? å¹³å‡æ¯å€‹å¥—ä»¶æœ‰å¹¾å€‹æª”æ¡ˆ?  pkgs\u0026lt;-installed.packages()\rstr(pkgs) #\u0026gt; chr [1:231, 1:16] \u0026quot;abind\u0026quot; \u0026quot;AER\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; \u0026quot;babynames\u0026quot; ...\r#\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; ..$ : chr [1:231] \u0026quot;abind\u0026quot; \u0026quot;AER\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; ...\r#\u0026gt; ..$ : chr [1:16] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Version\u0026quot; \u0026quot;Priority\u0026quot; ...\r# ğŸ·ä¸Šé¢å¯ä»¥çŸ¥é“æ˜¯matrix\rhead(rownames(pkgs),5)\r#\u0026gt; [1] \u0026quot;abind\u0026quot; \u0026quot;AER\u0026quot; \u0026quot;askpass\u0026quot; \u0026quot;assertthat\u0026quot; \u0026quot;babynames\u0026quot;\rhead(colnames(pkgs),5)\r#\u0026gt; [1] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Version\u0026quot; \u0026quot;Priority\u0026quot; \u0026quot;Depends\u0026quot;\r library(DT)\rfm\u0026lt;-data.frame(pkgs[,c(1,2,3)])\rdatatable(fm)\r \r{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"abind\",\"AER\",\"askpass\",\"assertthat\",\"babynames\",\"backports\",\"base64enc\",\"bindr\",\"bindrcpp\",\"bit\",\"bit64\",\"blob\",\"blogdown\",\"bookdown\",\"brew\",\"brio\",\"broom\",\"bslib\",\"bsplus\",\"cachem\",\"callr\",\"car\",\"carData\",\"cellranger\",\"cli\",\"clipr\",\"codetools\",\"colorspace\",\"commonmark\",\"conquer\",\"corrplot\",\"cowplot\",\"cpp11\",\"crayon\",\"credentials\",\"crosstalk\",\"curl\",\"data.table\",\"DBI\",\"dbplyr\",\"desc\",\"devtools\",\"diffobj\",\"digest\",\"dplyr\",\"DT\",\"dtplyr\",\"dygraphs\",\"e1071\",\"ellipsis\",\"emo\",\"evaluate\",\"fansi\",\"farver\",\"fastmap\",\"forcats\",\"formatR\",\"Formula\",\"fs\",\"gargle\",\"generics\",\"gert\",\"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggsci\",\"ggsignif\",\"gh\",\"gitcreds\",\"gld\",\"glue\",\"googledrive\",\"googlesheets4\",\"gridExtra\",\"gtable\",\"haven\",\"highr\",\"hms\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"httr\",\"ids\",\"ini\",\"isoband\",\"jquerylib\",\"jsonlite\",\"knitr\",\"labeling\",\"later\",\"lazyeval\",\"lifecycle\",\"lme4\",\"lmom\",\"lmtest\",\"lubridate\",\"magrittr\",\"maptools\",\"markdown\",\"matlab\",\"matlib\",\"MatrixModels\",\"matrixStats\",\"memoise\",\"mime\",\"miniUI\",\"minqa\",\"modelr\",\"moments\",\"munsell\",\"mvtnorm\",\"nloptr\",\"numDeriv\",\"openssl\",\"openxlsx\",\"PairedData\",\"pbkrtest\",\"pillar\",\"pkgbuild\",\"pkgconfig\",\"pkgload\",\"plogr\",\"polynom\",\"praise\",\"prettyunits\",\"processx\",\"progress\",\"promises\",\"proxy\",\"ps\",\"purrr\",\"quantreg\",\"R6\",\"rappdirs\",\"rcmdcheck\",\"RColorBrewer\",\"Rcpp\",\"RcppArmadillo\",\"RcppEigen\",\"readr\",\"readxl\",\"rematch\",\"rematch2\",\"remotes\",\"reprex\",\"rgl\",\"rio\",\"rjson\",\"RJSONIO\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstatix\",\"rstudioapi\",\"rversions\",\"rvest\",\"sandwich\",\"sass\",\"scales\",\"selectr\",\"servr\",\"sessioninfo\",\"shiny\",\"sloop\",\"sm\",\"SmdAid\",\"sourcetools\",\"sp\",\"SparseM\",\"Statamarkdown\",\"stringi\",\"stringr\",\"sys\",\"testit\",\"testthat\",\"tibble\",\"tidyr\",\"tidyselect\",\"tidyverse\",\"tinytex\",\"tzdb\",\"usethis\",\"utf8\",\"uuid\",\"vctrs\",\"viridisLite\",\"vroom\",\"waldo\",\"WDI\",\"whisker\",\"withr\",\"wooldridge\",\"xfun\",\"xml2\",\"xopen\",\"xtable\",\"xts\",\"yaml\",\"zip\",\"zoo\",\"base\",\"boot\",\"class\",\"cluster\",\"codetools.1\",\"compiler\",\"datasets\",\"foreign\",\"graphics\",\"grDevices\",\"grid\",\"KernSmooth\",\"lattice\",\"MASS\",\"Matrix\",\"methods\",\"mgcv\",\"nlme\",\"nnet\",\"parallel\",\"rpart\",\"spatial\",\"splines\",\"stats\",\"stats4\",\"survival\",\"tcltk\",\"tools\",\"translations\",\"utils\"],[\"abind\",\"AER\",\"askpass\",\"assertthat\",\"babynames\",\"backports\",\"base64enc\",\"bindr\",\"bindrcpp\",\"bit\",\"bit64\",\"blob\",\"blogdown\",\"bookdown\",\"brew\",\"brio\",\"broom\",\"bslib\",\"bsplus\",\"cachem\",\"callr\",\"car\",\"carData\",\"cellranger\",\"cli\",\"clipr\",\"codetools\",\"colorspace\",\"commonmark\",\"conquer\",\"corrplot\",\"cowplot\",\"cpp11\",\"crayon\",\"credentials\",\"crosstalk\",\"curl\",\"data.table\",\"DBI\",\"dbplyr\",\"desc\",\"devtools\",\"diffobj\",\"digest\",\"dplyr\",\"DT\",\"dtplyr\",\"dygraphs\",\"e1071\",\"ellipsis\",\"emo\",\"evaluate\",\"fansi\",\"farver\",\"fastmap\",\"forcats\",\"formatR\",\"Formula\",\"fs\",\"gargle\",\"generics\",\"gert\",\"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggsci\",\"ggsignif\",\"gh\",\"gitcreds\",\"gld\",\"glue\",\"googledrive\",\"googlesheets4\",\"gridExtra\",\"gtable\",\"haven\",\"highr\",\"hms\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"httr\",\"ids\",\"ini\",\"isoband\",\"jquerylib\",\"jsonlite\",\"knitr\",\"labeling\",\"later\",\"lazyeval\",\"lifecycle\",\"lme4\",\"lmom\",\"lmtest\",\"lubridate\",\"magrittr\",\"maptools\",\"markdown\",\"matlab\",\"matlib\",\"MatrixModels\",\"matrixStats\",\"memoise\",\"mime\",\"miniUI\",\"minqa\",\"modelr\",\"moments\",\"munsell\",\"mvtnorm\",\"nloptr\",\"numDeriv\",\"openssl\",\"openxlsx\",\"PairedData\",\"pbkrtest\",\"pillar\",\"pkgbuild\",\"pkgconfig\",\"pkgload\",\"plogr\",\"polynom\",\"praise\",\"prettyunits\",\"processx\",\"progress\",\"promises\",\"proxy\",\"ps\",\"purrr\",\"quantreg\",\"R6\",\"rappdirs\",\"rcmdcheck\",\"RColorBrewer\",\"Rcpp\",\"RcppArmadillo\",\"RcppEigen\",\"readr\",\"readxl\",\"rematch\",\"rematch2\",\"remotes\",\"reprex\",\"rgl\",\"rio\",\"rjson\",\"RJSONIO\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstatix\",\"rstudioapi\",\"rversions\",\"rvest\",\"sandwich\",\"sass\",\"scales\",\"selectr\",\"servr\",\"sessioninfo\",\"shiny\",\"sloop\",\"sm\",\"SmdAid\",\"sourcetools\",\"sp\",\"SparseM\",\"Statamarkdown\",\"stringi\",\"stringr\",\"sys\",\"testit\",\"testthat\",\"tibble\",\"tidyr\",\"tidyselect\",\"tidyverse\",\"tinytex\",\"tzdb\",\"usethis\",\"utf8\",\"uuid\",\"vctrs\",\"viridisLite\",\"vroom\",\"waldo\",\"WDI\",\"whisker\",\"withr\",\"wooldridge\",\"xfun\",\"xml2\",\"xopen\",\"xtable\",\"xts\",\"yaml\",\"zip\",\"zoo\",\"base\",\"boot\",\"class\",\"cluster\",\"codetools\",\"compiler\",\"datasets\",\"foreign\",\"graphics\",\"grDevices\",\"grid\",\"KernSmooth\",\"lattice\",\"MASS\",\"Matrix\",\"methods\",\"mgcv\",\"nlme\",\"nnet\",\"parallel\",\"rpart\",\"spatial\",\"splines\",\"stats\",\"stats4\",\"survival\",\"tcltk\",\"tools\",\"translations\",\"utils\"],[\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\"],[\"1.4-5\",\"1.2-9\",\"1.1\",\"0.2.1\",\"1.0.1\",\"1.2.1\",\"0.1-3\",\"0.1.1\",\"0.2.2\",\"4.0.4\",\"4.0.5\",\"1.2.2\",\"1.4\",\"0.23\",\"1.0-6\",\"1.1.2\",\"0.7.9\",\"0.2.5.1\",\"0.1.2\",\"1.0.6\",\"3.7.0\",\"3.0-11\",\"3.0-4\",\"1.1.0\",\"3.0.1\",\"0.7.1\",\"0.2-18\",\"2.0-2\",\"1.7\",\"1.0.2\",\"0.90\",\"1.1.1\",\"0.4.0\",\"1.4.1\",\"1.3.1\",\"1.1.1\",\"4.3.2\",\"1.14.2\",\"1.1.1\",\"2.1.1\",\"1.3.0\",\"2.4.2\",\"0.3.4\",\"0.6.27\",\"1.0.7\",\"0.19\",\"1.1.0\",\"1.1.1.6\",\"1.7-9\",\"0.3.2\",\"0.0.0.9000\",\"0.14\",\"0.5.0\",\"2.1.0\",\"1.1.0\",\"0.5.1\",\"1.11\",\"1.2-4\",\"1.5.0\",\"1.2.0\",\"0.1.0\",\"1.3.2\",\"3.3.5\",\"0.4.0.999\",\"0.9.1\",\"2.9\",\"0.6.3\",\"1.3.0\",\"0.1.1\",\"2.6.2\",\"1.4.2\",\"2.0.0\",\"1.0.0\",\"2.3\",\"0.3.0\",\"2.4.3\",\"0.9\",\"1.1.1\",\"0.5.2\",\"1.5.4\",\"1.6.2\",\"1.4.2\",\"1.0.1\",\"0.3.1\",\"0.2.5\",\"0.1.4\",\"1.7.2\",\"1.33\",\"0.4.2\",\"1.3.0\",\"0.2.2\",\"1.0.1\",\"1.1-27.1\",\"2.8\",\"0.9-38\",\"1.7.10\",\"2.0.1\",\"1.1-2\",\"1.1\",\"1.0.2\",\"0.9.5\",\"0.5-0\",\"0.61.0\",\"2.0.0\",\"0.11\",\"0.1.1.1\",\"1.2.4\",\"0.1.8\",\"0.14\",\"0.5.0\",\"1.1-3\",\"1.2.2.2\",\"2016.8-1.1\",\"1.4.5\",\"4.2.4\",\"1.1.1\",\"0.5.1\",\"1.6.3\",\"1.2.0\",\"2.0.3\",\"1.2.1\",\"0.2.0\",\"1.4-0\",\"1.0.0\",\"1.1.1\",\"3.5.2\",\"1.2.2\",\"1.2.0.1\",\"0.4-26\",\"1.6.0\",\"0.3.4\",\"5.86\",\"2.5.1\",\"0.3.3\",\"1.3.3\",\"1.1-2\",\"1.0.7\",\"0.10.7.0.0\",\"0.3.3.9.1\",\"2.0.1\",\"1.3.1\",\"1.0.1\",\"2.1.2\",\"2.4.0\",\"2.0.1\",\"0.107.14\",\"0.5.27\",\"0.2.20\",\"1.3-1.5\",\"0.4.11\",\"2.10\",\"7.1.1\",\"2.0.2\",\"0.7.0\",\"0.13\",\"2.1.1\",\"1.0.1\",\"3.0-1\",\"0.4.0\",\"1.1.1\",\"0.4-2\",\"0.23\",\"1.1.1\",\"1.6.0\",\"1.0.1\",\"2.2-5.6\",\"0.0.0.9000\",\"0.1.7\",\"1.4-5\",\"1.81\",\"0.4.5\",\"1.7.4\",\"1.4.0\",\"3.4\",\"0.13\",\"3.0.4\",\"3.1.4\",\"1.1.4\",\"1.1.1\",\"1.3.1\",\"0.33\",\"0.1.2\",\"2.0.1\",\"1.2.2\",\"0.1-4\",\"0.3.8\",\"0.4.0\",\"1.5.5\",\"0.3.0\",\"2.7.4\",\"0.4\",\"2.4.2\",\"1.4-1\",\"0.25\",\"1.3.2\",\"1.0.0\",\"1.8-4\",\"0.12.1\",\"2.2.1\",\"2.2.0\",\"1.8-9\",\"4.1.1\",\"1.3-28\",\"7.3-19\",\"2.1.2\",\"0.2-18\",\"4.1.1\",\"4.1.1\",\"0.8-81\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"2.23-20\",\"0.20-44\",\"7.3-54\",\"1.3-4\",\"4.1.1\",\"1.8-36\",\"3.1-152\",\"7.3-16\",\"4.1.1\",\"4.1-15\",\"7.3-14\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"3.2-11\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"4.1.1\"]],\"container\":\"\\n \\n \\n  \\n Package\\n LibPath\\n Version\\n \\n \\n\",\"options\":{\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"columnDefs\":[{\"orderable\":false,\"targets\":0}]}},\"evals\":[],\"jsHooks\":[]}\r  æª”æ¡ˆ write.csv(fm,file=\u0026quot;c:\\temp\\xx.csv\u0026quot;,useB) # ğŸ·ç‚ºç”šéº¼éŒ¯,å¦‚ä½•ä¿®æ­£\r ä¿®æ­£\n  è¼¸å‡ºæª”æ¡ˆ,å¸¶æœ‰row.names,åƒæ•¸:row.names å¯ä»¥æ˜¯T,F,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸²åç¨±\nwrite.csv(fm,file=\u0026quot;c:/temp/foo.csv\u0026quot;) #\r   .\n#ğŸ·ä¸è¦åˆ—åç¨±\rwrite.csv(fm,file=\u0026quot;c:/temp/foo1.csv\u0026quot;,row.names=F)    .\n#ğŸ·åˆ©ç”¨write.table\rwrite.table(x, file = \u0026quot;foo.csv\u0026quot;, sep = \u0026quot;,\u0026quot;, col.names = NA,\rqmethod = \u0026quot;double\u0026quot;)\rread.table(\u0026quot;foo.csv\u0026quot;, header = TRUE, sep = \u0026quot;,\u0026quot;, row.names = 1)    colnames(fm)\u0026lt;-c(\u0026quot;å¥—ä»¶,è·¯å¾‘,ç‰ˆæœ¬\u0026quot;)\r##ğŸ·ä¿®æ­£:\u0026quot;å¥—ä»¶\u0026quot;,\u0026quot;è·¯å¾‘\u0026quot;,\u0026quot;ç‰ˆæœ¬\u0026quot;\rdatatable(fm )  \r{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"abind\",\"AER\",\"askpass\",\"assertthat\",\"babynames\",\"backports\",\"base64enc\",\"bindr\",\"bindrcpp\",\"bit\",\"bit64\",\"blob\",\"blogdown\",\"bookdown\",\"brew\",\"brio\",\"broom\",\"bslib\",\"bsplus\",\"cachem\",\"callr\",\"car\",\"carData\",\"cellranger\",\"cli\",\"clipr\",\"codetools\",\"colorspace\",\"commonmark\",\"conquer\",\"corrplot\",\"cowplot\",\"cpp11\",\"crayon\",\"credentials\",\"crosstalk\",\"curl\",\"data.table\",\"DBI\",\"dbplyr\",\"desc\",\"devtools\",\"diffobj\",\"digest\",\"dplyr\",\"DT\",\"dtplyr\",\"dygraphs\",\"e1071\",\"ellipsis\",\"emo\",\"evaluate\",\"fansi\",\"farver\",\"fastmap\",\"forcats\",\"formatR\",\"Formula\",\"fs\",\"gargle\",\"generics\",\"gert\",\"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggsci\",\"ggsignif\",\"gh\",\"gitcreds\",\"gld\",\"glue\",\"googledrive\",\"googlesheets4\",\"gridExtra\",\"gtable\",\"haven\",\"highr\",\"hms\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"httr\",\"ids\",\"ini\",\"isoband\",\"jquerylib\",\"jsonlite\",\"knitr\",\"labeling\",\"later\",\"lazyeval\",\"lifecycle\",\"lme4\",\"lmom\",\"lmtest\",\"lubridate\",\"magrittr\",\"maptools\",\"markdown\",\"matlab\",\"matlib\",\"MatrixModels\",\"matrixStats\",\"memoise\",\"mime\",\"miniUI\",\"minqa\",\"modelr\",\"moments\",\"munsell\",\"mvtnorm\",\"nloptr\",\"numDeriv\",\"openssl\",\"openxlsx\",\"PairedData\",\"pbkrtest\",\"pillar\",\"pkgbuild\",\"pkgconfig\",\"pkgload\",\"plogr\",\"polynom\",\"praise\",\"prettyunits\",\"processx\",\"progress\",\"promises\",\"proxy\",\"ps\",\"purrr\",\"quantreg\",\"R6\",\"rappdirs\",\"rcmdcheck\",\"RColorBrewer\",\"Rcpp\",\"RcppArmadillo\",\"RcppEigen\",\"readr\",\"readxl\",\"rematch\",\"rematch2\",\"remotes\",\"reprex\",\"rgl\",\"rio\",\"rjson\",\"RJSONIO\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstatix\",\"rstudioapi\",\"rversions\",\"rvest\",\"sandwich\",\"sass\",\"scales\",\"selectr\",\"servr\",\"sessioninfo\",\"shiny\",\"sloop\",\"sm\",\"SmdAid\",\"sourcetools\",\"sp\",\"SparseM\",\"Statamarkdown\",\"stringi\",\"stringr\",\"sys\",\"testit\",\"testthat\",\"tibble\",\"tidyr\",\"tidyselect\",\"tidyverse\",\"tinytex\",\"tzdb\",\"usethis\",\"utf8\",\"uuid\",\"vctrs\",\"viridisLite\",\"vroom\",\"waldo\",\"WDI\",\"whisker\",\"withr\",\"wooldridge\",\"xfun\",\"xml2\",\"xopen\",\"xtable\",\"xts\",\"yaml\",\"zip\",\"zoo\",\"base\",\"boot\",\"class\",\"cluster\",\"codetools.1\",\"compiler\",\"datasets\",\"foreign\",\"graphics\",\"grDevices\",\"grid\",\"KernSmooth\",\"lattice\",\"MASS\",\"Matrix\",\"methods\",\"mgcv\",\"nlme\",\"nnet\",\"parallel\",\"rpart\",\"spatial\",\"splines\",\"stats\",\"stats4\",\"survival\",\"tcltk\",\"tools\",\"translations\",\"utils\"],[\"abind\",\"AER\",\"askpass\",\"assertthat\",\"babynames\",\"backports\",\"base64enc\",\"bindr\",\"bindrcpp\",\"bit\",\"bit64\",\"blob\",\"blogdown\",\"bookdown\",\"brew\",\"brio\",\"broom\",\"bslib\",\"bsplus\",\"cachem\",\"callr\",\"car\",\"carData\",\"cellranger\",\"cli\",\"clipr\",\"codetools\",\"colorspace\",\"commonmark\",\"conquer\",\"corrplot\",\"cowplot\",\"cpp11\",\"crayon\",\"credentials\",\"crosstalk\",\"curl\",\"data.table\",\"DBI\",\"dbplyr\",\"desc\",\"devtools\",\"diffobj\",\"digest\",\"dplyr\",\"DT\",\"dtplyr\",\"dygraphs\",\"e1071\",\"ellipsis\",\"emo\",\"evaluate\",\"fansi\",\"farver\",\"fastmap\",\"forcats\",\"formatR\",\"Formula\",\"fs\",\"gargle\",\"generics\",\"gert\",\"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggsci\",\"ggsignif\",\"gh\",\"gitcreds\",\"gld\",\"glue\",\"googledrive\",\"googlesheets4\",\"gridExtra\",\"gtable\",\"haven\",\"highr\",\"hms\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"httr\",\"ids\",\"ini\",\"isoband\",\"jquerylib\",\"jsonlite\",\"knitr\",\"labeling\",\"later\",\"lazyeval\",\"lifecycle\",\"lme4\",\"lmom\",\"lmtest\",\"lubridate\",\"magrittr\",\"maptools\",\"markdown\",\"matlab\",\"matlib\",\"MatrixModels\",\"matrixStats\",\"memoise\",\"mime\",\"miniUI\",\"minqa\",\"modelr\",\"moments\",\"munsell\",\"mvtnorm\",\"nloptr\",\"numDeriv\",\"openssl\",\"openxlsx\",\"PairedData\",\"pbkrtest\",\"pillar\",\"pkgbuild\",\"pkgconfig\",\"pkgload\",\"plogr\",\"polynom\",\"praise\",\"prettyunits\",\"processx\",\"progress\",\"promises\",\"proxy\",\"ps\",\"purrr\",\"quantreg\",\"R6\",\"rappdirs\",\"rcmdcheck\",\"RColorBrewer\",\"Rcpp\",\"RcppArmadillo\",\"RcppEigen\",\"readr\",\"readxl\",\"rematch\",\"rematch2\",\"remotes\",\"reprex\",\"rgl\",\"rio\",\"rjson\",\"RJSONIO\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstatix\",\"rstudioapi\",\"rversions\",\"rvest\",\"sandwich\",\"sass\",\"scales\",\"selectr\",\"servr\",\"sessioninfo\",\"shiny\",\"sloop\",\"sm\",\"SmdAid\",\"sourcetools\",\"sp\",\"SparseM\",\"Statamarkdown\",\"stringi\",\"stringr\",\"sys\",\"testit\",\"testthat\",\"tibble\",\"tidyr\",\"tidyselect\",\"tidyverse\",\"tinytex\",\"tzdb\",\"usethis\",\"utf8\",\"uuid\",\"vctrs\",\"viridisLite\",\"vroom\",\"waldo\",\"WDI\",\"whisker\",\"withr\",\"wooldridge\",\"xfun\",\"xml2\",\"xopen\",\"xtable\",\"xts\",\"yaml\",\"zip\",\"zoo\",\"base\",\"boot\",\"class\",\"cluster\",\"codetools\",\"compiler\",\"datasets\",\"foreign\",\"graphics\",\"grDevices\",\"grid\",\"KernSmooth\",\"lattice\",\"MASS\",\"Matrix\",\"methods\",\"mgcv\",\"nlme\",\"nnet\",\"parallel\",\"rpart\",\"spatial\",\"splines\",\"stats\",\"stats4\",\"survival\",\"tcltk\",\"tools\",\"translations\",\"utils\"],[\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\"],[\"1.4-5\",\"1.2-9\",\"1.1\",\"0.2.1\",\"1.0.1\",\"1.2.1\",\"0.1-3\",\"0.1.1\",\"0.2.2\",\"4.0.4\",\"4.0.5\",\"1.2.2\",\"1.4\",\"0.23\",\"1.0-6\",\"1.1.2\",\"0.7.9\",\"0.2.5.1\",\"0.1.2\",\"1.0.6\",\"3.7.0\",\"3.0-11\",\"3.0-4\",\"1.1.0\",\"3.0.1\",\"0.7.1\",\"0.2-18\",\"2.0-2\",\"1.7\",\"1.0.2\",\"0.90\",\"1.1.1\",\"0.4.0\",\"1.4.1\",\"1.3.1\",\"1.1.1\",\"4.3.2\",\"1.14.2\",\"1.1.1\",\"2.1.1\",\"1.3.0\",\"2.4.2\",\"0.3.4\",\"0.6.27\",\"1.0.7\",\"0.19\",\"1.1.0\",\"1.1.1.6\",\"1.7-9\",\"0.3.2\",\"0.0.0.9000\",\"0.14\",\"0.5.0\",\"2.1.0\",\"1.1.0\",\"0.5.1\",\"1.11\",\"1.2-4\",\"1.5.0\",\"1.2.0\",\"0.1.0\",\"1.3.2\",\"3.3.5\",\"0.4.0.999\",\"0.9.1\",\"2.9\",\"0.6.3\",\"1.3.0\",\"0.1.1\",\"2.6.2\",\"1.4.2\",\"2.0.0\",\"1.0.0\",\"2.3\",\"0.3.0\",\"2.4.3\",\"0.9\",\"1.1.1\",\"0.5.2\",\"1.5.4\",\"1.6.2\",\"1.4.2\",\"1.0.1\",\"0.3.1\",\"0.2.5\",\"0.1.4\",\"1.7.2\",\"1.33\",\"0.4.2\",\"1.3.0\",\"0.2.2\",\"1.0.1\",\"1.1-27.1\",\"2.8\",\"0.9-38\",\"1.7.10\",\"2.0.1\",\"1.1-2\",\"1.1\",\"1.0.2\",\"0.9.5\",\"0.5-0\",\"0.61.0\",\"2.0.0\",\"0.11\",\"0.1.1.1\",\"1.2.4\",\"0.1.8\",\"0.14\",\"0.5.0\",\"1.1-3\",\"1.2.2.2\",\"2016.8-1.1\",\"1.4.5\",\"4.2.4\",\"1.1.1\",\"0.5.1\",\"1.6.3\",\"1.2.0\",\"2.0.3\",\"1.2.1\",\"0.2.0\",\"1.4-0\",\"1.0.0\",\"1.1.1\",\"3.5.2\",\"1.2.2\",\"1.2.0.1\",\"0.4-26\",\"1.6.0\",\"0.3.4\",\"5.86\",\"2.5.1\",\"0.3.3\",\"1.3.3\",\"1.1-2\",\"1.0.7\",\"0.10.7.0.0\",\"0.3.3.9.1\",\"2.0.1\",\"1.3.1\",\"1.0.1\",\"2.1.2\",\"2.4.0\",\"2.0.1\",\"0.107.14\",\"0.5.27\",\"0.2.20\",\"1.3-1.5\",\"0.4.11\",\"2.10\",\"7.1.1\",\"2.0.2\",\"0.7.0\",\"0.13\",\"2.1.1\",\"1.0.1\",\"3.0-1\",\"0.4.0\",\"1.1.1\",\"0.4-2\",\"0.23\",\"1.1.1\",\"1.6.0\",\"1.0.1\",\"2.2-5.6\",\"0.0.0.9000\",\"0.1.7\",\"1.4-5\",\"1.81\",\"0.4.5\",\"1.7.4\",\"1.4.0\",\"3.4\",\"0.13\",\"3.0.4\",\"3.1.4\",\"1.1.4\",\"1.1.1\",\"1.3.1\",\"0.33\",\"0.1.2\",\"2.0.1\",\"1.2.2\",\"0.1-4\",\"0.3.8\",\"0.4.0\",\"1.5.5\",\"0.3.0\",\"2.7.4\",\"0.4\",\"2.4.2\",\"1.4-1\",\"0.25\",\"1.3.2\",\"1.0.0\",\"1.8-4\",\"0.12.1\",\"2.2.1\",\"2.2.0\",\"1.8-9\",\"4.1.1\",\"1.3-28\",\"7.3-19\",\"2.1.2\",\"0.2-18\",\"4.1.1\",\"4.1.1\",\"0.8-81\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"2.23-20\",\"0.20-44\",\"7.3-54\",\"1.3-4\",\"4.1.1\",\"1.8-36\",\"3.1-152\",\"7.3-16\",\"4.1.1\",\"4.1-15\",\"7.3-14\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"3.2-11\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"4.1.1\"]],\"container\":\"\\n \\n \\n  \\n å¥—ä»¶,è·¯å¾‘,ç‰ˆæœ¬\\n NA\\n NA\\n \\n \\n\",\"options\":{\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"columnDefs\":[{\"orderable\":false,\"targets\":0}]}},\"evals\":[],\"jsHooks\":[]}\r# ğŸ·â“æ€æ¨£æŠŠè¡¨æ ¼ä¸­çš„row.nameså»æ‰? # ğŸ·datatable(fm,rownames=F)  colnames(fm)\u0026lt;-c(\u0026quot;å¥—ä»¶\u0026quot;,\u0026quot;è·¯å¾‘\u0026quot;,\u0026quot;ç‰ˆæœ¬\u0026quot;)\rdatatable(fm,rownames=F )  \r{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"abind\",\"AER\",\"askpass\",\"assertthat\",\"babynames\",\"backports\",\"base64enc\",\"bindr\",\"bindrcpp\",\"bit\",\"bit64\",\"blob\",\"blogdown\",\"bookdown\",\"brew\",\"brio\",\"broom\",\"bslib\",\"bsplus\",\"cachem\",\"callr\",\"car\",\"carData\",\"cellranger\",\"cli\",\"clipr\",\"codetools\",\"colorspace\",\"commonmark\",\"conquer\",\"corrplot\",\"cowplot\",\"cpp11\",\"crayon\",\"credentials\",\"crosstalk\",\"curl\",\"data.table\",\"DBI\",\"dbplyr\",\"desc\",\"devtools\",\"diffobj\",\"digest\",\"dplyr\",\"DT\",\"dtplyr\",\"dygraphs\",\"e1071\",\"ellipsis\",\"emo\",\"evaluate\",\"fansi\",\"farver\",\"fastmap\",\"forcats\",\"formatR\",\"Formula\",\"fs\",\"gargle\",\"generics\",\"gert\",\"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggsci\",\"ggsignif\",\"gh\",\"gitcreds\",\"gld\",\"glue\",\"googledrive\",\"googlesheets4\",\"gridExtra\",\"gtable\",\"haven\",\"highr\",\"hms\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"httr\",\"ids\",\"ini\",\"isoband\",\"jquerylib\",\"jsonlite\",\"knitr\",\"labeling\",\"later\",\"lazyeval\",\"lifecycle\",\"lme4\",\"lmom\",\"lmtest\",\"lubridate\",\"magrittr\",\"maptools\",\"markdown\",\"matlab\",\"matlib\",\"MatrixModels\",\"matrixStats\",\"memoise\",\"mime\",\"miniUI\",\"minqa\",\"modelr\",\"moments\",\"munsell\",\"mvtnorm\",\"nloptr\",\"numDeriv\",\"openssl\",\"openxlsx\",\"PairedData\",\"pbkrtest\",\"pillar\",\"pkgbuild\",\"pkgconfig\",\"pkgload\",\"plogr\",\"polynom\",\"praise\",\"prettyunits\",\"processx\",\"progress\",\"promises\",\"proxy\",\"ps\",\"purrr\",\"quantreg\",\"R6\",\"rappdirs\",\"rcmdcheck\",\"RColorBrewer\",\"Rcpp\",\"RcppArmadillo\",\"RcppEigen\",\"readr\",\"readxl\",\"rematch\",\"rematch2\",\"remotes\",\"reprex\",\"rgl\",\"rio\",\"rjson\",\"RJSONIO\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstatix\",\"rstudioapi\",\"rversions\",\"rvest\",\"sandwich\",\"sass\",\"scales\",\"selectr\",\"servr\",\"sessioninfo\",\"shiny\",\"sloop\",\"sm\",\"SmdAid\",\"sourcetools\",\"sp\",\"SparseM\",\"Statamarkdown\",\"stringi\",\"stringr\",\"sys\",\"testit\",\"testthat\",\"tibble\",\"tidyr\",\"tidyselect\",\"tidyverse\",\"tinytex\",\"tzdb\",\"usethis\",\"utf8\",\"uuid\",\"vctrs\",\"viridisLite\",\"vroom\",\"waldo\",\"WDI\",\"whisker\",\"withr\",\"wooldridge\",\"xfun\",\"xml2\",\"xopen\",\"xtable\",\"xts\",\"yaml\",\"zip\",\"zoo\",\"base\",\"boot\",\"class\",\"cluster\",\"codetools\",\"compiler\",\"datasets\",\"foreign\",\"graphics\",\"grDevices\",\"grid\",\"KernSmooth\",\"lattice\",\"MASS\",\"Matrix\",\"methods\",\"mgcv\",\"nlme\",\"nnet\",\"parallel\",\"rpart\",\"spatial\",\"splines\",\"stats\",\"stats4\",\"survival\",\"tcltk\",\"tools\",\"translations\",\"utils\"],[\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Users/linchao/Documents/R/win-library/4.1\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\",\"C:/Program Files/R/R-4.1.1/library\"],[\"1.4-5\",\"1.2-9\",\"1.1\",\"0.2.1\",\"1.0.1\",\"1.2.1\",\"0.1-3\",\"0.1.1\",\"0.2.2\",\"4.0.4\",\"4.0.5\",\"1.2.2\",\"1.4\",\"0.23\",\"1.0-6\",\"1.1.2\",\"0.7.9\",\"0.2.5.1\",\"0.1.2\",\"1.0.6\",\"3.7.0\",\"3.0-11\",\"3.0-4\",\"1.1.0\",\"3.0.1\",\"0.7.1\",\"0.2-18\",\"2.0-2\",\"1.7\",\"1.0.2\",\"0.90\",\"1.1.1\",\"0.4.0\",\"1.4.1\",\"1.3.1\",\"1.1.1\",\"4.3.2\",\"1.14.2\",\"1.1.1\",\"2.1.1\",\"1.3.0\",\"2.4.2\",\"0.3.4\",\"0.6.27\",\"1.0.7\",\"0.19\",\"1.1.0\",\"1.1.1.6\",\"1.7-9\",\"0.3.2\",\"0.0.0.9000\",\"0.14\",\"0.5.0\",\"2.1.0\",\"1.1.0\",\"0.5.1\",\"1.11\",\"1.2-4\",\"1.5.0\",\"1.2.0\",\"0.1.0\",\"1.3.2\",\"3.3.5\",\"0.4.0.999\",\"0.9.1\",\"2.9\",\"0.6.3\",\"1.3.0\",\"0.1.1\",\"2.6.2\",\"1.4.2\",\"2.0.0\",\"1.0.0\",\"2.3\",\"0.3.0\",\"2.4.3\",\"0.9\",\"1.1.1\",\"0.5.2\",\"1.5.4\",\"1.6.2\",\"1.4.2\",\"1.0.1\",\"0.3.1\",\"0.2.5\",\"0.1.4\",\"1.7.2\",\"1.33\",\"0.4.2\",\"1.3.0\",\"0.2.2\",\"1.0.1\",\"1.1-27.1\",\"2.8\",\"0.9-38\",\"1.7.10\",\"2.0.1\",\"1.1-2\",\"1.1\",\"1.0.2\",\"0.9.5\",\"0.5-0\",\"0.61.0\",\"2.0.0\",\"0.11\",\"0.1.1.1\",\"1.2.4\",\"0.1.8\",\"0.14\",\"0.5.0\",\"1.1-3\",\"1.2.2.2\",\"2016.8-1.1\",\"1.4.5\",\"4.2.4\",\"1.1.1\",\"0.5.1\",\"1.6.3\",\"1.2.0\",\"2.0.3\",\"1.2.1\",\"0.2.0\",\"1.4-0\",\"1.0.0\",\"1.1.1\",\"3.5.2\",\"1.2.2\",\"1.2.0.1\",\"0.4-26\",\"1.6.0\",\"0.3.4\",\"5.86\",\"2.5.1\",\"0.3.3\",\"1.3.3\",\"1.1-2\",\"1.0.7\",\"0.10.7.0.0\",\"0.3.3.9.1\",\"2.0.1\",\"1.3.1\",\"1.0.1\",\"2.1.2\",\"2.4.0\",\"2.0.1\",\"0.107.14\",\"0.5.27\",\"0.2.20\",\"1.3-1.5\",\"0.4.11\",\"2.10\",\"7.1.1\",\"2.0.2\",\"0.7.0\",\"0.13\",\"2.1.1\",\"1.0.1\",\"3.0-1\",\"0.4.0\",\"1.1.1\",\"0.4-2\",\"0.23\",\"1.1.1\",\"1.6.0\",\"1.0.1\",\"2.2-5.6\",\"0.0.0.9000\",\"0.1.7\",\"1.4-5\",\"1.81\",\"0.4.5\",\"1.7.4\",\"1.4.0\",\"3.4\",\"0.13\",\"3.0.4\",\"3.1.4\",\"1.1.4\",\"1.1.1\",\"1.3.1\",\"0.33\",\"0.1.2\",\"2.0.1\",\"1.2.2\",\"0.1-4\",\"0.3.8\",\"0.4.0\",\"1.5.5\",\"0.3.0\",\"2.7.4\",\"0.4\",\"2.4.2\",\"1.4-1\",\"0.25\",\"1.3.2\",\"1.0.0\",\"1.8-4\",\"0.12.1\",\"2.2.1\",\"2.2.0\",\"1.8-9\",\"4.1.1\",\"1.3-28\",\"7.3-19\",\"2.1.2\",\"0.2-18\",\"4.1.1\",\"4.1.1\",\"0.8-81\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"2.23-20\",\"0.20-44\",\"7.3-54\",\"1.3-4\",\"4.1.1\",\"1.8-36\",\"3.1-152\",\"7.3-16\",\"4.1.1\",\"4.1-15\",\"7.3-14\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"3.2-11\",\"4.1.1\",\"4.1.1\",\"4.1.1\",\"4.1.1\"]],\"container\":\"\\n \\n \\n å¥—ä»¶\\n è·¯å¾‘\\n ç‰ˆæœ¬\\n \\n \\n\",\"options\":{\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\ræ‹¿åˆ°ä¸»è¦ç‰ˆæœ¬ x\u0026lt;-strsplit(fm[,3],\u0026quot;\\\\.\u0026quot;)\rsapply(x,head,1)\r"},
{"uri": "/blogR//rlang/demo/citation.html","title": "å¼•ç”¨",
	"tags": [],
	"description": "æš«æ™‚",
	"content": "introduction Goal: Estimate the effect of the price per citation on the number of library subscriptions\n\rJournals.csv\r\rJournals.csv\r\r\rinitial options(prompt = \u0026quot;R\u0026gt; \u0026quot;, continue = \u0026quot;+ \u0026quot;, width = 64, digits = 4, show.signif.stars = FALSE, useFancyQuotes = FALSE) library(\u0026quot;AER\u0026quot;) set.seed(1071)\nlibrary(\u0026quot;AER\u0026quot;)\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šcar\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šcarData\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šlmtest\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šzoo\r#\u0026gt; #\u0026gt; è¼‰å…¥å¥—ä»¶ï¼š'zoo'\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:base':\r#\u0026gt; #\u0026gt; as.Date, as.Date.numeric\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šsandwich\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šsurvival\rdata(\u0026quot;Journals\u0026quot;, package = \u0026quot;AER\u0026quot;)\r#View(Journals)\rjournals \u0026lt;- Journals[, c(\u0026quot;subs\u0026quot;, \u0026quot;price\u0026quot;)]\rjournals$citeprice \u0026lt;- Journals$price/Journals$citations\rsummary(journals)\r#\u0026gt; subs price citeprice #\u0026gt; Min. : 2.0 Min. : 20.0 Min. : 0.005223 #\u0026gt; 1st Qu.: 52.0 1st Qu.: 134.5 1st Qu.: 0.464495 #\u0026gt; Median : 122.5 Median : 282.0 Median : 1.320513 #\u0026gt; Mean : 196.9 Mean : 417.7 Mean : 2.548455 #\u0026gt; 3rd Qu.: 268.2 3rd Qu.: 540.8 3rd Qu.: 3.440171 #\u0026gt; Max. :1098.0 Max. :2120.0 Max. :24.459459\r â“ ç·´ç¿’: æ”¹æˆdatatable\nplot(log(subs) ~ log(citeprice), data = journals)\rjour_lm \u0026lt;- lm(log(subs) ~ log(citeprice), data = journals)\rabline(jour_lm)\r â“ what is jour_lm ?\nclass(jour_lm)\r#\u0026gt; [1] \u0026quot;lm\u0026quot;\rnames(jour_lm)\r#\u0026gt; [1] \u0026quot;coefficients\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;effects\u0026quot; \u0026quot;rank\u0026quot; #\u0026gt; [5] \u0026quot;fitted.values\u0026quot; \u0026quot;assign\u0026quot; \u0026quot;qr\u0026quot; \u0026quot;df.residual\u0026quot; #\u0026gt; [9] \u0026quot;xlevels\u0026quot; \u0026quot;call\u0026quot; \u0026quot;terms\u0026quot; \u0026quot;model\u0026quot;\rstr(jour_lm) #ğŸ·æ³¨æ„list of 12\r#\u0026gt; List of 12\r#\u0026gt; $ coefficients : Named num [1:2] 4.766 -0.533\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; $ residuals : Named num [1:180] -1.185 -0.739 -0.332 -2.725 1.136 ...\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ...\r#\u0026gt; $ effects : Named num [1:180] -63.599 -11.222 -0.338 -2.715 1.146 ...\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; ...\r#\u0026gt; $ rank : int 2\r#\u0026gt; $ fitted.values: Named num [1:180] 3.82 4.82 3.17 3.42 3.43 ...\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ...\r#\u0026gt; $ assign : int [1:2] 0 1\r#\u0026gt; $ qr :List of 5\r#\u0026gt; ..$ qr : num [1:180, 1:2] -13.4164 0.0745 0.0745 0.0745 0.0745 ...\r#\u0026gt; .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; .. .. ..$ : chr [1:180] \u0026quot;APEL\u0026quot; \u0026quot;SAJoEH\u0026quot; \u0026quot;CE\u0026quot; \u0026quot;MEPiTE\u0026quot; ...\r#\u0026gt; .. .. ..$ : chr [1:2] \u0026quot;(Intercept)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. ..- attr(*, \u0026quot;assign\u0026quot;)= int [1:2] 0 1\r#\u0026gt; ..$ qraux: num [1:2] 1.07 1.01\r#\u0026gt; ..$ pivot: int [1:2] 1 2\r#\u0026gt; ..$ tol : num 1e-07\r#\u0026gt; ..$ rank : int 2\r#\u0026gt; ..- attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;qr\u0026quot;\r#\u0026gt; $ df.residual : int 178\r#\u0026gt; $ xlevels : Named list()\r#\u0026gt; $ call : language lm(formula = log(subs) ~ log(citeprice), data = journals)\r#\u0026gt; $ terms :Classes 'terms', 'formula' language log(subs) ~ log(citeprice)\r#\u0026gt; .. ..- attr(*, \u0026quot;variables\u0026quot;)= language list(log(subs), log(citeprice))\r#\u0026gt; .. ..- attr(*, \u0026quot;factors\u0026quot;)= int [1:2, 1] 0 1\r#\u0026gt; .. .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; .. .. .. ..$ : chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. .. .. ..$ : chr \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. ..- attr(*, \u0026quot;term.labels\u0026quot;)= chr \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. ..- attr(*, \u0026quot;order\u0026quot;)= int 1\r#\u0026gt; .. ..- attr(*, \u0026quot;intercept\u0026quot;)= int 1\r#\u0026gt; .. ..- attr(*, \u0026quot;response\u0026quot;)= int 1\r#\u0026gt; .. ..- attr(*, \u0026quot;.Environment\u0026quot;)=\u0026lt;environment: R_GlobalEnv\u0026gt; #\u0026gt; .. ..- attr(*, \u0026quot;predvars\u0026quot;)= language list(log(subs), log(citeprice))\r#\u0026gt; .. ..- attr(*, \u0026quot;dataClasses\u0026quot;)= Named chr [1:2] \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot;\r#\u0026gt; .. .. ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; $ model :'data.frame':\t180 obs. of 2 variables:\r#\u0026gt; ..$ log(subs) : num [1:180] 2.639 4.078 2.833 0.693 4.564 ...\r#\u0026gt; ..$ log(citeprice): num [1:180] 1.7677 -0.0953 3.0025 2.5294 2.5089 ...\r#\u0026gt; ..- attr(*, \u0026quot;terms\u0026quot;)=Classes 'terms', 'formula' language log(subs) ~ log(citeprice)\r#\u0026gt; .. .. ..- attr(*, \u0026quot;variables\u0026quot;)= language list(log(subs), log(citeprice))\r#\u0026gt; .. .. ..- attr(*, \u0026quot;factors\u0026quot;)= int [1:2, 1] 0 1\r#\u0026gt; .. .. .. ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; .. .. .. .. ..$ : chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. .. .. .. ..$ : chr \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. .. ..- attr(*, \u0026quot;term.labels\u0026quot;)= chr \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; .. .. ..- attr(*, \u0026quot;order\u0026quot;)= int 1\r#\u0026gt; .. .. ..- attr(*, \u0026quot;intercept\u0026quot;)= int 1\r#\u0026gt; .. .. ..- attr(*, \u0026quot;response\u0026quot;)= int 1\r#\u0026gt; .. .. ..- attr(*, \u0026quot;.Environment\u0026quot;)=\u0026lt;environment: R_GlobalEnv\u0026gt; #\u0026gt; .. .. ..- attr(*, \u0026quot;predvars\u0026quot;)= language list(log(subs), log(citeprice))\r#\u0026gt; .. .. ..- attr(*, \u0026quot;dataClasses\u0026quot;)= Named chr [1:2] \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot;\r#\u0026gt; .. .. .. ..- attr(*, \u0026quot;names\u0026quot;)= chr [1:2] \u0026quot;log(subs)\u0026quot; \u0026quot;log(citeprice)\u0026quot;\r#\u0026gt; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;lm\u0026quot;\r â“ è‡ªç”±åº¦åœ¨å“ª?\n\ræç¤º\r```r\rjour_lm$rank\r#\u0026gt; [1] 2\r```\ræœ€ç°¡å–®çš„å ±å‘Šç”¢ç”Ÿå‡½æ•¸ summary(jour_lm)\r#\u0026gt; #\u0026gt; Call:\r#\u0026gt; lm(formula = log(subs) ~ log(citeprice), data = journals)\r#\u0026gt; #\u0026gt; Residuals:\r#\u0026gt; Min 1Q Median 3Q Max #\u0026gt; -2.72478 -0.53609 0.03721 0.46619 1.84808 #\u0026gt; #\u0026gt; Coefficients:\r#\u0026gt; Estimate Std. Error t value Pr(\u0026gt;|t|) #\u0026gt; (Intercept) 4.76621 0.05591 85.25 \u0026lt;2e-16 ***\r#\u0026gt; log(citeprice) -0.53305 0.03561 -14.97 \u0026lt;2e-16 ***\r#\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r#\u0026gt; #\u0026gt; Residual standard error: 0.7497 on 178 degrees of freedom\r#\u0026gt; Multiple R-squared: 0.5573,\tAdjusted R-squared: 0.5548 #\u0026gt; F-statistic: 224 on 1 and 178 DF, p-value: \u0026lt; 2.2e-16\r  jour_slm \u0026lt;- summary(jour_lm)\rclass(jour_slm)\r#\u0026gt; [1] \u0026quot;summary.lm\u0026quot;\rnames(jour_slm)\r#\u0026gt; [1] \u0026quot;call\u0026quot; \u0026quot;terms\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;coefficients\u0026quot; #\u0026gt; [5] \u0026quot;aliased\u0026quot; \u0026quot;sigma\u0026quot; \u0026quot;df\u0026quot; \u0026quot;r.squared\u0026quot; #\u0026gt; [9] \u0026quot;adj.r.squared\u0026quot; \u0026quot;fstatistic\u0026quot; \u0026quot;cov.unscaled\u0026quot;\rjour_slm$coefficients\r#\u0026gt; Estimate Std. Error t value Pr(\u0026gt;|t|)\r#\u0026gt; (Intercept) 4.7662121 0.05590908 85.24934 2.953913e-146\r#\u0026gt; log(citeprice) -0.5330535 0.03561320 -14.96786 2.563943e-33\r  anova(jour_lm)\r#\u0026gt; Analysis of Variance Table\r#\u0026gt; #\u0026gt; Response: log(subs)\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; log(citeprice) 1 125.93 125.934 224.04 \u0026lt; 2.2e-16 ***\r#\u0026gt; Residuals 178 100.06 0.562 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\rcoef(jour_lm)\r#\u0026gt; (Intercept) log(citeprice) #\u0026gt; 4.7662121 -0.5330535\rconfint(jour_lm, level = 0.95)\r#\u0026gt; 2.5 % 97.5 %\r#\u0026gt; (Intercept) 4.6558822 4.8765420\r#\u0026gt; log(citeprice) -0.6033319 -0.4627751\r predict(jour_lm, newdata = data.frame(citeprice = 2.11),\rinterval = \u0026quot;confidence\u0026quot;)\r#\u0026gt; fit lwr upr\r#\u0026gt; 1 4.368188 4.247485 4.48889\rpredict(jour_lm, newdata = data.frame(citeprice = 2.11), interval = \u0026quot;prediction\u0026quot;)\r#\u0026gt; fit lwr upr\r#\u0026gt; 1 4.368188 2.883746 5.852629\r  lciteprice \u0026lt;- seq(from = -6, to = 4, by = 0.25)\rjour_pred \u0026lt;- predict(jour_lm, interval = \u0026quot;prediction\u0026quot;,\rnewdata = data.frame(citeprice = exp(lciteprice))) plot(log(subs) ~ log(citeprice), data = journals)\rlines(jour_pred[, 1] ~ lciteprice, col = 1) lines(jour_pred[, 2] ~ lciteprice, col = 1, lty = 2)\rlines(jour_pred[, 3] ~ lciteprice, col = 1, lty = 2)\r åƒæ•¸ç‚ºæ¨¡å‹é¡åˆ¥çš„plot() ç”¢ç”Ÿ6ç¨®,é è¨­4ç¨®\n residuals versus fitted values, QQ plot for normality, scale-location plot, standardized residuals versus leverages.  å€‹åˆ¥çš„åœ–:ä¾‹å¦‚QQ plot:ã€€plot(jour_lm, which = 2)\npar(mfrow = c(2, 2))\rplot(jour_lm)\rpar(mfrow = c(1, 1))\rlinearHypothesis(jour_lm, \u0026quot;log(citeprice) = -0.5\u0026quot;)\r#\u0026gt; Linear hypothesis test\r#\u0026gt; #\u0026gt; Hypothesis:\r#\u0026gt; log(citeprice) = - 0.5\r#\u0026gt; #\u0026gt; Model 1: restricted model\r#\u0026gt; Model 2: log(subs) ~ log(citeprice)\r#\u0026gt; #\u0026gt; Res.Df RSS Df Sum of Sq F Pr(\u0026gt;F)\r#\u0026gt; 1 179 100.54 #\u0026gt; 2 178 100.06 1 0.48421 0.8614 0.3546\r â“ åˆ©ç”¨è³‡æ–™é›† cars : dist ~ speed\n åˆ†åˆ¥çµ¦å‡º speed=12,19,24 çš„ä¿¡è³´å€é–“å’Œé æ¸¬å€é–“ ç•«åœ–  "},
{"uri": "/blogR//rlang/1_0_requirement.html","title": "1 Requirement",
	"tags": [],
	"description": "è»Ÿé«”ç’°å¢ƒ",
	"content": "å®‰è£è»Ÿé«” éƒ¨ä»½è»Ÿé«”åˆ—è¡¨ å¦å¤–æ–¼linux å®‰è£ tidyverseæ™‚éœ€è¦:\nsudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev\r install.packages()\ninstall.packages('devtools')\rinstall.packages('bookdown')\rinstall.packages('rlang')\rinstall.packages('tidyr')\rinstall.packages('babynames')\rinstall.packages('ggplot2')\rinstall.packages('sm')\rinstall.packages('bindrcpp')\rinstall.packages('tidyverse')\rinstall.packages('codetools')\rinstall.packages('moments')\rlibrary('devtools')\rinstall_github(\u0026quot;Hadley/emo\u0026quot;)\rinstall.packages(\u0026quot;blogdown\u0026quot;)\rinstall.packages(\u0026quot;wooldridge\u0026quot;)\rinstall.packages(\u0026quot;WDI\u0026quot;)\rinstall.packages(\u0026quot;rjson\u0026quot;)\rinstall.packages(\u0026quot;AER\u0026quot;)\rinstall.packages(\u0026quot;DT\u0026quot;)\rinstall.packages(\u0026quot;dplyr\u0026quot;)\rinstall.packages(\u0026quot;jsonlite)\r##\roptions(repos = c(CRAN = \u0026quot;https://cran.revolutionanalytics.com\u0026quot;))\r å¦‚æœæ˜¯linuxç³»çµ±è¦å…ˆ:\n# sudo visudo\r# ç„¶å¾ŒåŠ å…¥\r# username ALL = NOPASSWD: /fullpath/to/command, /fullpath/to/othercommand\r# ä¸‹é¢é€™å€‹system éœ€è¦ä¸Šé¢å…©è¡Œ\rsystem('sudo apt update;sudo apt upgrade;sudo apt-get install curl')\rsystem('sudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev')\r \r\ræ›´æ–°å¥—ä»¶  update all available packages  update.packages()   update, without prompts for permission/clarification  update.packages(ask = FALSE,checkBuild=T)   ğŸ’¡å…ˆæŠŠå°ˆæ¡ˆé—œæ‰ ä¾‹å¦‚: all.packages \u0026lt;- installed.packages()\rr.version \u0026lt;- paste(version[['major']], '.', version[['minor']], sep = '')\rfor (i in 1:nrow(all.packages))\r{\rpackage.name \u0026lt;- all.packages[i, 1]\rpackage.version \u0026lt;- all.packages[i, 3]\rif (package.version != r.version)\r{\rprint(paste('Installing', package.name))\rinstall.packages(package.name)\r}\r}\r   Rtools åœ¨windowsä¸­å®‰è£å®Œä»¥å¾Œï¼Œåœ¨Rä¸»æ§å°ä¸ŠåŸ·è¡Œ\nwriteLines('PATH=\u0026quot;${RTOOLS40_HOME}\\\\usr\\\\bin;${PATH}\u0026quot;', con = \u0026quot;~/.Renviron\u0026quot;)\r é‡å•Ÿå‹•ï¼Œç„¶å¾Œæ¸¬è©¦ä¸‹é¢æŒ‡ä»¤\nSys.which(\u0026quot;make\u0026quot;)\r åå®‰è£ åœ¨R consoleä¸­ï¼Œåˆ©ç”¨æŒ‡ä»¤ .libPaths()ï¼Œæˆ–è€…åœ¨shell(terminal)ä¸­åˆ©ç”¨ R -e '.libPaths()' çŸ¥é“å¥—è£è¢«å®‰è£åœ¨å“ªè£¡ï¼Œç„¶å¾Œå¯ä»¥ç§»é™¤æ‰€æœ‰çš„ç›¸é—œå¥—ä»¶ uinstall.packages()\n"},
{"uri": "/blogR//rlang/4_2_type_vector.html","title": "4.2 å‘é‡",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "vector å‡½æ•¸ç¯„ä¾‹ cbind,rbind x\u0026lt;-runif(5)\ry\u0026lt;-runif(6)\rcbind(x,y)\r#\u0026gt; Warning in cbind(x, y): number of rows of result is not a multiple of vector\r#\u0026gt; length (arg 1)\r#\u0026gt; x y\r#\u0026gt; [1,] 0.05555426 0.81078837\r#\u0026gt; [2,] 0.39638526 0.83144706\r#\u0026gt; [3,] 0.26659782 0.42948876\r#\u0026gt; [4,] 0.14729596 0.21873952\r#\u0026gt; [5,] 0.50746265 0.03657459\r#\u0026gt; [6,] 0.05555426 0.50790482\r å‡½æ•¸diff å¯ä»¥ç”¨åœ¨å·®åˆ†è¨ˆç®—\nArguments\n x: a numeric vector or matrix containing the values to be differenced. lag: an integer indicating which lag to use. differences: an integer indicating the order of the difference.\nä¾‹å¦‚  diff(x,lag=d,differences=n)\rx[(1+d):n] - x[1:(n-d)]\r ç·´ç¿’: åˆªé™¤å‘é‡ä¸­çš„ä¸€å€‹å…ƒç´  x\u0026lt;-c(1,2,3)\r å¦‚ä½•åˆªé™¤xä¸­çš„ç¬¬2å€‹å…ƒç´  ?\nhint:\næ•¸å­—å‘é‡å…ƒç´ çš„åˆªé™¤ ï¼Œä¸èƒ½åƒæ˜¯list[2]\u0026lt;-NULL ï¼Œè«‹å•ä½ çš„è§£æ³•ï¼Ÿ ä¸¦èªªæ˜\nç‰©ä»¶å…ƒç´ çš„åˆªé™¤ï¼Œç°¡å–®ä¸€é»çš„åƒæ˜¯listï¼Œ\nx\u0026lt;-list(1,2,3)\rx[2]\u0026lt;-NULL\rx\r ä½†æ˜¯å‘é‡å…ƒç´ çš„åˆªé™¤æ²’æœ‰æ·å¾‘\nx\u0026lt;-c(1,2,3)\rx[2]\u0026lt;-NULL\r#\u0026gt; Error in x[2] \u0026lt;- NULL: ç½®æ›çš„é•·åº¦ç‚ºé›¶\r å› æ­¤ï¼Œéœ€è¦è®Šé€šçš„è¾¦æ³•\næ–¹æ³•1ï¼š\nx\u0026lt;-c(1,2,3)\rt\u0026lt;-as.list(x) # note: ä½¿ç”¨list(x)è€Œä¸æ˜¯as.list(x)æœƒæœ‰ä»€éº¼ä¸åŒ\rt[2]\u0026lt;-NULL\rx\u0026lt;-unlist(t)\rx\r#\u0026gt; [1] 1 3\r æ–¹æ³•2ï¼š\nx\u0026lt;-c(1,2,3)\ry\u0026lt;-x[-2]\rx\u0026lt;-y\r ç·´ç¿’ï¼šæ”¹ç‚ºå‡½æ•¸\ndelElement\u0026lt;-function(x,idx){\rif (is.vector(x)){\rt\u0026lt;-as.list(x)\rt[idx]\u0026lt;-NULL\rt\u0026lt;-unlist(t)\rreturn(t) } else {\rstop('must be vector')\r}\r}\rx\u0026lt;-c(1,2,3)\rx\u0026lt;-delElement(x,2)\rx\r#\u0026gt; [1] 1 3\r Adding Attributes to Vectors å‡½æ•¸attributes() å¯ä»¥è®“æˆ‘å€‘æœ‰èƒ½åŠ›çµ¦ä¸€å€‹æ™®é€šçš„ç‰©ä»¶åŠ å…¥ä¸€äº›è¨»è§£æˆ–æ˜¯åç¨±ã€‚ä»¥å‘é‡ç‚ºä¾‹,å¦‚ä¸‹,ä¸€é–‹å§‹è¨­å®šå‘é‡çš„æ™‚å€™,å…§å®šå±¬æ€§æ˜¯NULL\nv1 \u0026lt;- 8:17\rattributes(v1)\r#\u0026gt; NULL\r ç¾åœ¨å¯ä»¥çµ¦å…ƒç´ åç¨±\n# assigning names to a pre-existing vector\rnames(v1) \u0026lt;- letters[1:length(v1)] #ğŸ·ğŸ‘æ ¹æ“šå¯¦éš›é•·åº¦çµ¦å®ša,b,c,d...\rv1\r#\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17\r ç„¶å¾Œçœ‹çœ‹å±¬æ€§\nattributes(v1)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;\r é‚£ï¼Œä»€éº¼æ˜¯names(v1)\nnames(v1)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;\r ä¹Ÿå°±æ˜¯èªªnames()å‡½æ•¸è¿”å›æ¯å€‹å…ƒç´ çš„åå­ï¼Œè€Œattributes()è¿”å›çš„æ˜¯æœ‰ä»€éº¼å±¬æ€§ã€‚ä½†æ˜¯å†ä»”ç´°çœ‹çœ‹ï¼Œå¯ä»¥ç™¼ç¾æŒ‡æ´¾attribute çµ¦\nattributes(v1)\u0026lt;-list(x='',y='',z='')\rv1\r#\u0026gt; [1] 8 9 10 11 12 13 14 15 16 17\r#\u0026gt; attr(,\u0026quot;x\u0026quot;)\r#\u0026gt; [1] \u0026quot;\u0026quot;\r#\u0026gt; attr(,\u0026quot;y\u0026quot;)\r#\u0026gt; [1] \u0026quot;\u0026quot;\r#\u0026gt; attr(,\u0026quot;z\u0026quot;)\r#\u0026gt; [1] \u0026quot;\u0026quot;\rattributes(v1)\r#\u0026gt; $x\r#\u0026gt; [1] \u0026quot;\u0026quot;\r#\u0026gt; #\u0026gt; $y\r#\u0026gt; [1] \u0026quot;\u0026quot;\r#\u0026gt; #\u0026gt; $z\r#\u0026gt; [1] \u0026quot;\u0026quot;\r æ¸¬è©¦æ˜¯å¦å¯ä»¥è‡ªè¡ŒåŠ å…¥attributesï¼Œç„¶å¾Œè®“names()å¯ä»¥é‹ä½œï¼Œå¦‚ä¸‹ï¼š\nattributes(v1)\u0026lt;-list(names=letters[1:10])\rv1\r#\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17\rattributes(v1)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;\rnames(v1)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;\r ä¸Šé¢é€™å€‹ç¨‹å¼æš—ç¤ºäº†ä»€éº¼ï¼Ÿ\n å‡½æ•¸names()åªæ˜¯attributes()\u0026lt;-çš„ä¸€å€‹ç‰¹ä¾‹ï¼Œæˆ‘å€‘ç¸½æ˜¯å¯ä»¥è‡ªè¡ŒåŠ å…¥ä¸€å€‹å±¬æ€§ï¼Œåç¨±ç‚ºnamesè®“å‡½æ•¸names()å¯ä»¥æŠŠæ¯å€‹å…ƒç´ çš„åç¨±åˆ—å°å‡ºä¾†ã€‚\n å¾Œé¢é€™æ®µç¨‹å¼ç¢¼åªæ˜¯å°ç…§ä¸€ä¸‹ä¹‹å‰æ¯å€‹å…ƒç´ åŠ å…¥åç¨±çš„ä½œæ³•ï¼Œæœ¬èº«æ²’æ„ç¾©ï¼š\n# adding names when creating vectors\rv2 \u0026lt;- c(name1 = 1, name2 = 2, name3 = 3)\rv2\r#\u0026gt; name1 name2 name3 #\u0026gt; 1 2 3\rattributes(v2)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;name1\u0026quot; \u0026quot;name2\u0026quot; \u0026quot;name3\u0026quot;\r ä¹Ÿå¯ä»¥åŠ å…¥è¨»è§£ï¼š\ncomment(v1) \u0026lt;- \u0026quot;This is a comment on a vector\u0026quot;\rv1\r#\u0026gt; a b c d e f g h i j #\u0026gt; 8 9 10 11 12 13 14 15 16 17\rattributes(v1)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot;\r#\u0026gt; #\u0026gt; $comment\r#\u0026gt; [1] \u0026quot;This is a comment on a vector\u0026quot;\r "},
{"uri": "/blogR//rlang/1_2_filesystem.html","title": "1.2 æª”æ¡ˆç³»çµ±",
	"tags": [],
	"description": "è®€å–è³‡æ–™",
	"content": "åˆ†è§£ã€åˆæˆæª”æ¡ˆè·¯å¾‘ åˆæˆè·¯å¾‘ workingdir \u0026lt;- \u0026quot;work\u0026quot;\rprojectdir \u0026lt;- \u0026quot;demo\u0026quot;\rdatadir \u0026lt;- \u0026quot;data\u0026quot;\ry\u0026lt;-file.path(workingdir, projectdir, datadir)\ry\r#\u0026gt; [1] \u0026quot;work/demo/data\u0026quot;\rtypeof(y)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r ä¸Šé¢æ˜¯windows 10ç³»çµ±ä¸Šçš„çµæœ,åœ¨ Linux-based çš„ä½œæ¥­ç³»çµ±åŸ·è¡Œçµæœä¸€æ¨£,æ³¨æ„æ–œç·šéƒ½ä¸€æ¨£ã€‚\nåˆ©ç”¨å‡½æ•¸ file.path()åˆæˆæª”æ¡ˆè·¯å¾‘ï¼Œå…¶åˆ†éš”æ˜¯æ–œç·š,è€Œä¸æ˜¯åæ–œç·š (ä¾‹å¦‚for example C:/Program Files/R/R-3.5.1)?\nè·¯å¾‘åˆ†è§£  dirname() :åˆ†è§£è·¯å¾‘ç”¨ï¼Œä¾‹å¦‚ï¼‚c:/temp/text.txt\u0026quot; å¾—åˆ°\u0026quot;c:/temp\u0026quot;ï¼Œä½†æ˜¯\u0026quot;c:/temp/\u0026quot;,\u0026quot;c:/temp\u0026quot;, \u0026quot;c:/temp.txt\u0026quot;éƒ½å¾—åˆ°\u0026quot;c:/\u0026quot;ã€‚ğŸ˜’ğŸ·æœ‰æ™‚å€™æœ‰å¾Œç¶´\u0026quot;/\u0026quot;,æœ‰æ™‚å€™æ²’æœ‰ basename()  dirname(\u0026quot;c:\\\\temp\\\\demo.txt\u0026quot;)\r#\u0026gt; [1] \u0026quot;c:/temp\u0026quot;\rbasename(\u0026quot;c:\\\\temp\\\\demo.txt\u0026quot;)\r#\u0026gt; [1] \u0026quot;demo.txt\u0026quot;\rdirname(\u0026quot;c:/temp/\u0026quot;) #ğŸ·ğŸ‘æ²’æœ‰æ­£ç¢ºæ‹¿å‡ºDIR\r#\u0026gt; [1] \u0026quot;c:/\u0026quot;\rdirname(\u0026quot;c:/temp\u0026quot;) #ğŸ·ğŸ‘æ²’æœ‰æ­£ç¢ºæ‹¿å‡ºDIR\r#\u0026gt; [1] \u0026quot;c:/\u0026quot;\r æª”æ¡ˆç³»çµ±ç›¸é—œæ“ä½œ  dir():åŒ…æ‹¬è³‡æ–™å¤¾ã€æª”æ¡ˆåç¨± list.files() : åƒ…æª”æ¡ˆ list.dirs():åƒ…è³‡æ–™å¤¾  åˆ¤åˆ¥æ˜¯å¦ç›®æ¨™æª”æ¡ˆæˆ–è³‡æ–™å¤¾å·²ç¶“å­˜åœ¨(æˆ‘å€‘ä¸å¸Œæœ›åˆªé™¤æˆ–æ›´å‹•å·²ç¶“å­˜åœ¨çš„æª”æ¡ˆ):\n  file.exists(\u0026quot;xx.txt\u0026quot;): æ˜¯å¦å­˜åœ¨xx.txt\n  dir.exists(\u0026quot;xx\u0026quot;): æ˜¯å¦å­˜åœ¨å­ç›®éŒ„xx\n  å·¥ä½œå€ç›¸é—œ\n getwd() setwd() .libPaths() : ç›®å‰å¥—ä»¶å®‰è£çš„åœ°æ–¹ã€‚ R.Home() : ç›®å‰Rå®‰è£çš„åœ°æ–¹,ä¾‹å¦‚\u0026quot;C:/PROGRA~1/R/R-41~1.1\u0026quot;    ç¯„ä¾‹\ncurrentwd\u0026lt;-getwd()\rsetwd(\u0026quot;~\u0026quot;) # ğŸ·é€™æ˜¯ä½¿ç”¨è€…ç›®éŒ„,çœ‹ä½ æ˜¯ç”šéº¼ç³»çµ±è€Œå®š,æˆ‘çš„æ˜¯windows\rgetwd()\r#\u0026gt; [1] \u0026quot;C:/Users/you/Documents\u0026quot;\rsetwd(currentwd)\rpath.expand(\u0026quot;~\u0026quot;) # ğŸ·ğŸ‘å±•é–‹è·¯å¾‘~\rR.home()\rlibPaths()\rlist.files(R.home()) #:å¯ä»¥åˆ—å‡ºRçš„å®‰è£çš„ä½ç½®,ç„¶å¾Œlist.files()åˆ—å‡ºæª”æ¡ˆ\rlist.dirs(R.home(\u0026quot;doc\u0026quot;))\rlist.dirs(R.home(\u0026quot;doc\u0026quot;), full.names = FALSE)\r## åœ¨ä½¿ç”¨è€…æŒ‡å®šçš„ç›®éŒ„,åˆ—å‡º æª”æ¡ˆçš„é–‹é ­æ˜¯ aåˆ°l æˆ– rã€‚\rdir(\u0026quot;../..\u0026quot;, pattern = \u0026quot;^[a-lr]\u0026quot;, full.names = TRUE, ignore.case = TRUE)\r ç·´ç¿’ æŒ‰ç…§ä¸Šé¢çš„çµæœ,å¦‚æœæˆ‘è¦åˆ¤æ–·æˆ‘æ‹¿åˆ°æ˜¯æª”æ¡ˆè€Œä¸æ˜¯è³‡æ–™å¤¾,æ€éº¼åš?æç¤º\r file.exists(f) \u0026amp;\u0026amp; !dir.exists(f)\r \nå•é¡Œ: åˆ©ç”¨.libPaths() ã€ list.files()å•é¡Œ:åˆ—å‡ºæ‰€æœ‰å¥—ä»¶æç¤º\r list.files(.libPaths())\r \næ“ä½œæª”æ¡ˆç³»çµ±   æš«æ™‚å­ç›®éŒ„çš„è·¯å¾‘tempdir()ï¼Œæš«æ™‚æª”æ¡ˆtempfile()\n å‡½æ•¸ tempfile() ä¸æ˜¯çœŸæ­£çš„å»ºç«‹æ–°æª”æ¡ˆ,è€Œæ˜¯åœ¨ç›®å‰çš„r sessionä¸­éš¨æ©Ÿç”¢ç”Ÿå”¯ä¸€æª”æ¡ˆåç¨±ï¼Œæª”æ¡ˆä½ç½®é è¨­æ˜¯åœ¨æš«æ™‚å­ç›®éŒ„ä¸­ã€‚  mydirname \u0026lt;- tempfile(pattern = \u0026quot;mydir\u0026quot;)\rmydirname\r#\u0026gt; C:\\\\Users\\\\ä½¿ç”¨è€…åç¨±\\\\AppData\\\\Local\\\\Temp\\\\RtmpSg2qRA\\\\mydir326845a02140\r     å‡½æ•¸ file.exists() å¯ä»¥ç”¨ä¾†çŸ¥é“æª”æ¡ˆæ˜¯å¦å­˜åœ¨,\n  å‡½æ•¸ dir() ç”¨ä¾†åˆ—å‡ºå­ç›®éŒ„ä¸­çš„æª”æ¡ˆ,ä¾‹å¦‚dir(tempdir())\n  \rç¯„ä¾‹\rs\u0026lt;-\u0026quot;C:\\\\Users\\\\ä½¿ç”¨è€…åç¨±\\\\AppData\\\\Local\\\\Temp\u0026quot;\rdir(s)\r    å»ºç«‹ç›®éŒ„ dir.create å»ºç«‹å­ç›®éŒ„\ndir.create(mydirname) file.exists(mydirname) # ä¸Šé¢æŒ‡ä»¤å»ºç«‹çš„å­ç›®éŒ„æ˜¯å¦å­˜åœ¨\rdir(tempdir(), full.names = TRUE) #åˆ—å‡ºç›®å‰å­ç›®éŒ„å…§å®¹(å…¨å)\rfile.mtime(mydirname) #å­ç›®éŒ„å»ºç«‹æ™‚é–“,make time\r çµæœ\n[1] TRUE [1] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/file87e8755a1876\u0026quot; [2] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/mydir87e86b51384d\u0026quot; [3] \u0026quot;C:\\\\Users\\\\xxx\\\\AppData\\\\Local\\\\Temp\\\\RtmpIp3ZiD/rs-graphics-0f3f81af-32b7-49c4-a272-ad1a859f222f\u0026quot; [1] \u0026quot;2018-10-25 23:42:51 CST\u0026quot;\r Rç³»çµ±æª”æ¡ˆåˆ—è¡¨ å¦‚æœè¦è§€å¯Ÿå®‰è£å¥—ä»¶çš„æª”æ¡ˆä½ç½®,å¯ä»¥ä½¿ç”¨æŒ‡ä»¤system.file(),é€™å€‹æŒ‡ä»¤å¯ä»¥åˆ—å‡ºå…§å»ºæŸå€‹å¥—å»ºçš„å…¨è·¯å¾‘ã€‚ä¾‹å¦‚,\nsystem.file(package = \u0026quot;stats\u0026quot;)\r# \u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-3.5.1/library/stats\u0026quot;\rsystem.file() ğŸ·åŸºæœ¬å¥—ä»¶è·¯å¾‘\r# \u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base\u0026quot; .libPaths() ğŸ·å¦å¤–å®‰è£çš„å¥—ä»¶è·¯å¾‘\r# \u0026gt; [1] \u0026quot;C:/Users/you/Documents/R/win-library/4.1\u0026quot;\r# \u0026gt; [2] \u0026quot;C:/Program Files/R/R-4.1.1/library\u0026quot;\r system.file()çš„çµæœæ˜¯ä¸€å€‹ç›®éŒ„,å› æ­¤å¯ä»¥åˆ©ç”¨dir()åˆ—å‡ºå¥—ä»¶statsä¸­,æ‰€æœ‰çš„æª”æ¡ˆ\ndir(system.file(package = \u0026quot;stats\u0026quot;))\r#\u0026gt; [1] \u0026quot;COPYRIGHTS.modreg\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;DESCRIPTION\u0026quot; #\u0026gt; [4] \u0026quot;help\u0026quot; \u0026quot;html\u0026quot; \u0026quot;INDEX\u0026quot; #\u0026gt; [7] \u0026quot;libs\u0026quot; \u0026quot;Meta\u0026quot; \u0026quot;NAMESPACE\u0026quot; #\u0026gt; [10] \u0026quot;R\u0026quot; \u0026quot;SOURCES.ts\u0026quot;  ä¸Šé¢å¯ä»¥çœ‹åˆ°å¥—ä»¶ä¸­åŒ…å«å­ç›®éŒ„demoï¼Œå¦‚æœé‚„è¦æŸ¥çœ‹demoä¸­çš„æª”æ¡ˆå…§å®¹:\ndir(system.file(\u0026quot;demo\u0026quot;, package = \u0026quot;stats\u0026quot;))\r#\u0026gt; [1] \u0026quot;glm.vr.R\u0026quot; \u0026quot;lm.glm.R\u0026quot; \u0026quot;nlm.R\u0026quot; \u0026quot;smooth.R\u0026quot;\r ä¸Šé¢åªæœ‰æª”æ¡ˆåç¨±,å¦‚æœè¦çœ‹å…¨è·¯å¾‘ï¼Œå¯ä»¥åˆ©ç”¨åƒæ•¸full.names:\ndir(system.file(\u0026quot;demo\u0026quot;, package = \u0026quot;stats\u0026quot;), full.names = TRUE)\r#\u0026gt; [1] \u0026quot;/usr/lib64/R/library/stats/demo/glm.vr.R\u0026quot;\r#\u0026gt; [2] \u0026quot;/usr/lib64/R/library/stats/demo/lm.glm.R\u0026quot;\r#\u0026gt; [3] \u0026quot;/usr/lib64/R/library/stats/demo/nlm.R\u0026quot; #\u0026gt; [4] \u0026quot;/usr/lib64/R/library/stats/demo/smooth.R\u0026quot;\r æ‡‰ç”¨ç¯„ä¾‹ åˆ—å‡ºç›®å‰å·¥ä½œç›®éŒ„ä¸Šçš„æª”æ¡ˆ x \u0026lt;- dir()\rfor (item in x) {\rprint(item) # show(item) }\r æˆ–è€…,åƒ…åˆ—å‡ºå‰å¹¾å€‹æª”æ¡ˆ\nx\u0026lt;-dir()\rhead(x)\r æª¢æŸ¥åœ¨ç›®å‰çš„å·¥ä½œç›®éŒ„ä¸‹,æ˜¯å¦å­˜åœ¨ä½¿ç”¨è€…å‚³éé€²ä¾†çš„ç›®éŒ„? ä¾‹å¦‚\nfolderlist\u0026lt;-c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;)\rcheckdir(folderlist)  ğŸ“ åˆ©ç”¨file.exists()\n\r\ré€²éš use RStudio to open the file if possible\nopen_file = function(x, open = interactive(), line = -1L) {\rif (open) tryCatch(rstudioapi::navigateToFile(x, line), error = function(e) file.edit(x))\r}\r pkg_file = function(..., mustWork = TRUE) {\rsystem.file(..., package = 'blogdown', mustWork = mustWork)\r}\r# tempfile under the current working directory\rwd_tempfile = function(..., pattern = '') {\rbasename(tempfile(pattern, '.', ...))\r}\r# only copy files/dirs if they exist\rfile.copy2 = function(from, to, ...) {\ri = file.exists(from); from = from[i]\rif (length(from) == 0) return()\rif (length(to) \u0026gt; 1) {\rto = to[i]\rif (length(unique(to)) == 1) to = unique(to)\r}\rif (length(to) == 1) {\rfile.copy(from, to, ...)\r} else mapply(file.copy, from, to, ...)\r}\rdir_rename = function(from, to, clean = FALSE) {\rif (!dir_exists(from)) return()\rif (clean) unlink(to, recursive = TRUE)\rdir_create(dirname(to))\r# I don't know why file.rename() might fail, but if it fails, fall back to\r# file.copy(): https://github.com/rstudio/blogdown/issues/232\rsuppressWarnings(file.rename(from, to)) || {\rfile.copy(from, dirname(to), recursive = TRUE) \u0026amp;\u0026amp; unlink(from, recursive = TRUE)\r}\r}\rdirs_rename = function(from, to, ...) {\rn = length(from); if (n == 0) return()\rif (length(to) != n) stop(\r'The number of source dirs must be equal to the number of target dirs'\r)\rfor (i in seq_len(n)) dir_rename(from[i], to[i], ...)\r}\r# relative path with '/' as the path separator\rrel_path = function(x) {\rxfun::relative_path(xfun::normalize_path(x))\r}\r# change the default of full.names and recursive in list.files() because these\r# values are used much more frequently than the original defaults\rlist_files = function(..., full.names = TRUE, recursive = TRUE) {\rlist.files(..., full.names = full.names, recursive = recursive, no.. = TRUE)\r}\r "},
{"uri": "/blogR//rlang/11_00_sampling.html","title": "11. sampling",
	"tags": [],
	"description": "åŸºæœ¬æŠ½æ¨£",
	"content": "Sample and Distribution 01 N\u0026lt;-100\rpop\u0026lt;-rnorm(N,5,2)\rrndno\u0026lt;-as.integer(runif(N)*N)+1\rsmp\u0026lt;-pop[rndno]\rss\u0026lt;-summary(smp)\rs1\u0026lt;-hist(smp)\rrug(quantile(smp), col=2, lwd=2.5)\rplot(s1$mids,s1$density,type=\u0026quot;s\u0026quot;) #quiz:barplot??\rs2\u0026lt;-hist(pop)\rplot(s1,col=\u0026quot;red\u0026quot;)\rlines(s2,col=\u0026quot;blue\u0026quot;)  å…§å»ºéš¨æ©ŸæŠ½æ¨£ å‡½æ•¸sample(x,n,replace=FALSE ). å…¶ä¸­xç‚ºè¦æŠ½å–çš„å‘é‡, nç‚ºæ¨£æœ¬å®¹é‡. replace é è¨­ç‚ºfalse\n no replacement, ç­‰æ©Ÿç‡:  ä¾‹å¦‚å¾52å¼µæ’²å…‹ç‰Œä¸­æŠ½å–5å¼µ:\nsample(1:52, 5)\r#\u0026gt; [1] 15 7 10 12 23\r replacement: ä¾‹å¦‚æ‹‹ä¸€æšå‡å‹»çš„ç¡¬å¹£10æ¬¡  sample(c(\u0026quot;H\u0026quot;, \u0026quot;T\u0026quot;), 10, replace=T)\r#\u0026gt; [1] \u0026quot;T\u0026quot; \u0026quot;H\u0026quot; \u0026quot;T\u0026quot; \u0026quot;H\u0026quot; \u0026quot;T\u0026quot; \u0026quot;T\u0026quot; \u0026quot;H\u0026quot; \u0026quot;T\u0026quot; \u0026quot;T\u0026quot; \u0026quot;H\u0026quot;\r ç·´ç¿’:ä¸€æ£µéª°å­æ“²10æ¬¡å¯è¡¨ç¤ºç‚º:\nä¸ç­‰å¯èƒ½çš„éš¨æ©ŸæŠ½æ¨£: sample(x, n, replace=TRUE, prob=y) prob=yæŒ‡å®šxä¸­å…ƒç´ å‡ºç¾çš„æ¦‚ç‡, å‘é‡yèˆ‡xç­‰é•·åº¦. ä¾‹å¦‚ä¸€å¨ƒå¨ƒæ©Ÿå–å‡ºæˆåŠŸçš„æ¦‚ç‡ç‚º0.6, é‚£éº¼10æ¬¡çš„è©¦é©—ç‚º:  sample(c(\u0026quot;sucess\u0026quot;, \u0026quot;fail\u0026quot;), 10, replace=T, prob=c(0.6,0.4))\r#\u0026gt; [1] \u0026quot;sucess\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;sucess\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;fail\u0026quot; \u0026quot;sucess\u0026quot;\r#\u0026gt; [9] \u0026quot;sucess\u0026quot; \u0026quot;fail\u0026quot;\r æ’åˆ—çµ„åˆèˆ‡æ¦‚ç‡çš„è¨ˆç®— ä¾‹ å¾ä¸€å‰¯52å¼µæ’²å…‹ä¸­å–4å¼µ, æ±‚ä»¥ä¸‹äº‹ä»¶çš„æ¦‚ç‡:\n æŠ½å–çš„4å¼µä¾æ¬¡ç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡; ä¸€æ¬¡æŠ½å–4å¼µç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡.  è§£\n æŠ½å–çš„4å¼µæ˜¯æœ‰æ¬¡åºçš„, å› æ­¤ä½¿ç”¨æ’åˆ—ä¾†æ±‚è§£. æ‰€æ±‚çš„äº‹ä»¶(è¨˜ç‚ºA)æ¦‚ç‡ç‚º ($P(A)=\\frac{1}{52 \\times 51 \\times 50 \\times 49}$) åˆ©ç”¨Rå‡½æ•¸  1/prod(52:49)\r#\u0026gt; [1] 1.539077e-07\r æ²’æœ‰æ¬¡åºçš„, å¯ä»¥ä½¿ç”¨çµ„åˆæ•¸ä¾†æ±‚è§£.  $$ P(B)=\\frac{1}{(52,4)} $$\nå…¶ä¸­ ($(n,m)=\\frac{n!}{m!(n-m)!}$),å¯ä»¥åˆ©ç”¨å‡½æ•¸choose(),ä¾‹å¦‚\n1/choose(52,4)\r#\u0026gt; [1] 3.693785e-06\r distribution æ¨™æº–è¡¨æ ¼ä¸Šä¸‹æ²’æœ‰ç·šæ¢,å·¦å³æœ‰\n   åç¨± Rå‡½æ•¸ é¸é …     beta beta shape1, shape2   binomial binom size, prob   Cauchy cauchy location=0, scale=1   chi-sqaured ($\\chi^2$) chisq df, ncp   exponential exp rate   Fisher (F) f df1, df2, ncp   gamma gamma shape, scale=1   geometric geom prob   hypergeometric hyper m, n, k   lognormal lnorm meanlog=0, sdlog=1   logistic logis location=0, scale=1   multinomial multinom size, prob   normal norm mean=0, sd=1   negative binomial nbinom size, prob   Poisson pois lambda   Studentâ€™s (t) t df   uniform unif min=0, max=1   Weibull weibull shape, scale=1   Wilcoxonâ€™s statistics wilcox m, n    signrank n    å°æ–¼æ‰€çµ¦çš„åˆ†ä½ˆåç¨±ï¼Œæœ‰å››é¡ã€‚\nä»¥funcç‚ºä¾‹ï¼Œ å››é¡å‡½æ•¸çš„å°æ‡‰ç‚º:\n ã€Œdã€æ¦‚ç‡å¯†åº¦å‡½æ•¸: dfunc(x, p1, p2, ...), xç‚ºæ•¸å€¼å‘é‡; ã€Œpã€(ç´¯ç©)åˆ†ä½ˆå‡½æ•¸: pfunc(q, p1, p2, ...), qç‚ºæ•¸å€¼å‘é‡; ã€Œqã€åˆ†ä½æ•¸å‡½æ•¸: qfunc(p, p1, p2, ...), pç‚ºç”±æ¦‚ç‡æ§‹æˆçš„å‘é‡; ã€Œrã€éš¨æ©Ÿæ•¸å‡½æ•¸: rfunc(n, p1, p2, ...), nç‚ºç”Ÿæˆæ•¸æ“šçš„å€‹æ•¸  é€™å››é¡å‡½æ•¸çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯æœ‰è¦å¾‹çš„: å½¢ç‚ºdfuncçš„å‡½æ•¸ç‚ºxï¼Œpfuncçš„å‡½æ•¸ç‚ºqï¼Œqfuncçš„å‡½æ•¸ç‚ºpï¼Œrfuncçš„å‡½æ•¸ç‚ºn\nnote: (ä½†rhyperå’Œrwilcoxæ˜¯ç‰¹ä¾‹ï¼Œä»–å€‘çš„ç¬¬ä¸€å€‹åƒæ•¸ç‚ºnn). éä¸­å¿ƒåƒæ•¸(non-centrality parameter)åƒ…å°CDFå’Œ å°‘æ•¸å…¶å®ƒå¹¾å€‹å‡½æ•¸æœ‰æ•ˆ.\n$$ \\frac{{\\sum\\limits_{i = 1}^n {{x_i} - n\\mu } }}{{\\sqrt {n{\\sigma ^2}} }} \\sim N(0,1) $$\n$$ \\bar X = \\frac{{\\sum_{i = 1}^n {{x_i} } }}{n} \\sim N(\\mu, \\sigma^2/n) $$\nuniform a~b\n$$\\mu = (a+b)/2$$\n$$\\sigma^2=\\frac{(b-a)^2}{12} $$\ndataçš„æ¯ä¸€å€‹ROWæœ‰sample size (=i=column)\nå…±1000æ¬¡(=N=row)\nN=1000 i=3 #sample size\rmu=0.5\rsigma=1/sqrt(12)\rdata\u0026lt;-matrix(runif(i*N),ncol=i)\rrs\u0026lt;-rowSums(data)\rrs\u0026lt;-rs/i\rz\u0026lt;-(rs-mu)/(sigma/sqrt(i))\rhist(z)\rlines(density(z), col = 'red', lwd = 3)\rx\u0026lt;-z\rcurve(dnorm(x), col = 'blue', lwd = 3, lty = 3, add = T)\rrug(sample(z,100))\r limite.central \u0026lt;-\rfunction (r = runif, distpar = c(0, 1), m = .5, s = 1 / sqrt(12), n = c(1, 3, 10, 30), N = 1000) {\rfor (i in n) {\rif (length(distpar) == 2) {\rx \u0026lt;-matrix(r(i * N, distpar[1], distpar[2]), nc = i)\r} else {\rx \u0026lt;-matrix(r(i * N, distpar), nc = i)\r}\rx \u0026lt;-(apply(x, 1, sum) - i * m) / (sqrt(i) * s)\rhist(x, col = 'light blue', probability = T, main = paste(\u0026quot;n=\u0026quot;, i),\rylim = c(0, max(.4, density(x) $y)))\rlines(density(x), col = 'red', lwd = 3)\rcurve(dnorm(x), col = 'blue', lwd = 3, lty = 3, add = T)\rif (N \u0026gt; 100) {\rrug(sample(x, 100))\r} else {\rrug(x)\r}\r}\r}\rop \u0026lt;- par(mfrow=c(2,2))\rlimite.central(rbinom, distpar=c(10 ,0.1), m=1, s=0.9)\rpar(op)\r  apply(x,1,sum) ç¬¬2å€‹åƒæ•¸1è¡¨ç¤ºrow æ–¹å‘,å¦‚æœæ˜¯2è¡¨ç¤ºcolumn å’Œmatlab ç›¸åã€‚  "},
{"uri": "/blogR//rlang/1_1_%E7%B3%BB%E7%B5%B1.html","title": "1.1 é‹ä½œç’°å¢ƒ",
	"tags": ["ç’°å¢ƒè®Šæ•¸"],
	"description": "ä½œæ¥­ç³»çµ±, Rå¥—è£çš„ç’°å¢ƒ",
	"content": "è®“Rå¥½ç”¨ä¸€é» Viewer  Viewer viewer \u0026lt;- getOption(\u0026quot;viewer\u0026quot;)\rif (!is.null(viewer))\rviewer(\u0026quot;http://localhost:8100\u0026quot;) else\rutils::browseURL(\u0026quot;http://localhost:8100\u0026quot;)\r  ğŸ˜œviewer(\u0026quot;URLç¶²å€\u0026quot;, height = 500)å¯ä»¥æŒ‡å®šé«˜åº¦ã€‚   (æš«æ™‚)[https://stackoverflow.com/questions/33312891/force-rstudio-to-use-browser-instead-of-viewer]  options(viewer = NULL) çš„å•é¡Œ    æˆ‘è¦è®“helpå‡ºç¾åœ¨ç€è¦½å™¨: options(browser=NULL)\nå’Œç¨‹å¼è¨­è¨ˆæœ‰é—œ ç’°å¢ƒè®Šæ•¸  windows å¹¾å€‹å¸¸ç”¨çš„è³‡æ–™å¤¾  %USERPROFILE% %LOCALAPPDATA% %APPDATA%    \r\rå­˜å–ä½œæ¥­ç³»çµ±çš„ç’°å¢ƒè®Šæ•¸ æŒ‡ä»¤é–‹é ­æ˜¯Sys\nhugocmd(\u0026quot;expand\u0026quot; ,'title=\u0026quot;\u0026quot; incode=true')\r#\u0026gt; \rå±•é–‹\rSys.getenv()\r#\u0026gt; ALLUSERSPROFILE C:\\ProgramData\r#\u0026gt; APPDATA C:\\Users\\linchao\\AppData\\Roaming\r#\u0026gt; CHROME_CRASHPAD_PIPE_NAME\r#\u0026gt; \\\\.\\pipe\\crashpad_15568_QBGATGEVDHVHFXZV\r#\u0026gt; COLORTERM truecolor\r#\u0026gt; CommonProgramFiles C:\\Program Files\\Common Files\r#\u0026gt; CommonProgramFiles(x86)\r#\u0026gt; C:\\Program Files (x86)\\Common Files\r#\u0026gt; CommonProgramW6432 C:\\Program Files\\Common Files\r#\u0026gt; COMPUTERNAME TALI\r#\u0026gt; ComSpec C:\\WINDOWS\\system32\\cmd.exe\r#\u0026gt; DriverData C:\\Windows\\System32\\Drivers\\DriverData\r#\u0026gt; EDITURL D:/work/rmi_r\r#\u0026gt; GIT_ASKPASS c:\\Users\\linchao\\AppData\\Local\\Programs\\Microsoft\r#\u0026gt; VS\r#\u0026gt; Code\\resources\\app\\extensions\\git\\dist\\askpass.sh\r#\u0026gt; HOME C:\\Users\\linchao\\Documents\r#\u0026gt; HOMEDRIVE C:\r#\u0026gt; HOMEPATH \\Users\\linchao\r#\u0026gt; LANG zh_TW.UTF-8\r#\u0026gt; LANGUAGE zh_TW\r#\u0026gt; LOCALAPPDATA C:\\Users\\linchao\\AppData\\Local\r#\u0026gt; LOGONSERVER \\\\TALI\r#\u0026gt; MSYS2_ENV_CONV_EXCL R_ARCH\r#\u0026gt; NUMBER_OF_PROCESSORS 32\r#\u0026gt; OneDrive C:\\Users\\linchao\\OneDrive\r#\u0026gt; ORIGINAL_XDG_CURRENT_DESKTOP\r#\u0026gt; undefined\r#\u0026gt; OS Windows_NT\r#\u0026gt; PATH C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program\r#\u0026gt; Files\\Git\\cmd;C:\\Program\r#\u0026gt; Files\\R\\R-4.1.1\\bin\\x64;C:\\Users\\linchao\\AppData\\Roaming\\Hugo\\0.88.0;C:\\Program\r#\u0026gt; Files\\PowerShell\\7\\;C:\\Program\r#\u0026gt; Files\\nodejs\\;C:\\Program\r#\u0026gt; Files\\Docker\\Docker\\resources\\bin;C:\\ProgramData\\DockerDesktop\\version-bin;C:\\rtools40\\mingw64\\bin;C:\\rtools40\\usr\\bin;C:\\DesktopUtils\\mytool;C:\\Users\\linchao\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\linchao\\AppData\\Local\\Programs\\Microsoft\r#\u0026gt; VS\r#\u0026gt; Code\\bin;C:\\Users\\linchao\\AppData\\Local\\Pandoc\\;C:\\Users\\linchao\\AppData\\Roaming\\npm;C:\\Program\r#\u0026gt; Files (x86)\\EaseUS\\Todo Backup\\bin\\x64\\\r#\u0026gt; PATHEXT .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\r#\u0026gt; POWERSHELL_DISTRIBUTION_CHANNEL\r#\u0026gt; MSI:Windows 10 Pro\r#\u0026gt; PROCESSOR_ARCHITECTURE\r#\u0026gt; AMD64\r#\u0026gt; PROCESSOR_IDENTIFIER AMD64 Family 25 Model 33 Stepping 0,\r#\u0026gt; AuthenticAMD\r#\u0026gt; PROCESSOR_LEVEL 25\r#\u0026gt; PROCESSOR_REVISION 2100\r#\u0026gt; ProgramData C:\\ProgramData\r#\u0026gt; ProgramFiles C:\\Program Files\r#\u0026gt; ProgramFiles(x86) C:\\Program Files (x86)\r#\u0026gt; ProgramW6432 C:\\Program Files\r#\u0026gt; PROMPT $P$G\r#\u0026gt; PSModulePath %ProgramFiles%\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\r#\u0026gt; PUBLIC C:\\Users\\Public\r#\u0026gt; R_ARCH /x64\r#\u0026gt; R_COMPILED_BY gcc 8.3.0\r#\u0026gt; R_HOME C:/PROGRA~1/R/R-41~1.1\r#\u0026gt; R_LIBS_USER C:\\Users\\linchao\\Documents/R/win-library/4.1\r#\u0026gt; R_USER C:\\Users\\linchao\\Documents\r#\u0026gt; RTOOLS40_HOME C:\\rtools40\r#\u0026gt; SystemDrive C:\r#\u0026gt; SystemRoot C:\\WINDOWS\r#\u0026gt; TEMP C:\\Users\\linchao\\AppData\\Local\\Temp\r#\u0026gt; TERM_PROGRAM vscode\r#\u0026gt; TERM_PROGRAM_VERSION 1.61.2\r#\u0026gt; TMP C:\\Users\\linchao\\AppData\\Local\\Temp\r#\u0026gt; USERDOMAIN TALI\r#\u0026gt; USERDOMAIN_ROAMINGPROFILE\r#\u0026gt; TALI\r#\u0026gt; USERNAME linchao\r#\u0026gt; USERPROFILE C:\\Users\\linchao\r#\u0026gt; VSCODE_GIT_ASKPASS_MAIN\r#\u0026gt; c:\\Users\\linchao\\AppData\\Local\\Programs\\Microsoft\r#\u0026gt; VS\r#\u0026gt; Code\\resources\\app\\extensions\\git\\dist\\askpass-main.js\r#\u0026gt; VSCODE_GIT_ASKPASS_NODE\r#\u0026gt; C:\\Users\\linchao\\AppData\\Local\\Programs\\Microsoft\r#\u0026gt; VS Code\\Code.exe\r#\u0026gt; VSCODE_GIT_IPC_HANDLE \\\\.\\pipe\\vscode-git-787abf7477-sock\r#\u0026gt; windir C:\\WINDOWS\rhugocmd(m=\u0026#34;expand\u0026#34; ,end=T)\r#\u0026gt; \rSys.setenv(R_TEST = \u0026quot;testit\u0026quot;)\rSys.getenv(\u0026quot;R_TEST\u0026quot;)\r#\u0026gt; [1] \u0026quot;testit\u0026quot;\rSys.unsetenv(\u0026quot;R_TEST\u0026quot;) # on Unix-alike may warn and not succeed\rSys.getenv(\u0026quot;R_TEST\u0026quot;, unset = NA)\r#\u0026gt; [1] NA\r (å¾…è£œå……)æ¯”è¼ƒæœ‰è¶£çš„æŒ‡ä»¤\nSys.sleep(0.1)\r \r\rRçš„ç’°å¢ƒè®Šæ•¸ åœ¨ä½œæ¥­ç³»çµ±ä¸­çš„æª”æ¡ˆ,ä¾‹å¦‚.Renviron,.Rprofileæœƒå½±éŸ¿Rçš„å•Ÿå‹•ç’°å¢ƒ(âœ”åƒè€ƒ)ã€‚\n .Platform = .Platform$OS.type .Renviron - which contains environment variables to be set in R sessions.  .Renviron åœ¨%USERPROFILE%ä¸­(é è¨­æ˜¯æ²’æœ‰çš„)ã€‚ç”¨ä¾†åœ¨Rå•Ÿå‹•ä¹‹å‰,è¨­å®šç³»çµ±çš„ç’°å¢ƒè®Šæ•¸ï¼Œå…§å®¹æ˜¯æ–‡å­—æª”,ä»¥KEY=VALUEçš„æ–¹å¼è¨­å®šã€‚ä¾‹å¦‚rtoolsçš„ä½ç½®(åƒè€ƒ1)ã€‚   .Rprofile - which contains R code to be run in each session. \rç¯„ä¾‹ ~/.Renviron on Unix\r## ç¯„ä¾‹ ~/.Renviron on Unix\rR_LIBS=~/R/library\rPAGER=/usr/local/bin/less\r## ç¯„ä¾‹ .Renviron on Windows âœ”\rR_LIBS=C:/R/library\rMY_TCLTK=\u0026quot;c:/Program Files/Tcl/bin\u0026quot;\r## ç¯„ä¾‹ setting R_DEFAULT_PACKAGES (from R CMD check)\rR_DEFAULT_PACKAGES='utils,grDevices,graphics,stats'\r# ä¾æ¬¡è¼‰å…¥ä¸Šè¿°çš„å¥—ä»¶,å› æ­¤åœ¨æœå°‹è·¯å¾‘ä¸Šæ˜¯åéä¾†çš„ã€‚\r   å‰é¢æéæ¯æ¬¡å•Ÿå‹•Rçš„æ™‚å€™æœƒç”¢ç”Ÿä¸€å€‹session,åŒæ™‚æœƒè¼‰å…¥.Rrofile(åˆ©ç”¨source),åœ¨é€™å€‹sessionè¼‰å…¥ä¹‹å¾Œ,æœƒåŸ·è¡Œ.First(),åœ¨è„«é›¢çš„æ™‚å€™,æœƒåŸ·è¡Œ.Last()ã€‚\n  \rç¯„ä¾‹ .Rprofile .First .Last\roptions(width=65, digits=5)\roptions(show.signif.stars=FALSE)\rsetHook(packageEvent(\u0026quot;grDevices\u0026quot;, \u0026quot;onLoad\u0026quot;),\rfunction(...) grDevices::ps.options(horizontal=FALSE))\rset.seed(1234)\r.First \u0026lt;- function() cat(\u0026quot;\\n headache!\\n\\n\u0026quot;)\r.Last \u0026lt;- function() cat(\u0026quot;\\n headacue cured!\\n\\n\u0026quot;)\r    \rç¯„ä¾‹ Rprofile.site\rlocal({\r# add MASS to the default packages, set a CRAN mirror\rold \u0026lt;- getOption(\u0026quot;defaultPackages\u0026quot;); r \u0026lt;- getOption(\u0026quot;repos\u0026quot;)\rr[\u0026quot;CRAN\u0026quot;] \u0026lt;- \u0026quot;http://my.local.cran\u0026quot;\roptions(defaultPackages = c(old, \u0026quot;MASS\u0026quot;), repos = r)\r## (for Unix terminal users) set the width from COLUMNS if set\rcols \u0026lt;- Sys.getenv(\u0026quot;COLUMNS\u0026quot;)\rif(nzchar(cols)) options(width = as.integer(cols))\r# interactive sessions get a fortune cookie (needs fortunes package)\rif (interactive())\rfortunes::fortune()\r})\r## if .Renviron contains\rFOOBAR=\u0026quot;coo\\bar\u0026quot;doh\\ex\u0026quot;abc\\\u0026quot;def'\u0026quot;\r## then we get\r# \u0026gt; cat(Sys.getenv(\u0026quot;FOOBAR\u0026quot;), \u0026quot;\\n\u0026quot;)\r# coo\\bardoh\\exabc\u0026quot;def'\r    R.home() Sys.getenv(\u0026quot;R_HOME\u0026quot;) éƒ½å¯ä»¥çŸ¥é“å®‰è£çš„ç›®éŒ„\n  ç›®å‰çš„è¨­å®š - å‡½æ•¸options()\n  options()\rgetOption(\u0026quot;windowsTimeouts\u0026quot;)\r \roptions()çš„åŸ·è¡Œçµæœ\r#\u0026gt; $add.smooth\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $blogdown.method\r#\u0026gt; [1] \u0026quot;markdown\u0026quot;\r#\u0026gt; #\u0026gt; $blogdown.serve_site.startup\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $browserNLdisabled\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $CBoundsCheck\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $check.bounds\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $citation.bibtex.max\r#\u0026gt; [1] 1\r#\u0026gt; #\u0026gt; $continue\r#\u0026gt; [1] \u0026quot;+ \u0026quot;\r#\u0026gt; #\u0026gt; $contrasts\r#\u0026gt; unordered ordered #\u0026gt; \u0026quot;contr.treatment\u0026quot; \u0026quot;contr.poly\u0026quot; #\u0026gt; #\u0026gt; $defaultPackages\r#\u0026gt; [1] \u0026quot;datasets\u0026quot; \u0026quot;utils\u0026quot; \u0026quot;grDevices\u0026quot; \u0026quot;graphics\u0026quot; \u0026quot;stats\u0026quot; \u0026quot;methods\u0026quot; #\u0026gt; #\u0026gt; $demo.ask\r#\u0026gt; [1] \u0026quot;default\u0026quot;\r#\u0026gt; #\u0026gt; $deparse.cutoff\r#\u0026gt; [1] 60\r#\u0026gt; #\u0026gt; $device\r#\u0026gt; function (width = 7, height = 7, ...) #\u0026gt; {\r#\u0026gt; grDevices::pdf(NULL, width, height, ...)\r#\u0026gt; }\r#\u0026gt; \u0026lt;bytecode: 0x000000001a675208\u0026gt;\r#\u0026gt; \u0026lt;environment: namespace:knitr\u0026gt;\r#\u0026gt; #\u0026gt; $device.ask.default\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $digits\r#\u0026gt; [1] 7\r#\u0026gt; #\u0026gt; $echo\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $editor\r#\u0026gt; [1] \u0026quot;notepad\u0026quot;\r#\u0026gt; #\u0026gt; $encoding\r#\u0026gt; [1] \u0026quot;native.enc\u0026quot; \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;è®€æª”æ™‚æœƒç”¨åˆ°,ä¾‹å¦‚readLine()\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; #\u0026gt; $example.ask\r#\u0026gt; [1] \u0026quot;default\u0026quot;\r#\u0026gt; #\u0026gt; $expressions\r#\u0026gt; [1] 5000\r#\u0026gt; #\u0026gt; $help.search.types\r#\u0026gt; [1] \u0026quot;vignette\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;help\u0026quot; #\u0026gt; #\u0026gt; $help.try.all.packages\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $help_type\r#\u0026gt; [1] \u0026quot;html\u0026quot;\r#\u0026gt; #\u0026gt; $HTTPUserAgent\r#\u0026gt; [1] \u0026quot;R (4.1.1 x86_64-w64-mingw32 x86_64 mingw32)\u0026quot;\r#\u0026gt; #\u0026gt; $install.packages.compile.from.source\r#\u0026gt; [1] \u0026quot;interactive\u0026quot;\r#\u0026gt; #\u0026gt; $internet.info\r#\u0026gt; [1] 2\r#\u0026gt; #\u0026gt; $keep.parse.data\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $keep.parse.data.pkgs\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $keep.source\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $keep.source.pkgs\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $knitr.in.progress \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ç›®å‰çš„æ–‡ä»¶åœ¨RMDä¸­ç”¢ç”Ÿ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $locatorBell\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $mailer\r#\u0026gt; [1] \u0026quot;mailto\u0026quot;\r#\u0026gt; #\u0026gt; $matprod\r#\u0026gt; [1] \u0026quot;default\u0026quot;\r#\u0026gt; #\u0026gt; $max.print\r#\u0026gt; [1] 99999\r#\u0026gt; #\u0026gt; $menu.graphics\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $na.action\r#\u0026gt; [1] \u0026quot;na.omit\u0026quot;\r#\u0026gt; #\u0026gt; $nwarnings\r#\u0026gt; [1] 50\r#\u0026gt; #\u0026gt; $OutDec\r#\u0026gt; [1] \u0026quot;.\u0026quot;\r#\u0026gt; #\u0026gt; $pager\r#\u0026gt; [1] \u0026quot;internal\u0026quot;\r#\u0026gt; #\u0026gt; $papersize\r#\u0026gt; [1] \u0026quot;a4\u0026quot;\r#\u0026gt; #\u0026gt; $PCRE_limit_recursion\r#\u0026gt; [1] NA\r#\u0026gt; #\u0026gt; $PCRE_study\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $PCRE_use_JIT\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $pdfviewer\r#\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/bin/x64/open.exe\u0026quot;\r#\u0026gt; #\u0026gt; $pkgType\r#\u0026gt; [1] \u0026quot;both\u0026quot;\r#\u0026gt; #\u0026gt; $prompt\r#\u0026gt; [1] \u0026quot;\u0026gt; \u0026quot;\r#\u0026gt; #\u0026gt; $repos\r#\u0026gt; CRAN #\u0026gt; \u0026quot;@CRAN@\u0026quot; #\u0026gt; #\u0026gt; $scipen\r#\u0026gt; [1] 0\r#\u0026gt; #\u0026gt; $show.coef.Pvalues\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $show.error.messages\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $show.signif.stars\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $showErrorCalls\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $str\r#\u0026gt; $str$strict.width\r#\u0026gt; [1] \u0026quot;no\u0026quot;\r#\u0026gt; #\u0026gt; $str$digits.d\r#\u0026gt; [1] 3\r#\u0026gt; #\u0026gt; $str$vec.len\r#\u0026gt; [1] 4\r#\u0026gt; #\u0026gt; $str$list.len\r#\u0026gt; [1] 99\r#\u0026gt; #\u0026gt; $str$deparse.lines\r#\u0026gt; NULL\r#\u0026gt; #\u0026gt; $str$drop.deparse.attr\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $str$formatNum\r#\u0026gt; function (x, ...) #\u0026gt; format(x, trim = TRUE, drop0trailing = TRUE, ...)\r#\u0026gt; \u0026lt;environment: 0x00000000193f2900\u0026gt;\r#\u0026gt; #\u0026gt; #\u0026gt; $str.dendrogram.last\r#\u0026gt; [1] \u0026quot;`\u0026quot;\r#\u0026gt; #\u0026gt; $stringsAsFactors\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $tikzMetricsDictionary\r#\u0026gt; [1] \u0026quot;1_0_requirement-tikzDictionary\u0026quot;\r#\u0026gt; #\u0026gt; $timeout\r#\u0026gt; [1] 60\r#\u0026gt; #\u0026gt; $try.outFile\r#\u0026gt; A connection with #\u0026gt; description \u0026quot;output\u0026quot; #\u0026gt; class \u0026quot;textConnection\u0026quot;\r#\u0026gt; mode \u0026quot;wr\u0026quot; #\u0026gt; text \u0026quot;text\u0026quot; #\u0026gt; opened \u0026quot;opened\u0026quot; #\u0026gt; can read \u0026quot;no\u0026quot; #\u0026gt; can write \u0026quot;yes\u0026quot; #\u0026gt; #\u0026gt; $ts.eps\r#\u0026gt; [1] 1e-05\r#\u0026gt; #\u0026gt; $ts.S.compat\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $unzip\r#\u0026gt; [1] \u0026quot;internal\u0026quot;\r#\u0026gt; #\u0026gt; $useFancyQuotes\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $verbose\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $warn\r#\u0026gt; [1] 0\r#\u0026gt; #\u0026gt; $warning.length\r#\u0026gt; [1] 1000\r#\u0026gt; #\u0026gt; $width\r#\u0026gt; [1] 80\r#\u0026gt; #\u0026gt; $windowsTimeouts\r#\u0026gt; [1] 100 500\r  å®‰è£çš„æ™‚å€™,å‡ºç¾æ‰¾ä¸åˆ°repos,å¯ä»¥å¦‚ä¸‹,é€™æ¨£ä¸ç”¨ç¬¬äºŒæ¬¡å®šç¾©\nr = getOption(\u0026quot;repos\u0026quot;) \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;options()$\u0026quot;repos\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rr[\u0026quot;CRAN\u0026quot;] = \u0026quot;http://cran.us.r-project.org\u0026quot;\roptions(repos = r)\r è§£é‡‹\nr # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å¸¶åå­—çš„å­—ä¸²,ç°¡å–®ç†è§£ç‚ºå…ƒç´ ç·¨è™Ÿå¯ä»¥ç”¨å…ƒç´ åå­—ä»£æ›¿\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; CRAN #\u0026gt; \u0026quot;http://cran.us.r-project.org\u0026quot; #\u0026gt; attr(,\u0026quot;RStudio\u0026quot;)\r#\u0026gt; [1] TRUE\rr[\u0026quot;CRAN\u0026quot;] # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;=r[1]\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; CRAN #\u0026gt; \u0026quot;http://cran.us.r-project.org\u0026quot;  \r\rç·´ç¿’ æ¯”è¼ƒä¸€ä¸‹environments()é€™å€‹å‡½æ•¸ï¼Œå¯ä»¥åˆ—å‡ºç›®å‰å·¥ä½œå€ä¸Šçš„è®Šæ•¸ã€‚environment() å‚³å›ä¸€å€‹frame,ç›¸ç•¶æ–¼Ræä¾›çš„ç¸½é«”è®Šæ•¸.GlobalEnv\nnames(environment()) # ğŸ·å› ç‚ºæ˜¯çµæ§‹frame å› æ­¤å¯ä»¥åˆ©ç”¨names()åˆ—å‡ºæ¬„ä½\ridentical(.GlobalEnv, environment()) #ğŸ·ç”¨ä¾†æ¯”è¼ƒå…©å€‹åƒæ•¸æ˜¯å¦ç›¸åŒ,åŒ…æ‹¬å€¼å’Œé¡åˆ¥\rnames(.GlobalEnv)\r"},
{"uri": "/blogR//rlang/1_3_%E5%9F%B7%E8%A1%8C.html","title": "1.3 åŸ·è¡Œ",
	"tags": [],
	"description": "1_1_run",
	"content": "ç„¡æ³•å•Ÿå‹•bash args \u0026lt;- commandArgs()\rprint(args)\rscript in .R æ€æ¨£çŸ¥é“Script çš„å·¥ä½œç›®éŒ„(åƒè€ƒ)\nscript.dir \u0026lt;- dirname(sys.frame(1)$ofile)\r .Rprofile  è©³ç´°çš„ç¯„ä¾‹\n debug  å‡½æ•¸:debug()  ä¾‹å¦‚æœ‰ä¸€å€‹å‡½æ•¸ç‚ºg(),å‰‡debug(g)å¯ä»¥é–‹å§‹åµéŒ¯ã€‚   å‡½æ•¸Stopifnot(x\u0026gt;0): æ”¾åœ¨å‡½æ•¸ä¸­é–“,ç¢ºå®šè®Šæ•¸x\u0026gt;0ã€‚ å‡½æ•¸traceback()æ§åˆ¶å°å‡ºç¾ç´…è‰²è¨Šæ¯é¡¯ç¤ºéŒ¯èª¤æ™‚,åœ¨æ§åˆ¶å°æ•²å…¥traceback()å¯ä»¥è¿½è¹¤éŒ¯èª¤ã€‚ å‡½æ•¸browser()æ”¾åœ¨å‡½æ•¸ä¸­,åŸ·è¡Œåˆ°é€™è¡Œçš„æ™‚å€™æœƒé€²å…¥åµéŒ¯çš„æ­¥é€²æ¨¡å¼ï¼Œç„¶å¾Œä¸€æ­¥ä¸€æ­¥åµéŒ¯ã€‚ å‡½æ•¸tracer() å‡½æ•¸recover()  è‡ªè¨‚å¥—ä»¶çš„åµéŒ¯ï¼Œå¯ä»¥è¨­å®šoptions(error = recover)ã€‚é€™æ¨£é‡åˆ°éŒ¯èª¤çš„æ™‚å€™,æœƒé€²å…¥æ­¥é€²æ¨¡å¼ã€‚\n"},
{"uri": "/blogR//rlang/1_4_rpackages.html","title": "1.4 R Package",
	"tags": [],
	"description": "å¥—ä»¶",
	"content": "åŸºæœ¬ åƒè€ƒ\n R package and Github å»ºç«‹Rå¥—ä»¶  å¥—ä»¶åœ¨å“ªè£¡   å…ˆçŸ¥é“ä¸€ä¸‹Rè¢«å®‰è£åœ¨å“ªè£¡\nR.home() #ğŸ·ğŸ‘Rè¢«å®‰è£åœ¨å“ªè£¡\rsystem.file() #ğŸ·ğŸ‘é è¨­å¥—ä»¶baseè¢«è£åœ¨å“ªè£¡\r   å¦‚æœè¦çŸ¥é“å®‰è£çš„å¥—ä»¶åœ¨é›»è…¦çš„å“ªå€‹åœ°æ–¹: .libPaths()\n.libPaths()\r #\u0026gt; [1] \u0026quot;C:/Users/linchao/Documents/R/win-library/4.1\u0026quot;\r#\u0026gt; [2] \u0026quot;C:/Program Files/R/R-4.1.1/library\u0026quot;\r   å¦‚æœè¦è‡ªå·±é è¨­æŒ‡å®šå®‰è£å¥—ä»¶ä½ç½®ï¼Œå¯ä»¥åœ¨ä½¿ç”¨è€…æ–‡ä»¶å¤¾ä¸Šæ‰¾åˆ°.Rprofile ç„¶å¾Œå¯«ä¸Šé€™ä¸€è¡Œ: .libPaths(\u0026quot;C:/myRlibary\u0026quot;)\n  å¥—ä»¶çš„å®‰è£ install.packages('Rcpp', dependencies = TRUE) #ğŸ·ğŸ‘dependencies = TRUE,å¯ä»¥è®“ä¾å­˜çš„æª”æ¡ˆè‡ªå‹•å®‰è£ã€‚\r ç›®å‰ä½¿ç”¨ä¸­çš„å¥—ä»¶ search()å¯ä»¥åˆ—å‡ºåœ¨æ‰¹æ¬¡æ¨¡å¼ä¸‹ä½¿ç”¨çš„å¥—ä»¶,å¦å¤–ä¸€å€‹æŒ‡ä»¤sessionInfo() å¯ä»¥åˆ—å‡ºæ›´å¤šç›¸é—œè¨Šæ¯ã€‚\næœå°‹å¥—ä»¶ä¸­çš„æª”æ¡ˆ å°å‡½æ•¸system.file()çš„ç†è§£ç‚º,è¼¸å…¥æ˜¯ä»¥å¥—ä»¶ç‚ºæ ¹è·¯å¾‘,ç„¶å¾Œç›¸å°è·¯å¾‘,å‚³å›çš„æ˜¯çµ•å°è·¯å¾‘ã€‚ ç¯„ä¾‹\nsystem.file(\u0026quot;help\u0026quot;, \u0026quot;AnIndex\u0026quot;, package = \u0026quot;splines\u0026quot;) # ğŸ·ğŸ‘è§£é‡‹ï¼šåœ¨å¥—ä»¶splines ä¸­çš„æ ¹ç›®éŒ„ä¸­æœå°‹å­ç›®éŒ„helpï¼Œæ‰¾å‡ºåç¨±ç‚ºAnIndexçš„æª”æ¡ˆï¼Œä¸¦å‚³å›è·¯å¾‘åç¨±ã€‚\r#\u0026gt; [1] \u0026quot;C:/PROGRA~1/MICROS~4/RCLIEN~1/R_SERVER/library/splines/help/AnIndex\u0026quot; #ğŸ·ğŸ‘å‚³å›çµ•å°è·¯å¾‘\r å¤§è‡´ä¸Šçš„æœç´¢æ­¥é©Ÿ\n  åˆ—å‡ºå¥—ä»¶statsæ‰€åœ¨çš„å­ç›®éŒ„\nsystem.file(package = \u0026quot;stats\u0026quot;)\r #\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/stats\u0026quot;\r   çŸ¥é“äº†å­ç›®éŒ„,å¯ä»¥åˆ—å‡ºå…¶ä¸­çš„æª”æ¡ˆ\ndir(system.file(package = \u0026quot;stats\u0026quot;))\r #\u0026gt; [1] \u0026quot;COPYRIGHTS.modreg\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;DESCRIPTION\u0026quot; #\u0026gt; [4] \u0026quot;help\u0026quot; \u0026quot;html\u0026quot; \u0026quot;INDEX\u0026quot; #\u0026gt; [7] \u0026quot;libs\u0026quot; \u0026quot;Meta\u0026quot; \u0026quot;NAMESPACE\u0026quot; #\u0026gt; [10] \u0026quot;R\u0026quot; \u0026quot;SOURCES.ts\u0026quot; \u0026quot;tests\u0026quot;\r   ä¸Šé¢çŸ¥é“æœ‰å­ç›®éŒ„demo,å¯ä»¥å†é€²ä¸€æ­¥çœ‹å…¶ä¸­çš„æª”æ¡ˆ:\ndir(system.file(\u0026quot;demo\u0026quot;, package = \u0026quot;stats\u0026quot;))\r #\u0026gt; [1] \u0026quot;glm.vr.R\u0026quot; \u0026quot;lm.glm.R\u0026quot; \u0026quot;nlm.R\u0026quot; \u0026quot;smooth.R\u0026quot;\r   å¦‚æœè¦çŸ¥é“å¥—ä»¶ä¸­æœ‰å“ªäº›å‡½æ•¸å¯ä»¥ç”¨,å‰‡\nlibrary(help = \u0026quot;base\u0026quot;) # ğŸ·ğŸ‘åˆ—å‡ºåŸºæœ¬å¥—ä»¶æ‰€æœ‰å¯ç”¨å‡½æ•¸\rlibrary(help = \u0026quot;utils\u0026quot;)\r å“ªå€‹å‡½æ•¸å±¬æ–¼å“ªå€‹å¥—ä»¶?  å¯ä»¥ç›´æ¥æ‰“å…¥å‡½æ•¸åç¨±ä½†æ˜¯ä¸è¦æœ‰æ‹¬è™Ÿï¼Œçœ‹æœ€å¾Œä¸€è¡Œ:  R.home \u0026lt;-\rfunction (component = \u0026quot;home\u0026quot;) {\rrh \u0026lt;- .Internal(R.home())\rswitch(component, home = rh, bin = if (.Platform$OS.type == \u0026quot;windows\u0026quot; \u0026amp;\u0026amp; nzchar(p \u0026lt;- .Platform$r_arch)) file.path(rh, component, p) else file.path(rh, component), share = if (nzchar(p \u0026lt;- Sys.getenv(\u0026quot;R_SHARE_DIR\u0026quot;))) p else file.path(rh, component), doc = if (nzchar(p \u0026lt;- Sys.getenv(\u0026quot;R_DOC_DIR\u0026quot;))) p else file.path(rh, component), include = if (nzchar(p \u0026lt;- Sys.getenv(\u0026quot;R_INCLUDE_DIR\u0026quot;))) p else file.path(rh, component), modules = if (nzchar(p \u0026lt;- .Platform$r_arch)) file.path(rh, component, p) else file.path(rh, component), file.path(rh, component))\r}\r\u0026lt;bytecode: 0x3183948\u0026gt;\r\u0026lt;environment: namespace:base\u0026gt;\r è³‡æ–™é›† æœ‰ä¸‰å€‹æ–¹æ³•å¯ä»¥å¾å¥—ä»¶å­˜å–è³‡æ–™ã€‚ä¾‹å¦‚ï¼Œ\n åˆ©ç”¨:: ggplot2::diamonds %\u0026gt;% head()\r  library() library(ggplot2)\rdiamonds %\u0026gt;% head()\r  data() data(\u0026quot;diamonds\u0026quot;, package=\u0026quot;ggplot2\u0026quot;)\rls()\r   ç·´ç¿’ é™¤äº†ä¸Šé¢çš„è³‡æ–™é›†å­˜å–ä»¥å¤–,æœ‰æ™‚å€™ä¹Ÿæœƒæƒ³è¦å­˜å–å…¶ä»–æª”æ¡ˆçš„å…§å®¹,é€™è£¡å°±æ˜¯ç›¸é—œçš„ç·´ç¿’ã€‚\nä¾‹å¦‚,å¥—ä»¶epuRateçš„å®‰è£ç›®éŒ„ç‚ºD:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INSTï¼Œç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š\nD:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INST\râ””â”€rmarkdown\râ””â”€templates\râ”œâ”€basic\râ”‚ â””â”€skeleton\râ”œâ”€epurate\râ”‚ â”œâ”€resources\râ”‚ â””â”€skeleton\râ””â”€PCTG\râ”œâ”€resources\râ””â”€skeleton\r åƒè€ƒä¸Šé¢çš„ç›®éŒ„çµæ§‹ï¼Œå‰‡ä¸‹é¢ç¨‹å¼åŸ·è¡Œçš„çµæœcss,header, template åˆ†åˆ¥æ˜¯ä»€éº¼? css \u0026lt;- system.file(\u0026quot;rmarkdown\u0026quot;, \u0026quot;templates\u0026quot;, \u0026quot;epurate\u0026quot; ,\u0026quot;resources\u0026quot;, \u0026quot;style.css\u0026quot;, package = \u0026quot;epuRate\u0026quot;)\rheader \u0026lt;- system.file(\u0026quot;rmarkdown\u0026quot;, \u0026quot;templates\u0026quot;, \u0026quot;epurate\u0026quot; ,\u0026quot;resources\u0026quot;, \u0026quot;header.html\u0026quot;, package = \u0026quot;epuRate\u0026quot;)\rtemplate \u0026lt;- system.file(\u0026quot;rmarkdown\u0026quot;, \u0026quot;templates\u0026quot;, \u0026quot;epurate\u0026quot; ,\u0026quot;resources\u0026quot;, \u0026quot;template_epurate.html\u0026quot;, package = \u0026quot;epuRate\u0026quot;)\r æç¤º\r hint:\ncss: D:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INST\\rmarkdown\\templates\\eurate\\resouces\\style.css\r \nå•é¡Œï¼š\nsystem.file('rmarkdown')\r #\u0026gt; [1] \u0026quot;\u0026quot;\r ç‚ºä»€éº¼å‚³å›ç©ºå€¼ : \u0026quot;\u0026quot; ?\næç¤º\r hint æ²’æœ‰æŒ‡å®šå¥—ä»¶åç¨±ï¼Œå› æ­¤é è¨­ç‚ºbaseï¼Œè€Œbaseçš„æ ¹ç›®éŒ„ä¸­ï¼Œæ‰¾ä¸åˆ°å­ç›®éŒ„æˆ–æª”æ¡ˆç‚ºrmarkdownçš„æª”æ¡ˆã€‚\nå¯¦é©—è¨˜éŒ„\nlist.dirs(system.file()) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ²’æœ‰ä»»ä½•åƒæ•¸,é è¨­æ˜¯\u0026lt;code\u0026gt;base\u0026lt;/code\u0026gt;å¥—ä»¶ ğŸ‘å› æ­¤\u0026lt;code\u0026gt;system.file()\u0026lt;/code\u0026gt;å‚³å›å¥—ä»¶\u0026lt;code\u0026gt;base\u0026lt;/code\u0026gt;çš„æ ¹ç›®éŒ„\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r #\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base\u0026quot; #\u0026gt; [2] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/demo\u0026quot;\r#\u0026gt; [3] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/help\u0026quot;\r#\u0026gt; [4] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/html\u0026quot;\r#\u0026gt; [5] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/Meta\u0026quot;\r#\u0026gt; [6] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/R\u0026quot;\r list.files(system.file()) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘\u0026lt;code\u0026gt;list.files\u0026lt;/code\u0026gt; çš„å¦ä¸€å€‹åå­æ˜¯\u0026lt;code\u0026gt;dir()\u0026lt;/code\u0026gt;åˆ—å‡ºæ‰€æœ‰æª”æ¡ˆå’Œç›®éŒ„\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r #\u0026gt; [1] \u0026quot;CITATION\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;DESCRIPTION\u0026quot; \u0026quot;help\u0026quot; \u0026quot;html\u0026quot; #\u0026gt; [6] \u0026quot;INDEX\u0026quot; \u0026quot;Meta\u0026quot; \u0026quot;R\u0026quot;\r  list.dirs(system.file()) å‚³å›ä¸Šè¿°æ ¹ç›®éŒ„çš„æ‰€æœ‰å­ç›®éŒ„ã€‚ system.file()çš„å‚³å›çš„é …ç›®åŒ…æ‹¬å­ç›®éŒ„å’Œæª”æ¡ˆåç¨±ã€‚ä¸‹é¢çš„åƒæ•¸ï¼Œä¸€å€‹æ˜¯å­ç›®éŒ„htmlä¸€å€‹æ˜¯æª”æ¡ˆINDEXï¼Œéƒ½å‚³å›è·¯å¾‘åç¨±ã€‚ system.file(\u0026quot;html\u0026quot;)\r#\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/html\u0026quot; \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™æ˜¯folder\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rsystem.file(\u0026quot;INDEX\u0026quot;)\r#\u0026gt; [1] \u0026quot;C:/PROGRA~1/R/R-41~1.1/library/base/INDEX\u0026quot; \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™æ˜¯file\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r   \r\rlibrary() vs require() if (!require(\u0026quot;å¥—ä»¶åç¨±\u0026quot;)){\rinstall.pacakges(\u0026quot;å¥—ä»¶åç¨±\u0026quot;)\r}\r detach ç¯„ä¾‹ detach_package() è¨è«–å…§å»ºå‡½æ•¸detach_package()\nä½¿ç”¨æ–¹æ³•ï¼š\ndetach_package(vegan)\rdetach_package(\u0026quot;vegan\u0026quot;, TRUE)#ğŸ·ğŸ‘ å› ç‚ºç¬¬1å€‹åƒæ•¸æ˜¯å­—ä¸²,æ‰€ä»¥ç¬¬2å€‹åƒæ•¸`character.only'=Tï¼š\r \rçœ‹ä¸€ä¸‹detach_package()é€™å€‹å‡½æ•¸æ˜¯æ€éº¼å¯«çš„\rdetach_package \u0026lt;- function(pkg, character.only = FALSE)\r{\rif(!character.only) #å¦‚æœæ²’æœ‰æŒ‡å®šåƒæ•¸æ˜¯å­—ä¸²\r{\rpkg \u0026lt;- deparse(substitute(pkg)) # è½‰å­—ä¸²\r}\rsearch_item \u0026lt;- paste(\u0026quot;package\u0026quot;, pkg, sep = \u0026quot;:\u0026quot;)\rwhile(search_item %in% search())\r{\rdetach(search_item, unload = TRUE, character.only = TRUE)\r}\r}\r "},
{"uri": "/blogR//rlang/1_5_%E7%B7%A8%E7%A2%BC.html","title": "1.5 ç·¨ç¢¼",
	"tags": [],
	"description": "1_5_ç·¨ç¢¼",
	"content": "ç·¨ç¢¼   æ¯ä¸€ç¨®ç‰¹å®šçš„èªè¨€ï¼Œéƒ½å­˜åœ¨ä¸€ç¨®æˆ–æ•¸ç¨®çš„ code page(ä½†æ˜¯åœ¨ä¸åŒå» å•†(ä¾‹å¦‚IBM), code page çš„æ•¸å­—ä¸åŒ) ã€‚ ä¾‹å¦‚ï¼š\n code page = 950 : æ­£é«”ä¸­æ–‡big5 windows-1252 çš„ code page = 1252 :è¥¿æ­çš„è‹±èªç³»ä½¿ç”¨ shift_jis çš„ code page = 932 : æ—¥èªä¸­çš„æ¼¢å­—ä½¿ç”¨ã€‚    textmining\n  æ›´å¤š\n  åƒè€ƒ\n  æœ€ä½³ç·¨ç¢¼ğŸ‘\n  çœ‹çœ‹ç³»çµ±æœ¬èº«çš„ç·¨ç¢¼(Current Locale)\nl10n_info()\r#\u0026gt; $MBCS â›³ \r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; $`UTF-8` ğŸ·ğŸ‘åœ¨linuxç³»çµ±ä¸­,é€™å…©å€‹(UTF-8,Latin-1)æœ‰ä¸€å€‹æ˜¯çœŸï¼Œæ„æ€å°±æ˜¯èªªï¼Œä¸æ˜¯é€™å€‹ï¼Œå°±æ˜¯é‚£å€‹ï¼Œä½†æ˜¯åœ¨windowsä¸­ï¼Œéƒ½æ˜¯ï¼¦ğŸ¤·â€â™€ï¸\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $`Latin-1`\r#\u0026gt; [1] FALSE\r#\u0026gt; #\u0026gt; $codepage\r#\u0026gt; [1] 950\r#\u0026gt; #\u0026gt; $system.codepage\r#\u0026gt; [1] 950\rsessionInfo() # è£¡çš„ localğŸ·å› ç‚ºå‚³å›çš„æ˜¯çµæ§‹listå› æ­¤sessionInfo()$localå¯ä»¥çœ‹åˆ°çµæœ\r#\u0026gt; R version 4.1.1 (2021-08-10)\r#\u0026gt; Platform: x86_64-w64-mingw32/x64 (64-bit)\r#\u0026gt; Running under: Windows 10 x64 (build 19043)\r#\u0026gt; #\u0026gt; Matrix products: default\r#\u0026gt; #\u0026gt; locale:\r#\u0026gt; [1] LC_COLLATE=Chinese (Traditional)_Taiwan.950 ğŸ·ğŸ‘ç•¶å‰ç·¨ç¢¼çš„æ’åºå’Œæ¯”è¼ƒè¦å‰‡\r#\u0026gt; [2] LC_CTYPE=Chinese (Traditional)_Taiwan.950 ğŸ·ğŸ‘ ç”¨æ–¼å­—å…ƒåˆ†é¡å’Œå­—ä¸²è™•ç†ï¼Œæ§åˆ¶æ‰€æœ‰å­—å…ƒçš„è™•ç†æ–¹å¼ï¼ŒåŒ…æ‹¬å­—å…ƒç·¨ç¢¼ï¼Œå­—å…ƒæ˜¯å–®å­—ç¯€é‚„æ˜¯å¤šä½å…ƒçµ„ï¼Œå¦‚ä½•åˆ—å°ç­‰\r#\u0026gt; [3] LC_MONETARY=Chinese (Traditional)_Taiwan.950 ğŸ·ğŸ‘è²¨å¹£æ ¼å¼\r#\u0026gt; [4] LC_NUMERIC=C ğŸ·ğŸ‘ éè²¨å¹£çš„æ•¸å­—é¡¯ç¤ºæ ¼å¼\r#\u0026gt; [5] LC_TIME=Chinese (Traditional)_Taiwan.950 ğŸ·ğŸ‘ æ™‚é–“å’Œæ—¥æœŸæ ¼å¼ #\u0026gt; #\u0026gt; attached base packages:\r#\u0026gt; [1] stats graphics grDevices utils datasets methods base #\u0026gt; #\u0026gt; loaded via a namespace (and not attached):\r#\u0026gt; [1] compiler_4.1.1 magrittr_2.0.1 tools_4.1.1 glue_1.4.2 stringi_1.7.4 #\u0026gt; [6] knitr_1.33 stringr_1.4.0 xfun_0.25 evaluate_0.14\rSys.getlocale(\u0026quot;LC_ALL\u0026quot;) # ğŸ·âœ”ç”±é–‹é ­Sysï¼Œå¯ä»¥çŸ¥é“é€™æ˜¯ä½œæ¥­ç³»çµ±è®Šæ•¸å­˜å– ğŸ·âœ”ä¹Ÿå¯ä»¥åªæ‰“Sys.getlocale()\r#\u0026gt; [1] \u0026quot;LC_COLLATE=Chinese (Traditional)_Taiwan.950;LC_CTYPE=Chinese (Traditional)_Taiwan.950;LC_MONETARY=Chinese (Traditional)_Taiwan.950;LC_NUMERIC=C;LC_TIME=Chinese (Traditional)_Taiwan.950\u0026quot;\rgetOption(\u0026quot;encoding\u0026quot;) # ğŸ·âœ”å…¶å¯¦æ˜¯å¾å‰é¢çš„options()ä¸­çš„éµå€¼encodingæ‹¿è³‡æ–™ï¼Œæ‰€ä»¥options()$encodingä¹Ÿå¯ä»¥ ğŸ·âœ”é€™å€‹é¸é …æ˜¯ç”¨ä¾†ç·¨ç¢¼ä¸²æµ(ä¾‹å¦‚æª”æ¡ˆ,URLç­‰ç­‰)è€Œä¸æ˜¯è§£è®€ç¨‹å¼ç¢¼ä¸­çš„å­—ä¸²å‘é‡ã€‚å…§å®šæ˜¯ \u0026quot;native.enc\u0026quot; ã€‚ç™½è©±æ–‡çš„æ„æ€å°±æ˜¯é€šè¨Šå”å®šå…§å®šæ˜¯ASCIIï¼ˆå› æ­¤éœ€è¦å°‡å„ç¨®ä¸æ˜¯ASCIIçš„å­—å…ƒç·¨ç¢¼ï¼Œå¯ä»¥åˆ©ç”¨UTF-8ï¼‰,è€ƒæ…®ç¶²è·¯å”å®šéƒ½æ˜¯ASCII,å› æ­¤,ä¸ç”¨è²»è…¦ç­‹åœ¨é€™è£¡äº†,é™¤éè¦é‡å¯«ç³»çµ±\r#\u0026gt; [1] \u0026quot;native.enc\u0026quot;\r æ›´æ”¹ç³»çµ±çš„èªç³»ï¼Œä»¥ä¸‹æ›´æ”¹ç‚º UTF-8\n# for mac\rSys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = \u0026quot;en_US.UTF-8\u0026quot;)\r# for windows\rSys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = \u0026quot;UTF-8\u0026quot;)\rx=\u0026quot;hello\u0026quot;\r# x is a vector\rEncoding(x) #ğŸ·âœ”ä¸æ˜¯ç”¨ä¾†çŸ¥é“ç³»çµ±çš„ç·¨ç¢¼,è€Œæ˜¯ï¼²ç¨‹å¼ç¢¼è®Šæ•¸ï¼ˆä¾‹å¦‚é€™è£¡çš„x)ä¸­çš„è³‡æ–™ç·¨ç¢¼\r Encoding()çš„ä½¿ç”¨ç¯„ä¾‹\n ğŸ‘ºascii å­—ä¸²ä¾‹å¦‚ x=\u0026quot;hello\u0026quot; ,Encoding(x)çš„çµæœéƒ½æ˜¯ unknown,å› ç‚ºASCIIä¸ç”¨ç·¨ç¢¼,åœ¨æ‰€æœ‰çš„ç·¨ç¢¼ç³»çµ±éƒ½ä¸€è‡´ã€‚\n x\u0026lt;- 'éç™½é¦¬' Encoding(x) ## [1] \u0026quot;unknown\u0026quot; \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;a href=\u0026quot;#%e6%8f%90%e7%a4%ba1\u0026quot;\u0026gt;è¨»è§£\u0026lt;/a\u0026gt;\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;â“ç‚ºç”šéº¼æ˜¯unknownâ“â“æŒ‰ç…§èªªæ˜æ›¸,éASCIIå…§å®šéƒ½æ˜¯çµ¦ç›®å‰æŒ‡å®šçš„localeèªç³»ï¼Œå°±æ˜¯l10n_info()ç‚ºTRUEçš„é‚£å€‹\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r# å¦‚æœæ˜¯big5\rx2\u0026lt;- iconv(x, 'big5', 'UTF-8') #è½‰UTF-8ï¼Œè½‰å®Œä»¥å¾Œå¯ä»¥ç”¨Encoding(x)å†æ¬¡é©—è­‰\r# å¦‚æœæ˜¯GB2312\rx2\u0026lt;- iconv(x, 'GB2312', 'UTF-8') #è½‰UTF-8\rEncoding(x2) ## [1] \u0026quot;UTF-8\u0026quot;  è®€æª”æ¡ˆçš„æ™‚å€™,å¦‚æœè¦è‡ªè¡ŒæŒ‡å®šç·¨ç¢¼,é‚£éº¼ä¸‹é¢æ˜¯ä¸€äº›ç›¸é—œç¨‹å¼ç¢¼\nsource(\u0026quot;myRcode.R\u0026quot;, encoding = \u0026quot;utf-8\u0026quot;)\rreadLines(\u0026quot;mydata.csv\u0026quot;, encoding = \u0026quot;big5\u0026quot;)\rread.table(..., fileEncoding = \u0026quot;\u0026quot;, encoding = \u0026quot;unknown\u0026quot;,...)\rdata \u0026lt;- iconv(data, \u0026quot;big5\u0026quot;, \u0026quot;utf8\u0026quot;) # å°‡è³‡æ–™è½‰æˆ UTF-8\r \r\räº‚ç¢¼å¸¸ç”¨çš„åˆ¤æ–·æŸ¥è©¢ ğŸ˜’åªåœ¨WINä¸Šæ¸¬è©¦\n æŸ¥çœ‹ç›®å‰Rä½¿ç”¨çš„èªç³»: è¼¸å…¥ Sys.getlocale() æˆ– Sys.getlocale(category = \u0026quot;LC_ALL\u0026quot;)ï¼Œ  \ræˆ‘çš„ç³»çµ±ä¸Šé¡¯ç¤ºçš„æ˜¯\rSys.getlocale()\r# \u0026quot;LC_COLLATE=Chinese (Traditional)_Taiwan.950;LC_CTYPE=Chinese (Traditional)_Taiwan.950;LC_MONETARY=Chinese (Traditional)_Taiwan.950;LC_NUMERIC=C;LC_TIME=Chinese (Traditional)_Taiwan.950\u0026quot;\r# ğŸ˜’æœ‰äº›ç³»çµ±æ˜¯ç”¨/åˆ†éš”ï¼Œä¾‹å¦‚\r#.UTF-8/C/en_US.UTF-8/en_US.UTF-8\u0026quot;      å¦‚æœä¸æ˜¯ Chinese (Traditional)_Taiwan.950 è€…ï¼Œå¯ä»¥è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤è¨­å®š RStudio/R çš„èªç³»\n è‹±æ–‡ï¼š  Sys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = â€œUTF-8\u0026quot;)   ä¸­æ–‡ï¼š  Sys.setlocale(\u0026quot;LC_ALL\u0026quot;,\u0026quot;Chinese (Traditional)_Taiwan.950\u0026quot;) æˆ–Sys.setlocale(\u0026quot;LC_ALL\u0026quot;,\u0026quot;cht\u0026quot;)  \råŸ·è¡Œçµæœ\rğŸ˜’è¨­å®šçš„çµæœ,å°±æ˜¯é è¨­çš„å®‰è£ç’°å¢ƒ,å¦‚ä¸‹æ‰€ç¤º\r \u0026gt; Sys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = \u0026quot;cht\u0026quot;) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ ç­‰åŒæ–¼Sys.setlocale(\u0026amp;quot;LC_ALL\u0026amp;quot;,\u0026amp;quot;Chinese (Traditional)_Taiwan.950\u0026amp;quot;)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r[1] \u0026quot;LC_COLLATE=Chinese (Traditional)_Taiwan.950;LC_CTYPE=Chinese (Traditional)_Taiwan.950;LC_MONETARY=Chinese (Traditional)_Taiwan.950;LC_NUMERIC=C;LC_TIME=Chinese (Traditional)_Taiwan.950\u0026quot;\r    Sys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = \u0026quot;zh_TW.UTF-8\u0026quot;) æˆ– Sys.setlocale(category = \u0026quot;LC_ALL\u0026quot;, locale = \u0026quot;zh_TW\u0026quot;) #ğŸ·ğŸ‘é€™æ˜¯linuxåœ¨è¦–çª—ä¸­ä¸è¡Œ  é€™æ‡‰è©²æ˜¯linux åœ¨windows ç„¡ä½œç”¨,éœ€è¦è¶…ç´šä½¿ç”¨è€…      è©¦è©¦çœ‹(é›–ç„¶ä¹Ÿæ²’ä»€éº¼ç”¨)\n æ‰¾åˆ°Rconsole æª”æ¡ˆï¼ˆç”¨everythingæœå°‹è»Ÿé«”,å¯èƒ½ä½ç½® Rçš„å®‰è£ç›®éŒ„\\etc\\Rconsoleï¼‰,ã€‚é€™æ˜¯ä¸€å€‹æ–‡å­—æª”ã€‚ åœ¨å…¶ä¸­æ‰¾åˆ° language ç„¶å¾Œæ”¹æˆlanguage = English æˆ– zh_TW  read.csv  stack overflow  åœ¨linux ä¸­,å¦‚æœæ˜¯UTF-8,é€™æ¨£å°±å¯ä»¥ read.csv(\u0026quot;japanese_utf8.csv\u0026quot;) ä½†æ˜¯å¦‚æœä¸æ˜¯UTF-8,å‰‡æŒ‡å®šç·¨ç¢¼ read.csv(\u0026quot;japanese_shiftjis.csv\u0026quot;, fileEncoding = \u0026quot;SHIFT-JIS\u0026quot;) å•é¡Œæ˜¯windows:\nif(!require(readr)){\rinstall.packages(\u0026quot;readr\u0026quot;,dependencies=T)\r}\r #\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šreadr\r options(stringsAsFactors = FALSE)\rdf\u0026lt;-read_csv(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;,\rcomment=\u0026quot;#\u0026quot;,\rlocale = locale(encoding = \u0026quot;UTF-8\u0026quot;))\r #\u0026gt; Error: 'resources/wh_zh_utf8.csv' does not exist in current working directory ('D:/work/rmi_r').\r knitr::kable(df)\r #\u0026gt; Error in as.data.frame.default(x): ä¸èƒ½æŠŠ \u0026quot;'\u0026quot;function\u0026quot;'\u0026quot; é¡åˆ¥å¼·è¿«è®Šæˆ data.frame\r df\u0026lt;-read_csv(\u0026quot;resources/wh_zh_950.csv\u0026quot;,\rcomment=\u0026quot;#\u0026quot;,\rlocale = locale(encoding = \u0026quot;big5\u0026quot;) )\r #\u0026gt; Error: 'resources/wh_zh_950.csv' does not exist in current working directory ('D:/work/rmi_r').\r #ğŸ·âŒzh_TW,cht, Chinese (Traditional)_Taiwan.950ã€‚âœ”:big5\rknitr::kable(df)\r #\u0026gt; Error in as.data.frame.default(x): ä¸èƒ½æŠŠ \u0026quot;'\u0026quot;function\u0026quot;'\u0026quot; é¡åˆ¥å¼·è¿«è®Šæˆ data.frame\r è¼”åŠ© hugocmd(\u0026quot;expand\u0026quot; ,'title=\u0026quot;\u0026quot; incode=true')\r#\u0026gt;  \rå±•é–‹\riconvlist()\r#\u0026gt; [1] \u0026#34;437\u0026#34; \u0026#34;850\u0026#34; #\u0026gt; [3] \u0026#34;852\u0026#34; \u0026#34;855\u0026#34; #\u0026gt; [5] \u0026#34;857\u0026#34; \u0026#34;860\u0026#34; #\u0026gt; [7] \u0026#34;861\u0026#34; \u0026#34;862\u0026#34; #\u0026gt; [9] \u0026#34;863\u0026#34; \u0026#34;865\u0026#34; #\u0026gt; [11] \u0026#34;866\u0026#34; \u0026#34;869\u0026#34; #\u0026gt; [13] \u0026#34;ANSI_X3.4-1968\u0026#34; \u0026#34;ANSI_X3.4-1986\u0026#34; #\u0026gt; [15] \u0026#34;ASCII\u0026#34; \u0026#34;ASMO-708\u0026#34; #\u0026gt; [17] \u0026#34;BIG-5\u0026#34; \u0026#34;BIG-FIVE\u0026#34; #\u0026gt; [19] \u0026#34;big5\u0026#34; \u0026#34;BIG5\u0026#34; #\u0026gt; [21] \u0026#34;big5-hkscs\u0026#34; \u0026#34;BIG5-HKSCS\u0026#34; #\u0026gt; [23] \u0026#34;big5hkscs\u0026#34; \u0026#34;BIG5HKSCS\u0026#34; #\u0026gt; [25] \u0026#34;CP-GR\u0026#34; \u0026#34;CP-IS\u0026#34; #\u0026gt; [27] \u0026#34;cp1025\u0026#34; \u0026#34;CP1125\u0026#34; #\u0026gt; [29] \u0026#34;CP1133\u0026#34; \u0026#34;CP1200\u0026#34; #\u0026gt; [31] \u0026#34;CP12000\u0026#34; \u0026#34;CP12001\u0026#34; #\u0026gt; [33] \u0026#34;CP1201\u0026#34; \u0026#34;CP1250\u0026#34; #\u0026gt; [35] \u0026#34;CP1251\u0026#34; \u0026#34;CP1252\u0026#34; #\u0026gt; [37] \u0026#34;CP1253\u0026#34; \u0026#34;CP1254\u0026#34; #\u0026gt; [39] \u0026#34;CP1255\u0026#34; \u0026#34;CP1256\u0026#34; #\u0026gt; [41] \u0026#34;CP1257\u0026#34; \u0026#34;CP1258\u0026#34; #\u0026gt; [43] \u0026#34;CP1361\u0026#34; \u0026#34;CP154\u0026#34; #\u0026gt; [45] \u0026#34;CP367\u0026#34; \u0026#34;CP437\u0026#34; #\u0026gt; [47] \u0026#34;CP50221\u0026#34; \u0026#34;CP51932\u0026#34; #\u0026gt; [49] \u0026#34;CP65001\u0026#34; \u0026#34;CP737\u0026#34; #\u0026gt; [51] \u0026#34;CP775\u0026#34; \u0026#34;CP819\u0026#34; #\u0026gt; [53] \u0026#34;CP850\u0026#34; \u0026#34;CP852\u0026#34; #\u0026gt; [55] \u0026#34;CP853\u0026#34; \u0026#34;CP855\u0026#34; #\u0026gt; [57] \u0026#34;CP857\u0026#34; \u0026#34;CP858\u0026#34; #\u0026gt; [59] \u0026#34;CP860\u0026#34; \u0026#34;CP861\u0026#34; #\u0026gt; [61] \u0026#34;CP862\u0026#34; \u0026#34;CP863\u0026#34; #\u0026gt; [63] \u0026#34;CP864\u0026#34; \u0026#34;CP865\u0026#34; #\u0026gt; [65] \u0026#34;cp866\u0026#34; \u0026#34;CP866\u0026#34; #\u0026gt; [67] \u0026#34;CP869\u0026#34; \u0026#34;CP874\u0026#34; #\u0026gt; [69] \u0026#34;cp875\u0026#34; \u0026#34;CP932\u0026#34; #\u0026gt; [71] \u0026#34;CP936\u0026#34; \u0026#34;CP949\u0026#34; #\u0026gt; [73] \u0026#34;CP950\u0026#34; \u0026#34;CSASCII\u0026#34; #\u0026gt; [75] \u0026#34;CSIBM855\u0026#34; \u0026#34;CSIBM857\u0026#34; #\u0026gt; [77] \u0026#34;CSIBM860\u0026#34; \u0026#34;CSIBM861\u0026#34; #\u0026gt; [79] \u0026#34;CSIBM863\u0026#34; \u0026#34;CSIBM864\u0026#34; #\u0026gt; [81] \u0026#34;CSIBM865\u0026#34; \u0026#34;CSIBM866\u0026#34; #\u0026gt; [83] \u0026#34;CSIBM869\u0026#34; \u0026#34;csISO2022JP\u0026#34; #\u0026gt; [85] \u0026#34;CSISOLATIN1\u0026#34; \u0026#34;CSPC775BALTIC\u0026#34; #\u0026gt; [87] \u0026#34;CSPC850MULTILINGUAL\u0026#34; \u0026#34;CSPC862LATINHEBREW\u0026#34; #\u0026gt; [89] \u0026#34;CSPC8CODEPAGE437\u0026#34; \u0026#34;CSPCP852\u0026#34; #\u0026gt; [91] \u0026#34;CSPTCP154\u0026#34; \u0026#34;CSWINDOWS31J\u0026#34; #\u0026gt; [93] \u0026#34;CYRILLIC-ASIAN\u0026#34; \u0026#34;DOS-720\u0026#34; #\u0026gt; [95] \u0026#34;DOS-862\u0026#34; \u0026#34;EUC-CN\u0026#34; #\u0026gt; [97] \u0026#34;euc-jp\u0026#34; \u0026#34;euc-kr\u0026#34; #\u0026gt; [99] \u0026#34;EUC-KR\u0026#34; \u0026#34;EUCCN\u0026#34; #\u0026gt; [101] \u0026#34;eucjp\u0026#34; \u0026#34;euckr\u0026#34; #\u0026gt; [103] \u0026#34;GB18030\u0026#34; \u0026#34;gb2312\u0026#34; #\u0026gt; [105] \u0026#34;GBK\u0026#34; \u0026#34;hz-gb-2312\u0026#34; #\u0026gt; [107] \u0026#34;IBM-CP1133\u0026#34; \u0026#34;IBM-Thai\u0026#34; #\u0026gt; [109] \u0026#34;IBM00858\u0026#34; \u0026#34;IBM00924\u0026#34; #\u0026gt; [111] \u0026#34;IBM01047\u0026#34; \u0026#34;IBM01140\u0026#34; #\u0026gt; [113] \u0026#34;IBM01141\u0026#34; \u0026#34;IBM01142\u0026#34; #\u0026gt; [115] \u0026#34;IBM01143\u0026#34; \u0026#34;IBM01144\u0026#34; #\u0026gt; [117] \u0026#34;IBM01145\u0026#34; \u0026#34;IBM01146\u0026#34; #\u0026gt; [119] \u0026#34;IBM01147\u0026#34; \u0026#34;IBM01148\u0026#34; #\u0026gt; [121] \u0026#34;IBM01149\u0026#34; \u0026#34;IBM037\u0026#34; #\u0026gt; [123] \u0026#34;IBM1026\u0026#34; \u0026#34;IBM273\u0026#34; #\u0026gt; [125] \u0026#34;IBM277\u0026#34; \u0026#34;IBM278\u0026#34; #\u0026gt; [127] \u0026#34;IBM280\u0026#34; \u0026#34;IBM284\u0026#34; #\u0026gt; [129] \u0026#34;IBM285\u0026#34; \u0026#34;IBM290\u0026#34; #\u0026gt; [131] \u0026#34;IBM297\u0026#34; \u0026#34;IBM367\u0026#34; #\u0026gt; [133] \u0026#34;IBM420\u0026#34; \u0026#34;IBM423\u0026#34; #\u0026gt; [135] \u0026#34;IBM424\u0026#34; \u0026#34;IBM437\u0026#34; #\u0026gt; [137] \u0026#34;IBM437\u0026#34; \u0026#34;IBM500\u0026#34; #\u0026gt; [139] \u0026#34;ibm737\u0026#34; \u0026#34;ibm775\u0026#34; #\u0026gt; [141] \u0026#34;IBM775\u0026#34; \u0026#34;IBM819\u0026#34; #\u0026gt; [143] \u0026#34;ibm850\u0026#34; \u0026#34;IBM850\u0026#34; #\u0026gt; [145] \u0026#34;ibm852\u0026#34; \u0026#34;IBM852\u0026#34; #\u0026gt; [147] \u0026#34;IBM855\u0026#34; \u0026#34;IBM855\u0026#34; #\u0026gt; [149] \u0026#34;ibm857\u0026#34; \u0026#34;IBM857\u0026#34; #\u0026gt; [151] \u0026#34;IBM860\u0026#34; \u0026#34;IBM860\u0026#34; #\u0026gt; [153] \u0026#34;ibm861\u0026#34; \u0026#34;IBM861\u0026#34; #\u0026gt; [155] \u0026#34;IBM862\u0026#34; \u0026#34;IBM863\u0026#34; #\u0026gt; [157] \u0026#34;IBM863\u0026#34; \u0026#34;IBM864\u0026#34; #\u0026gt; [159] \u0026#34;IBM864\u0026#34; \u0026#34;IBM865\u0026#34; #\u0026gt; [161] \u0026#34;IBM865\u0026#34; \u0026#34;IBM866\u0026#34; #\u0026gt; [163] \u0026#34;ibm869\u0026#34; \u0026#34;IBM869\u0026#34; #\u0026gt; [165] \u0026#34;IBM870\u0026#34; \u0026#34;IBM871\u0026#34; #\u0026gt; [167] \u0026#34;IBM880\u0026#34; \u0026#34;IBM905\u0026#34; #\u0026gt; [169] \u0026#34;iso-2022-jp\u0026#34; \u0026#34;iso-2022-jp\u0026#34; #\u0026gt; [171] \u0026#34;ISO-2022-JP\u0026#34; \u0026#34;ISO-2022-JP-MS\u0026#34; #\u0026gt; [173] \u0026#34;iso-2022-kr\u0026#34; \u0026#34;ISO-8859-1\u0026#34; #\u0026gt; [175] \u0026#34;iso-8859-13\u0026#34; \u0026#34;iso-8859-15\u0026#34; #\u0026gt; [177] \u0026#34;iso-8859-2\u0026#34; \u0026#34;iso-8859-3\u0026#34; #\u0026gt; [179] \u0026#34;iso-8859-4\u0026#34; \u0026#34;iso-8859-5\u0026#34; #\u0026gt; [181] \u0026#34;iso-8859-6\u0026#34; \u0026#34;iso-8859-7\u0026#34; #\u0026gt; [183] \u0026#34;iso-8859-8\u0026#34; \u0026#34;iso-8859-8-i\u0026#34; #\u0026gt; [185] \u0026#34;iso-8859-9\u0026#34; \u0026#34;ISO-IR-100\u0026#34; #\u0026gt; [187] \u0026#34;ISO-IR-6\u0026#34; \u0026#34;ISO_646.IRV:1991\u0026#34; #\u0026gt; [189] \u0026#34;iso_8859-1\u0026#34; \u0026#34;ISO_8859-1\u0026#34; #\u0026gt; [191] \u0026#34;ISO_8859-1:1987\u0026#34; \u0026#34;iso_8859-13\u0026#34; #\u0026gt; [193] \u0026#34;iso_8859-15\u0026#34; \u0026#34;iso_8859-2\u0026#34; #\u0026gt; [195] \u0026#34;iso_8859-3\u0026#34; \u0026#34;iso_8859-4\u0026#34; #\u0026gt; [197] \u0026#34;iso_8859-5\u0026#34; \u0026#34;iso_8859-6\u0026#34; #\u0026gt; [199] \u0026#34;iso_8859-7\u0026#34; \u0026#34;iso_8859-8\u0026#34; #\u0026gt; [201] \u0026#34;iso_8859-8-i\u0026#34; \u0026#34;iso_8859-9\u0026#34; #\u0026gt; [203] \u0026#34;iso_8859_1\u0026#34; \u0026#34;iso_8859_13\u0026#34; #\u0026gt; [205] \u0026#34;iso_8859_15\u0026#34; \u0026#34;iso_8859_2\u0026#34; #\u0026gt; [207] \u0026#34;iso_8859_3\u0026#34; \u0026#34;iso_8859_4\u0026#34; #\u0026gt; [209] \u0026#34;iso_8859_5\u0026#34; \u0026#34;iso_8859_6\u0026#34; #\u0026gt; [211] \u0026#34;iso_8859_7\u0026#34; \u0026#34;iso_8859_8\u0026#34; #\u0026gt; [213] \u0026#34;iso_8859_8-i\u0026#34; \u0026#34;iso_8859_9\u0026#34; #\u0026gt; [215] \u0026#34;ISO2022-JP\u0026#34; \u0026#34;ISO2022-JP-MS\u0026#34; #\u0026gt; [217] \u0026#34;iso2022-kr\u0026#34; \u0026#34;ISO646-US\u0026#34; #\u0026gt; [219] \u0026#34;iso8859-1\u0026#34; \u0026#34;ISO8859-1\u0026#34; #\u0026gt; [221] \u0026#34;iso8859-13\u0026#34; \u0026#34;iso8859-15\u0026#34; #\u0026gt; [223] \u0026#34;iso8859-2\u0026#34; \u0026#34;iso8859-3\u0026#34; #\u0026gt; [225] \u0026#34;iso8859-4\u0026#34; \u0026#34;iso8859-5\u0026#34; #\u0026gt; [227] \u0026#34;iso8859-6\u0026#34; \u0026#34;iso8859-7\u0026#34; #\u0026gt; [229] \u0026#34;iso8859-8\u0026#34; \u0026#34;iso8859-8-i\u0026#34; #\u0026gt; [231] \u0026#34;iso8859-9\u0026#34; \u0026#34;Johab\u0026#34; #\u0026gt; [233] \u0026#34;JOHAB\u0026#34; \u0026#34;koi8-r\u0026#34; #\u0026gt; [235] \u0026#34;koi8-u\u0026#34; \u0026#34;ks_c_5601-1987\u0026#34; #\u0026gt; [237] \u0026#34;L1\u0026#34; \u0026#34;latin-9\u0026#34; #\u0026gt; [239] \u0026#34;LATIN1\u0026#34; \u0026#34;latin2\u0026#34; #\u0026gt; [241] \u0026#34;latin3\u0026#34; \u0026#34;latin4\u0026#34; #\u0026gt; [243] \u0026#34;latin5\u0026#34; \u0026#34;latin7\u0026#34; #\u0026gt; [245] \u0026#34;latin9\u0026#34; \u0026#34;mac\u0026#34; #\u0026gt; [247] \u0026#34;mac-centraleurope\u0026#34; \u0026#34;mac-is\u0026#34; #\u0026gt; [249] \u0026#34;macarabic\u0026#34; \u0026#34;maccentraleurope\u0026#34; #\u0026gt; [251] \u0026#34;maccroatian\u0026#34; \u0026#34;maccyrillic\u0026#34; #\u0026gt; [253] \u0026#34;macgreek\u0026#34; \u0026#34;machebrew\u0026#34; #\u0026gt; [255] \u0026#34;maciceland\u0026#34; \u0026#34;macintosh\u0026#34; #\u0026gt; [257] \u0026#34;macis\u0026#34; \u0026#34;macroman\u0026#34; #\u0026gt; [259] \u0026#34;macromania\u0026#34; \u0026#34;macthai\u0026#34; #\u0026gt; [261] \u0026#34;macturkish\u0026#34; \u0026#34;macukraine\u0026#34; #\u0026gt; [263] \u0026#34;macukrainian\u0026#34; \u0026#34;MS-ANSI\u0026#34; #\u0026gt; [265] \u0026#34;MS-ARAB\u0026#34; \u0026#34;MS-CYRL\u0026#34; #\u0026gt; [267] \u0026#34;MS-EE\u0026#34; \u0026#34;MS-GREEK\u0026#34; #\u0026gt; [269] \u0026#34;MS-HEBR\u0026#34; \u0026#34;MS-TURK\u0026#34; #\u0026gt; [271] \u0026#34;MS50221\u0026#34; \u0026#34;MS51932\u0026#34; #\u0026gt; [273] \u0026#34;MS932\u0026#34; \u0026#34;MS936\u0026#34; #\u0026gt; [275] \u0026#34;PT154\u0026#34; \u0026#34;PTCP154\u0026#34; #\u0026gt; [277] \u0026#34;SHIFFT_JIS\u0026#34; \u0026#34;SHIFFT_JIS-MS\u0026#34; #\u0026gt; [279] \u0026#34;shift-jis\u0026#34; \u0026#34;shift_jis\u0026#34; #\u0026gt; [281] \u0026#34;SJIS\u0026#34; \u0026#34;SJIS-MS\u0026#34; #\u0026gt; [283] \u0026#34;SJIS-OPEN\u0026#34; \u0026#34;SJIS-WIN\u0026#34; #\u0026gt; [285] \u0026#34;UCS-2\u0026#34; \u0026#34;UCS-2BE\u0026#34; #\u0026gt; [287] \u0026#34;UCS-2LE\u0026#34; \u0026#34;UCS-4\u0026#34; #\u0026gt; [289] \u0026#34;UCS-4BE\u0026#34; \u0026#34;UCS-4BE\u0026#34; #\u0026gt; [291] \u0026#34;UCS-4LE\u0026#34; \u0026#34;UCS-4LE\u0026#34; #\u0026gt; [293] \u0026#34;UCS2\u0026#34; \u0026#34;UCS2BE\u0026#34; #\u0026gt; [295] \u0026#34;UCS2LE\u0026#34; \u0026#34;UCS4\u0026#34; #\u0026gt; [297] \u0026#34;UCS4BE\u0026#34; \u0026#34;UCS4LE\u0026#34; #\u0026gt; [299] \u0026#34;UHC\u0026#34; \u0026#34;unicodeFFFE\u0026#34; #\u0026gt; [301] \u0026#34;US\u0026#34; \u0026#34;US-ASCII\u0026#34; #\u0026gt; [303] \u0026#34;UTF-16\u0026#34; \u0026#34;UTF-16BE\u0026#34; #\u0026gt; [305] \u0026#34;UTF-16LE\u0026#34; \u0026#34;UTF-32\u0026#34; #\u0026gt; [307] \u0026#34;UTF-32BE\u0026#34; \u0026#34;UTF-32LE\u0026#34; #\u0026gt; [309] \u0026#34;UTF-8\u0026#34; \u0026#34;UTF16\u0026#34; #\u0026gt; [311] \u0026#34;UTF16BE\u0026#34; \u0026#34;UTF16LE\u0026#34; #\u0026gt; [313] \u0026#34;UTF32\u0026#34; \u0026#34;UTF32BE\u0026#34; #\u0026gt; [315] \u0026#34;UTF32LE\u0026#34; \u0026#34;UTF8\u0026#34; #\u0026gt; [317] \u0026#34;WINBALTRIM\u0026#34; \u0026#34;windows-1250\u0026#34; #\u0026gt; [319] \u0026#34;windows-1251\u0026#34; \u0026#34;windows-1252\u0026#34; #\u0026gt; [321] \u0026#34;windows-1253\u0026#34; \u0026#34;windows-1254\u0026#34; #\u0026gt; [323] \u0026#34;windows-1255\u0026#34; \u0026#34;windows-1256\u0026#34; #\u0026gt; [325] \u0026#34;windows-1257\u0026#34; \u0026#34;windows-1258\u0026#34; #\u0026gt; [327] \u0026#34;WINDOWS-31J\u0026#34; \u0026#34;WINDOWS-50221\u0026#34; #\u0026gt; [329] \u0026#34;WINDOWS-51932\u0026#34; \u0026#34;windows-874\u0026#34; #\u0026gt; [331] \u0026#34;WINDOWS-932\u0026#34; \u0026#34;WINDOWS-936\u0026#34; #\u0026gt; [333] \u0026#34;x-Chinese_CNS\u0026#34; \u0026#34;x-cp20001\u0026#34; #\u0026gt; [335] \u0026#34;x-cp20003\u0026#34; \u0026#34;x-cp20004\u0026#34; #\u0026gt; [337] \u0026#34;x-cp20005\u0026#34; \u0026#34;x-cp20261\u0026#34; #\u0026gt; [339] \u0026#34;x-cp20269\u0026#34; \u0026#34;x-cp20936\u0026#34; #\u0026gt; [341] \u0026#34;x-cp20949\u0026#34; \u0026#34;x-cp50227\u0026#34; #\u0026gt; [343] \u0026#34;x-EBCDIC-KoreanExtended\u0026#34; \u0026#34;x-Europa\u0026#34; #\u0026gt; [345] \u0026#34;x-IA5\u0026#34; \u0026#34;x-IA5-German\u0026#34; #\u0026gt; [347] \u0026#34;x-IA5-Norwegian\u0026#34; \u0026#34;x-IA5-Swedish\u0026#34; #\u0026gt; [349] \u0026#34;x-iscii-as\u0026#34; \u0026#34;x-iscii-be\u0026#34; #\u0026gt; [351] \u0026#34;x-iscii-de\u0026#34; \u0026#34;x-iscii-gu\u0026#34; #\u0026gt; [353] \u0026#34;x-iscii-ka\u0026#34; \u0026#34;x-iscii-ma\u0026#34; #\u0026gt; [355] \u0026#34;x-iscii-or\u0026#34; \u0026#34;x-iscii-pa\u0026#34; #\u0026gt; [357] \u0026#34;x-iscii-ta\u0026#34; \u0026#34;x-iscii-te\u0026#34; #\u0026gt; [359] \u0026#34;x-mac-arabic\u0026#34; \u0026#34;x-mac-ce\u0026#34; #\u0026gt; [361] \u0026#34;x-mac-chinesesimp\u0026#34; \u0026#34;x-mac-chinesetrad\u0026#34; #\u0026gt; [363] \u0026#34;x-mac-croatian\u0026#34; \u0026#34;x-mac-cyrillic\u0026#34; #\u0026gt; [365] \u0026#34;x-mac-greek\u0026#34; \u0026#34;x-mac-hebrew\u0026#34; #\u0026gt; [367] \u0026#34;x-mac-icelandic\u0026#34; \u0026#34;x-mac-japanese\u0026#34; #\u0026gt; [369] \u0026#34;x-mac-korean\u0026#34; \u0026#34;x-mac-romanian\u0026#34; #\u0026gt; [371] \u0026#34;x-mac-thai\u0026#34; \u0026#34;x-mac-turkish\u0026#34; #\u0026gt; [373] \u0026#34;x-mac-ukrainian\u0026#34; \u0026#34;x_Chinese-Eten\u0026#34;\rhugocmd(m=\u0026#34;expand\u0026#34; ,end=T)\r#\u0026gt;  å’Œä½œæ¥­ç³»çµ±ä¸€è‡´çš„ç·¨ç¢¼\nlocaleToCharset(locale =Sys.getlocale(\u0026quot;LC_CTYPE\u0026quot;))\r å·¥å…·ç¨‹å¼\nnative_encode = function(x) {\rif (.Platform$OS.type == 'unix') return(x)\rx2 = enc2native(x)\rif (identical(enc2utf8(x2), x)) x2 else x\r}\r å·¥å…·ç¨‹å¼\ndetails \u0026lt;- function(x) {\rdetails \u0026lt;-\rlist(x=x,encoding=Encoding(x),bytes=nchar(x,\u0026quot;b\u0026quot;),chars=nchar(x,\u0026quot;c\u0026quot;),\rwidth=nchar(x,\u0026quot;w\u0026quot;),raw=paste(charToRaw(x),collapse=\u0026quot;:\u0026quot;))\rprint(t(as.matrix(details)))\r}\rx \u0026lt;- \u0026quot;Maur\\xEDcio\u0026quot;\rEncoding(x) \u0026lt;- \u0026quot;latin1\u0026quot;\rdetails(x)\r#\u0026gt; x encoding bytes chars width raw #\u0026gt; [1,] \u0026quot;Mauricio\u0026quot; \u0026quot;latin1\u0026quot; 8 8 8 \u0026quot;4d:61:75:72:ed:63:69:6f\u0026quot;\rx \u0026lt;- \u0026quot;ä½ å¥½\u0026quot;\rEncoding(x) \u0026lt;- \u0026quot;UTF-8\u0026quot;\rdetails(x)\r#\u0026gt; Error in nchar(x, \u0026quot;c\u0026quot;): invalid multibyte string, element 1\rx \u0026lt;- \u0026quot;ä½ å¥½\u0026quot;\riconv(x,\u0026quot;unknown\u0026quot;,\u0026quot;utf-8\u0026quot;)\r#\u0026gt; Error in iconv(x, \u0026quot;unknown\u0026quot;, \u0026quot;utf-8\u0026quot;): åœ¨ç·¨ç¢¼é  950 ä¸­ä¸æ”¯æ´å¾ 'unknown' è½‰æ›åˆ° 'utf-8'\rEncoding(x) \u0026lt;- \u0026quot;UTF-8\u0026quot;\rdetails(x)\r#\u0026gt; Error in nchar(x, \u0026quot;c\u0026quot;): invalid multibyte string, element 1\rx \u0026lt;- \u0026quot;ä½ å¥½\u0026quot;\ry\u0026lt;-enc2utf8(x)\rdetails(y)\r#\u0026gt; x encoding bytes chars width raw #\u0026gt; [1,] \u0026quot;ä½ å¥½\u0026quot; \u0026quot;UTF-8\u0026quot; 6 2 4 \u0026quot;e4:bd:a0:e5:a5:bd\u0026quot;\r åˆæ­¥çµè«–å°±æ˜¯ç³»çµ±ä½¿ç”¨big5çš„é›™ä½å…ƒã€‚ç”¨enc2utf8(),enc2native()æ‡‰è©²æ˜¯æ¯”è¼ƒç¬¦åˆwindows10ç³»çµ±çš„æ–¹æ³•ã€‚\nå·¥å…·\n åˆ¤æ–·æ˜¯ä¸æ˜¯UTF-8 is.na(iconv(x, \u0026quot;UTF-8\u0026quot;, \u0026quot;UTF-8\u0026quot;))\r  "},
{"uri": "/blogR//rlang/10_00_dplyrbasic01.html","title": "10. tidyr, dplyr basic",
	"tags": [],
	"description": "10_00_dplyrBasic01",
	"content": " cheat sheet  éœ€è¦å®‰è£babynames,ggplot2\r long and wide data å¯¬è®Šé•· å‡½æ•¸gather(): å¯¬è®Šé•· From http://stackoverflow.com/questions/1181060\nrequire(tidyr)\rrequire(dplyr) # tibble\r# æ¯å€‹æ™‚é–“é»(å…±10å€‹),ç”¢ç”Ÿ3å€‹è‚¡ç¥¨,X,Y,Z\rstocks \u0026lt;- tibble( #ğŸ·ğŸ‘ä¹Ÿå¯ä»¥ç”¨data.frame\rtime = as.Date('2009-01-01') + 0:9,\rX = rnorm(10, 0, 1),\rY = rnorm(10, 0, 2),\rZ = rnorm(10, 0, 4)\r)\rkable(head(stocks)) #\r \rå±•é–‹\r   time X Y Z     2009-01-01 0.6778663 0.7513016 -9.9708545   2009-01-02 -0.2238161 -2.1862983 0.6832973   2009-01-03 -0.1217276 -0.0860699 -0.1664718   2009-01-04 -0.3546435 0.2440224 7.4886484   2009-01-05 0.3119788 -1.5312788 -3.7477823   2009-01-06 -0.5437336 -1.1486502 4.7369778     kable(gather(stocks, stock, price, -time)) #ğŸ·ğŸ‘é™¤äº†æ™‚é–“æ¬„ä½ä»¥å¤–,å…¶é¤˜æ¬„ä½ä¾åºå¡«åˆ°å…©å€‹æ–°æ¬„ä½,åˆ†åˆ¥æ˜¯1)åˆ†çµ„æ¬„ä½(stock)å’Œ2)æ•¸å€¼æ¬„ä½(price)  \rå±•é–‹\r   time stock price     2009-01-01 X 0.6778663   2009-01-02 X -0.2238161   2009-01-03 X -0.1217276   2009-01-04 X -0.3546435   2009-01-05 X 0.3119788   2009-01-06 X -0.5437336   2009-01-07 X 0.1571257   2009-01-08 X -1.4585921   2009-01-09 X 1.1313788   2009-01-10 X -1.1935117   2009-01-01 Y 0.7513016   2009-01-02 Y -2.1862983   2009-01-03 Y -0.0860699   2009-01-04 Y 0.2440224   2009-01-05 Y -1.5312788   2009-01-06 Y -1.1486502   2009-01-07 Y 1.6882895   2009-01-08 Y -4.4474627   2009-01-09 Y 1.1243285   2009-01-10 Y -2.4531855   2009-01-01 Z -9.9708545   2009-01-02 Z 0.6832973   2009-01-03 Z -0.1664718   2009-01-04 Z 7.4886484   2009-01-05 Z -3.7477823   2009-01-06 Z 4.7369778   2009-01-07 Z 5.3013235   2009-01-08 Z -0.6878305   2009-01-09 Z 4.0872611   2009-01-10 Z -6.7961287     stocks %\u0026gt;% gather(stock, price, -time) # ğŸ·ğŸ‘ä¹Ÿå¯ä»¥ç”¨ç®¡é“å¯«æ³• stocks %\u0026gt;% gather(stock, price, -time) \rå±•é–‹\r#\u0026gt; # A tibble: 30 x 3\r#\u0026gt; time stock price\r#\u0026gt; \u0026lt;date\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 2009-01-01 X 0.678\r#\u0026gt; 2 2009-01-02 X -0.224\r#\u0026gt; 3 2009-01-03 X -0.122\r#\u0026gt; 4 2009-01-04 X -0.355\r#\u0026gt; 5 2009-01-05 X 0.312\r#\u0026gt; 6 2009-01-06 X -0.544\r#\u0026gt; 7 2009-01-07 X 0.157\r#\u0026gt; 8 2009-01-08 X -1.46 #\u0026gt; 9 2009-01-09 X 1.13 #\u0026gt; 10 2009-01-10 X -1.19 #\u0026gt; # ... with 20 more rows\r ğŸ±â€ğŸ‘¤ç›´æ¥å¯«å‡ºhtml : åˆ©ç”¨writeLines(),ä¾‹å¦‚è¨­å®šcss è¨­å®šcss\nwriteLines(\u0026quot;td, th { padding : 6px } th { background-color : brown ; color : white; border : 1px solid white; } td { color : brown ; border : 1px solid brown }\u0026quot;, con = \u0026quot;tableStyle.css\u0026quot;)\rkable(head(mtcars))\r \r\ré•·åˆ°å¯¬è³‡æ–™ åˆ©ç”¨å‡½æ•¸spread()\nlong\u0026lt;-gather(stocks, stock, price, -time) #è½‰æˆé•·è³‡æ–™\rstr(long)\r#\u0026gt; tibble [30 x 3] (S3: tbl_df/tbl/data.frame)\r#\u0026gt; $ time : Date[1:30], format: \u0026quot;2009-01-01\u0026quot; \u0026quot;2009-01-02\u0026quot; ...\r#\u0026gt; $ stock: chr [1:30] \u0026quot;X\u0026quot; \u0026quot;X\u0026quot; \u0026quot;X\u0026quot; \u0026quot;X\u0026quot; ...\r#\u0026gt; $ price: num [1:30] 0.678 -0.224 -0.122 -0.355 0.312 ...\rwide \u0026lt;-spread(long,stock,price) #è½‰æˆå¯¬è³‡æ–™\rstr(wide)\r#\u0026gt; tibble [10 x 4] (S3: tbl_df/tbl/data.frame)\r#\u0026gt; $ time: Date[1:10], format: \u0026quot;2009-01-01\u0026quot; \u0026quot;2009-01-02\u0026quot; ...\r#\u0026gt; $ X : num [1:10] 0.678 -0.224 -0.122 -0.355 0.312 ...\r#\u0026gt; $ Y : num [1:10] 0.7513 -2.1863 -0.0861 0.244 -1.5313 ...\r#\u0026gt; $ Z : num [1:10] -9.971 0.683 -0.166 7.489 -3.748 ...\rhead(wide)\r#\u0026gt; # A tibble: 6 x 4\r#\u0026gt; time X Y Z\r#\u0026gt; \u0026lt;date\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 2009-01-01 0.678 0.751 -9.97 #\u0026gt; 2 2009-01-02 -0.224 -2.19 0.683\r#\u0026gt; 3 2009-01-03 -0.122 -0.0861 -0.166\r#\u0026gt; 4 2009-01-04 -0.355 0.244 7.49 #\u0026gt; 5 2009-01-05 0.312 -1.53 -3.75 #\u0026gt; 6 2009-01-06 -0.544 -1.15 4.74\r æ›´å¤šåƒè€ƒ: cookbook for R\ndplyr çš„å‘é‡å‡½æ•¸ å‡½æ•¸å åŠŸèƒ½\n  row_number() æ’åº(ğŸ˜’ä¸æ˜¯ç´€éŒ„è™Ÿç¢¼),å¦‚æœæ•¸å€¼ä¸€æ¨£,å‰‡é å‰å‡ºç¾çš„å…ƒç´ æ’ååœ¨å‰,ä¾‹å¦‚(3,3) å‰‡ 1,2\n  min_rank() æ’åº,å¦‚æœæ•¸å€¼ä¸€æ¨£,å‰‡éƒ½æ˜¯åŒä¸€ç­‰ç´šï¼Œä½†æ˜¯ï¼Œä½”ç”¨ä¸‹ä¸€åæ¬¡ã€‚ä¾‹å¦‚\ndata\u0026lt;-c(3,3,4) min_rank(data)\r#\u0026gt; [1] 1 1 3 #ğŸ·ğŸ‘æ²’æœ‰2\r   dense_rank() æ’åº,å¦‚æœæ•¸å€¼ä¸€æ¨£,å‰‡éƒ½æ˜¯åŒä¸€ç­‰ç´šï¼Œä½†æ˜¯ï¼Œä¸ä½”ç”¨ä¸‹ä¸€åæ¬¡\ndata\u0026lt;-c(3,3,4) dense_rank(data)\r#\u0026gt; [1] 1 1 2\r   percent_rank() æŒ‰ç™¾åˆ†æ¯”çš„æ’å\npercent_rank = (min_rank(x) - 1)/(sum(!is.na(x)) - 1)    cume_dist() ç´¯è¨ˆåˆ†ä½ˆ\n  ntile() : floor(n * (row_number(x) - 1)/len + 1) \ndata\u0026lt;-round(runif(10)*10)\rpr\u0026lt;-percent_rank(data)\rcd\u0026lt;-cume_dist(data)\rmr\u0026lt;-min_rank(data)\rdf\u0026lt;-data.frame(data,pr,mr,cd)\rarrange(df,data)\r data pr mr cd   0 0.0000000 1 0.1  1 0.1111111 2 0.2  3 0.2222222 3 0.4  3 0.2222222 3 0.4  4 0.4444444 5 0.5  6 0.5555556 6 0.6  7 0.6666667 7 0.8  7 0.6666667 7 0.8  8 0.8888889 9 0.9  10 1.0000000 10 1.0       å…¶ä»–ç¯„ä¾‹\nx \u0026lt;- c(5, 1, 3, 2, 2, NA)\rrow_number(x)\r#\u0026gt; [1] 5 1 4 2 3 NA\rmin_rank(x)\r#\u0026gt; [1] 5 1 4 2 2 NA\rdense_rank(x)\r#\u0026gt; [1] 4 1 3 2 2 NA\rpercent_rank(x)\r#\u0026gt; [1] 1.00 0.00 0.75 0.25 0.25 NA\rcume_dist(x)\r#\u0026gt; [1] 1.0 0.2 0.8 0.6 0.6 NA\rntile(x, 2)\r#\u0026gt; [1] 2 1 2 1 1 NA\rntile(1:8, 3)\r#\u0026gt; [1] 1 1 1 2 2 2 3 3\r note:\n(2,3,3,3,3,4,5,6,6,9)\n   1 2 3 4 5 6 7 8 9     0 1 4 1 1 2 0 0 1    arrange(dataframe, col1, col2, col3) vs. dataframe[order(dataframe$col1, dataframe$col2, dataframe$col3), ]\rvs. with(dataframe, dataframe[order(col1, col2, col3), ])  \r\rrankç­‰ç´šæƒ³è¦ç”±å¤§åˆ°å°å¯ä»¥åƒä¸‹é¢é€™æ¨£\ndata\r#\u0026gt; [1] 1 8 10 0 7 6 3 3 4 7\rrow_number(desc(data))\r#\u0026gt; [1] 9 2 1 10 3 5 7 8 6 4\r â“æ¢è¨ç‚ºç”šéº¼?\næç¤º\r desc(data)\r#\u0026gt; [1] -7 -4 -1 -6 -4 -8 -9 -3 -1 -2 #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åŸä¾†çš„è³‡æ–™è®Šæˆè² æ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rrow_number(data)\r#\u0026gt; [1] 8 5 1 7 6 9 10 4 2 3\r \nè¤‡ç¿’ä¸€ä¸‹Percentile\nâ“Find the 32nd, 57th and 98th percentiles of runiform(200).\ndata\u0026lt;-runif(200) quantile(data, c(.32, .57, .98)) #\u0026gt; 32% 57% 98% #\u0026gt; 0.2398605 0.5510189 0.9456776\r \r\rsubset  select()é¸æ¬„ä½ filter()é¸ç´€éŒ„  library(babynames)\rbabynames #\u0026gt; # A tibble: 1,924,665 x 5\r#\u0026gt; year sex name n prop\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 1880 F Mary 7065 0.0724\r#\u0026gt; 2 1880 F Anna 2604 0.0267\r#\u0026gt; 3 1880 F Emma 2003 0.0205\r#\u0026gt; 4 1880 F Elizabeth 1939 0.0199\r#\u0026gt; 5 1880 F Minnie 1746 0.0179\r#\u0026gt; 6 1880 F Margaret 1578 0.0162\r#\u0026gt; 7 1880 F Ida 1472 0.0151\r#\u0026gt; 8 1880 F Alice 1414 0.0145\r#\u0026gt; 9 1880 F Bertha 1320 0.0135\r#\u0026gt; 10 1880 F Sarah 1288 0.0132\r#\u0026gt; # ... with 1,924,655 more rows\rbabynames %\u0026gt;% select(-prop) #ğŸ·ğŸ‘ä¸€å€‹æœ‰äº”å€‹æ¬„ä½,æ‰£æ‰æ¬„ä½prop\r#\u0026gt; # A tibble: 1,924,665 x 4\r#\u0026gt; year sex name n\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 1880 F Mary 7065\r#\u0026gt; 2 1880 F Anna 2604\r#\u0026gt; 3 1880 F Emma 2003\r#\u0026gt; 4 1880 F Elizabeth 1939\r#\u0026gt; 5 1880 F Minnie 1746\r#\u0026gt; 6 1880 F Margaret 1578\r#\u0026gt; 7 1880 F Ida 1472\r#\u0026gt; 8 1880 F Alice 1414\r#\u0026gt; 9 1880 F Bertha 1320\r#\u0026gt; 10 1880 F Sarah 1288\r#\u0026gt; # ... with 1,924,655 more rows\rbabynames %\u0026gt;% select(year:n)\r#\u0026gt; # A tibble: 1,924,665 x 4\r#\u0026gt; year sex name n\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 1880 F Mary 7065\r#\u0026gt; 2 1880 F Anna 2604\r#\u0026gt; 3 1880 F Emma 2003\r#\u0026gt; 4 1880 F Elizabeth 1939\r#\u0026gt; 5 1880 F Minnie 1746\r#\u0026gt; 6 1880 F Margaret 1578\r#\u0026gt; 7 1880 F Ida 1472\r#\u0026gt; 8 1880 F Alice 1414\r#\u0026gt; 9 1880 F Bertha 1320\r#\u0026gt; 10 1880 F Sarah 1288\r#\u0026gt; # ... with 1,924,655 more rows\r# starts_with(), ends_with(), contains()\rbabynames %\u0026gt;% filter(name == \u0026quot;Hadley\u0026quot;)\r#\u0026gt; # A tibble: 163 x 5\r#\u0026gt; year sex name n prop\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 1906 M Hadley 6 0.0000416\r#\u0026gt; 2 1908 M Hadley 16 0.0000962\r#\u0026gt; 3 1909 M Hadley 14 0.0000792\r#\u0026gt; 4 1910 M Hadley 5 0.0000240\r#\u0026gt; 5 1911 M Hadley 9 0.0000373\r#\u0026gt; 6 1912 M Hadley 11 0.0000244\r#\u0026gt; 7 1913 M Hadley 10 0.0000186\r#\u0026gt; 8 1914 M Hadley 15 0.0000220\r#\u0026gt; 9 1915 M Hadley 14 0.0000159\r#\u0026gt; 10 1916 M Hadley 14 0.0000152\r#\u0026gt; # ... with 153 more rows\rbabynames %\u0026gt;% filter(year == 1900, sex == \u0026quot;F\u0026quot;)\r#\u0026gt; # A tibble: 2,224 x 5\r#\u0026gt; year sex name n prop\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 1900 F Mary 16706 0.0526\r#\u0026gt; 2 1900 F Helen 6343 0.0200\r#\u0026gt; 3 1900 F Anna 6114 0.0192\r#\u0026gt; 4 1900 F Margaret 5304 0.0167\r#\u0026gt; 5 1900 F Ruth 4765 0.0150\r#\u0026gt; 6 1900 F Elizabeth 4096 0.0129\r#\u0026gt; 7 1900 F Florence 3920 0.0123\r#\u0026gt; 8 1900 F Ethel 3896 0.0123\r#\u0026gt; 9 1900 F Marie 3856 0.0121\r#\u0026gt; 10 1900 F Lillian 3414 0.0107\r#\u0026gt; # ... with 2,214 more rows\rbabynames %\u0026gt;% filter(year == 2013, sex == \u0026quot;F\u0026quot;)\r#\u0026gt; # A tibble: 19,231 x 5\r#\u0026gt; year sex name n prop\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 2013 F Sophia 21213 0.0110 #\u0026gt; 2 2013 F Emma 20936 0.0109 #\u0026gt; 3 2013 F Olivia 18414 0.00957\r#\u0026gt; 4 2013 F Isabella 17631 0.00916\r#\u0026gt; 5 2013 F Ava 15249 0.00793\r#\u0026gt; 6 2013 F Mia 13147 0.00683\r#\u0026gt; 7 2013 F Emily 13124 0.00682\r#\u0026gt; 8 2013 F Abigail 12405 0.00645\r#\u0026gt; 9 2013 F Madison 10591 0.00551\r#\u0026gt; 10 2013 F Elizabeth 9448 0.00491\r#\u0026gt; # ... with 19,221 more rows\r å‡½æ•¸mutate()\nbabynames %\u0026gt;%\rmutate(\rfirst = tolower(substr(name, 1, 1)),\rlast = substr(name, nchar(name), nchar(name))\r)\r#\u0026gt; # A tibble: 1,924,665 x 7\r#\u0026gt; year sex name n prop first last #\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt;\r#\u0026gt; 1 1880 F Mary 7065 0.0724 m y #\u0026gt; 2 1880 F Anna 2604 0.0267 a a #\u0026gt; 3 1880 F Emma 2003 0.0205 e a #\u0026gt; 4 1880 F Elizabeth 1939 0.0199 e h #\u0026gt; 5 1880 F Minnie 1746 0.0179 m e #\u0026gt; 6 1880 F Margaret 1578 0.0162 m t #\u0026gt; 7 1880 F Ida 1472 0.0151 i a #\u0026gt; 8 1880 F Alice 1414 0.0145 a e #\u0026gt; 9 1880 F Bertha 1320 0.0135 b a #\u0026gt; 10 1880 F Sarah 1288 0.0132 s h #\u0026gt; # ... with 1,924,655 more rows\rbabynames %\u0026gt;%\rarrange(desc(prop))\r#\u0026gt; # A tibble: 1,924,665 x 5\r#\u0026gt; year sex name n prop\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 1880 M John 9655 0.0815\r#\u0026gt; 2 1881 M John 8769 0.0810\r#\u0026gt; 3 1880 M William 9532 0.0805\r#\u0026gt; 4 1883 M John 8894 0.0791\r#\u0026gt; 5 1881 M William 8524 0.0787\r#\u0026gt; 6 1882 M John 9557 0.0783\r#\u0026gt; 7 1884 M John 9388 0.0765\r#\u0026gt; 8 1882 M William 9298 0.0762\r#\u0026gt; 9 1886 M John 9026 0.0758\r#\u0026gt; 10 1885 M John 8756 0.0755\r#\u0026gt; # ... with 1,924,655 more rows\rbabynames %\u0026gt;%\rsummarise(n = sum(n)) #ğŸ·ğŸ‘å°næ¬„ä½åŠ ç¸½\r#\u0026gt; # A tibble: 1 x 1\r#\u0026gt; n\r#\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 348120517\r åˆ†çµ„  å‡½æ•¸group_by() ç”¨ä¾†åˆ†çµ„ï¼Œä¸æœƒå½±éŸ¿åˆ°åŸä¾†çš„è³‡æ–™,åªæ˜¯æ·»åŠ è³‡è¨Š å–æ¶ˆåˆ†çµ„çš„å‡½æ•¸ç‚ºungroup()  head(mtcars)\r  mpg cyl disp hp drat wt qsec vs am gear carb   Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4  Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4  Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1  Hornet 4 Drive 21.4 6 258 110 3.08 3.215 19.44 1 0 3 1  Hornet Sportabout 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2  Valiant 18.1 6 225 105 2.76 3.460 20.22 1 0 3 1     str(mtcars)\r#\u0026gt; 'data.frame':\t32 obs. of 11 variables:\r#\u0026gt; $ mpg : num 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...\r#\u0026gt; $ cyl : num 6 6 4 6 8 6 8 4 4 6 ...\r#\u0026gt; $ disp: num 160 160 108 258 360 ...\r#\u0026gt; $ hp : num 110 110 93 110 175 105 245 62 95 123 ...\r#\u0026gt; $ drat: num 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...\r#\u0026gt; $ wt : num 2.62 2.88 2.32 3.21 3.44 ...\r#\u0026gt; $ qsec: num 16.5 17 18.6 19.4 17 ...\r#\u0026gt; $ vs : num 0 0 1 1 0 1 0 1 1 1 ...\r#\u0026gt; $ am : num 1 1 1 0 0 0 0 0 0 0 ...\r#\u0026gt; $ gear: num 4 4 4 3 3 3 3 4 4 4 ...\r#\u0026gt; $ carb: num 4 4 1 1 2 1 4 2 2 4 ...\rby_cyl \u0026lt;- mtcars %\u0026gt;% group_by(cyl)\rhead(by_cyl) #ğŸ·ğŸ‘å¯ä»¥çœ‹åˆ°åªæ˜¯æ·»åŠ è³‡è¨Š,åŸä¾†çš„è³‡æ–™æ¬„ä½æ²’è®Š\r#\u0026gt; # A tibble: 6 x 11\r#\u0026gt; # Groups: cyl [3]\r#\u0026gt; mpg cyl disp hp drat wt qsec vs am gear carb\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 21 6 160 110 3.9 2.62 16.5 0 1 4 4\r#\u0026gt; 2 21 6 160 110 3.9 2.88 17.0 0 1 4 4\r#\u0026gt; 3 22.8 4 108 93 3.85 2.32 18.6 1 1 4 1\r#\u0026gt; 4 21.4 6 258 110 3.08 3.22 19.4 1 0 3 1\r#\u0026gt; 5 18.7 8 360 175 3.15 3.44 17.0 0 0 3 2\r#\u0026gt; 6 18.1 6 225 105 2.76 3.46 20.2 1 0 3 1\rstr(by_cyl)\r#\u0026gt; grouped_df [32 x 11] (S3: grouped_df/tbl_df/tbl/data.frame)\r#\u0026gt; $ mpg : num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...\r#\u0026gt; $ cyl : num [1:32] 6 6 4 6 8 6 8 4 4 6 ...\r#\u0026gt; $ disp: num [1:32] 160 160 108 258 360 ...\r#\u0026gt; $ hp : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...\r#\u0026gt; $ drat: num [1:32] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...\r#\u0026gt; $ wt : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...\r#\u0026gt; $ qsec: num [1:32] 16.5 17 18.6 19.4 17 ...\r#\u0026gt; $ vs : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...\r#\u0026gt; $ am : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...\r#\u0026gt; $ gear: num [1:32] 4 4 4 3 3 3 3 4 4 4 ...\r#\u0026gt; $ carb: num [1:32] 4 4 1 1 2 1 4 2 2 4 ...\r#\u0026gt; - attr(*, \u0026quot;groups\u0026quot;)= tibble [3 x 2] (S3: tbl_df/tbl/data.frame)\r#\u0026gt; ..$ cyl : num [1:3] 4 6 8\r#\u0026gt; ..$ .rows: list\u0026lt;int\u0026gt; [1:3] #\u0026gt; .. ..$ : int [1:11] 3 8 9 18 19 20 21 26 27 28 ...\r#\u0026gt; .. ..$ : int [1:7] 1 2 4 6 10 11 30\r#\u0026gt; .. ..$ : int [1:14] 5 7 12 13 14 15 16 17 22 23 ...\r#\u0026gt; .. ..@ ptype: int(0) #\u0026gt; ..- attr(*, \u0026quot;.drop\u0026quot;)= logi TRUE\r ä½†æ˜¯åˆ†çµ„çµæœæœƒå½±éŸ¿å…¶ä»–dplyræŒ‡ä»¤çš„è¨ˆç®—çµæœ:\nby_cyl %\u0026gt;% summarise( disp = mean(disp), hp = mean(hp) )\r#\u0026gt; # A tibble: 3 x 3\r#\u0026gt; cyl disp hp\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 4 105. 82.6\r#\u0026gt; 2 6 183. 122. #\u0026gt; 3 8 353. 209.\rby_cyl %\u0026gt;% filter(disp == max(disp))\r#\u0026gt; # A tibble: 3 x 11\r#\u0026gt; # Groups: cyl [3]\r#\u0026gt; mpg cyl disp hp drat wt qsec vs am gear carb\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 21.4 6 258 110 3.08 3.22 19.4 1 0 3 1\r#\u0026gt; 2 24.4 4 147. 62 3.69 3.19 20 1 0 4 2\r#\u0026gt; 3 10.4 8 472 205 2.93 5.25 18.0 0 0 3 4\r dplyr::group_by(iris, Species)\r#\u0026gt; # A tibble: 150 x 5\r#\u0026gt; # Groups: Species [3]\r#\u0026gt; Sepal.Length Sepal.Width Petal.Length Petal.Width Species\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;fct\u0026gt; #\u0026gt; 1 5.1 3.5 1.4 0.2 setosa #\u0026gt; 2 4.9 3 1.4 0.2 setosa #\u0026gt; 3 4.7 3.2 1.3 0.2 setosa #\u0026gt; 4 4.6 3.1 1.5 0.2 setosa #\u0026gt; 5 5 3.6 1.4 0.2 setosa #\u0026gt; 6 5.4 3.9 1.7 0.4 setosa #\u0026gt; 7 4.6 3.4 1.4 0.3 setosa #\u0026gt; 8 5 3.4 1.5 0.2 setosa #\u0026gt; 9 4.4 2.9 1.4 0.2 setosa #\u0026gt; 10 4.9 3.1 1.5 0.1 setosa #\u0026gt; # ... with 140 more rows\r#Group data into rows with the same value of Species.\r#dplyr::ungroup(iris) #ğŸ·ğŸ‘åƒ…åƒ…ç§»é™¤åˆ†çµ„è³‡è¨Š\riris %\u0026gt;% group_by(Species) %\u0026gt;% summarise(mean=mean(Sepal.Length))\r#\u0026gt; # A tibble: 3 x 2\r#\u0026gt; Species mean\r#\u0026gt; \u0026lt;fct\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 setosa 5.01\r#\u0026gt; 2 versicolor 5.94\r#\u0026gt; 3 virginica 6.59\r å ±å‘Š å‡½æ•¸summarise()\n              summarize() å¯ä»¥ç”¨çš„å‡½æ•¸å‹æ…‹æ˜¯è¼¸å…¥å‘é‡,è¼¸å‡ºä¸€å€‹å€¼å¾—å‡½æ•¸ã€‚ä¾‹å¦‚\n mean(): the mean AKA the average sd(): the standard deviation, which is a measure of spread min() and max(): the minimum and maximum values respectively IQR(): Interquartile range sum(): the sum n(): æ¯çµ„è§€å¯Ÿæ•¸ç›®ã€‚å¯ä»¥ç”¨ä¾†é…å¥—group_by()ã€‚  å¯¦é©— pipeline vs no pipeline  x %\u0026gt;% f(y) \u0026lt;===\u0026gt; f(x, y) ğŸ·ğŸ‘S3 object y %\u0026gt;% f(x, ., z) \u0026lt;===\u0026gt; f(x, y, z ) #ğŸ·ğŸ‘å–ä»£é€—é»    ç”¢ç”Ÿè³‡æ–™\nyear=c(1990,\t1991,\t1990,\t1991,\t1990,\t1991,\t1990,\t1991,\t1990,\t1991) sex=c(\u0026quot;f\u0026quot;,\t\u0026quot;f\u0026quot;,\t\u0026quot;f\u0026quot;,\t\u0026quot;f\u0026quot;,\t\u0026quot;f\u0026quot;,\t\u0026quot;m\u0026quot;,\t\u0026quot;m\u0026quot;,\t\u0026quot;m\u0026quot;,\t\u0026quot;m\u0026quot;,\t\u0026quot;m\u0026quot;)\r#value=c(1,\t2,\t3,\t4,\t5,\t1,\t2,\t3,\t4,\t5)\rvalue=c(1,\t2,\t3,\t4,\t5,\t6,\t7,\t8,\t9,\t10)\rodf\u0026lt;-data.frame(sex,year,value)\rhead(odf)\r sex year value   f 1990 1  f 1991 2  f 1990 3  f 1991 4  f 1990 5  m 1991 6       ä¸ç”¨ pipeline\ndf\u0026lt;-group_by(odf,sex)\rndf\u0026lt;-mutate(df,rank=min_rank(value)) # ğŸ·ğŸ‘å¢åŠ æ–°æ¬„ä½\rarrange(ndf,sex) #ğŸ·ğŸ‘æ ¹æ“šsexç”±ä½åˆ°é«˜æ’åº\r#\u0026gt; # A tibble: 10 x 4\r#\u0026gt; # Groups: sex [2]\r#\u0026gt; sex year value rank\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 f 1990 1 1\r#\u0026gt; 2 f 1991 2 2\r#\u0026gt; 3 f 1990 3 3\r#\u0026gt; 4 f 1991 4 4\r#\u0026gt; 5 f 1990 5 5\r#\u0026gt; 6 m 1991 6 1\r#\u0026gt; 7 m 1990 7 2\r#\u0026gt; 8 m 1991 8 3\r#\u0026gt; 9 m 1990 9 4\r#\u0026gt; 10 m 1991 10 5\r   ä½¿ç”¨ pipeline\nndf\u0026lt;-odf %\u0026gt;%\rgroup_by(sex) %\u0026gt;%\rmutate(rank = min_rank(value)) arrange(ndf,sex)\r#\u0026gt; # A tibble: 10 x 4\r#\u0026gt; # Groups: sex [2]\r#\u0026gt; sex year value rank\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 f 1990 1 1\r#\u0026gt; 2 f 1991 2 2\r#\u0026gt; 3 f 1990 3 3\r#\u0026gt; 4 f 1991 4 4\r#\u0026gt; 5 f 1990 5 5\r#\u0026gt; 6 m 1991 6 1\r#\u0026gt; 7 m 1990 7 2\r#\u0026gt; 8 m 1991 8 3\r#\u0026gt; 9 m 1990 9 4\r#\u0026gt; 10 m 1991 10 5\r   çœ‹çœ‹å…¶ä»–ç¯„ä¾‹\ndf %\u0026gt;% group_by(sex) %\u0026gt;%str() #ğŸ·ğŸ‘åˆ†çµ„ä»¥å¾Œæ”¾åˆ°édyplrå¥—ä»¶çš„å‡½æ•¸str()è¦çœ‹çµæ§‹,çµæœä¸¦æ²’æœ‰ç”¢ç”Ÿå…©å€‹åˆ†çµ„çµæ§‹ï¼Œä¹Ÿå°±æ˜¯èªªstr()ä¸èªè­˜åˆ†çµ„çµæ§‹\r#\u0026gt; grouped_df [10 x 3] (S3: grouped_df/tbl_df/tbl/data.frame)\r#\u0026gt; $ sex : chr [1:10] \u0026quot;f\u0026quot; \u0026quot;f\u0026quot; \u0026quot;f\u0026quot; \u0026quot;f\u0026quot; ...\r#\u0026gt; $ year : num [1:10] 1990 1991 1990 1991 1990 ...\r#\u0026gt; $ value: num [1:10] 1 2 3 4 5 6 7 8 9 10\r#\u0026gt; - attr(*, \u0026quot;groups\u0026quot;)= tibble [2 x 2] (S3: tbl_df/tbl/data.frame)\r#\u0026gt; ..$ sex : chr [1:2] \u0026quot;f\u0026quot; \u0026quot;m\u0026quot;\r#\u0026gt; ..$ .rows: list\u0026lt;int\u0026gt; [1:2] #\u0026gt; .. ..$ : int [1:5] 1 2 3 4 5\r#\u0026gt; .. ..$ : int [1:5] 6 7 8 9 10\r#\u0026gt; .. ..@ ptype: int(0) #\u0026gt; ..- attr(*, \u0026quot;.drop\u0026quot;)= logi TRUE\rbabynames %\u0026gt;%\rgroup_by(name) %\u0026gt;%\rsummarise(n = sum(n)) #ğŸ·ğŸ‘n æ˜¯æ¬„ä½åç¨±\r#\u0026gt; # A tibble: 97,310 x 2\r#\u0026gt; name n\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 Aaban 107\r#\u0026gt; 2 Aabha 35\r#\u0026gt; 3 Aabid 10\r#\u0026gt; 4 Aabir 5\r#\u0026gt; 5 Aabriella 32\r#\u0026gt; 6 Aada 5\r#\u0026gt; 7 Aadam 254\r#\u0026gt; 8 Aadan 130\r#\u0026gt; 9 Aadarsh 199\r#\u0026gt; 10 Aaden 4658\r#\u0026gt; # ... with 97,300 more rows\rbabynames %\u0026gt;%\rfilter(name %in% c(\u0026quot;John\u0026quot;, \u0026quot;Mary\u0026quot;, \u0026quot;William\u0026quot;)) %\u0026gt;%\rgroup_by(name, sex) %\u0026gt;%\rsummarise(n = sum(n))\r#\u0026gt; # A tibble: 6 x 3\r#\u0026gt; # Groups: name [3]\r#\u0026gt; name sex n\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 John F 21676\r#\u0026gt; 2 John M 5115466\r#\u0026gt; 3 Mary F 4123200\r#\u0026gt; 4 Mary M 15160\r#\u0026gt; 5 William F 15949\r#\u0026gt; 6 William M 4102604\rbabynames %\u0026gt;%\rgroup_by(year, sex) %\u0026gt;%\rmutate(rank = min_rank(desc(n))) %\u0026gt;%\rtail() #ğŸ·ğŸ‘åªçœ‹å¾Œå¹¾ç­†\r#\u0026gt; # A tibble: 6 x 6\r#\u0026gt; # Groups: year, sex [1]\r#\u0026gt; year sex name n prop rank\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 2017 M Zyhier 5 0.00000255 12171\r#\u0026gt; 2 2017 M Zykai 5 0.00000255 12171\r#\u0026gt; 3 2017 M Zykeem 5 0.00000255 12171\r#\u0026gt; 4 2017 M Zylin 5 0.00000255 12171\r#\u0026gt; 5 2017 M Zylis 5 0.00000255 12171\r#\u0026gt; 6 2017 M Zyrie 5 0.00000255 12171\r ç·´ç¿’    åå«Hadley çš„ç”·å¥³å„å¤šå°‘äºº?\nbabynames %\u0026gt;%\rfilter(name == \u0026quot;Hadley\u0026quot;) %\u0026gt;%\rgroup_by(sex) %\u0026gt;%\rsummarise(n = sum(n))\r#\u0026gt; # A tibble: 2 x 2\r#\u0026gt; sex n\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r#\u0026gt; 1 F 26708\r#\u0026gt; 2 M 1883\r   The travestyå»¶çºŒä¸Šé¡Œï¼Œå„å¹´çš„çš„ç”·å¥³Hadleyæ•¸ç›®?\nlibrary(ggplot2)\rbabynames %\u0026gt;%\rfilter(name == \u0026quot;Hadley\u0026quot;) %\u0026gt;%\rggplot(aes(year, n)) + geom_line(aes(colour = sex)) #ğŸ·ğŸ‘éæ¿¾å‡ºä¾†,ç„¶å¾ŒæŒ‰ç…§å¹´åº¦(x),å‡ºç”Ÿæ•¸(y)ä½œåœ–\r figure\r  "},
{"uri": "/blogR//rlang/11_environments.html","title": "11 Environments",
	"tags": [],
	"description": "é€²éš",
	"content": "åƒè€ƒ https://holtzy.github.io/Pimp-my-rmd/\nIntroduction The environment is the data structure that powers scoping. ç›¸é—œæ¦‚å¿µ:lexical scoping, namespaces, and R6 classesã€‚\né€™å€‹æ–‡ä»¶éœ€è¦ devtools::install_github(\u0026quot;tidyverse/rlang\u0026quot;)\nQuiz If you can answer the following questions correctly, you already know the most important topics in this chapter. You can find the answers at the end of the chapter in answers.\n List at least three ways that an environment is different to a list. What is the parent of the global environment? What is the only environment that doesn't have a parent? What is the enclosing environment of a function? Why is it important? How do you determine the environment from which a function was called? How are \u0026lt;- and \u0026lt;\u0026lt;- different?  Outline  Environment basics introduces you to the basic properties of an environment and shows you how to create your own. Recursing over environments provides a function template for computing with environments, illustrating the idea with a useful function. Explicit environments briefly discusses three places where environments are useful data structures for solving other problems.  Prerequisites é€™å€‹ç« ç¯€åˆ©ç”¨äº†å¥—ä»¶rlangè£¡çš„å‡½æ•¸ï¼Œä¾†æ¢ç´¢ç’°å¢ƒç‰©ä»¶ã€‚\nåœ¨rlangå¥—ä»¶ä¸­,env_å‡½æ•¸æ˜¯è¨­è¨ˆç”¨ä¾†å’Œpipeä¸€èµ·å·¥ä½œçš„,é€™è£¡ä¸æ·±å…¥ã€‚\nglobal_env()å’Œglobalenv()çš„åŸ·è¡Œçµæœä¸€æ¨£ã€‚\n.GlobalEnv\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\rglobalenv()\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\rglobal_env()\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r.BaseNamespaceEnv\r#\u0026gt; \u0026lt;environment: namespace:base\u0026gt;\rcurrent_env() #\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r \r\råŸºæœ¬ åŸºæœ¬ä¸Šä¸€å€‹ environment é¡ä¼¼åç¨±ä¸²åˆ—(named list),ä½†æ˜¯æœ‰4å€‹ä¾‹å¤–:\n åç¨±å”¯ä¸€(å°±æ˜¯è®Šæ•¸å”¯ä¸€) åç¨±æ²’æœ‰é †åºé—œä¿‚ æœƒæœ‰ä¸€å€‹parent ç•¶æ”¹è®Šçš„æ™‚å€™,ä¸æœƒè‡ªå‹•è¤‡è£½ (Environments are not copied when modified).  åˆ†åˆ¥æ¢ç´¢ä¸Šé¢å››é»:\næè¦ è¦å»ºç«‹environment, ä½¿ç”¨ rlang::env(). é¡ä¼¼ä½¿ç”¨list(),ä¹Ÿæ˜¯ä¸€çµ„åç¨±-å€¼çš„é…å°ã€‚:\ne1 \u0026lt;- env(\ra = FALSE,\rb = \u0026quot;a\u0026quot;,\rc = 2.3,\rd = 1:3\r)\r å»ºç«‹environmentç‰©ä»¶,åˆ©ç”¨å‡½æ•¸ new.env() ä¸ç”¨ç®¡åƒæ•¸ hash å’Œ sizeã€‚æ³¨æ„ä¸èƒ½åˆ©ç”¨\u0026lt;-åŒæ™‚å®šç¾©å’Œå»ºç«‹ parameters; ä¾‹å¦‚, e1 \u0026lt;- env( a \u0026lt;- FALSE ) # error\r\r\renvironmentç‰©ä»¶å¯ä»¥æƒ³æˆæ˜¯ä¸€å€‹è¢‹å­,æˆ–æ˜¯namesé›†åˆã€‚å› ç‚ºæ²’æœ‰æ¬¡åºé—œä¿‚\n å°±åƒåœ¨ names and values, è¨è«–çš„,é€™å€‹ç‰©ä»¶æ˜¯åƒè€ƒç‚ºåŸºç¤.(in C concept) ä¸æœƒæœ‰copy on modifyingã€‚è€Œä¸”,ç’°å¢ƒç‰©ä»¶å¯ä»¥è‡ªå·±æŒ‡å‘è‡ªå·±(recursion)\ne1$d \u0026lt;- e1\r  æ²’æœ‰æŒ‡æ´¾çš„ç’°å¢ƒè®Šæ•¸,åªæœƒé¡¯ç¤ºè¨˜æ†¶é«”ä½å€:\ne1\r#\u0026gt; \u0026lt;environment: 0x0000000013c47d10\u0026gt;\r è¦çŸ¥é“å…§å®¹å¯ä»¥ä½¿ç”¨ env_print() :\nenv_print(e1)\r#\u0026gt; \u0026lt;environment: 0000000013C47D10\u0026gt;\r#\u0026gt; parent: \u0026lt;environment: global\u0026gt;\r#\u0026gt; bindings:\r#\u0026gt; * a: \u0026lt;lgl\u0026gt;\r#\u0026gt; * b: \u0026lt;chr\u0026gt;\r#\u0026gt; * c: \u0026lt;dbl\u0026gt;\r#\u0026gt; * d: \u0026lt;env\u0026gt;\r æƒ³è¦çŸ¥é“ç›®å‰æœ‰å“ªäº›binding(åç¨±-å€¼ é…å°)å¯ä»¥åˆ©ç”¨ env_names()\nenv_names(e1)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot;\r è¦åˆ—å‡ºç’°å¢ƒä¸‹çš„ç¹«çµï¼Œåœ¨R 3.2.0 ä»¥ä¸Š,å¯ä»¥ä½¿ç”¨å‡½æ•¸names() ,ä¹‹å‰çš„ç‰ˆæœ¬å‰‡æ˜¯ ls(), ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ls çš„åƒæ•¸ all.names å…§è¨­æ˜¯ FALSE å› æ­¤.é–‹é ­çš„çœ‹ä¸åˆ°ã€‚.\r\r\rImportant environments å¦å¤–åƒè€ƒ [Special environments]ã€‚ current_env() å¯ä»¥çŸ¥é“ç›®å‰ç¨‹å¼ç¢¼çš„åŸ·è¡Œç’°å¢ƒã€‚ä¾‹å¦‚,ç•¶æˆ‘å€‘äº’å‹•åŸ·è¡ŒRCODEçš„æ™‚å€™,ç’°å¢ƒé€šå¸¸æ˜¯ [ç¸½é«”ç’°å¢ƒ](#global environment),æˆ–è€…ç”±å‡½æ•¸global_env()å¯ä»¥å¾—åˆ°ã€‚é€™å€‹ç¸½é«”ç’°å¢ƒæœ‰æ™‚å€™å°±å«\u0026quot;workspace\u0026quot;ï¼ŒåŒæ™‚,é€™ä¹Ÿæ˜¯å‡½æ•¸å¤–é¢æ‰€æœ‰äº’å‹•è¨ˆç®—ç™¼ç”Ÿçš„åœ°æ–¹ã€‚ ç’°å¢ƒç‰©ä»¶çš„æ¯”è¼ƒä¸èƒ½ç”¨==,åªèƒ½ç”¨å‡½æ•¸identical()ã€‚\nidentical(global_env(), current_env())\r#\u0026gt; [1] TRUE\rglobal_env() == current_env()\r#\u0026gt; Error in global_env() == current_env(): åªæœ‰åŸºå…ƒæˆ–ä¸²åˆ—é¡å‹æ‰èƒ½åšæ¯”è¼ƒ (1)\r  globalenv() å’Œ.GlobalEnv: æ‹¿åˆ°global environmentandã€‚ environment():æ‹¿åˆ°ç›®å‰çš„ç’°å¢ƒ  global environment çš„åç¨±ç‚º R_GlobalEnv ã€‚\nglobal_env()\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\rcurrent_env()\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r.GlobalEnv\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r \r\rParents æ¯ä¸€å€‹ç’°å¢ƒç‰©ä»¶éƒ½æœ‰ä¸€å€‹ parentã€‚ parent ä¹Ÿä¸€å€‹ç’°å¢ƒç‰©ä»¶ã€‚åœ¨æ–¹å¡Šåœ–ä¸­,parentä»¥è—è‰²åœˆè¡¨ç¤º,ä¸¦ç”¨ç®­é ­æŒ‡å‘å¦ä¸€å€‹ç’°å¢ƒç‰©ä»¶ã€‚\né€™å€‹parentç”¨ä¾†å»ºç«‹ lexical scoping: å¦‚æœnameæ²’æœ‰åœ¨æŸå€‹ç’°å¢ƒç‰©ä»¶æ‰¾åˆ°,Ræœƒé‡è¤‡çš„åœ¨parentä¸­æ‰¾ã€‚\nå‡½æ•¸env()å¯ä»¥ç”¨ä¾†å»ºç«‹ä¸€å€‹æ²’æœ‰åå­—çš„ç’°å¢ƒ You can set the parent environment by supplying an unnamed argument to env(). If you don't supply it, it defaults to the current environment.\ne2a \u0026lt;- env(d = 4, e = 5)\re2b \u0026lt;- env(e2a, a = 1, b = 2, c = 3)\r  e2bçš„parent ç‚ºe2a,e2aæ²’æœ‰parentã€‚\nå‡½æ•¸ env_parent()å¯ä»¥ç”¨ä¾†æ‰¾å‡ºæŸå€‹ç’°å¢ƒç‰©ä»¶çš„parent:\nenv_parent(e2b)\r#\u0026gt; \u0026lt;environment: 0x0000000015418df8\u0026gt;\renv_parent(e2a)\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r parent.env() === env_parent()\r\r\ræ‰€æœ‰çš„ç’°å¢ƒç‰©ä»¶ä¸­åªæœ‰ä¸€å€‹åç¨±ç‚ºR_EmptyEnvçš„ç‰©ä»¶æ²’æœ‰parent(ç”¨ç©ºå¿ƒè—è‰²è¡¨ç¤º):\ne2c \u0026lt;- env(empty_env(), d = 4, e = 5)\re2d \u0026lt;- env(e2c, a = 1, b = 2, c = 3)\r  emptyenv() === empty_env()\r\r\rè©¦åœ–åˆ©ç”¨å‡½æ•¸env_parent()æ‰¾ç©ºç’°å¢ƒç‰©ä»¶çš„parentæœƒç™¼ç”ŸéŒ¯èª¤:\nenv_parent(empty_env())\r#\u0026gt; Error: The empty environment has no parent\r å‡½æ•¸ env_parents()å¯ä»¥æ‰¾å‡ºç›®å‰ç’°å¢ƒç‰©ä»¶çš„æ‰€æœ‰ç¥–å…ˆ:é€™å€‹å‡½æ•¸æœƒç¹¼çºŒç›´åˆ°é‡ä¸Šglobal environment æˆ–æ˜¯ç©ºç’°å¢ƒç‰©ä»¶ã€‚ä¸Šè¿°éç¨‹å¯ä»¥åˆ©ç”¨lastç’°å¢ƒç‰©ä»¶æ§åˆ¶ã€‚\nenv_parents(e2b)\r#\u0026gt; [[1]] \u0026lt;env: 0000000015418DF8\u0026gt;\r#\u0026gt; [[2]] $ \u0026lt;env: global\u0026gt;\renv_parents(e2d)\r#\u0026gt; [[1]] \u0026lt;env: 0000000015F16BB0\u0026gt;\r#\u0026gt; [[2]] $ \u0026lt;env: empty\u0026gt;\r å¯ä»¥åˆ©ç”¨Use parent.env() æ‰¾åˆ°ç’°å¢ƒçš„parentï¼Œä½†æ˜¯baseä¸­æ²’æœ‰å¯ä»¥æ‰¾å‡ºæ‰€æœ‰ç¥–å…ˆçš„å‡½æ•¸ã€‚\r\r\rGetting and setting å­˜å–ç’°å¢ƒä¸­å…ƒç´ çš„æ–¹æ³•å’Œlisté¡ä¼¼:ä½¿ç”¨ $ å’Œ [[:\ne3 \u0026lt;- env(x = 1, y = 2)\re3$x\r#\u0026gt; [1] 1\re3$z \u0026lt;- 3\re3[[\u0026quot;z\u0026quot;]]\r#\u0026gt; [1] 3\r ä½†æ˜¯ä¸èƒ½ä½¿ç”¨ [[ +æ•¸å­—ç´¢å¼•,ä¹Ÿä¸èƒ½å–®ç¨ä½¿ç”¨ [:\ne3[[1]]\r#\u0026gt; Error in e3[[1]]: å–å­é›†ç’°å¢ƒæ™‚çš„å¼•æ•¸ä¸æ­£ç¢º\re3[c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)]\r#\u0026gt; Error in e3[c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)]: 'environment' é¡å‹çš„ç‰©ä»¶ç„¡æ³•å…·æœ‰å­é›†åˆ\r ç•¶ç’°å¢ƒä¸­çš„ç¹«çµä¸å­˜åœ¨æ™‚(ç°¡å–®é»,å°±æ˜¯è®Šæ•¸ä¸å­˜åœ¨æ™‚)$ å’Œ [[ æœƒå‚³å› NULL ä½†ä¸æœƒå¼•ç™¼éŒ¯èª¤,å¦‚æœè¦æœ‰éŒ¯èª¤è­¦å‘Š,å‰‡åˆ©ç”¨ env_get() :\ne3$xyz\r#\u0026gt; NULL\renv_get(e3, \u0026quot;xyz\u0026quot;)\r#\u0026gt; Error in env_get(e3, \u0026quot;xyz\u0026quot;): ç¼ºå°‘å¼•æ•¸ \u0026quot;default\u0026quot;ï¼Œä¹Ÿæ²’æœ‰é è¨­å€¼\r ç•¶ç¹«çµä¸å­˜åœ¨,ä½†æ˜¯æƒ³è¦æœ‰é è¨­å€¼å‚³å›æ™‚,å¯ä»¥åˆ©ç”¨åƒæ•¸ default .\nenv_get(e3, \u0026quot;xyz\u0026quot;, default = NA)\r#\u0026gt; [1] NA\r å¦æœ‰å…©ç¨®æ–¹å¼å¯ä»¥åœ¨ç’°å¢ƒç‰©ä»¶åŠ å…¥ç¹«çµ:\n  env_poke()1 takes a name (as string) and a value:\nenv_poke(e3, \u0026quot;a\u0026quot;, 100)\re3$a\r#\u0026gt; [1] 100\r   env_bind() allows you to bind multiple values:\nenv_bind(e3, a = 10, b = 20)\renv_names(e3)\r#\u0026gt; [1] \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;z\u0026quot; \u0026quot;a\u0026quot; \u0026quot;b\u0026quot;\r   env_has(): æ˜¯å¦ç’°å¢ƒä¸­æœ‰ç¹«çµ\nenv_has(e3, \u0026quot;a\u0026quot;)\r#\u0026gt; a #\u0026gt; TRUE\r ä¸èƒ½åƒæ˜¯listä¸­åˆªé™¤å…ƒç´ çš„æ–¹å¼(æŒ‡æ´¾NULLçµ¦å…ƒç´ )ï¼Œè€Œå¿…é ˆä½¿ç”¨ env_unbind():\ne3$a \u0026lt;- NULL\renv_has(e3, \u0026quot;a\u0026quot;)\r#\u0026gt; a #\u0026gt; TRUE\renv_unbind(e3, \u0026quot;a\u0026quot;)\renv_has(e3, \u0026quot;a\u0026quot;)\r#\u0026gt; a #\u0026gt; FALSE\r å¾ä¸€å€‹ç‰©ä»¶Unbinding è§£é™¤åç¨±ï¼Œä¸¦ä¸æœƒåˆªé™¤ç‰©ä»¶ï¼Œæ˜¯å¦åˆªé™¤ç‰©ä»¶æ˜¯ garbage collectorçš„å·¥ä½œ.ã€‚å¯ä»¥åƒè€ƒ GC.\nSee get(), assign(), exists(), and rm(). These are designed interactively for use with the current environment, so working with other environments is a little clunky. Also beware the inherits argument: it defaults to TRUE meaning that the base equivalents will inspect the supplied environment and all its ancestors.\r\r\rAdvanced bindings There are two more exotic variants of env_bind():\n  env_bind_exprs() creates delayed bindings, which are evaluated the first time they are accessed. Behind the scenes, delayed bindings create promises, so behave in the same way as function arguments.\nenv_bind_exprs(current_env(), b = {Sys.sleep(1); 1})\r#\u0026gt; Warning: `env_bind_exprs()` is deprecated as of rlang 0.3.0.\r#\u0026gt; Please use `env_bind_lazy()` instead.\r#\u0026gt; This warning is displayed once per session.\rsystem.time(print(b))\r#\u0026gt; [1] 1\r#\u0026gt; ä½¿ç”¨è€… ç³»çµ± æµé€ #\u0026gt; 0.00 0.00 1.01\rsystem.time(print(b))\r#\u0026gt; [1] 1\r#\u0026gt; ä½¿ç”¨è€… ç³»çµ± æµé€ #\u0026gt; 0 0 0\r Delayed bindings are used to implement autoload(), which makes R behave as if the package data is in memory, even though it's only loaded from disk when you ask for it.\n  env_bind_fns() creates active bindings which are re-computed every time they're accessed:\nenv_bind_fns(current_env(), z1 = function(val) runif(1)) #\u0026gt; Warning: `env_bind_fns()` is deprecated as of rlang 0.3.0.\r#\u0026gt; Please use `env_bind_active()` instead.\r#\u0026gt; This warning is displayed once per session.\rz1\r#\u0026gt; [1] 0.5319685\rz1\r#\u0026gt; [1] 0.2939102\r The argument to the function allows you to also override behaviour when the variable is set:\nenv_bind_fns(current_env(), z2 = function(val) {\rif (missing(val)) {\r2\r} else {\rstop(\u0026quot;Don't touch z2!\u0026quot;, call. = FALSE)\r}\r})\rz2\r#\u0026gt; [1] 2\rz2 \u0026lt;- 3\r#\u0026gt; Error: Don't touch z2!\r   See ?delayedAssign() and ?makeActiveBinding().\r\r\rExercises  List three ways in which an environment differs from a list. Create an environment as illustrated by this picture.  Create a pair of environments as illustrated by this picture.  Explain why e[[1]] and e[c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;)] don't make sense when e is an environment. Create a version of env_poke() that will only bind new names, never re-bind old names. Some programming languages only do this, and are known as single assignment languages.  Recursing over environments If you want to operate on every ancestor of an environment, it's often convenient to write a recursive function. This section shows you how, applying your new knowledge of environments to write a function that given a name, finds the environment where() that name is defined, using R's regular scoping rules.\nThe definition of where() is straightforward. It has two arguments: the name to look for (as a string), and the environment in which to start the search. (We'll learn why caller_env() is a good default in calling environments.)\nwhere \u0026lt;- function(name, env = caller_env()) {\rif (identical(env, empty_env())) {\r# Base case\rstop(\u0026quot;Can't find \u0026quot;, name, call. = FALSE)\r} else if (env_has(env, name)) {\r# Success case\renv\r} else {\r# Recursive case\rwhere(name, env_parent(env))\r}\r}\r 3å€‹æƒ…æ³:\n The base case: åˆ°é”empty environment æ²’æœ‰parentç„¡æ³•ç¹¼çºŒ,æ‰€ä»¥ä¸Ÿå‡ºerror. The successful case: åœ¨envä¸­æ‰¾åˆ°name ï¼ŒæˆåŠŸ,æ‰€ä»¥å‚³å›envã€‚. The recursive case: åœ¨envä¸­æ‰¾ä¸åˆ°,ç¹¼çºŒåœ¨parentä¸­æ‰¾ã€‚.  These three cases are illustrated with these three examples:\nwhere(\u0026quot;yyy\u0026quot;)\r#\u0026gt; Error: Can't find yyy\rx \u0026lt;- 5\rwhere(\u0026quot;x\u0026quot;)\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\rwhere(\u0026quot;mean\u0026quot;)\r#\u0026gt; \u0026lt;environment: base\u0026gt;\r æƒ³åƒæœ‰å…©å€‹ç’°å¢ƒç‰©ä»¶(å¦‚åœ–):\ne4a \u0026lt;- env(empty_env(), a = 1, b = 2)\re4b \u0026lt;- env(e4a, x = 10, a = 11)\r   where(a, e4a) will find a in e4a. where(\u0026quot;b\u0026quot;, e4a) doesn't find b in e4a, so it looks in its parent, e4b, and finds it there. where(\u0026quot;c\u0026quot;, e4a) looks in e4a, then e4b, then hits the empty environment and throws an error.  It's natural to work with environments recursively, so where() provides a useful template. Removing the specifics of where() shows the structure more clearly:\nf \u0026lt;- function(..., env = caller_env()) {\rif (identical(env, empty_env())) {\r# base case\r} else if (success) {\r# success case\r} else {\r# recursive case\rf(..., env = env_parent(env))\r}\r}\r Iteration vs recursion ä¹Ÿå¯ä»¥ç”¨è¿­ä»£çš„æ–¹å¼\nf2 \u0026lt;- function(..., env = caller_env()) {\rwhile (!identical(env, empty_env())) {\rif (success) {\r# success case\rreturn()\r}\r# inspect parent\renv \u0026lt;- env_parent(env)\r}\r# base case\r}\r \r\rExercises   Modify where() to return all environments that contain a binding for name. Carefully think through what type of object the function will need to return.\n  Write a function called fget() that finds only function objects. It should have two arguments, name and env, and should obey the regular scoping rules for functions: if there's an object with a matching name that's not a function, look in the parent. For an added challenge, also add an inherits argument which controls whether the function recurses up the parents or only looks in one environment.\n  Special environments é€™è£¡è¨è«– package environments. ç„¶å¾Œæ¢è¨ç•¶å‡½æ•¸å»ºç«‹æ™‚,ç¶å…¥å‡½æ•¸çš„å‡½æ•¸ç’°å¢ƒã€‚é‚„æœ‰ç•¶å‡½æ•¸è¢«å‘¼å«æ™‚çš„åŸ·è¡Œç’°å¢ƒ(ephemeral)ã€‚\nå¥—è£ç’°å¢ƒä¸»è¦æ˜¯çœ‹é€™äº›ç’°å¢ƒå¦‚ä½•æ”¯æ´namespacesã€‚åŒæ™‚,namespaceè®“packageæ¯æ¬¡è¼‰å…¥çš„æ™‚å€™,éƒ½æœ‰ä¸€æ¨£çš„è¡Œç‚º,è€Œä¸å”®å…¶ä»–packagesè¼‰å…¥å…ˆå¾Œçš„å½±éŸ¿ã€‚\nå¥—ä»¶ç’°å¢ƒå’Œæœå°‹è·¯å¾‘ æ¯å€‹å¥—ä»¶ç¶“ç”±library() æˆ– require() æ¥å…¥æˆç‚ºç¸½é«”ç’°å¢ƒçš„parentã€‚è€Œæœ€å¾Œä¸€å€‹æ¥å…¥çš„å¥—ä»¶,å‰‡æ˜¯ç¸½é«”ç’°å¢ƒçš„ç¬¬ä¸€å€‹parent:\nload å’Œ attachä¸ä¸€æ¨£ï¼Œç•¶æˆ‘å€‘ä½¿ç”¨requireæˆ– libraryçš„æ™‚å€™,æˆ‘å€‘åšçš„æ˜¯attach ã€‚å°±æ˜¯åœ¨ç›®å‰(ä½¿ç”¨è€…)ç’°å¢ƒä¸²åˆ—ä¸­åŠ å…¥æˆ‘å€‘åˆ©ç”¨libraryè¼‰å…¥çš„ç‰©ä»¶.\n attaching and .onAttach  thus means that a package is attached to the user space aka the global environment usually this is done via library(pkg) and you can use normal fun() syntax   loading and .onLoad  thus means that package is (in any way) made available to the current R-session (e.g. by loading/attaching another package that depends on it or by using pkg::fun() syntax the first time) though you will not find functions in the global environment you can use pkg::fun()    \r\rä¾‹å¦‚æ‰¾å‡ºç¸½é«”ç’°å¢ƒçš„parent\nenv_parent(global_env())\r#\u0026gt; \u0026lt;environment: package:rlang\u0026gt;\r#\u0026gt; attr(,\u0026quot;name\u0026quot;)\r#\u0026gt; [1] \u0026quot;package:rlang\u0026quot;\r#\u0026gt; attr(,\u0026quot;path\u0026quot;)\r#\u0026gt; [1] \u0026quot;C:/Users/linchao/Documents/R/win-library/4.1/rlang\u0026quot;\r æ‰¾åˆ°æ˜¯æœ€è¿‘ä¸€æ¬¡,ä½¿ç”¨æŒ‡ä»¤library(packageA),è£¡é¢é€™å€‹packageAã€‚ä»¥æ­¤é¡æ¨,ä¸‹é¢æ‰¾å‡ºåœ¨packageAä¹‹å‰çš„å¥—ä»¶ç’°å¢ƒã€‚\nenv_parent(env_parent(global_env()))\r#\u0026gt; \u0026lt;environment: package:stats\u0026gt;\r#\u0026gt; attr(,\u0026quot;name\u0026quot;)\r#\u0026gt; [1] \u0026quot;package:stats\u0026quot;\r#\u0026gt; attr(,\u0026quot;path\u0026quot;)\r#\u0026gt; [1] \u0026quot;C:/Program Files/R/R-4.1.1/library/stats\u0026quot;\r å¦‚æœä¸€å±¤ä¸€å±¤parentå›æœ”,å°±å¯ä»¥åˆ°æ¯å€‹å¥—ä»¶è¢«æ¥å…¥çš„é †åº,é€™ä¹Ÿæ˜¯RåŸ·è¡Œä¸­æœƒç”¨åˆ°çš„ search path å› ç‚ºé€™äº›ç’°å¢ƒçš„æ‰€æœ‰ç‰©ä»¶éƒ½å¯ä»¥ç¶“ç”± top-level interactive workspaceæ‰¾åˆ°ã€‚\nsearch_envs()\r#\u0026gt; [[1]] $ \u0026lt;env: global\u0026gt;\r#\u0026gt; [[2]] $ \u0026lt;env: package:rlang\u0026gt;\r#\u0026gt; [[3]] $ \u0026lt;env: package:stats\u0026gt;\r#\u0026gt; [[4]] $ \u0026lt;env: package:graphics\u0026gt;\r#\u0026gt; [[5]] $ \u0026lt;env: package:grDevices\u0026gt;\r#\u0026gt; [[6]] $ \u0026lt;env: package:utils\u0026gt;\r#\u0026gt; [[7]] $ \u0026lt;env: package:datasets\u0026gt;\r#\u0026gt; [[8]] $ \u0026lt;env: package:methods\u0026gt;\r#\u0026gt; [[9]] $ \u0026lt;env: Autoloads\u0026gt;\r#\u0026gt; [[10]] $ \u0026lt;env: package:base\u0026gt;\r å‡½æ•¸ search()å¯ä»¥æ‰¾å‡ºç’°å¢ƒç‰©ä»¶çš„åç¨±ã€‚\r\r\ræœ€å¾Œå…©å€‹ç’°å¢ƒç‰©ä»¶éƒ½ä¸€æ¨£:\n  Autoloads ç’°å¢ƒç‰©ä»¶,åˆ©ç”¨ delayed bindingsä¾†ç¯€çœè¨˜æ†¶é«”ï¼Œä¹Ÿå°±æ˜¯åœ¨éœ€è¦çš„æ™‚å€™æ‰è¼‰å…¥(loading)packageä¸­çš„ç‰©ä»¶(ä¾‹å¦‚å¤§å‹è³‡æ–™é›†)ã€‚\n  base environment, package:base æˆ–ç°¡ç¨± base, æ˜¯base å¥—è£çš„ç’°å¢ƒç‰©ä»¶ã€‚ç”¨ä¾† è¼‰å…¥å…¶ä»–å¥—è£(bootstrap)ã€‚åˆ©ç”¨å‡½æ•¸ base_env()å­˜å–.\n  åˆ©ç”¨åœ–å‹è¡¨ç¤º:\n ç•¶åˆ©ç”¨ library() attachå…¶ä»–å¥—ä»¶çš„æ™‚å€™, ç¸½é«”ç’°å¢ƒçš„parenté¦¬ä¸Šæ”¹è®Š:\n The function environment ç•¶å‡½æ•¸è¢«å»ºç«‹çš„æ™‚å€™,ç¾æœ‰çš„ç’°å¢ƒæœƒè¢«ç¹«çµã€‚ç¨±ç‚ºfunction environment, ä¸»è¦ç”¨ä¾†æ”¯æ´lexical scoping. åœ¨é›»è…¦èªè¨€ä¸­,ç•¶å‡½æ•¸ç´€éŒ„å®ƒå€‘çš„é‹ä½œç’°å¢ƒæ™‚,æˆ‘å€‘èªªé€™å€‹å‡½æ•¸å±¬æ–¼ closuresã€‚,é€™ä¹Ÿæ˜¯ç‚ºç”šéº¼é€™å€‹å­—çœ¼ç¶“å¸¸åœ¨Rèªè¨€ä¸­å‡ºç¾ã€‚.\nåˆ©ç”¨å‡½æ•¸ fn_env()å¯ä»¥å¾—åˆ°å‡½æ•¸çš„ç’°å¢ƒç‰©ä»¶:\ny \u0026lt;- 1\rf \u0026lt;- function(x) x + y\rfn_env(f)\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r ä¸€æ¨£åˆ©ç”¨å‡½æ•¸ environment(f) å¯ä»¥æ‰¾åˆ°å‡½æ•¸ fçš„ç’°å¢ƒ.\r\r\råœ¨åœ–å½¢ä¸­,å‡½æ•¸è¢«ç•«æˆé¡ä¼¼å­å½ˆ,è€Œå½ˆé ­çš„éƒ¨åˆ†ç¹«çµç’°å¢ƒã€‚\n åœ¨é€™å€‹æ¡ˆä¾‹ä¸­,f()ç¹«çµçš„ç’°å¢ƒç‰©ä»¶,å°±æ˜¯ç¹«çµåç¨±fçš„ç’°å¢ƒã€‚ä½†ä¸¦ä¸ä¸€å®šç¸½æ˜¯é€™æ¨£ï¼Œä¾‹å¦‚åœ¨ä¸‹ä¸€å€‹ä¾‹å­ä¸­,gè¢«ç¹«çµåœ¨æ–°ç’°å¢ƒç‰©ä»¶eä¸­ã€‚ä½†æ˜¯å‡½æ•¸g()ç¹«çµçš„æ˜¯global environmentã€‚é€™ä¹‹é–“çš„åˆ†åˆ¥æ˜¯æˆ‘å€‘å¦‚ä½•æ‰¾åˆ°gå’Œgå¦‚ä½•æ‰¾åˆ°ä»–çš„è®Šæ•¸ã€‚\ne \u0026lt;- env()\re$g \u0026lt;- function() 1\r  Namespaces åœ¨ä¸Šé¢çš„åœ–å½¢ä¸­,æˆ‘å€‘å·²ç¶“çŸ¥é“å¥—ä»¶çš„parentæœƒéš¨è‘—ä¹‹å‰å¥—ä»¶è¼‰å…¥çš„é †åºä¸åŒè€Œä¸åŒã€‚é€™å°±å°è‡´Rç¨‹å¼è¨­è¨ˆè€…å¿…é ˆä¿è­‰å€‹åˆ¥å¥—ä»¶ä¸Šå¦‚æœä½¿ç”¨åˆ¥çš„å¥—ä»¶çš„å‡½æ•¸ï¼Œå¿…é ˆæ˜¯åŸå§‹ç›®çš„çš„é‚£ä¸€å€‹ã€‚namespaces å°±æ˜¯ç‚ºæ­¤ç›®çš„è€Œç”¢ç”Ÿ: æ¯å€‹å¥—ä»¶å¿…é ˆçš„ä½¿ç”¨å¿…é ˆä¸€è‡´,è€Œä¸ç®¡ä½¿ç”¨è€…å¦‚ä½•è¼‰å…¥å¥—ä»¶.\nä»¥ sd()ç‚ºä¾‹å­:\nsd\r#\u0026gt; function (x, na.rm = FALSE) #\u0026gt; sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), #\u0026gt; na.rm = na.rm))\r#\u0026gt; \u0026lt;bytecode: 0x000000001c9a2d28\u0026gt;\r#\u0026gt; \u0026lt;environment: namespace:stats\u0026gt;\r sd() å¿…é ˆä½¿ç”¨å‡½æ•¸ var(), å› æ­¤é€™å€‹var()åˆ°åº•ä¾†è‡ª global environment,é‚„æ˜¯å…¶ä»–æ¥å…¥(attached)çš„å¥—ä»¶çš„é€™ç¨®å•é¡Œå¿…é ˆé¿å…ã€‚ R avoids this problem by taking advantage of the function vs. binding environment described above.\næ¯å€‹å¥—ä»¶ä¸­çš„å‡½æ•¸å’Œä¸€å°ç’°å¢ƒç‰©ä»¶æœ‰é—œ:å¥—ä»¶ç’°å¢ƒ(ä¹‹å‰å­¸åˆ°çš„)é‚„æœ‰ namespace ç’°å¢ƒç‰©ä»¶ã€‚\n package environment: æ˜¯å¥—ä»¶çš„å¤–éƒ¨ä»‹é¢ï¼Œé€™æ˜¯Rä½¿ç”¨è€…å¦‚ä½•åœ¨æ¥å…¥çš„å¥—ä»¶ä¸­å°‹æ‰¾å‡½æ•¸çš„åœ°æ–¹(æˆ–è€…å¯ä»¥åˆ©ç”¨ ::) package enviromnent çš„parent ç”±æœå°‹è·¯å¾‘æ±ºå®š(å¯ä»¥åˆ©ç”¨search()çŸ¥é“)æ±ºå®š(ä¹Ÿå°±æ˜¯è¼‰å…¥çš„é †åº) namespace environment:æ˜¯å¥—ä»¶çš„å…§éƒ¨ä»‹é¢ã€‚package environment æ§åˆ¶æˆ‘å€‘å¦‚ä½•æ‰¾åˆ°å‡½æ•¸,è€Œnamespace environmentæ§åˆ¶å‡½æ•¸å¦‚ä½•æ‰¾åˆ°è®Šæ•¸ã€‚  åœ¨package environmentçš„æ¯å€‹ç¹«çµä¹Ÿå¯ä»¥åœ¨namespace environmentä¸­æ‰¾åˆ°ã€‚é€™æ¨£å¯ä»¥ç¢ºä¿æ¯å€‹å‡½æ•¸å¯ä»¥ä½¿ç”¨å¥—ä»¶ä¸­çš„å…¶ä»–å‡½æ•¸ã€‚ä½†æ˜¯æœ‰äº›ç¹«çµåªèƒ½åœ¨namespace ä¸­æ‰¾åˆ°(ä¾‹å¦‚å…§éƒ¨æˆ–éè¼¸å‡ºç‰©ä»¶),é€™ç¨®å…§éƒ¨ç‰©ä»¶é€šå¸¸æ˜¯ç”¨ä¾†éš±è—ä¸€äº›ç¹ç‘£çš„ä¸”ä¸éœ€è¦çµ¦ä½¿ç”¨è€…çœ‹åˆ°çš„ç´°ç¯€ã€‚;\n æ¯å€‹namespace environment æœ‰ä¸€æ¨£çš„ç¥–é›†åˆ:\n æ¯å€‹namespaceæœ‰ imports çš„ç’°å¢ƒç‰©ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¥—ä»¶ä¸­ç”¨åˆ°çš„æ‰€æœ‰å‡½æ•¸ç¹«çµã€‚è€Œæ‰€è¬‚è¼¸å…¥ç’°å¢ƒå¯¦éš›ç”±å¥—è£é–‹ç™¼äººå“¡åœ¨æª”æ¡ˆNAMESPACEæŒ‡å®š æ˜ç¢ºçš„è¼¸å…¥æ¯å€‹baseå‡½æ•¸,å¾ˆç¹ç‘£,æ‰€ä»¥Rç›´æ¥è¨­å®šimport enviromentçš„parentæ˜¯base *namespae*[^1]ã€‚  The base namespace contains the same bindings as the base environment, but it has different parent.\r\r\r base namespace çš„parentæ˜¯ç¸½é«”ç’°å¢ƒ(#global environment).åƒè€ƒä¸‹åœ–,é€™ç¨®è¨­è¨ˆå°è‡´åœ¨import environmentä¸­æ‰¾ä¸åˆ°ç¹«çµæ™‚,æœƒé–‹å§‹å†ç¸½é«”ç’°å¢ƒä¸­å°‹æ‰¾,è€Œä¹‹å‰æéç¸½é«”ç’°å¢ƒé€šå¸¸æ˜¯äº’å‹•ç’°å¢ƒä¸‹åç¨±æœå°‹çš„é–‹å§‹è·¯å¾‘,é€™ä¹Ÿå°è‡´æœå°‹çš„æ–¹å¼å—åˆ°å¥—ä»¶è¼‰å…¥é †åºçš„å½±éŸ¿ã€‚å› æ­¤,Ræä¾›äº†äº†R CMD checkä¾†è­¦å‘Šæ­¤ç¨®æƒ…æ³çš„ç™¼ç”Ÿã€‚(é›–ç„¶æœ‰éº»ç…©,ä½†æ˜¯ç”±æ–¼S3 æ–¹æ³•çš„dispatch é—œä¿‚,æ­¤ç¨®æ–¹å¼ä»ç„¶ç•™è‘—)   ç¶œåˆä¸Šè¿°,å¯ä»¥å¾—åˆ°ä¸‹åœ–:: \næ‰€ä»¥ç•¶ sd() æœå°‹var çš„å€¼çš„æ™‚å€™,æœå°‹é †åºæ˜¯å—åˆ°é–‹ç™¼è€…çš„æŒ‡å®š(åœ¨æª”æ¡ˆNAMESPACEåˆ©ç”¨import)ï¼Œè€Œä¸æœƒå—åˆ°å¥—è£ä½¿ç”¨è€…çš„å½±éŸ¿ã€‚é€™æ¨£ä¿è­‰æ¯æ¬¡å¥—ä»¶ç¨‹å¼ç¢¼åŸ·è¡Œçš„æ™‚å€™,éƒ½ä¸€æ¨£,è€Œä¸æœƒå—åˆ°ä¸€èˆ¬ä½¿ç”¨è€…è¼‰å…¥å¥—ä»¶çš„é †åºè€Œå½±éŸ¿ã€‚\næ³¨æ„åœ¨packageå’Œnamespaceå…©ç¨®ç’°å¢ƒä¹‹é–“æ²’æœ‰ç›´æ¥çš„é€£çµ.é€£çµæ˜¯ç”±å‡½æ•¸ç’°å¢ƒå®šç¾©ã€‚\nExecution environments execution environment. ä¸‹é¢çš„å‡½æ•¸ç¬¬ä¸€æ¬¡åŸ·è¡Œçš„æ™‚å€™æœƒå‚³å›ç”šéº¼?ç¬¬2æ¬¡å‘¢?\ng \u0026lt;- function(x) {\rif (!env_has(current_env(), \u0026quot;a\u0026quot;)) {\rmessage(\u0026quot;Defining a\u0026quot;)\ra \u0026lt;- 1\r} else {\ra \u0026lt;- a + 1\r}\ra\r}\r å†ä¸€æ¬¡åˆ©ç”¨ä¸‹é¢çš„èª¿ç”¨,ç¢ºèªä½ çš„ç­”æ¡ˆ:\ng(10)\r#\u0026gt; Defining a\r#\u0026gt; [1] 1\rg(10)\r#\u0026gt; Defining a\r#\u0026gt; [1] 1\rg(11)\r#\u0026gt; Defining a\r#\u0026gt; [1] 1\r é€™å€‹å‡½æ•¸æ¯æ¬¡åŸ·è¡Œéƒ½å‚³å›ğŸ’¯ä¸€æ¨£çš„ç­”æ¡ˆ,åƒè€ƒ a fresh start. æ¯æ¬¡å‡½æ•¸è¢«èª¿ç”¨çš„æ™‚å€™,ä¸€å€‹æ–°çš„ç’°å¢ƒéƒ½æœƒè¢«å»ºç«‹ä¾†ä¸»å°åŸ·è¡Œã€‚é€™ç¨®ç’°å¢ƒç¨±ç‚ºåŸ·è¡Œç’°å¢ƒã€‚è€ŒåŸ·è¡Œç’°å¢ƒçš„parentç‚º function environment.\nç”¨å¦ä¸€å€‹ç°¡å–®é»çš„ä¾‹å­èªªæ˜. (åœ–ä¸­,åŸ·è¡Œç’°å¢ƒçš„parenté–“æ¥è¡¨ç¤º:ç¶“ç”±å‡½æ•¸ç’°å¢ƒ).\nh \u0026lt;- function(x) {\r# 1.\ra \u0026lt;- 2 # 2.\rx + a\r}\ry \u0026lt;- h(1) # 3.\r  åŸ·è¡Œç’°å¢ƒ(execution environment)çŸ­æš«å­˜åœ¨,ç•¶å‡½æ•¸åŸ·è¡Œå®Œç•¢é€šå¸¸æœƒè¢«GCã€‚åœ¨å¹¾ç¨®æƒ…æ³ä¸‹,æœƒåœ¨è¨˜æ†¶é«”å­˜åœ¨æ¯”è¼ƒä¹…,ç¬¬ä¸€ç¨®æ˜¯å›å‚³çµ¦å¦ä¸€å€‹è®Šæ•¸:\nh2 \u0026lt;- function(x) {\ra \u0026lt;- x * 2\rcurrent_env()\r}\re \u0026lt;- h2(x = 10)\renv_print(e)\r#\u0026gt; \u0026lt;environment: 000000001D3DEF08\u0026gt;\r#\u0026gt; parent: \u0026lt;environment: global\u0026gt;\r#\u0026gt; bindings:\r#\u0026gt; * a: \u0026lt;dbl\u0026gt;\r#\u0026gt; * x: \u0026lt;dbl\u0026gt;\rfn_env(h2)\r#\u0026gt; \u0026lt;environment: R_GlobalEnv\u0026gt;\r Another way to capture it is to return an object with a binding to that environment, like a function. The following example illustrates that idea with a function factory, plus(). We use that factory to create a function called plus_one().\nThere's a lot going on in the diagram because the enclosing environment of plus_one() is the execution environment of plus().\nplus \u0026lt;- function(x) {\rfunction(y) x + y\r}\rplus_one \u0026lt;- plus(1)\rplus_one\r#\u0026gt; function(y) x + y\r#\u0026gt; \u0026lt;environment: 0x000000001d7333a0\u0026gt;\r  What happens when we call plus_one()? Its execution environment will have the captured execution environment of plus() as its parent:\nplus_one(2)\r#\u0026gt; [1] 3\r  You'll learn more about function factories in functional programming.\nExercises   How is search_envs() different to env_parents(global_env())?\n  Draw a diagram that shows the enclosing environments of this function:\nf1 \u0026lt;- function(x1) {\rf2 \u0026lt;- function(x2) {\rf3 \u0026lt;- function(x3) {\rx1 + x2 + x3\r}\rf3(3)\r}\rf2(2)\r}\rf1(1)\r   Write an enhanced version of str() that provides more information about functions. Show where the function was found and what environment it was defined in.\n  The call stack é‚„æœ‰å¦ä¸€ç¨®ç’°å¢ƒç¨±ç‚º caller environment, å¯ä»¥ç¶“ç”± rlang::caller_env()å­˜å–ã€‚. This provides the environment from which the function was called, and hence varies based on how the function is called, not how the function was created. As we saw above this is a useful default whenever you write a function that takes an environment as an argument.\nparent.frame() is equivalent to caller_env(); just note that it returns an environment, not a frame.\r\r\rTo fully understand the caller environment we need to discuss two related concepts: the call stack, which is made up of frames. Executing a function creates two types of context. You've learned about one already: the execution environment is a child of the function environment, which is determined by where the function was created. There's another type of context created by where the function was called: this is called the call stack.\nThere are also a couple of small wrinkles when it comes to custom evaluation. See environments vs. frames for more details.\nSimple call stacks Let's illustrate this with a simple sequence of calls: f() calls g() calls h().\nf \u0026lt;- function(x) {\rg(x = 2)\r}\rg \u0026lt;- function(x) {\rh(x = 3)\r}\rh \u0026lt;- function(x) {\rstop()\r}\r The way you most commonly see a call stack in R is by looking at the traceback() after an error has occured:\nf(x = 1)\r#\u0026gt; Error:\rtraceback()\r#\u0026gt; 4: stop()\r#\u0026gt; 3: h(x = 3) #\u0026gt; 2: g(x = 2)\r#\u0026gt; 1: f(x = 1)\r Instead of stop() + traceback() to understand the call stack, we're going to use lobstr::cst() to print out the call stack tree:\nh \u0026lt;- function(x) {\rlobstr::cst()\r}\rf(x = 1)\r#\u0026gt; ???\r#\u0026gt; ??îœ¿?Â€f(x = 1)\r#\u0026gt; ??îœ¿?Â€g(x = 2)\r#\u0026gt; ??îœ¿?Â€h(x = 3)\r#\u0026gt; ??îœ¿?Â€lobstr::cst()\r This shows us that cst() was called from h(), which was called from g(), which was called from f(). Note that the order is the opposite from traceback(). As the call stacks get more compliated, I think it's easier to understand the sequence of calls if you start from the beginning, rather than the end (i.e. f() calls g(); rather than g() was called by f()).\nLazy evaluation The call stack above is simple - while you get a hint that there's some tree-like structure involved, everything happens on a single branch. This is typical of a call stack when all arguments are eagerly evaluated.\nLet's create a more complicated example that involves some lazy evaluation. We'll create a sequence of functions, a(), b(), c(), that pass along an argument x.\na \u0026lt;- function(x) b(x)\rb \u0026lt;- function(x) c(x)\rc \u0026lt;- function(x) x\ra(f())\r#\u0026gt; ???\r#\u0026gt; ??î°§?Â€a(f())\r#\u0026gt; ??? ??îœ¿?Â€b(x)\r#\u0026gt; ??? ??îœ¿?Â€c(x)\r#\u0026gt; ??îœ¿?Â€f()\r#\u0026gt; ??îœ¿?Â€g(x = 2)\r#\u0026gt; ??îœ¿?Â€h(x = 3)\r#\u0026gt; ??îœ¿?Â€lobstr::cst()\r x is lazily evaluated so this tree gets two branches. In the first branch a() calls b(), then b() calls c(). The second branch starts when c() evaluates its argument x. This argument is evaluated in a new branch because the environment in which it is evaluated is the global environment, not the environment of c().\nFrames Each element of the call stack is a frame2, also known as an evaluation context. The frame is an extremely important internal data structure, and R code can only access a small part of the data structure because it's so critical. A frame has three main components that are accessible from R:\n  An expression (labelled with expr) giving the function call. This is what traceback() prints out.\n  An environment (labelled with env), which is typically the execution environment of a function. There are two main exceptions: the environment of the global frame is the global environment, and calling eval() also generates frames, where the environment can be anything.\n  A parent, the previous call in the call stack (shown by a grey arrow).\n   (To focus on the calling environments, I have omitted the bindings in the global environment from f, g, and h to the respective function objects.)\nThe frame also holds exit handlers created with on.exit(), restarts and handlers for the condition system, and which context to return() to when a function completes. These are important for the internal operation of R, but are not directly accessible.\nDynamic scope Looking up variables in the calling stack rather than in the enclosing environment is called dynamic scoping. Few languages implement dynamic scoping (Emacs Lisp is a notable exception.) This is because dynamic scoping makes it much harder to reason about how a function operates: not only do you need to know how it was defined, you also need to know the context in which it was called. Dynamic scoping is primarily useful for developing functions that aid interactive data analysis. It is one of the topics discussed in non-standard evaluation.\nExercises  Write a function that lists all the variables defined in the environment in which it was called. It should return the same results as ls().  As data structures As well as powering scoping, environments are also useful data structures in their own right because they have reference semantics. There are three common problems that they can help solve:\n  Avoiding copies of large data. Since environments have reference semantics, you'll never accidentally create a copy. This makes it a useful vessel for large objects. Bare environments are not that pleasant to work with; I recommend using R6 objects instead. Learn more in [R6].\n  Managing state within a package. Explicit environments are useful in packages because they allow you to maintain state across function calls. Normally, objects in a package are locked, so you can't modify them directly. Instead, you can do something like this:\nmy_env \u0026lt;- new.env(parent = emptyenv())\rmy_env$a \u0026lt;- 1\rget_a \u0026lt;- function() {\rmy_env$a\r}\rset_a \u0026lt;- function(value) {\rold \u0026lt;- my_env$a\rmy_env$a \u0026lt;- value\rinvisible(old)\r}\r Returning the old value from setter functions is a good pattern because it makes it easier to reset the previous value in conjunction with on.exit() (see more in on exit).\n  As a hashmap. A hashmap is a data structure that takes constant, O(1), time to find an object based on its name. Environments provide this behaviour by default, so can be used to simulate a hashmap. See the CRAN package hash for a complete development of this idea.\n  \u0026lt;\u0026lt;- The ancestors of an environment have an important relationship to \u0026lt;\u0026lt;-. The regular assignment arrow, \u0026lt;-, always creates a variable in the current environment. The deep assignment arrow, \u0026lt;\u0026lt;-, never creates a variable in the current environment, but instead modifies an existing variable found by walking up the parent environments.\nx \u0026lt;- 0\rf \u0026lt;- function() {\rx \u0026lt;\u0026lt;- 1\r}\rf()\rx\r#\u0026gt; [1] 1\r If \u0026lt;\u0026lt;- doesn't find an existing variable, it will create one in the global environment. This is usually undesirable, because global variables introduce non-obvious dependencies between functions. \u0026lt;\u0026lt;- is most often used in conjunction with a closure, as described in Closures.\nExercises   What does this function do? How does it differ from \u0026lt;\u0026lt;- and why might you prefer it?\nrebind \u0026lt;- function(name, value, env = caller_env()) {\rif (identical(env, empty_env())) {\rstop(\u0026quot;Can't find `\u0026quot;, name, \u0026quot;`\u0026quot;, call. = FALSE)\r} else if (env_has(env, name)) {\renv_poke(env, name, value)\r} else {\rrebind(name, value, env_parent(env))\r}\r}\rrebind(\u0026quot;a\u0026quot;, 10)\r#\u0026gt; Error: Can't find `a`\ra \u0026lt;- 5\rrebind(\u0026quot;a\u0026quot;, 10)\ra\r#\u0026gt; [1] 10\r   Quiz answers   There are four ways: every object in an environment must have a name; order doesn't matter; environments have parents; environments have reference semantics.\n  The parent of the global environment is the last package that you loaded. The only environment that doesn't have a parent is the empty environment.\n  The enclosing environment of a function is the environment where it was created. It determines where a function looks for variables.\n  Use caller_env() or parent.frame().\n  \u0026lt;- always creates a binding in the current environment; \u0026lt;\u0026lt;- rebinds an existing name in a parent of the current environment.\n  term global environment :ç¸½é«”ç’°å¢ƒ package environments imports environment   You might wonder why rlang has env_poke() instead of env_set(). This is for consistency: _set() functions return a modified copy; _poke() functions modify in place.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n NB: ?environment uses frame in a different sense: \u0026quot;Environments consist of a frame, or collection of named objects, and a pointer to an enclosing environment.\u0026quot;. We avoid this sense of frame, which comes from S, because it's very specific and not widely used in base R. For example, the \u0026quot;frame\u0026quot; in parent.frame() is an execution context, not a collection of named objects.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  "},
{"uri": "/blogR//rlang/2_0_%E8%BC%B8%E5%87%BA%E8%BC%B8%E5%85%A5.html","title": "2.0 åŸºæœ¬è¼¸å‡ºè¼¸å…¥",
	"tags": ["å­—ä¸²"],
	"description": "2_0_è¼¸å‡ºè¼¸å…¥",
	"content": "Rçš„åŸºæœ¬çš„è¼¸å‡ºå‡½æ•¸ å¤§æ¦‚æœ‰é€™å¹¾ç¨®ï¼š\n print() cat() message() warning() stop()  å‰å…©å€‹è¼¸å‡ºåˆ°æ¨™æº–è¼¸å‡ºè£ç½®(standard output)ï¼Œå¾Œä¸‰å€‹æœƒé¡¯ç¤ºåœ¨æ¨™æº–éŒ¯èª¤è£ç½®ä¸Š(standard error)ã€‚ å¦‚æœä¸æƒ³è¦é¡¯ç¤ºè¨Šæ¯,\n æ˜¯stderr é¡çš„è¼¸å‡ºå‡½æ•¸,å¯ä»¥åˆ©ç”¨ suppressWarnings(), suppressMessages(), suppressPackageStartupMessages()ã€‚ stdin é¡å‰‡ä½¿ç”¨ sink() or capture.output()  å¦å¤–æœ‰é—œRmarkdown: knitr æä¾›çš„é¸é …,åƒæ˜¯ error = F, message = F, and warning = F.\nå‡½æ•¸èªªæ˜   print() - ç„¡æ³•é€£çµå­—ä¸²ï¼Œæœƒå¸¶æœ‰[1]ï¼Œä¾‹å¦‚ï¼š\nprint(paste(\u0026quot;Hello\u0026quot;,\u0026quot;World!\u0026quot;))\r[1] \u0026quot;Hello World!\u0026quot;\r   cat() å¸¶æœ‰é¡ä¼¼paste()çš„åƒæ•¸ï¼Œsep=\u0026quot; \u0026quot;ï¼Œæ‰€ä»¥é€£çµå­—ä¸²æ¯”è¼ƒæ–¹ä¾¿ï¼Œä½†æ˜¯å¿…é ˆè‡ªè¡Œå¯«æ›è¡Œç¬¦è™Ÿ\\nã€‚\ncat(\u0026quot;Hello!\\n\u0026quot;)\r#\u0026gt; Hello!\r#\u0026gt; # ğŸ·ğŸ‘é€™æ˜¯ç©ºç™½è¡Œ,å‹•æ‡‰å­—ä¸²ä¸­çš„æœ€å¾Œä¸€å€‹\\n1 cat(\u0026quot;Hello\u0026quot;,\u0026quot;World!\\n\u0026quot;) # ğŸ·ğŸ‘æ„æ€æ˜¯èªªç¢°åˆ°\\nå°±æ›è¡Œ\r#\u0026gt; Hello World!\r#\u0026gt; cat(\u0026quot;Hello\u0026quot;,\u0026quot;World!\\n\u0026quot;, sep = \u0026quot;\u0026quot;)\r#\u0026gt; HelloWorld! # # ğŸ·ğŸ‘å…¨éƒ¨æ“ åœ¨ä¸€èµ·,è€Œä¸”\\nç„¡ç”¨\r   message() å¸¶ç´…å­—çš„è¼¸å‡ºï¼ŒåŸºæœ¬ä¸Šæ˜¯åˆ°æ¨™æº–éŒ¯èª¤è£ç½®ã€‚\nmessage(\u0026quot;Hello \u0026quot;,\u0026quot;World!\u0026quot;) # Note the space after Hello\r#\u0026gt; \u0026quot;Hello World!\u0026quot;\r  æ›´æ–¹ä¾¿çš„æ˜¯èƒ½ç”¨ä¾†é…åˆtryCatch()e.g. tryCatch(message(\u0026quot;hello\\n\u0026quot;), message=function(e){cat(\u0026quot;goodbye\\n\u0026quot;)})\r#\u0026gt; goodbye\r     warning() : æˆ‘å€‘è‡ªè¨‚çš„å‡½æ•¸æª¢æŸ¥åˆ°åƒæ•¸(å¯èƒ½æ˜¯é¡åˆ¥)å¯èƒ½å°è‡´èªæ„éŒ¯èª¤çš„è¨Šæ¯ã€‚\n  stop(): éŒ¯èª¤è¨Šæ¯ï¼Œå†ç¹¼çºŒè¨ˆç®—ä¹Ÿæ˜¯éŒ¯çš„ã€‚\n  å¦å¤–,åœ¨å¥—ä»¶é–‹ç™¼ä¸­çš„å‡½æ•¸,å¯ä»¥ç›¡é‡å°‘ç”¨print()ã€‚å¦‚æœè¦è¼¸å‡ºçš„å‡½æ•¸å±¬æ–¼S3ç‰©ä»¶çš„print.*(),é‚£éº¼å°±ä½¿ç”¨cat(),å…¶ä»–ç‹€æ³å‰‡ä½¿ç”¨message()ã€‚warning(),stop()\nåŸºæœ¬è¼¸å…¥å’Œè¼¸å‡º  print() cat() sprintf()  a\u0026lt;-\u0026quot;hello\\nR\u0026quot; # ğŸ·ğŸ‘ä¹Ÿå¯ä»¥æ˜¯å–®å¼•è™Ÿ'hello\\n'\rprint(a) # ä¹Ÿå¯ä»¥ä¸ç”¨å…ˆæŒ‡æ´¾è®Šæ•¸,è€Œç›´æ¥ print(\u0026quot;hello\u0026quot;)\r#\u0026gt; [1] \u0026quot;hello\\nR\u0026quot;\rcat(a)\r#\u0026gt; hello\r#\u0026gt; R\r print(),cat()é›–ç„¶åœ¨ä¸Šé¢çš„ä¾‹å­çœ‹èµ·ä¾†ä¸€æ¨£ã€‚ä½†æ˜¯åˆå­¸è€…æ¨è–¦ä½¿ç”¨print()ã€‚\n cat() èªè­˜å­—ä¸²ä¸­çš„æ›è¡Œç¬¦è™Ÿ\\n, print() ä¸èªè­˜ å¦‚æœæœ‰å¤šå€‹å­—ä¸²,ä½¿ç”¨cat()çš„æ™‚å€™,å¯ä»¥è¨­å®šcat(..., sep=\u0026quot;\\n\u0026quot;)ã€‚  \rè£œå……\rcat()é€šå¸¸æ˜¯åœ¨æª”æ¡ˆè™•ç†çš„æ™‚å€™ã€‚åœ¨Cé¡çš„èªè¨€ä¸­,éµç›¤å’Œè¢å¹•éƒ½å±¬æ–¼æª”æ¡ˆ-ç‰¹æ®Šæª”æ¡ˆ,ä¸€ç¨®åªèƒ½è®€å‡º,ä¸€ç¨®åªèƒ½å¯«å…¥,æŠ½è±¡è§€å¿µçš„æè¿°æ˜¯ä¸²æµã€‚ ä½¿ç”¨ç¯„ä¾‹å¦‚ä¸‹:\nsink(\u0026quot;foobar.txt\u0026quot;) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å¾é€™å€‹æŒ‡ä»¤é–‹å§‹,æ‰€æœ‰æµå‘è¢å¹•çš„è¼¸å‡ºéƒ½è¼¸å‡ºåˆ°æª”æ¡ˆfoobar.txt\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rcat('\u0026quot;foo\u0026quot;\\n')\rcat('\u0026quot;bar\u0026quot;')\rsink() #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;çµæŸ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r æª”æ¡ˆå…§å®¹æ˜¯:\n\u0026quot;foo\u0026quot;\r\u0026quot;bar\u0026quot;\r  ä¸€è¡ŒæŒ‡ä»¤å®Œæˆä¸Šè¿°ç¨‹å¼ç¢¼ cat('\u0026quot;foo\u0026quot;', '\u0026quot;bar\u0026quot;', file=\u0026quot;foobar.txt\u0026quot;, sep=\u0026quot;\\n\u0026quot;)\r  å¦‚æœæª”æ¡ˆå·²ç¶“å­˜åœ¨,é‚„è¦æ·»åŠ ,é‚£éº¼å°±åŠ ä¸Šåƒæ•¸append=T cat('\u0026quot;foo\u0026quot;', file=\u0026quot;foobar.txt\u0026quot;, append=TRUE)\rcat('\u0026quot;bar\u0026quot;', file=\u0026quot;foobar.txt\u0026quot;, append=TRUE)\r   "},
{"uri": "/blogR//rlang/2_1_%E8%AE%80%E6%AA%94%E5%AF%AB%E6%AA%94.html","title": "2.1 è®€æª”å¯«æª”",
	"tags": [],
	"description": "è®€æª”å¯«æª”",
	"content": "å¯¦é©—ææ–™ \rğŸ“é™„ä»¶:ç·´ç¿’æ–‡å­—æª”\r\rå¯ä»¥ç”¨ä¾†ç·´ç¿’çš„æ–‡å­—æª”\r\rJournals.csv\r\rsample1.csv\r\rsample2.csv\r\rsample3.csv\r\rsimple.csv\r\rsmoker.csv\r\rtrees91.csv\r\rwh.csv\r\rwh_zh_950.csv\r\rwh_zh_utf8.csv\r\r\r Rèªè¨€çš„æª”æ¡ˆæ ¼å¼  name.rdb: a concatenation of serialized objects. name.rdx: file contains an index. name.rds the serialized R objects written by saveRDS name.rda(RData): äºŒé€²ä½Rè³‡æ–™æª”ã€‚(ç”¨load(name)è¼‰å…¥)  å¦‚æœä¸è€ƒæ…®å­˜æª”æ ¼å¼ï¼Œé‚£éº¼å¯ä»¥åˆ©ç”¨ save(v1,v2,...file=\u0026quot;myfile.RData\u0026quot;)\r...\rload(file=\u0026quot;myfie.RData\u0026quot;)\r     ç¯„ä¾‹\nx=3 #ğŸ·æˆ‘è¦æš«æ™‚æŠŠé€™å€‹çµæœx=3å­˜æª”,é€²è¡Œå…¶ä»–è³‡æ–™è™•ç†\r#.....do task\rsave(x,file=\u0026quot;xx\u0026quot;) # ğŸ·â“å•é¡Œ:å­˜åˆ°å“ª?\rdir(getwd()) # ğŸ·åŒ…æ‹¬ç›®éŒ„(list.dir())å’Œæª”æ¡ˆ(list.files())\r#\u0026gt; [1] \u0026quot;desktop.ini\u0026quot; \u0026quot;foobar.txt\u0026quot; \u0026quot;My Music\u0026quot; \u0026quot;My Pictures\u0026quot;\r#\u0026gt; [5] \u0026quot;My Videos\u0026quot; \u0026quot;R\u0026quot; \u0026quot;xx\u0026quot; x=5 #ğŸ·çœ‹çœ‹ç­‰ä¸‹å¾æª”æ¡ˆè¼‰å…¥é€²ä¾†çš„æ™‚å€™,æœƒä¸æœƒæ˜¯åŸä¾†çš„3\rload(\u0026quot;xx\u0026quot;)\rx\r#\u0026gt; [1] 3\r ä½¿ç”¨è€…æŒ‡å®šäº†ä¸€å€‹æª”æ¡ˆå¤¾,å¦‚ä½•åˆ¤å®šå®ƒæ˜¯å¦å­˜åœ¨,è€ƒæ…®ä»¥ä¸‹å¹¾é»\n åœ¨ç•¶å‰çš„å·¥ä½œå­ç›®éŒ„ä¸­å°‹æ‰¾ åˆ©ç”¨å‡½æ•¸error()çµ¦éŒ¯èª¤è¨Šæ¯  æç¤º\r ğŸ’¡ è§£ç­”\nuserfolder\u0026lt;-??(ä½¿ç”¨è€…æŒ‡å®š)\rallfolder\u0026lt;-list.dir() # å…§å®šæ˜¯getwd()\rokfolder\u0026lt;-allfolder[dir.exists(userfolder)]\rå¦‚æœokfolder é•·åº¦æ˜¯0,å‰‡error()\r \nä½éšé–‹æª”/é—œæª”éç¨‹ å¤§é«”ä¸Šæ¯å€‹èªè¨€çš„é–‹æª”å’Œé—œæª”æ¡ˆçš„éç¨‹ï¼Œéƒ½æœƒåˆ©ç”¨åˆ°ä½œæ¥­ç³»çµ±ï¼Œå› æ­¤æœƒæœ‰é–‹æª”å‹•ä½œï¼Œå¾ä½œæ¥­ç³»çµ±å¾—åˆ°ä¸€å€‹æ•¸å­—ï¼Œé€™è£¡ç¨±ç‚ºæª”æ¡ˆæŒ‡æ¨™ï¼Œç„¶å¾Œåˆ©ç”¨é€™å€‹æŒ‡æ¨™ï¼Œè®€å…¥æ–‡å­—æˆ–å¯«å…¥æ–‡å­—ï¼Œç„¶å¾Œæœ‰ä¸€å€‹é—œé–‰æª”æ¡ˆçš„å‹•ä½œå‘Šè¨´ä½œæ¥­ç³»çµ±ï¼Œè™•ç†æª”æ¡ˆçµæŸã€‚\nåœ¨Rèªè¨€ä¸­ï¼Œé–‹æª”ä¸æ˜¯open(),è€Œæ˜¯fileï¼š\ncon = file(filepath, \u0026quot;r\u0026quot;)\ré–‹å§‹è®€å¯«æ“ä½œ\rclose(con)\r è¿´åœˆä¸€è¡Œä¸€è¡Œè®€å…¥ä¸¦å¯«åˆ°è¢å¹•ä¸Š\nprocessFile = function(filepath) {\rcon = file(filepath, \u0026quot;r\u0026quot;)\rwhile ( TRUE ) {\rline = readLines(con, n = 1) # ğŸ·n=1 æ¯æ¬¡è®€å…¥ä¸€è¡Œ\rif ( length(line) == 0 ) {\rbreak\r}\rprint(line)\r}\rclose(con)\r}\r å¾Œé¢ç« ç¯€ä¸ä½¿ç”¨ä¸Šé¢çš„ä½éšæ–¹æ³•,è€Œæ˜¯ä½¿ç”¨Ræä¾›çš„å‡½æ•¸\nè®€å¯«æª”æ¡ˆçš„çš„å¸¸ç”¨å‡½æ•¸  æŒ‡ä»¤   readLines(logf, encoding=\u0026quot;UTF-8\u0026quot;) \rreadLines()çš„ç¯„ä¾‹\r```r\rdir(system.file())\r#\u0026gt; [1] \u0026quot;CITATION\u0026quot; \u0026quot;demo\u0026quot; \u0026quot;DESCRIPTION\u0026quot;â›³ \u0026quot;help\u0026quot; #\u0026gt; [5] \u0026quot;html\u0026quot; \u0026quot;INDEX\u0026quot; \u0026quot;Meta\u0026quot; \u0026quot;R\u0026quot; res \u0026lt;- readLines(system.file(\u0026quot;DESCRIPTION\u0026quot;, package=\u0026quot;MASS\u0026quot;)) \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ç”šéº¼æ˜¯DESCRIPTION? çœ‹ä¸Šé¢çš„dir(system.file()) è¼¸å‡º\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rstr(res)\r```\r \n  writeLines(å­—ä¸², æª”æ¡ˆåç¨±, useBytes=T)\n    â­•æº–å‚™ææ–™:å…ˆçœ‹ä¸€ä¸‹ç›®æ¨™æª”æ¡ˆå…§å®¹ \rå±•é–‹\ræ¸¬è©¦çš„æª”æ¡ˆ\n# this is a test file\rheight,weight,sex\r156,56, m\r167,., f #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘weightæœ‰ä¸€é»\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r189,70, m\r180,, f #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘weightæ˜¯ç©ºçš„\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r å¦ä¸€å€‹æ¸¬è©¦æª”æ¡ˆ(å…§æœ‰ä¸­æ–‡)\n æŒ‡ä»¤,file.show(\u0026quot;resources/wh.csv\u0026quot;),æœƒåœ¨Rçš„æ‰“é–‹å¦ä¸€å€‹è¦–çª—ã€‚ ä¹Ÿå¯ä»¥åˆ©ç”¨æ®¼å±¤æŒ‡ä»¤:  system(\u0026quot;cat resources/wh.csv\u0026quot;)ï¼Œä½†æ˜¯å¦‚æœå…§å®¹æ˜¯ä¸­æ–‡,é¡¯ç¤ºçµæœæœƒè®Šæˆäº‚ç¢¼ã€‚    ä¸Šé¢å…©ç¨®æ–¹æ³•,å¯èƒ½æœƒè¦ºå¾—æœ‰é»å¤šé¤˜,å› ç‚ºåœ¨è¦–çª—ä»‹é¢ä¸­,ç›´æ¥æŒ‰å…©ä¸‹å°±å¯ä»¥æ‰“è©²æª”æ¡ˆã€‚é€™è£¡åªæ˜¯æä¸€ä¸‹å¦‚ä½•å’Œå¤–éƒ¨æŒ‡ä»¤å‹¾é€£ã€‚\n\næ³¨æ„æª”æ¡ˆå…§å®¹ç¬¬ä¸€è¡Œä¸æ˜¯è³‡æ–™,è€Œæ˜¯æ¬„ä½ã€‚\næ¸¬è©¦readChar()éç¨‹çš„ç´€éŒ„   æ¸¬è©¦readChar() (æœ‰æ™‚å€™æª”æ¡ˆå¾ˆå¤§,ä¸€èˆ¬çš„ç·¨è¼¯å™¨æ‰“ä¸é–‹ä½†æ˜¯åˆä¸çŸ¥é“æ˜¯ç”šéº¼æ ¼å¼ï¼Œé™¤äº†ä¸Šé¢æåˆ°çš„readLines()ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¯ä»¥æŒ‡å®šè®€å…¥é•·åº¦çš„æŒ‡ä»¤readChar())\ncat(readChar(\u0026quot;resources/wh.csv\u0026quot;, 1e5)) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘1e5æŒ‡å®šæœ€å¤§é•·åº¦,å¯ä»¥ä¸è¦æœ‰\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; Warning in readChar(\u0026quot;resources/wh.csv\u0026quot;, 1e+05): åœ¨é UTF-8 MBCS èªå€ä¸­åªèƒ½ä»¥ä½å…ƒ\r#\u0026gt; çµ„ç‚ºå–®ä½è®€å–\r#\u0026gt; # this is a test file\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r#\u0026gt; 167,., f\r#\u0026gt; 189,70, m\r#\u0026gt; 180,, f\r   åˆ©ç”¨useBytes ä¸æœƒå‡ºç¾è­¦å‘Š\ncat(readChar(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;, useBytes=TRUE,1e5)) #\u0026gt; Error in cat(readChar(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;, useBytes = TRUE, 1e+05)): ç„¡æ•ˆçš„å¤šä½å…ƒçµ„å­—ä¸²æ–¼ '\u0026lt;e9\u0026gt;Â€\u0026lt;99\u0026gt;\u0026lt;e6\u0026gt;î¦€çšœç¥ˆå²«ç‘¼\u0026lt;94\u0026gt;\r#\u0026gt; é ¨æ\u0026lt;ab\u0026gt;\u0026lt;98\u0026gt;,æ“ƒî†\u0026lt;87\u0026gt;\u0026lt;8d\u0026gt;,\u0026lt;e6\u0026gt;Â€æ‰¹ï†\r#\u0026gt; 156,56,\u0026lt;e7\u0026gt;îœ”\r#\u0026gt; 167,66,æ†Ÿ\u0026lt;b3\u0026gt;\r#\u0026gt; 189,70,\u0026lt;e7\u0026gt;îœ”\r#\u0026gt; 180,,æ†Ÿ\u0026lt;b3\u0026gt;\r#\u0026gt; '\rcat(readChar(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;, useBytes=TRUE,1e5),sep=\u0026quot;\\r\\n\u0026quot;)\r#\u0026gt; Error in cat(readChar(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;, useBytes = TRUE, 1e+05), : ç„¡æ•ˆçš„å¤šä½å…ƒçµ„å­—ä¸²æ–¼ '\u0026lt;e9\u0026gt;Â€\u0026lt;99\u0026gt;\u0026lt;e6\u0026gt;î¦€çšœç¥ˆå²«ç‘¼\u0026lt;94\u0026gt;\r#\u0026gt; é ¨æ\u0026lt;ab\u0026gt;\u0026lt;98\u0026gt;,æ“ƒî†\u0026lt;87\u0026gt;\u0026lt;8d\u0026gt;,\u0026lt;e6\u0026gt;Â€æ‰¹ï†\r#\u0026gt; 156,56,\u0026lt;e7\u0026gt;îœ”\r#\u0026gt; 167,66,æ†Ÿ\u0026lt;b3\u0026gt;\r#\u0026gt; 189,70,\u0026lt;e7\u0026gt;îœ”\r#\u0026gt; 180,,æ†Ÿ\u0026lt;b3\u0026gt;\r#\u0026gt; '\r   âŒåƒæ•¸æœ‰useBytes,ä½†æ˜¯ä¸ç®¡TRUE/FALSEï¼Œéƒ½æ˜¯ä¸­æ–‡äº‚ç¢¼\n  âœ”æ­£è§£:\nx\u0026lt;-readChar(\u0026quot;resources/wh_zh_utf8.csv\u0026quot;, useBytes=TRUE,1e5)\rEncoding(x)\r#\u0026gt; [1] \u0026quot;unknown\u0026quot;\rEncoding(x)\u0026lt;-\u0026quot;UTF-8\u0026quot; #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å› ç‚ºWIN10ç”¨çš„æ˜¯ç³»çµ±çš„ç·¨ç¢¼,ä¹Ÿå°±æ˜¯native.lang,åæ­£å°±æ˜¯Encoding(x)çš„çµæœæ˜¯unknown\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rcat(x)\r#\u0026gt; #é€™æ˜¯æ¸¬è©¦æª”\r#\u0026gt; èº«é«˜,é«”é‡,æ€§åˆ¥\r#\u0026gt; 156,56,ç”·\r#\u0026gt; 167,66,å¥³\r#\u0026gt; 189,70,ç”·\r#\u0026gt; 180,,å¥³\r   å¦‚æœè¦è½‰ç¢¼: â“iconv(x,\u0026quot;UTF-8\u0026quot;,\u0026quot;zh_TW\u0026quot;)\n  \r\rè®€å…¥è³‡æ–™é›† å…ˆä»‹ç´¹å…§å»ºå‡½æ•¸read.csv()\nread.csv()è®€å…¥data.frame\nread.csv(\u0026quot;filename.csv\u0026quot;, #name of file\rheader = TRUE, #are there column names in 1st row?\rsep = \u0026quot;,\u0026quot;, #what separates rows?\ras.is = !stringsAsFactors, #ğŸ‘é—œæ‰å­—å…ƒè½‰factor\rcolClasses = NA #to convert everything to character data set to \u0026quot;character\u0026quot;\rna.string = \u0026quot;NA\u0026quot; #could be \u0026quot;.\u0026quot; for SAS files\rskip = 0, #è¦è·³éçš„å‰å¹¾è¡Œæ•¸ç›®\u0026gt;0\rstrip.white = TRUE, #æ“ æ‰ç©ºç™½,ä¾‹å¦‚ \u0026quot; 0.1\u0026quot; = \u0026quot;0.1\u0026quot;\rfill = TRUE, #fill in rows that have unequal numbers of columns\rcomment.char = \u0026quot;#\u0026quot;, #è¨»è§£ä¸è®€å…¥\rstringsAsFactors = FALSE #æ¯”as.is å¸¸ç”¨,é—œæ‰å­—å…ƒè½‰factor\r)\r æ¸¬è©¦read.csv()   read.csv()æœ€ç°¡å–®çš„ç”¨æ³•æ˜¯ç›´æ¥çµ¦æª”æ¡ˆåç¨±,ä¾‹å¦‚\nrst = read.csv('resources/wh.csv')\r ğŸä½†æ˜¯wh.csv å‰é¢æœ‰å¹¾è¡Œæ˜¯è¨»è§£\ncat(readLines('resources/wh.csv',n=3),sep=\u0026quot;\\n\u0026quot;) #\u0026gt; # this is a test file\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r##â“å¯ä¸å¯ä»¥æŠŠä¸Šé¢çš„catå¯«æˆå‡½æ•¸type()?\r# æç¤º\r\r#type\u0026lt;-function(path,n=-1L) { # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ç‚ºç”šéº¼çŸ¥é“ç”¨-1L,çœ‹å‡½æ•¸readLineçš„å…§å®¹\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rcat(readLines(path,n=n),sep=\u0026quot;\\n\u0026quot;)\r}\rtype('resources/wh.csv',3)\r#\u0026gt; # this is a test file\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r# \r   å› æ­¤åŠ ä¸Šskip åƒæ•¸\nrst = read.csv('resources/wh.csv',skip=1) #ğŸ·ğŸ‘ç¬¬ä¸€è¡Œæ˜¯æ¬„ä½åç¨±ä¸æ˜¯è³‡æ–™,å› æ­¤æŒ‡å®šè·³éç¬¬ä¸€è¡Œskip=1\rhead(rst)\r \rheight weight sex   156 56 m  167 . f  189 70 m  180  f     ğŸ‘ä¹Ÿå¯ä»¥åˆ©ç”¨åƒæ•¸comment.char\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;)\rhead(rst)\r height weight sex   156 56 m  167 . f  189 70 m  180  f       ä½†æ˜¯æ³¨æ„åˆ°weighté€™å€‹æ¬„ä½è¢«è½‰ç‚ºå­—ä¸²,å› ç‚ºæœ‰ä¸€å€‹ \u0026quot;.\u0026quot; ã€‚æœ‰äº›å¥—è£è»Ÿé«”çš„CSVè¼¸å‡ºå°‡NAè½‰ç‚º\u0026quot;.\u0026quot;,å› æ­¤\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.')\rhead(rst)\r height weight sex   156 56 m  167 NA f  189 70 m  180 NA f       æœ€å¾Œç·´ç¿’å¯«å‡ºæª”æ¡ˆ\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.')\rwrite.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, quote=F) # ğŸ·ğŸ‘ç·´ç¿’å¯«å‡ºæª”æ¡ˆ\rcat(readLines('MyData.csv'), sep = '\\n') # ğŸ·å…§å»º readLine()\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r#\u0026gt; 167,NA, f\r#\u0026gt; 189,70, m\r#\u0026gt; 180,NA, f\rtype('MyData.csv')\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r#\u0026gt; 167,NA, f\r#\u0026gt; 189,70, m\r#\u0026gt; 180,NA, f\rcat(readr::read_file(\u0026quot;MyData.csv\u0026quot;)) # ğŸ·åˆ©ç”¨å¥—ä»¶readr\r#\u0026gt; height,weight,sex\r#\u0026gt; 156,56, m\r#\u0026gt; 167,NA, f\r#\u0026gt; 189,70, m\r#\u0026gt; 180,NA, f\r   æ¸¬è©¦write.csv() æ¥çºŒä¸Šç¯€æœ€å¾Œä¸€å€‹æ­¥é©Ÿ,çœ‹çœ‹write.csv()å¯«å‡ºç”šéº¼æ±è¥¿(é€™æ¬¡å¯«åˆ°æš«å­˜æª”)?\n#ğŸ·ğŸ‘é™„ä»¶\rrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.') # ğŸ·ğŸ‘class(rst) = data.frame;\rfn\u0026lt;-tempfile(\u0026quot;tempData\u0026quot;) #ğŸ·ğŸ‘tempfile()æœƒå¾—åˆ°æš«å­˜æª”æ¡ˆåç¨±\rfn #ğŸ·ğŸ‘åŒ…æ‹¬è·¯å¾‘å’Œåç¨±,æ²’æœ‰å‰¯æª”å\r#\u0026gt; [1] \u0026quot;C:\\\\Users\\\\linchao\\\\AppData\\\\Local\\\\Temp\\\\RtmpQn5EuB\\\\tempData86243cbb54fd\u0026quot;\rwrite.csv(rst, file = fn)\rlines\u0026lt;-readLines(fn,n=3) # ğŸ·ğŸ‘åªè®€å…¥å‰3è¡Œ\rlines\r#\u0026gt; [1] \u0026quot;\\\u0026quot;\\\u0026quot;,\\\u0026quot;height\\\u0026quot;,\\\u0026quot;weight\\\u0026quot;,\\\u0026quot;sex\\\u0026quot;\u0026quot; \u0026quot;\\\u0026quot;1\\\u0026quot;,156,56,\\\u0026quot; m\\\u0026quot;\u0026quot; #\u0026gt; [3] \u0026quot;\\\u0026quot;2\\\u0026quot;,167,NA,\\\u0026quot; f\\\u0026quot;\u0026quot;\r â“å•é¡Œ:ä¸Šä¾‹ä¸­çš„è¼¸å‡ºç‚ºç”šéº¼æ²’æœ‰æ›è¡Œ?æç¤º\r #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ¯”è¼ƒä¸Šé¢åªæœ‰readLines()çš„è¼¸å‡º\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rcat(readLines(fn,n=3),sep=\u0026quot;\\n\u0026quot;) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ²’æœ‰sepåƒæ•¸,ä¾‹å¦‚\u0026lt;code\u0026gt;cat(readLines(fn,n=3))\u0026lt;/code\u0026gt;ä¹Ÿä¸æ›è¡Œ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; \u0026quot;\u0026quot;,\u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot; #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ³¨æ„,åŸä¾†æœ‰3å€‹æ¬„ä½,ä½†æ˜¯ç¾åœ¨é€™è£¡æœ‰4å€‹æ¬„ä½,ç¬¬ä¸€å€‹æ˜¯ç©ºçš„,å› ç‚ºå®ƒæ˜¯row names\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; \u0026quot;1\u0026quot;,156,56,\u0026quot; m\u0026quot;\r#\u0026gt; \u0026quot;2\u0026quot;,167,NA,\u0026quot; f\u0026quot;\r \n  ä¸Šä¾‹ä¸­çš„write.csv(),è¼¸å‡ºçµæœ,åŒ…å«äº†æ²’æ„ç¾©çš„æ©«è¡Œåç¨±(å°±ç·¨è™Ÿæ•¸å­—è€Œå·²)ã€‚\n  å¦‚æœä¸è¦å¯«é€²csv,å¯ä»¥åˆ©ç”¨åƒæ•¸ row.names=FALSEã€‚\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.')\rwrite.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE) #ğŸ·ğŸ‘row.names=Fä¸æƒ³è¦è¼¸å‡ºç„¡æ„ç¾©çš„æ©«è¡Œåç¨±\rreadLines(\u0026quot;MyData.csv\u0026quot;,n=3) #\u0026gt; [1] \u0026quot;\\\u0026quot;height\\\u0026quot;,\\\u0026quot;weight\\\u0026quot;,\\\u0026quot;sex\\\u0026quot;\u0026quot; \u0026quot;156,56,\\\u0026quot; m\\\u0026quot;\u0026quot; #\u0026gt; [3] \u0026quot;167,NA,\\\u0026quot; f\\\u0026quot;\u0026quot;\rcat(readLines(\u0026quot;MyData.csv\u0026quot;,n=3),sep=\u0026quot;\\n\u0026quot;) #\u0026gt; \u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot;\r#\u0026gt; 156,56,\u0026quot; m\u0026quot;\r#\u0026gt; 167,NA,\u0026quot; f\u0026quot;\rtype(\u0026quot;MyData.csv\u0026quot;,n=3)\r#\u0026gt; \u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot;\r#\u0026gt; 156,56,\u0026quot; m\u0026quot;\r#\u0026gt; 167,NA,\u0026quot; f\u0026quot;\r \rå°ç…§åŸä¾†çš„æ–‡å­—æª”\rmyData.csv\r```r\r\u0026quot;height\u0026quot;,\u0026quot;weight\u0026quot;,\u0026quot;sex\u0026quot; 156,56,\u0026quot; m\u0026quot; 167,NA,\u0026quot; f\u0026quot; 189,70,\u0026quot; m\u0026quot; 180,NA,\u0026quot; f\u0026quot; ```\råŸä¾†çš„æ–‡å­—æª”\r```r\r# this is a test file\rheight,weight,sex\r156,56, m\r167,., f #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘weightæœ‰ä¸€é»\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r189,70, m\r180,, f #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘weightæ˜¯ç©ºçš„\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r```\râ“å°ç…§ä¸€ä¸‹ä¸Šé¢sexæ¬„ä½,å¯ä»¥çœ‹è¦‹`, m` åˆ©ç”¨`read.csv` è®€å…¥æ™‚,è®Šæˆ\u0026quot; m\u0026quot;     å¦‚æœè¼¸å‡ºæ™‚,å­—ä¸²ä¸è¦é›™å¼•è™Ÿ,å‰‡å¯ä»¥ç”¨quote=FALSE\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.')\rwrite.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, quote=F) # ğŸ·é–‹é—œquote=F\rcat(readLines('MyData.csv'), sep = '\\n')\r   è³‡æ–™ä¸­æœ‰ç©ºç™½CELL,å¦‚æœè¦æŒ‡å®šNAçš„å€¼,å¯ä»¥åˆ©ç”¨æ¬„ä½=\u0026quot;\u0026quot;,å¦å‰‡é å®šæ˜¯NA\nrst = read.csv('resources/wh.csv',comment.char=\u0026quot;#\u0026quot;,na.string='.')\rwrite.csv(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, na=\u0026quot;\u0026quot;) # ğŸ·è¼¸å‡ºçš„æ–‡ä»¶ä¸­,é€™æ¬„æ˜¯ç©ºçš„\rcat(readLines(\u0026quot;MyData.csv\u0026quot;), sep = '\\n')\r   more å¦‚æœè¦æ›´å¤šçš„è¼¸å‡ºæ§åˆ¶å¯ä»¥åƒè€ƒå¯ä»¥write.table().\nå‡½æ•¸write.csv(),å¯¦éš›ä¸Šæœƒå†å‘¼å«write.table()å‡½æ•¸ã€‚\nä¾‹å¦‚,æ¬„ä½åç¨±ä¹Ÿä¸è¦è¼¸å‡ºçš„è©±,å¯ä»¥åˆ©ç”¨write.table()ï¼Œè¦è¨­å®šçš„åƒæ•¸å¦‚ä¸‹:\n sep=\u0026quot;,\u0026quot; :è¨­å®šæ¬„ä½çš„åˆ†éš”å­—å…ƒ col.names=FALSE : ä¸è¦æ¬„ä½åç¨±ã€‚ write.table(rst, file = \u0026quot;MyData.csv\u0026quot;,row.names=FALSE, na=\u0026quot;\u0026quot;,col.names=FALSE, sep=\u0026quot;,\u0026quot;)\rcat(readLines('MyData.csv'), sep = '\\n')\r  "},
{"uri": "/blogR//rlang/2_2_data_explorer.html","title": "2.2 è³‡æ–™æ¢ç´¢",
	"tags": ["t-test"],
	"description": "è³‡æ–™æ¢ç´¢",
	"content": "å¸¸ç”¨å‡½æ•¸  Mean Median Quartile Percentile Range Interquartile Range Box Plot Variance Standard Deviation Covariance Correlation Coefficient Central Moment Skewness : å¥—ä»¶ moments Kurtosis : å¥—ä»¶ moments  mean(mtcars$mpg)\r#\u0026gt; [1] 20.09062\rmedian(mtcars$mpg)\r#\u0026gt; [1] 19.2\rmin(mtcars$mpg)\r#\u0026gt; [1] 10.4\rmax(mtcars$mpg)\r#\u0026gt; [1] 33.9\rquantile(mtcars$mpg)\r#\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 10.400 15.425 19.200 22.800 33.900\rquantile(mtcars$mpg,c(0.2))\r#\u0026gt; 20% #\u0026gt; 15.2\rif(!require(moments))\rinstall.packages(\u0026quot;moment\u0026quot;)\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šmoments\rskewness(mtcars$mpg)\r#\u0026gt; [1] 0.6404399\rkurtosis(mtcars$mpg)\r#\u0026gt; [1] 2.799467\r x \u0026lt;- rnorm(100)\rquantile(x, probs = c(0, 0.25, 0.5, 0.75, 1)) # quantile of 0% 25% 50% ..\r#\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; -2.98699656 -0.49087057 0.08812317 0.79885838 2.03939058\r quantile(x, probs = seq(0, 1, by= 0.01)) # decile ecdf(x)\nå•é¡Œï¼šecdf()çš„çµæœå’Œquantile()çš„çµæœæ˜¯å¦ä¸€æ¨£ï¼Ÿ ## åŒ¯å…¥å…¶ä»–æ ¼å¼çš„è³‡æ–™\rå®‰è£package : `foreign`ï¼Œä»¥`stata` ç‚ºä¾‹(åˆ©ç”¨å…¶ä¸­çš„å‡½æ•¸`read.dta()`)ï¼š ```r?lang=r?class=.source?preclass=ms-5.w-75\rif (!file.exists('resources/ceosal1.RData')){\rceosal1\u0026lt;-read.dta(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/ceosal1.dta\u0026quot;)\rsave(ceosal1, file='resources/ceosal1.RData')\r}\r ä¾†è‡ªwooldridge çš„è³‡æ–™é›† è³‡æ–™ affairs\nload('resources/affairs.RData')\r# åŸå§‹è³‡æ–™kidæ˜¯æ•´æ•¸ï¼ŒåŠ å…¥æ¨™ç±¤æˆç‚ºfactor haskids \u0026lt;- factor(affairs$kids,labels=c(\u0026quot;no\u0026quot;,\u0026quot;yes\u0026quot;))\rmlab \u0026lt;- c(\u0026quot;very unhappy\u0026quot;,\u0026quot;unhappy\u0026quot;,\u0026quot;average\u0026quot;,\u0026quot;happy\u0026quot;, \u0026quot;very happy\u0026quot;)\rmarriage \u0026lt;- factor(affairs$ratemarr, labels=mlab)\r# Frequencies for having kids:\rtable(haskids)\r#\u0026gt; haskids\r#\u0026gt; no yes #\u0026gt; 171 430\r# Marriage ratings (share):\rprop.table(table(marriage))\r#\u0026gt; marriage\r#\u0026gt; very unhappy unhappy average happy very happy #\u0026gt; 0.0266223 0.1098170 0.1547421 0.3227953 0.3860233\r# Contigency table: counts (display \u0026amp; store in var.)\r(countstab \u0026lt;- table(marriage,haskids))\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 3 13\r#\u0026gt; unhappy 8 58\r#\u0026gt; average 24 69\r#\u0026gt; happy 40 154\r#\u0026gt; very happy 96 136\r# Share within \u0026quot;marriage\u0026quot; (i.e. within a row):\rprop.table(countstab, margin=1)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.1875000 0.8125000\r#\u0026gt; unhappy 0.1212121 0.8787879\r#\u0026gt; average 0.2580645 0.7419355\r#\u0026gt; happy 0.2061856 0.7938144\r#\u0026gt; very happy 0.4137931 0.5862069\r# Share within \u0026quot;haskids\u0026quot; (i.e. within a column):\rprop.table(countstab, margin=2)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.01754386 0.03023256\r#\u0026gt; unhappy 0.04678363 0.13488372\r#\u0026gt; average 0.14035088 0.16046512\r#\u0026gt; happy 0.23391813 0.35813953\r#\u0026gt; very happy 0.56140351 0.31627907\r å¦‚æœä¸çŸ¥é“å‡½æ•¸prop.table()\nçœ‹ä¸€ä¸‹è³‡æ–™çµæ§‹\nstr(x\u0026lt;-table(haskids))\r#\u0026gt; 'table' int [1:2(1d)] 171 430\r#\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 1\r#\u0026gt; ..$ haskids: chr [1:2] \u0026quot;no\u0026quot; \u0026quot;yes\u0026quot;\r ä¸Šé¢çš„çµæ§‹é¡¯ç¤ºï¼Œ\n int [1:2(1d)] 171 430 : æ•´æ•¸å‘é‡ï¼Œé•·åº¦ç”±1åˆ°2ï¼Œæ˜¯å€‹1ç¶­å‘é‡ã€‚å…ƒç´ 1åˆ°2çš„å…§å®¹åˆ†åˆ¥æ˜¯171,430ã€‚ å¯ä»¥ç”±dimnames(x)å¾—åˆ°ä¸€å€‹list,è£¡é¢åªæœ‰ä¸€å€‹å…ƒç´ ï¼Œé€™å€‹å…ƒç´ åˆæ˜¯ä¸€å€‹char list(é•·åº¦ç‚º2)ã€‚\nå› æ­¤å¯ä»¥è©¦è©¦çœ‹  x/sum(x)\r#\u0026gt; haskids\r#\u0026gt; no yes #\u0026gt; 0.2845258 0.7154742\r çµæœæ‡‰è©²å’Œprop.table()ä¸€æ¨£ã€‚\né‚£éº¼2 way å‘¢ï¼Ÿ ä¹Ÿæ˜¯å…ˆçœ‹çµæ§‹ï¼š\nstr(countstab \u0026lt;- table(marriage,haskids))\r#\u0026gt; 'table' int [1:5, 1:2] 3 8 24 40 96 13 58 69 154 136\r#\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; ..$ marriage: chr [1:5] \u0026quot;very unhappy\u0026quot; \u0026quot;unhappy\u0026quot; \u0026quot;average\u0026quot; \u0026quot;happy\u0026quot; ...\r#\u0026gt; ..$ haskids : chr [1:2] \u0026quot;no\u0026quot; \u0026quot;yes\u0026quot;\rcountstab/rowSums(countstab)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.1875000 0.8125000\r#\u0026gt; unhappy 0.1212121 0.8787879\r#\u0026gt; average 0.2580645 0.7419355\r#\u0026gt; happy 0.2061856 0.7938144\r#\u0026gt; very happy 0.4137931 0.5862069\rcountstab/colSums(countstab)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.01754386 0.03023256\r#\u0026gt; unhappy 0.01860465 0.33918129\r#\u0026gt; average 0.14035088 0.16046512\r#\u0026gt; happy 0.09302326 0.90058480\r#\u0026gt; very happy 0.56140351 0.31627907\r#??countstab/colsum(countstab)\r ceosal1\nload('resources/ceosal1.RData')\r# sample average:\rmean(ceosal1$salary)\r#\u0026gt; [1] 1281.12\r# sample median:\rmedian(ceosal1$salary)\r#\u0026gt; [1] 1039\r#standard deviation:\rsd(ceosal1$salary)\r#\u0026gt; [1] 1372.345\r# summary information:\rsummary(ceosal1$salary)\r#\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 223 736 1039 1281 1407 14822\r# correlation with ROE:\rcor(ceosal1$salary, ceosal1$roe)\r#\u0026gt; [1] 0.1148417\rboxplot(ceosal1$roe,horizontal = T)\r figure\r boxplot(ceosal1$roe~ceosal1$consprod)\r figure\r åˆ†çµ„ ç›®çš„ï¼šåˆ†çµ„æ±‚çµ±è¨ˆé‡ å¤§ç¶±æ˜¯ï¼šå…ˆæ¢ç´¢ä¸€ä¸‹æˆ‘å€‘å¯èƒ½ç”¨åˆ°çš„Rèªè¨€æŠ€å·§ï¼Œç„¶å¾Œæ˜¯å¯«æˆå‡½æ•¸ã€‚\næ–¹æ³•1: åˆ©ç”¨ forè¿´åœˆ å¦‚æœä¸åˆ†çµ„\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\rsummary(dframe)\r#\u0026gt; age group #\u0026gt; Min. : 5.212 Min. :1.0 #\u0026gt; 1st Qu.:26.742 1st Qu.:1.0 #\u0026gt; Median :33.212 Median :1.0 #\u0026gt; Mean :29.216 Mean :1.4 #\u0026gt; 3rd Qu.:35.142 3rd Qu.:2.0 #\u0026gt; Max. :36.780 Max. :2.0\r data.frame çš„recordç¯©é¸ï¼Œå¯ä»¥åˆ©ç”¨é‚è¼¯å€¼ç´¢å¼•ä¾†ç¯©é¸åˆ†çµ„ï¼Œé€™è£¡çš„ç¯„ä¾‹éƒ½æ˜¯æ±‚å¾—ä¸€çµ„(ä»¥ç¬¬ä¸€åˆ†é¡ç‚ºä¾‹)ï¼š\nft\u0026lt;-factor(dframe$group)\rgn\u0026lt;-length(levels(ft)) # nlevels(ft)\rgf\u0026lt;-ft==levels(ft)[1] # ç¬¬ä¸€çµ„\rg1\u0026lt;-dframe[gf,]\rg1\r  age group   1 23.0883 1  2 25.8344 1  3 29.4648 1  5 33.6372 1  6 34.9350 1  10 36.7803 1     é™¤äº†ä¸Šé¢çš„ç¯©é¸æ–¹å¼ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨%in%\nft\u0026lt;-factor(dframe$group)\rgn\u0026lt;-length(levels(ft)) # nlevels(ft)\rgf\u0026lt;-as.numeric(levels(ft)[1]) # ç¬¬ä¸€çµ„\rg1\u0026lt;-dframe[group %in% gf,] # ä¸æ˜¯ gf %in% group\rrst\u0026lt;-summary(g1)\rrst[4,1]\r#\u0026gt; [1] \u0026quot;Mean :30.62 \u0026quot;\rrst[4,2]\r#\u0026gt; [1] \u0026quot;Mean :1 \u0026quot;\r æœ€å¾Œçš„ç¨‹å¼ç¢¼ï¼š\nft\u0026lt;-factor(dframe$group)\rrst \u0026lt;- as.list(numeric(nlevels(ft)))\rnames(rst)\u0026lt;-levels(ft)\rfor (gi in levels(ft) ){\rgf\u0026lt;-as.numeric(gi)\rg1\u0026lt;-dframe[group %in% gf,] t\u0026lt;-summary(g1)\rrst[gi]=t[4,1]\r}\rprint(rst)\r#\u0026gt; $`1`\r#\u0026gt; [1] \u0026quot;Mean :30.62 \u0026quot;\r#\u0026gt; #\u0026gt; $`2`\r#\u0026gt; [1] \u0026quot;Mean :27.105 \u0026quot;\r å‡½æ•¸summary()çš„çµæœæ˜¯ä¸€å€‹tableï¼Œä½†æ˜¯è€Œä¸”è£¡é¢çš„å…ƒç´ æ˜¯ã€Œå­—ä¸²ã€ï¼Œä¾‹å¦‚\nage group Min. : 5.212 Min. :1.0 1st Qu.:26.742 1st Qu.:1.0 Median :33.212 Median :1.0 Mean :29.216 Mean :1.4 3rd Qu.:35.142 3rd Qu.:2.0 Max. :36.780 Max. :2.0  ä½†æ˜¯åœ¨å¾ˆå¤šæƒ…æ³ä¸‹ï¼Œæˆ‘å€‘å¸Œæœ›å¯ä»¥è‡ªå·±å¯ä»¥æ§åˆ¶çš„æ ¼å¼ä¾¿æ–¼é€²æ­¥åˆ†æã€‚ä¾‹å¦‚ï¼Œè¦ä¸€å€‹çŸ©é™£ï¼Œæ­¤æ™‚å¯ä»¥åˆ©ç”¨sub()ï¼š as.numeric(sub('.*:', '', summary(dframe)[4,1]))\n\r\ræ–¹æ³•2:ã€€å‡½æ•¸aggregate() aggregate(dframe$age, by=list(dframe$group), FUN=mean)\r Group.1 x   1 30.62333  2 27.10507     aggregate(dframe$age, by=list(dframe$group), FUN=mean)[2]\r \rx   30.62333  27.10507     aggregate()å‚³å›data.frameï¼Œè½‰çŸ©é™£åˆ©ç”¨as.matrix()\nç·´ç¿’ï¼š ä¸Šé¢çš„ç¯„ä¾‹æ˜¯æ¯çµ„æ±‚å¾—ä¸€å€‹å€¼ï¼Œå¦‚æœæ˜¯å¤šå€‹å‘¢ï¼Ÿä¾‹å¦‚åˆ©ç”¨aggregate()æ±‚å¾—æ¯çµ„min,max,median,q25,q75 ?\næ–¹æ³•3: å‡½æ•¸ã€€tapply f1\u0026lt;-function(im)\r{\rc(min(im),median(im),mean(im),max(im))\r}\rrst\u0026lt;-tapply(dframe$age,dframe$group,FUN = f1)#çµæœæ˜¯listå…©å€‹å…ƒç´ ï¼Œåˆ†åˆ¥å°æ‡‰f1çš„è¨ˆç®—çµæœ\rrstm\u0026lt;-unlist(rst) # unlist æœƒæŠŠrst è®Šæˆ1ç¶­å‘é‡\rrstm\u0026lt;-matrix(rstm,ncol=2) # hard code2 , try `length(levels(factor(dframe$group)))`\rrownames(rstm)\u0026lt;-c(\u0026quot;min\u0026quot;,\u0026quot;median\u0026quot;,\u0026quot;mean\u0026quot;,\u0026quot;max\u0026quot;)\rcolnames(rstm)\u0026lt;-paste(\u0026quot;çµ„åˆ¥:\u0026quot;,levels(factor(dframe$group)))\rrstm\r#\u0026gt; çµ„åˆ¥: 1 çµ„åˆ¥: 2\r#\u0026gt; min 23.08830 5.21150\r#\u0026gt; median 31.55100 33.99865\r#\u0026gt; mean 30.62333 27.10507\r#\u0026gt; max 36.78030 35.21150\r æ–¹æ³•3 åˆ©ç”¨å…¶ä»–å¥—ä»¶ library(dplyr)\rdt \u0026lt;- data.frame(age=rchisq(20,10), group=sample(1:2,20, rep=T))\rgrp \u0026lt;- group_by(dt, group)\rsummarise(grp, mean=mean(age), sd=sd(age))\rdetach(\u0026quot;package:dplyr\u0026quot;, unload=TRUE)\r plot é€™è£¡çš„åˆ†çµ„ä¸èƒ½ç”¨ä¹‹å‰çš„hard code ä¸­æåˆ°çš„æ–¹æ³•ï¼Œå› ç‚ºå„çµ„å¯èƒ½æ•¸é‡ä¸åŒã€‚\nv1\u0026lt;-c(1,2,3)\rv2\u0026lt;-c(4,4)\rcbind(v1,v2)\r#\u0026gt; Warning in cbind(v1, v2): number of rows of result is not a multiple of vector\r#\u0026gt; length (arg 2)\r#\u0026gt; v1 v2\r#\u0026gt; [1,] 1 4\r#\u0026gt; [2,] 2 4\r#\u0026gt; [3,] 3 4\r rbind(v1,v2) ç™¼ç”ŸéŒ¯èª¤ï¼Œæ˜¯å¦åªèƒ½ç”¨æ–¼data.frame\nå•é¡Œï¼š å¦‚æœæƒ³è¦åˆä½µå…©å€‹å‘é‡ï¼ŒåŒæ™‚å¦‚æœé•·åº¦ä¸ä¸€æ¨£ï¼Œå°±çŸ­çš„å‘é‡å°±è£œNAè¦æ€éº¼åšï¼Ÿç·´ç¿’å¯«æˆå‡½æ•¸ã€‚\n#\u0026gt; v1 v2\r#\u0026gt; [1,] 1 4\r#\u0026gt; [2,] 2 4\r#\u0026gt; [3,] 3 NA\r ç·´ç¿’:\nå·²ç¶“çŸ¥é“boxplot()çš„åƒæ•¸å¦‚æœå‚³é€²çŸ©é™£æˆ–è³‡æ–™é›†ï¼Œå°‡å°æ¯ä¸€å€‹æ¬„ä½ä½œåœ–\nnote:boxplotåƒ y~xå›æ­¸å¼,ä¾‹å¦‚\nboxplot(formula = Ozone ~ Month, # Y ~ X data = airquality, # è³‡æ–™\rxlab = \u0026quot;Month\u0026quot;, ylab = \u0026quot;Ozone (ppb)\u0026quot;, col =\u0026quot;red\u0026quot;)\r boxplot(matrix(rnorm(100),ncol=2))\r figure\r ç¾åœ¨è¦åˆ†çµ„å°å¹´é½¡boxplot,è«‹å¯«å‡ºç¨‹å¼ç¢¼ï¼Œè³‡æ–™å¦‚ä¸‹ï¼š\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\r hint: æ¯çµ„é•·åº¦å¯èƒ½ä¸ä¸€æ¨£ï¼Œéœ€è¦è£œNA\nfigure\r\nhint: æœ€ç°¡å–®çš„å¯«æ³• boxplot(age~group)\n\u0026lt;1\u0026gt; FUN.Name æœƒè·‘åˆ°mathch.fun() é€™å€‹å‡½æ•¸ï¼Œè€Œé€™å€‹å‡½æ•¸æ˜¯ç”¨å­—ä¸²æœå°‹\nm2: ç¾åœ¨æƒ³è¦æŠŠrstè½‰æˆdata.frameã€‚\nå…ˆçœ‹ä¸€ä¸‹ç¤ºç¯„ï¼Œå¦‚ä½•æŠŠlist è½‰æˆ data.frame\n# è§£é‡‹çµæœ,å•stringsAsFactors=F æœ‰ä»€éº¼æ•ˆæœï¼Ÿ\rtest1 \u0026lt;- list( c(a='a',b='b',c='c'), c(a='d',b='e',c='f'))\rd1\u0026lt;-as.data.frame(test1)\rd1\r  c.a....a...b....b...c....c.. c.a....d...b....e...c....f..   a a d  b b e  c c f     # ok\rtest2 \u0026lt;- list(a = c(1, 2, 3), b = c(4, 5, 6))\rd2\u0026lt;-as.data.frame(test2)\rd2\r a b   1 4  2 5  3 6    "},
{"uri": "/blogR//rlang/2_3_data_explorer.html","title": "2.3 è³‡æ–™æ¢ç´¢",
	"tags": [],
	"description": "2_3_data_explorer",
	"content": "ç›®çš„ ç·´ç¿’æ’°å¯«å‡½æ•¸,åˆ©ç”¨data.frame,levels,factor\nç·´ç¿’å•é¡Œ å¾ç¾æœ‰è³‡æ–™é›†ä¸­, åˆ†å‡ºå„çµ„è³‡æ–™ã€‚\nğŸ’¡å¯ä»¥ä½¿ç”¨ç®¡é“æ–¹å¼,æ¯”è¼ƒç°¡æ½”ã€‚\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\r åˆ†çµ„åˆ—å‡ºsummary:åˆ©ç”¨è‡ªå·±çš„å‡½æ•¸ age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\rmygroup\u0026lt;-function(df,g,idx)\r{\rft\u0026lt;-factor(df$g)\rgf\u0026lt;-ft==levels(ft)[idx] # ç¬¬ä¸€çµ„\rg1\u0026lt;-df[gf,]\rreturn(g1) }\rx\u0026lt;-mygroup(dframe,\u0026quot;group\u0026quot;,1)\r å•é¡Œï¼š ç¾åœ¨æŠŠæŸå€‹æ¬„ä½ä¾æ“šåˆ†çµ„ç•«å‡ºboxplot A:age B:group(1,2) ä¸è¶³çš„è£œNA,æ¯ä¸€æ¬„æˆç‚ºçŸ©é™£ï¼Œä¾‹å¦‚å…±å…©çµ„ï¼Œé‚£éº¼çŸ©é™£æ¬„ä½å°±æ˜¯2ï¼Œæ¯”æ•¸ç‚ºå„çµ„è³‡æ–™ï¼Œé•·åº¦ä¸å¤ è£œnaï¼Œ æœ€å¾Œ boxplot(mtx)\nage = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\rgf\u0026lt;-group==1\rg1\u0026lt;-dframe[gf,1]\rgf\u0026lt;-group==2\rg2\u0026lt;-dframe[gf,1]\rmlen\u0026lt;-max(length(g1),length(g2))\rlength(g1)\u0026lt;-mlen\rlength(g2)\u0026lt;-mlen\rmtx\u0026lt;-cbind(g1,g2)\rboxplot(mtx)\r figure\r age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372,\r34.935, 35.2115, 35.2115, 5.2115, 36.7803)\rgroup = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1)\rdframe = data.frame(age=age, group=group)\rvl\u0026lt;-list()\rfor (i in 1:2){\rgf\u0026lt;-group==i\rg1\u0026lt;-dframe[gf,1]\rvl[[i]]\u0026lt;-g1\r}\rgn\u0026lt;-sapply(vl,length)\rgn\u0026lt;-max(gn)\rvl\u0026lt;-lapply(vl,`length\u0026lt;-`,gn) # è£œNA\rmtx\u0026lt;-matrix(unlist(vl),nrow=gn)\rboxplot(mtx)\r figure\r summary(dframe)\rft\u0026lt;-factor(dframe$group)\rgn\u0026lt;-length(levels(ft)) # nlevels(ft)\rgf\u0026lt;-ft==levels(ft)[1] # ç¬¬ä¸€çµ„\rg1\u0026lt;-dframe[gf,]\rsummary(g1)\rgf\u0026lt;-ft==levels(ft)[2] # ç¬¬ä¸€çµ„\rg2\u0026lt;-dframe[gf,]\rsummary(g2)\rmygroup\u0026lt;-function(df,g,idx)\r{\rft\u0026lt;-factor(df$g)\rgf\u0026lt;-ft==levels(ft)[idx] # ç¬¬idxçµ„\rg1\u0026lt;-df[gf,]\rreturn(g1) }\rfor (i in 1:2){\rx\u0026lt;-mygroup(dframe,\u0026quot;group\u0026quot;,i) print(summary(x))\r}\r"},
{"uri": "/blogR//rlang/3_quickview1.html","title": "3. Quick view 1",
	"tags": [],
	"description": "3_quickview1",
	"content": "åƒè€ƒå¸– base cheat sheet package glu\nå¿«é€ŸæŒ‡ä»¤\nç›®å‰æœ‰å“ªäº›è³‡æ–™é›†å¯ä»¥æ¸¬è©¦ data() attach() ä¸€èˆ¬æ˜¯\nlibrary(sample)\rdata(\u0026quot;mydata\u0026quot;)\r attach(\u0026quot;mydata\u0026quot;) å°±ä¸ç”¨æ‰“å…¥mydata$æ¬„ä½åç¨±\nå¹¾å€‹å¸¸ç”¨çš„çµ±è¨ˆé‡: x\u0026lt;-c(1,2,3)\rmedian(x)\rmean(x)\rmin(x)\rsd(x)\rrange(x)\rdiff(x)\r è³‡æ–™å‹æ…‹å’Œå…§å®¹ å¯ä»¥å…ˆçœ‹çœ‹è³‡æ–™æè¿° ?mtcars\nmtcars\r  mpg cyl disp hp drat wt qsec vs am gear carb   Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4  Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4  Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1  Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1  Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2  Valiant 18.1 6 225.0 105 2.76 3.460 20.22 1 0 3 1  Duster 360 14.3 8 360.0 245 3.21 3.570 15.84 0 0 3 4  Merc 240D 24.4 4 146.7 62 3.69 3.190 20.00 1 0 4 2  Merc 230 22.8 4 140.8 95 3.92 3.150 22.90 1 0 4 2  Merc 280 19.2 6 167.6 123 3.92 3.440 18.30 1 0 4 4  Merc 280C 17.8 6 167.6 123 3.92 3.440 18.90 1 0 4 4  Merc 450SE 16.4 8 275.8 180 3.07 4.070 17.40 0 0 3 3  Merc 450SL 17.3 8 275.8 180 3.07 3.730 17.60 0 0 3 3  Merc 450SLC 15.2 8 275.8 180 3.07 3.780 18.00 0 0 3 3  Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.250 17.98 0 0 3 4  Lincoln Continental 10.4 8 460.0 215 3.00 5.424 17.82 0 0 3 4  Chrysler Imperial 14.7 8 440.0 230 3.23 5.345 17.42 0 0 3 4  Fiat 128 32.4 4 78.7 66 4.08 2.200 19.47 1 1 4 1  Honda Civic 30.4 4 75.7 52 4.93 1.615 18.52 1 1 4 2  Toyota Corolla 33.9 4 71.1 65 4.22 1.835 19.90 1 1 4 1  Toyota Corona 21.5 4 120.1 97 3.70 2.465 20.01 1 0 3 1  Dodge Challenger 15.5 8 318.0 150 2.76 3.520 16.87 0 0 3 2  AMC Javelin 15.2 8 304.0 150 3.15 3.435 17.30 0 0 3 2  Camaro Z28 13.3 8 350.0 245 3.73 3.840 15.41 0 0 3 4  Pontiac Firebird 19.2 8 400.0 175 3.08 3.845 17.05 0 0 3 2  Fiat X1-9 27.3 4 79.0 66 4.08 1.935 18.90 1 1 4 1  Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.70 0 1 5 2  Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.90 1 1 5 2  Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.50 0 1 5 4  Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.50 0 1 5 6  Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.60 0 1 5 8  Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.60 1 1 4 2     head(mtcars)\r  mpg cyl disp hp drat wt qsec vs am gear carb   Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4  Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4  Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1  Hornet 4 Drive 21.4 6 258 110 3.08 3.215 19.44 1 0 3 1  Hornet Sportabout 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2  Valiant 18.1 6 225 105 2.76 3.460 20.22 1 0 3 1     tail(mtcars)\r \r mpg cyl disp hp drat wt qsec vs am gear carb   Porsche 914-2 26.0 4 120.3 91 4.43 2.140 16.7 0 1 5 2  Lotus Europa 30.4 4 95.1 113 3.77 1.513 16.9 1 1 5 2  Ford Pantera L 15.8 8 351.0 264 4.22 3.170 14.5 0 1 5 4  Ferrari Dino 19.7 6 145.0 175 3.62 2.770 15.5 0 1 5 6  Maserati Bora 15.0 8 301.0 335 3.54 3.570 14.6 0 1 5 8  Volvo 142E 21.4 4 121.0 109 4.11 2.780 18.6 1 1 4 2     head å‰å¹¾ç­†è³‡æ–™ tail å¾Œå¹¾ç­†è³‡æ–™\nç·¨è¼¯/ç€è¦½è³‡æ–™ edit(mtcars)\rdata.entry(mtcars)\rView(mtcars)\r å€‹åˆ¥æ¬„ä½ å¦‚æœè¦é¡¯ç¤ºå€‹åˆ¥æ¬„ä½,ä¸€èˆ¬å¯ä»¥æ˜¯mtcars$mpg,ä½†æ˜¯å¦‚æœè¦ç›´æ¥ä½¿ç”¨mpgæ¬„ä½,å¯ä»¥åˆ©ç”¨attach()\nattach(mtcars)\rmpg\r è³ªæ€§æ•¸æ“šçš„åˆ†æ æ¬„ä½cylç‚ºè³ªæ€§è®Šæ•¸,å¯ä»¥åˆ©ç”¨tableåˆ†æ\nattach(mtcars)\rtable(mtcars$cyl)\r#\u0026gt; #\u0026gt; 4 6 8 #\u0026gt; 11 7 14\r é »ç‡åœ–\nattach(mtcars)\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 3):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\rbarplot(table(mtcars$cyl))\r figure\r è§£é‡‹ä¸‹é¢å…©å€‹åœ–ç‚ºç”šéº¼ä¸ä¸€æ¨£?\nattach(mtcars)\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 3):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 4):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\rv\u0026lt;-as.vector(table(mtcars$cyl))\rbarplot(v)\r figure\n\rattach(mtcars)\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 3):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 4):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª mtcars (pos = 5):\r#\u0026gt; #\u0026gt; am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt\rm\u0026lt;-as.matrix(table(mtcars$cyl))\rbarplot(m)\r figure\n\rä¸Šé¢å…©å€‹åœ–ä¸ä¸€æ¨£,å› ç‚ºtable()çš„å®šç¾©,æ‰€ä»¥è½‰æˆçŸ©é™£ä»¥å¾Œæ˜¯3x1ã€‚\nx\u0026lt;-c(1,1,1)\rx1\u0026lt;-as.matrix(x)\rx2\u0026lt;-as.table(x)\rx3\u0026lt;-table(x)\rx1\rx2\rx3\r  [,1]\r[1,] 1\r[2,] 1\r[3,] 1\r# x2 åŸåœ°è½‰\rA B C 1 1 1 # x3 : è¨ˆç®—1æœ‰å¹¾å€‹\rx\r1 3  \r\rbarplot(c(11,7,4))\r figure\r barplot(mtcars$mpg)\r figure\r barplot(mtcars$cyl)\r figure\r assignment  \u0026lt;-å’Œ -\u0026gt; æ˜¯ä¸€å° ï¼Œå¯ä»¥å‘å·¦å’Œå‘å³è³¦å€¼ = æ˜¯å–®å‘çš„ ï¼Œä½œç”¨å’Œ\u0026lt;-åŸºæœ¬ç›¸åŒï¼Œä½†å°å‡½æ•¸ä¸­çš„è®Šæ•¸é€šå¸¸ä½¿ç”¨= \u0026lt;\u0026lt;- é€™å€‹æ˜¯å…¨åŸŸè³¦å€¼ ï¼Œè·Ÿè®Šæ•¸çš„ä½œç”¨åŸŸæœ‰é—œï¼Œé–‹ç™¼è‡ªå·±çš„å¥—ä»¶(package)çš„æ™‚å€™,å¸¸ç”¨ã€‚  ##Delete x (if it exists)\rrm(x)\r#\u0026gt; Warning in rm(x): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x'\rmean(x = 1:10) #[1] 5.5\r#\u0026gt; [1] 5.5\rx #Error: object 'x' not found\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x'\r è§€å¯Ÿä¸Šé¢çš„x,ç¬¬ä¸€è¡ŒæŒ‡ä»¤å¾ç’°å¢ƒä¸­å»æ‰è®Šæ•¸xçš„å®šç¾©ã€‚ ç¬¬2è¡Œä¸­çš„xæ˜¯åœ¨block ä¸­å®šç¾©ï¼Œå› æ­¤åŸ·è¡Œå®Œä»¥å¾Œ,æœƒè¢«æ®ºæ‰ã€‚å› æ­¤ç¬¬ä¸‰è¡ŒæŒ‡ä»¤,å‡ºç¾æ‰¾ä¸åˆ°xçš„æç¤ºã€‚\nå¾Œé¢æ¸¬è©¦\u0026lt;- operator:\nmean(x \u0026lt;- 1:10) # [1] 5.5\r#\u0026gt; [1] 5.5\rx\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10\r  x # [1] 1 2 3 4 5 6 7 8 9 10\n This time the x variable is declared within the user workspace. When does the assignment take place ? In the code above, you may be tempted to thin that we â€œassign 1:10 to x, then calculate the mean. â€ This would be true for #languages such as C, but it isn â€™t true in R. Consider the following function:\na \u0026lt;- 1\rf \u0026lt;- function(a) return(TRUE)\rf \u0026lt;- f(a \u0026lt;- a + 1);\r# è¼¸å‡º:TRUE\ra # çµæœ=1 #\u0026gt; [1] 1\r æ³¨æ„ä¸Šé¢açš„å€¼,ä»ç„¶æ˜¯1ã€‚åŸå› æ˜¯å› ç‚ºRçš„ç·¨è­¯å™¨,åœ¨æœ€ä½³åŒ–çš„æ™‚å€™,çŸ¥é“å‡½æ•¸ä¸­æ²’ç”¨åˆ°åƒæ•¸,å› æ­¤æ ¹æœ¬æ²’æœ‰å­˜å–åˆ°è®Šæ•¸a,å› æ­¤ï¼ŒåŸä¾†çš„aæ˜¯ç”šéº¼,aä»ç„¶æ˜¯ç”šéº¼ã€‚\nç°¡å–®è¬›å°±æ˜¯f(a\u0026lt;-a+1)ä¸­çš„a\u0026lt;-a+1 è¢«å»æ‰ä¸æœƒè¢«åŸ·è¡Œ\nf(a\u0026lt;-a+1) =\u0026gt; f()\nrewrite\nf \u0026lt;- function(a) {\rif (runif(1) \u0026gt; 0.5) TRUE else a\r} f(a \u0026lt;- a + 1);\r#\u0026gt; [1] TRUE\ra # result 2\r#\u0026gt; [1] 1\r é€™å€‹å‡½æ•¸fç”¨åˆ°äº†åƒæ•¸a,ä½†æ˜¯ç·¨è­¯å™¨é€™æ¬¡æ²’é‚£éº¼è°æ˜,çŸ¥é“ä½¿ç”¨è€…ç”¨aä¾†åšç”šéº¼,é›–ç„¶é€™å€‹å‡½æ•¸çš„bodyä»ç„¶æ²’æœ‰å‹•åˆ°a,ä½†æ˜¯é€™æ¬¡f(a\u0026lt;-a+1)ä¸­çš„a\u0026lt;-a+1 æœƒè¢«åŸ·è¡Œã€‚\nç·´ç¿’\n å…ˆå»æ‰ç’°å¢ƒä¸­çš„è®Šæ•¸a,ç„¶å¾Œåœ¨åŸ·è¡Œä¸Šé¢çš„chunk.   hint: rm(a)  æç¤º\r \nf(a \u0026lt;- a + 1);\r# TRUE\ra # 2\r#\u0026gt; [1] 2\r f(a \u0026lt;- a + 1);\ra #3\r#\u0026gt; [1] 3\r a\u0026lt;-1;\rf \u0026lt;- function(a) return(a);\rinvisible(f(a=a+1)) a\r#\u0026gt; [1] 1\rinvisible(f(a\u0026lt;-a+1))\ra\r#\u0026gt; [1] 2\r ä¸Šé¢ç¨‹å¼ä¸­,invisibleå‡½æ•¸åœ¨é€™è£¡çš„èªªæ˜ä¸é‡è¦,åªæ˜¯ç”¨ä¾†éš±è—è¨ˆç®—çµæœã€‚\na\u0026lt;-1;\rf \u0026lt;- function(a) return(3);\rinvisible(f(a=a+1))\ra\r#\u0026gt; [1] 1\rinvisible(f(a\u0026lt;-a+1))\ra\r#\u0026gt; [1] 1\r =ç”¨åœ¨åƒæ•¸æŒ‡æ´¾ ä¾‹å¦‚\nmatrix(1:20, ncol = 4)\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 1 6 11 16\r#\u0026gt; [2,] 2 7 12 17\r#\u0026gt; [3,] 3 8 13 18\r#\u0026gt; [4,] 4 9 14 19\r#\u0026gt; [5,] 5 10 15 20\rncol\r#\u0026gt; function (x) #\u0026gt; dim(x)[2L]\r#\u0026gt; \u0026lt;bytecode: 0x00000000189dc6a8\u0026gt;\r#\u0026gt; \u0026lt;environment: namespace:base\u0026gt;\r ç”¢ç”Ÿ5X4çŸ©é™£ã€‚å¦‚æœ\nmatrix(1:20, ncol \u0026lt;- 4)\r#\u0026gt; [,1] [,2] [,3] [,4] [,5]\r#\u0026gt; [1,] 1 5 9 13 17\r#\u0026gt; [2,] 2 6 10 14 18\r#\u0026gt; [3,] 3 7 11 15 19\r#\u0026gt; [4,] 4 8 12 16 20\rncol\r#\u0026gt; [1] 4\r æœƒç”¢ç”Ÿä¸€å€‹è®Šæ•¸ ncolï¼Œé€™è£¡ç”¢ç”Ÿçš„ç‚º4x5çš„çŸ©é™£ã€‚ç‚ºç”šéº¼?å› ç‚ºé€™è£¡çš„ç¬¬2å€‹åƒæ•¸ncol\u0026lt;-4,æŒ‡æ´¾çµ¦è®Šæ•¸ncol,ç„¶å¾Œé€™å€‹expressionæœƒreturn 4,è€Œ4å°±è¢«ç•¶æˆç¬¬2å€‹åƒæ•¸,ä¹Ÿå°±æ˜¯matrix(1:20, ncol \u0026lt;- 4)ç­‰åŒæ–¼matrix(1:20, 4),ä¹Ÿå°±æ˜¯æŒ‡å®šROWçš„ç¶­åº¦ã€‚\nçµè«–:x\u0026lt;-3 \u0026lt;-æœƒåœ¨å…¨å±€ç”¢ç”Ÿè®Šæ•¸xç„¶å¾ŒæŒ‡æ´¾3\n(x \u0026lt;- 3)\r#\u0026gt; [1] 3\r#rm(list = ls())\rrm(x)\rls()\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;f\u0026quot; \u0026quot;m\u0026quot; \u0026quot;ncol\u0026quot; \u0026quot;v\u0026quot;\r(x = 3)\r#\u0026gt; [1] 3\rls()\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;f\u0026quot; \u0026quot;m\u0026quot; \u0026quot;ncol\u0026quot; \u0026quot;v\u0026quot; \u0026quot;x\u0026quot;\r å› ç‚ºxæ˜¯åƒæ•¸åç¨±ä¸æ˜¯è®Šæ•¸,çœ‹mean help\n"},
{"uri": "/blogR//rlang/4_1_1_type_%E5%9F%BA%E6%9C%AC.html","title": "4.1 åŸºæœ¬",
	"tags": [],
	"description": "ä¸»è¦ä»‹ç´¹åŸºæœ¬èªæ³•",
	"content": "åŸºæœ¬æ“ä½œ  æ“ä½œé€šå¸¸å’Œè³‡æ–™çµæ§‹ç›¸é—œ,å¯ä»¥åƒè€ƒ è³‡æ–™çµæ§‹\n åœ¨Rèªè¨€ä¸­,å‹æ…‹ä¸é ˆç¶“éå®£å‘Š(declared)ã€‚ ä¸€å€‹è®Šæ•¸çš„å‹æ…‹ç¶“ç”±assignmentçš„éç¨‹æ±ºå®š,å³\u0026lt;-å³é‚Šçš„R-Objectsã€‚ä¹Ÿå°±æ˜¯åœ¨æŒ‡æ´¾è®Šæ•¸å€¼çš„æ™‚å€™,åŒæ™‚æ±ºå®šäº†å‹æ…‹ã€‚\nåŸºæœ¬çš„ R-objectæœ‰ âˆ’\n Vectors Lists Matrices Arrays Factors Data Frames  æœ€ç°¡å–®çš„æ˜¯vectorç‰©ä»¶,atomic vector æœ‰6ç¨®data types(æœ‰æ™‚ä¹Ÿå«åš 6 å€‹classes)\nData Type Example   Logical TRUE, FALSE  Numeric 1.3, 5, 99  Integer 3L, 24L, 0L  Complex 5 + 4i  Character 'b' , \u0026quot;good\u0026quot;, \u0026quot;TRUE\u0026quot;, '23.4'  Raw \u0026quot;Hello\u0026quot; is stored as 48 65 6c 6c 6f      ğŸ’¡: ä¸Šè¡¨ä¸­,å­—å…ƒHå°æ‡‰çš„48æ€éº¼ä¾†çš„? åˆ©ç”¨JSé©—è­‰ \u0026quot;H\u0026quot;.charCodeAt(0).toString(16) ï¼Œåœ¨ï¼²ä¸­å¯ä»¥åˆ©ç”¨charToRaw(ç¯„ä¾‹ä¸­)\n æ•¸å­—(3ç¨®,ä¾‹å¦‚æ•´æ•¸ã€æµ®é»ã€è¤‡æ•¸ï¼‰,é‚è¼¯,å­—å…ƒ(2ç¨®ï¼Œcharacter, raw)\nv \u0026lt;- TRUE print(class(v))\r#\u0026gt; [1] \u0026quot;logical\u0026quot;\rv \u0026lt;- 23.5\rprint(class(v))\r#\u0026gt; [1] \u0026quot;numeric\u0026quot;\rv \u0026lt;- 2L\rprint(class(v))\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rv \u0026lt;- 2+5i\rprint(class(v))\r#\u0026gt; [1] \u0026quot;complex\u0026quot;\rv \u0026lt;- \u0026quot;TRUE\u0026quot;\rprint(class(v))\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rv \u0026lt;- charToRaw(\u0026quot;Hello\u0026quot;)ã€€#ğŸ·ğŸ‘åŒæ¨£çš„ä¸­æ–‡å­—åˆ©ç”¨charToRaw()æ‰¾å‡ºä¾†çš„ï¼‘ï¼–é€²ä½ï¼Œæœƒå› ç‚ºç·¨ç¢¼è€Œä¸åŒ\rprint(class(v))\r#\u0026gt; [1] \u0026quot;raw\u0026quot;\r ğŸ’¡ æ•¸å­—ï¼“ä¸æ˜¯çœŸä¹Ÿä¸æ˜¯å‡\nisTRUE(3)\r#\u0026gt; [1] FALSE\risFALSE(3)\r#\u0026gt; [1] FALSE\r class(3),class(3.1) çš„é¡åˆ¥æ˜¯ç”šéº¼ï¼Ÿæç¤º\r numeric\næŒ‡æ´¾  \u0026lt;-, \u0026lt;\u0026lt;-, =\tå‘å·¦æŒ‡æ´¾å€¼ã€‚ -\u0026gt;, -\u0026gt;\u0026gt;\tå‘å³æŒ‡æ´¾å€¼ã€‚  æŒ‡æ´¾é‹ç®—å­é›–ç„¶ä¹Ÿå¯ä»¥ç”¨=ä½†æ˜¯ï¼ŒRçš„è¨­è¨ˆæ˜¯ä½¿ç”¨\u0026lt;-ã€‚\na \u0026lt;- 3\r a\u0026lt;-3æ˜¯ä¸€å€‹æŒ‡æ´¾çš„æ•˜è¿°å¥,ä¸æœƒå›é¥‹è³‡è¨Šåˆ°è¢å¹•ä¸Šã€‚å¦‚æœè¦çŸ¥é“açš„å…§å®¹æ˜¯ç”šéº¼,å°±æ‰“å…¥a æˆ–è€…(a\u0026lt;-3)\na\r#\u0026gt; [1] 3\r(a\u0026lt;-3)\r#\u0026gt; [1] 3\r ä¸€èˆ¬çš„æ•¸å­¸å‡½æ•¸\nb \u0026lt;- sqrt(a * a + 5)\rb\r#\u0026gt; [1] 3.741657\r \u0026lt;- vs =(ä¾‹å¦‚a\u0026lt;-3 vs. a=3) çš„ç°¡åŒ–èªªæ˜\n  å¤§éƒ¨åˆ†æƒ…æ³ä¸‹\u0026lt;- å’Œ = åœ¨ç›¸åŒçš„ç’°å¢ƒä¸‹ç­‰åƒ¹ã€‚\n å¦å¤–,\u0026lt;\u0026lt;- ç”¨ä¾†æŒ‡æ´¾å€¼çµ¦è¦ªä»£ç’°å¢ƒä¸‹çš„è®Šæ•¸ã€‚    æŒ‰ç…§Rçš„èªªæ˜,ç­‰è™Ÿåªèƒ½ç”¨åœ¨top level,æˆ–æ˜¯å‡½æ•¸åƒæ•¸çš„æŒ‡å®šã€‚åƒè€ƒ\nâ€¹function_nameâ€º(â€¹argnameâ€º = â€¹valueâ€º, â€¦) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™è£¡ç”¨\u0026lt;-æœ‰ä¸ä¸€æ¨£çš„æ„æ€\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\râ€¹function_nameâ€º(â€¹argsâ€º, â€¹argnameâ€º = â€¹valueâ€º, â€¦)\r   ä¾‹å¦‚ åœ¨ä¸»æ§å°åŸ·è¡Œä¸‹é¢ç¨‹å¼ç¢¼\nrm(list=ls()) # (ğŸæœƒåˆªæ‰æˆ‘è‡ªå·±çš„å–®é ç·¨è­¯è®Šæ•¸) ls() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å·¥ä½œå€æ˜¯ç©ºçš„,æ²’æœ‰xè®Šæ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rmean(x\u0026lt;-1:10) #\u0026gt; [1] 5.5\rls() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åœ¨å·¥ä½œå€æœƒå‡ºç¾xè®Šæ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rrm(x)ã€€# \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å¾å·¥ä½œå€ç§»é™¤è®Šæ•¸x\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rmean(x=1:10) #\u0026gt; [1] 5.5\rls() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å·¥ä½œå€æ²’æœ‰xè®Šæ•¸ï¼Œé€™è£¡åªæ˜¯åƒæ•¸æŒ‡å®šï¼Œåœ¨ä¸»æ§å°æ•²å…¥ï¼Ÿmeanå¯ä»¥çœ‹åˆ°åƒæ•¸æœ‰x\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r \rè£œå……å‡½æ•¸ls()çš„èªªæ˜\råœ¨sessionä¸­çš„å¦‚æœè¦åˆ—å‡ºå·²ç¶“å®šç¾©éçš„è®Šæ•¸,å¯ä»¥åˆ©ç”¨lsï¼ˆç›¸é—œå‡½æ•¸rmï¼‰\nls()\r# [1] \"a\" \"b\"\r \r\r\ré‹ç®— å››å‰‡é‹ç®— åƒè€ƒå¯¦éš›æ“ä½œ\nLogical é‚è¼¯é¡åªæœ‰å…©å€‹å€¼ TRUE and FALSEæˆ–æ˜¯ç°¡å¯«ï¼´ï¼Œï¼¦:\na = TRUE\rtypeof(a)\r#\u0026gt; [1] \u0026quot;logical\u0026quot;\rb = FALSE\rtypeof(b)\r#\u0026gt; [1] \u0026quot;logical\u0026quot;\r Rèªè¨€å¸¸ç”¨é‚è¼¯é‹ç®—å­ operator èªªæ˜   \u0026lt; less than  \u0026gt; great than  \u0026lt;= less than or equal  \u0026gt;= greater than or equal  == equal to  != not equal to  | entry wise or  || or  ! not  \u0026amp; entry wise and  \u0026amp;\u0026amp; and  xor(a,b) exclusive or     ç¯„ä¾‹ï¼šä¸åŒçš„é‹ç®—å­ï¼Œåœ¨å€‹åˆ¥å…ƒç´ å’Œæ•´å€‹å‘é‡çš„é‹ç®—çµæœä¸ä¸€æ¨£ï¼š\na = c(TRUE, FALSE)\rb = c(FALSE, F)\ra | b\r#\u0026gt; [1] TRUE FALSE # ğŸ·ğŸ‘å…¨éƒ¨å…ƒç´ \ra || b\r#\u0026gt; [1] TRUE # ğŸ·ğŸ‘åªæœ‰ç¬¬ä¸€å€‹å…ƒç´ \ra \u0026amp; b\r#\u0026gt; [1] FALSE FALSE # ğŸ·ğŸ‘å…¨éƒ¨å…ƒç´ \ra \u0026amp;\u0026amp; b\r#\u0026gt; [1] FALSE # ğŸ·ğŸ‘åªæœ‰ç¬¬ä¸€å€‹å…ƒç´ \rxor(a, b)\r#\u0026gt; [1] TRUE FALSE\r a||b, a\u0026amp;\u0026amp;b åªæ¯”å°a,bä¸­çš„ç¬¬ä¸€å€‹å…ƒç´ ã€‚å› æ­¤é•·åº¦åªæœ‰1å€‹ã€‚âœ”å¦‚æœæ˜¯æµç¨‹æ§åˆ¶,å¤§é«”ä¸Šç”¨çš„é€™å…©ç¨®ã€‚\n\u0026amp; å’Œ | æ¯”å°å…ƒç´ ,å‚³å›é•·åº¦ç‚ºå¤§å°æœ€é•·çš„é‚£å€‹ã€‚\n0ç‚ºFALSE,è€Œ1ç‚ºTRUEã€‚åœ¨Rä¸­,åˆ¤æ–·ä¸€å€‹è®Šæ•¸æ˜¯å¦TRUE,è¦æª¢æŸ¥å¥½å¹¾å€‹åœ°æ–¹,å› æ­¤æœ‰æä¾›å…§å®šçš„æª¢æŸ¥å‡½æ•¸âœ”isTRUE()\nx \u0026lt;- c(TRUE,FALSE,0,6)\ry \u0026lt;- c(FALSE,TRUE,FALSE,TRUE)\r!x\rx\u0026amp;y\rx\u0026amp;\u0026amp;y\rx|y\rx||y #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å¸¸ç”¨æ–¼é‚è¼¯åˆ¤æ–·å¼\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r æç¤º\r \u0026gt; x \u0026lt;- c(TRUE,FALSE,0,6)\r#\u0026gt; [1] 1 0 0 6\r\u0026gt; y \u0026lt;- c(FALSE,TRUE,FALSE,TRUE)\r#\u0026gt; [1] FALSE TRUE FALSE TRUE\r\u0026gt; !x\r#\u0026gt; [1] FALSE TRUE TRUE FALSE #ğŸ‘ºğŸ‘º\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ºå’ŒCå®¶æ—çš„é0ç‚ºçœŸä¸ä¸€æ¨£ğŸ¤·â€â™€ï¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r\u0026gt; x\u0026amp;y\r#\u0026gt; [1] FALSE FALSE FALSE TRUE\r\u0026gt; x\u0026amp;\u0026amp;y\r#\u0026gt; [1] FALSE\r\u0026gt; x|y\r#\u0026gt; [1] TRUE TRUE FALSE TRUE\r\u0026gt; x||y\r#\u0026gt; [1] TRUE\r  x \u0026lt;- c(TRUE,FALSE,0,6,0) # å€‹æ•¸æœ‰ï¼•å€‹\ry \u0026lt;- c(T,TRUE,FALSE,TRUE)ã€€#ã€€å€‹æ•¸æœ‰ï¼”å€‹\rx| y\r è§£é‡‹ä¸Šé¢çš„çµæœ\n é•·åº¦ç‚ºç”šéº¼æ˜¯ï¼• æœ€å¾Œä¸€å€‹ç‚ºç”šéº¼æ˜¯ï¼´ å¦‚æœx \u0026lt;- c(TRUE,FALSE,0,6,3) ç„¶å¾Œå• x \u0026amp; y  æç¤º\r ğŸ’¡å¾ªç’°è£œè¶³\né‚è¼¯å‡½æ•¸ is.family å‡½æ•¸ï¼Œå¯ä»¥ç”¨ä¾†åˆ¤å®šè®Šæ•¸æ˜¯ä»€éº¼å‹æ…‹ï¼Œå‚³å›çœŸå‡å€¼ï¼Œä¾‹å¦‚\na = c(1, 2, 3)\ris.numeric(a)\r#\u0026gt; [1] TRUE\ris.factor(a)\r#\u0026gt; [1] FALSE\ris.character(a)\r#\u0026gt; [1] FALSE\r å‡½æ•¸which()å“ªäº›å…ƒç´ ä¸ä¸€è‡´\nA\u0026lt;-c(T,F,T,F)\rC\u0026lt;-c(F,F,F,T)\rwhich(A)\r#\u0026gt; [1] 1 3\rwhich(A != C)\r#\u0026gt; [1] 1 3 4\r å‡½æ•¸all() æ˜¯ä¸æ˜¯å‘é‡å…§æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ï¼´\nall(A==B)\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'B'\rall(A==C)\r#\u0026gt; [1] FALSE\rall(A==A)\r#\u0026gt; [1] TRUE\r which(),all()è£¡é¢çš„åƒæ•¸å…¶å¯¦éƒ½æ˜¯é‚è¼¯å‘é‡ã€‚\r\r\rè¨»è§£ï¼šä½†æ˜¯Rèªè¨€çš„å‘é‡é‹ç®—ï¼Œæ¶‰åŠè‡ªå‹•å¡«å……å¾ªç’°ï¼Œå› æ­¤æ³¨æ„ä¸‹é¢çš„è¨ˆç®—çµæœ\nD \u0026lt;- c(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;)\rE \u0026lt;- c(\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;)\rall(D==E)\r#\u0026gt; [1] TRUE\rall(length(D)==length(E)) \u0026amp;\u0026amp; all(D==E)\r#\u0026gt; [1] FALSE\r å‡½æ•¸identical(a,b) a,b æ˜¯å¦ç›¸ç­‰,æ¯”è¼ƒçš„æ˜¯é™¤äº†a,bçš„å…§å®¹ä»¥å¤–,ğŸ’¡é‚„æœ‰a b çš„å‹æ…‹ã€‚ä¾‹å¦‚ï¼Œidentical(1,as.integer(1)) çµæœæ˜¯F,å› ç‚º å‰è€…æ˜¯double,å¾Œè€…æ˜¯æ•´æ•¸ã€‚\nidentical(1,as.integer(1)) #\u0026gt; [1] FALSE\rtypeof(1)\r#\u0026gt; [1] \u0026quot;double\u0026quot;\ridentical(1L,as.integer(1)) #\u0026gt; [1] TRUE\r   æ¯”å°æ•¸å­—3å’Œå­—ä¸²3\n3==\u0026quot;3\u0026quot;\r#\u0026gt; [1] TRUE\ridentical(3,\u0026quot;3\u0026quot;)\r#\u0026gt; [1] FALSE\r   å‡½æ•¸identical()\nA \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;D\u0026quot;)\rB \u0026lt;- A\rC \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;E\u0026quot;)\rA==B\r#\u0026gt; [1] TRUE TRUE TRUE TRUE\rA==C #\u0026gt; [1] TRUE FALSE TRUE FALSE\ridentical(A,B) # ğŸ·ğŸ‘åªæœ‰ä¸€å€‹çœŸå‡å€¼\r#\u0026gt; [1] TRUE\ridentical(A,C)\r#\u0026gt; [1] FALSE\r   å¯¦æ•¸çš„æ¯”è¼ƒğŸ‘º\n0.1+0.2 == 0.3 #F\r#\u0026gt; [1] FALSE\ridentical(0.1+0.2 , 0.3) #F\r#\u0026gt; [1] FALSE\r   identical å¯ä»¥å’Œå¾Œé¢çš„å‡½æ•¸all.equalå‡½æ•¸æ¯”è¼ƒã€‚\nå¯¦æ•¸çš„æ¯”è¼ƒ å‡½æ•¸all.equal()\n0.1+0.2 == 0.3 #â›³ \r#\u0026gt; [1] FALSE\rall.equal(0.1+0.2,0.3)\r#\u0026gt; [1] TRUE\r åœ¨EXCELä¸­åˆ©ç”¨æœ‰æ•ˆä½æ•¸15ä¾†è§£0.1+0.2==0.3 æ˜¯å¦ç›¸ç­‰çš„å•é¡Œã€‚\nåœ¨Rä¸­ï¼Œå¯ä»¥ç”¨signif()ç¤ºç¯„(ğŸ˜’options()$digitsé è¨­æ˜¯7,å¯ä»¥ç”¨(options(digits=15)æ”¹è®Šè¨­å®š)ä½†æ˜¯å¥½åƒåªæ˜¯ç”¨ä¾†æ§åˆ¶é¡¯ç¤ºçš„æœ‰æ•ˆä½å…ƒ)\nx\u0026lt;-runif(1)\rsignif(x,3)\r#\u0026gt; [1] 0.111\rsignif(0.1+0.2, 15)==signif(0.3,15)\r#\u0026gt; [1] TRUE\rsignif(0.1,15)+signif(0.2,15)==signif(0.3,15) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ + ä»¥å¾Œçš„çµæœä¹Ÿè¦\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] FALSE\r \r\ré€™æ˜¯å¦ä¸€å€‹ä¾‹å­,è·Ÿæˆ‘å€‘èªªå¯¦æ•¸çš„æ¯”è¼ƒå¾ˆä¸ç©©å®š\n# å…ˆçœ‹æˆ‘å€‘æ‡‰è©²çŸ¥é“çš„éƒ¨åˆ†\r1-0.4 ==0.6 # TRUE ğŸ‘\r#\u0026gt; [1] TRUE\r1-0.6==0.4 # TRUE\r#\u0026gt; [1] TRUE\rx \u0026lt;- seq(0, 1, by = 0.2)\ry \u0026lt;- seq(0, 1, by = 0.2)\ry[4] #\u0026gt; [1] 0.6\rx[3] #\u0026gt; [1] 0.4\r1 - x[3] #\u0026gt; [1] 0.6\ry[4] == 1 - x[3] #ğŸ·å‰é¢çš„1-0.4==0.6 ç‚ºçœŸ\r#\u0026gt; [1] FALSE ğŸ‘\r## ğŸ’¯\rall.equal(y[4], 1 - x[3])ã€€#\u0026gt; [1] TRUE\r## ğŸ’¯\rall.equal(y[4], 1 - x[3])ã€€ å‡½æ•¸ç·´ç¿’ï¼š\nå°‡ä¸Šé¢å¯èƒ½é€ æˆèª¤åˆ¤çš„æƒ…æ³ï¼Œå¯«æˆå‡½æ•¸å…ˆåˆ¤æ–·æ˜¯å¦é•·åº¦ç›¸ç­‰ï¼Œç„¶å¾Œåˆ¤æ–·å…ƒç´ ç›¸ç­‰ï¼Œå¯ä»¥å’Œidentical()æ¯”è¼ƒã€‚æç¤º\r hint: åˆ©ç”¨length\na \u0026lt;- character(0)\ridentical(a, character(0)) # returns TRUE\ridentical(a, \u0026quot;\u0026quot;) # returns FALSE\ridentical(a, numeric(0)) # returns also FALSE\r \næ˜¯ä¸æ˜¯NA, NULL nx1\u0026lt;-numeric(0)\rnx2\u0026lt;-3\ris.null(nx1) # F,å› ç‚ºnx1æ˜¯ç©ºå‘é‡(é•·åº¦ç‚º0çš„æ•¸å­—å‘é‡)\r#\u0026gt; [1] FALSE\ris.na(nx1) # logical(0),æ¯å€‹å…ƒç´ æª¢æŸ¥æ˜¯ä¸æ˜¯NA,ä½†æ˜¯ç¾åœ¨æ˜¯ç©ºå‘é‡,æ‰€ä»¥çµæœæ˜¯logical(0)\r#\u0026gt; logical(0)\rtypeof(nx1) # double\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rtypeof(nx2) # double\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rlength(nx1) # 0 #\u0026gt; [1] 0\rlength(nx2) # 1\r#\u0026gt; [1] 1\r ç”šéº¼æ™‚å€™ç”¨åˆ°is.nullæç¤º\r config \u0026lt;- list()\ris.null(config) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ˜¯empty(ç©ºçš„)listç‰©ä»¶,ä½†ä¸æ˜¯null(è™›çš„)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] FALSE\ris.null(config$name)\r#\u0026gt; [1] TRUE\r ç©ºçš„å’Œè™›çš„æœ‰ç”šéº¼å·®åˆ¥? ä¸€å€‹æ˜¯åœ¨è¨˜æ†¶é«”æœ‰ä½ç½®,ä¸€å€‹æ˜¯æ²’æœ‰ã€‚\r\r\r å¦‚ä½•åˆ¤æ–·æ˜¯å¦NA\nx == NA\r#\u0026gt; [1] NA\r ä¸Šé¢çš„æ¯”è¼ƒæ²’æœ‰æ„ç¾©,å’ŒNAçš„ä»»ä½•é‹ç®—éƒ½æ˜¯NA\nr = x == NA\rr\r#\u0026gt; [1] NA\r çµè«–:ä»»ä½•è®Šæ•¸å’ŒNAé‹ç®—,çµæœé‚„æ˜¯NA\nå¦ä¸€ç¨®æ–¹æ³•\nprint(x == NA)\r#\u0026gt; [1] NA\r å¦‚ä½•åˆ¤æ–·NA ? is.na()\nis.na(a[6])\r#\u0026gt; [1] TRUE\r \r\rvector åˆ©ç”¨cå‡½æ•¸ï¼Œå¯ä»¥ä½¿ç”¨vectorå­˜æ”¾ä¸€å€‹ä»¥ä¸Šçš„æ•¸å­—ã€‚\na = c(1, 2, 3, 4, 5)\ra1 = 1:5\r æœ‰é—œvectorçš„é‹ç®—:åŠ æ¸›ä¹˜é™¤ç­‰ç­‰\na = c(1, 2, 3, 4, 5)\ra+1\r#\u0026gt; [1] 2 3 4 5 6\ra-1\r#\u0026gt; [1] 0 1 2 3 4\ra/2\r#\u0026gt; [1] 0.5 1.0 1.5 2.0 2.5\ra*3\r#\u0026gt; [1] 3 6 9 12 15\r mean(a)\r#\u0026gt; [1] 3\rvar(a)\r#\u0026gt; [1] 2.5\rsummary(a)\r#\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 1 2 3 3 4 5\r note: å°æ¯”stata sum a æŒ‡ä»¤,summary(a) è¿”å›çš„æ˜¯ä¸€å€‹tableç‰©ä»¶ã€‚å¯ä»¥æŒ‡æ´¾çµ¦è®Šæ•¸,å› æ­¤è¨ˆç®—çµæœå¯ä»¥ç¶“ç”±è®Šæ•¸(é¡åˆ¥ç‚ºtable)å­˜å–ã€‚\nlistçš„å…ƒç´ ,åˆ©ç”¨ä¸­æ‹¬è™Ÿ\na = 2:6\ra[1]\r#\u0026gt; [1] 2\ra[2]\r#\u0026gt; [1] 3\ra[0]\r#\u0026gt; integer(0)\ra[6]\r#\u0026gt; [1] NA\r åœ¨Rä¸­,çš„æœ€å°çš„ç´¢å¼•å€¼ç‚º1base.å¦‚æœçµ¦ç´¢å¼•ç‚º0,å¯ä»¥çŸ¥é“è³‡æ–™æ˜¯å¦è¢«æ’åºã€‚ è¶…å‡ºç´¢å¼•ç¯„åœå¾—åˆ°\u0026quot;NAã€‚\na=2:6\rx = a[6]\r åˆå§‹åŒ–å‘é‡,å¯ä»¥åˆ©ç”¨a\u0026lt;-10 æˆ–æŒ‡å®šnumeric(double)å‹æ…‹\na \u0026lt;- numeric(10) a\r#\u0026gt; [1] 0 0 0 0 0 0 0 0 0 0\r å¦‚æœæƒ³è¦çŸ¥åˆ°è®Šæ•¸çš„è³‡æ–™å‹åˆ¥,åˆ©ç”¨å‡½æ•¸typeof()\ntypeof()å‡½æ•¸å›å‚³çš„çµæœæ˜¯\u0026quot;å­—ä¸²\u0026quot;\ntypeof(a) # çµæœæ˜¯\u0026quot;double\u0026quot;\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rs = typeof(a)\rs\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rtypeof(s) #çµæœæ˜¯ \u0026quot;character\u0026quot;\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r å­—ä¸²  åƒè€ƒ\n å»ºç«‹å­—ä¸² å¯ä»¥æ˜¯ é›™å¼•è™Ÿä¸­\u0026quot; æˆ– å–®å¼•è™Ÿä¸­'ã€‚ å­—ä¸²ä¸­å¦‚æœæœ‰é›™å¼•è™Ÿ,æˆ–å–®å¼•è™Ÿï¼Œå‰‡å¦‚ä¸‹è¡¨ç¤º:\n\u0026quot;'é€™å€‹'ä¾†è‡ª'é‚£å€‹'\u0026quot;\na \u0026lt;- \u0026quot;hello\u0026quot;\ra\r#\u0026gt; [1] \u0026quot;hello\u0026quot;\rtypeof(a) #[1] \u0026quot;character\u0026quot; #\u0026gt; [1] \u0026quot;character\u0026quot;\ris.vector(a) #[1] TRUE\r#\u0026gt; [1] TRUE\r åˆ©ç”¨å‡½æ•¸:character() é€™å€‹å‡½æ•¸çš„åƒæ•¸ç‚ºæ•´æ•¸,å»ºç«‹ä¸€å€‹vector(ä¸æ˜¯list),è£¡é¢çš„å…ƒç´ éƒ½æ˜¯ç©ºå­—ä¸²,ä¾‹å¦‚character(5)ã€‚\n# è®Šæ•¸exåˆå§‹åŒ–ç‚ºcharacter vector,åƒçœ‹å¾Œé¢çš„è¨è«–\r(ex \u0026lt;- character(0))\r#\u0026gt; character(0)\ris.null(ex) #ğŸ·ä¸æ˜¯null,é€™æ˜¯ä¸€å€‹æŒ‡æ¨™\r#\u0026gt; [1] FALSE\rlength(ex)\r#\u0026gt; [1] 0\rclass(ex)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r# å¦‚æœå‰›å‰›æ²’æœ‰è¨­å®šex \u0026lt;- character(0),é€™è£¡æœƒç™¼ç”ŸéŒ¯èª¤\r(ex[1] \u0026lt;- \u0026quot;first\u0026quot;)\r#\u0026gt; [1] \u0026quot;first\u0026quot;\r# check its length again\rlength(ex)\r#\u0026gt; [1] 1\r(ex[4] \u0026lt;- \u0026quot;fourth\u0026quot;) # ğŸ·ç´¢å¼•å¯ä»¥ç”¨è·³çš„:\r#\u0026gt; [1] \u0026quot;fourth\u0026quot;\rlength(ex)\r#\u0026gt; [1] 4\rtypeof(ex)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rex\r#\u0026gt; [1] \u0026quot;first\u0026quot; NA NA \u0026quot;fourth\u0026quot;\r è·³éçš„ç´¢å¼•,å…§å®¹è‡ªå‹•ç‚ºNA.\nç©ºå­—ä¸² å¼•è™Ÿå…§é€£ç©ºç™½éƒ½æ²’æœ‰çš„å­—ä¸²: (æ¯”è¼ƒä¸Šé¢åˆ©ç”¨character(5)å¯ä»¥å»ºç«‹5å€‹å…ƒç´ ç‚ºç©ºå­—ä¸²çš„vectorã€‚)\n# empty string\rempty_str \u0026lt;- \u0026quot;\u0026quot;\rempty_str\r#\u0026gt; [1] \u0026quot;\u0026quot;\r# class\rclass(empty_str)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r æ¢è¨character(0) å‰é¢èªªcharacter(2),å¯ä»¥å‚³å›é•·åº¦2,æ¯å€‹å…ƒç´ éƒ½æ˜¯ç©ºç™½å­—ä¸²\u0026quot;\u0026quot;çš„å‘é‡,é‚£éº¼character(0)æ˜¯ç”šéº¼? é™¤äº†å‰é¢æåˆ°çš„è®Šæ•¸åˆå§‹åŒ–ç‚ºå‘é‡(ä¹Ÿè¨±å¯ä»¥èªªæ˜¯å‘é‡å®£å‘Š) ä¾‹å¦‚,æ•´æ•¸ä¹Ÿæ˜¯é€™æ¨£\nzz\u0026lt;-integer(0)\rzz[4]=6\rzz\r#\u0026gt; [1] NA NA NA 6\r é€™è£¡åˆ©ç”¨åˆ†åˆ¥ä½¿ç”¨typeof, str,class,iså°character(0)åšä¸€äº›æ¸¬è©¦:\nex1\u0026lt;-character(0) ex2\u0026lt;-\u0026quot;\u0026quot;\rtypeof(ex1) # ğŸ·éƒ½æ˜¯å‘é‡\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rtypeof(ex2)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r å‡½æ•¸str()ç”¨ä¾†é¡¯ç¤ºRç‰©ä»¶çš„çµæ§‹:\nstr(ex1) #\u0026gt; chr(0)\rstr(ex2) #ğŸ·å‰é¢çœ‹èµ·ä¾†éƒ½æ˜¯å‘é‡,ä½†æ˜¯é€™è£¡æœ‰æ›´å¤šè³‡è¨Š chr(0),\u0026quot;\u0026quot;\r#\u0026gt; chr \u0026quot;\u0026quot;\r class(ex1)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rclass(ex2)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r is.list(ex1)\r#\u0026gt; [1] FALSE\ris.list(ex2)\r#\u0026gt; [1] FALSE\r ğŸ‘¹ 0æˆ–ï¼‘å€‹å­—å…ƒä¹Ÿæ˜¯å‘é‡ã€‚\nis.vector(ex1)ã€€#T\r#\u0026gt; [1] TRUE\ris.vector(ex2) #T\r#\u0026gt; [1] TRUE\r length(ex1)\r#\u0026gt; [1] 0\rlength(ex2)\r#\u0026gt; [1] 1\r is.null(ex1) #F\r#\u0026gt; [1] FALSE\ris.null(ex2) #F\r#\u0026gt; [1] FALSE\ris.na(ex1) #\u0026gt; ğŸ·logical(0) èªªé€™æ˜¯é‚è¼¯å‘é‡,ä½†æ˜¯é•·åº¦0\r#\u0026gt; logical(0)\ris.na(ex2) #\u0026gt; FALSE\r#\u0026gt; [1] FALSE\r æœ€å¾Œ,é€™å…©å€‹æ˜¯ä¸æ˜¯ç›¸ç­‰\nex1==ex2\r#\u0026gt; logical(0)\r å­—ä¸²å’Œvector  vector ä¸€èˆ¬æŒ‡çš„æ˜¯åªæ”¾å…ƒç´ ç‚ºæ•¸å­—çš„é™£åˆ—(array)ï¼Œåœ¨EXCELä¸­åˆ©ç”¨é™£åˆ—è¡¨ç¤ºvector;è€Œé™£åˆ—æ˜¯å¯ä»¥å­˜æ•¸å­—å’Œæ–‡å­—çš„å€åŸŸã€‚(EXCEL çš„tableæ˜¯æœ‰æ¬„ä½çš„é™£åˆ—)ã€‚ ä½†æ˜¯åœ¨Rèªè¨€ä¸­,vector åªæ˜¯å…ƒç´ å‹æ…‹ç›¸åŒå³å¯(å¾Œè¿°)[#whatisvector]\n a \u0026lt;- \u0026quot;hello\u0026quot;\ra\r#\u0026gt; [1] \u0026quot;hello\u0026quot;\rtypeof(a)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r b \u0026lt;- c(\u0026quot;hello\u0026quot;, \u0026quot;there\u0026quot;)\rb\r#\u0026gt; [1] \u0026quot;hello\u0026quot; \u0026quot;there\u0026quot;\rb[1]\r#\u0026gt; [1] \u0026quot;hello\u0026quot;\rtypeof(b)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r (a = character(5)) # ç”¢ç”Ÿ5å€‹ç©ºå­—ä¸²\r#\u0026gt; [1] \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot; \u0026quot;\u0026quot;\r(b = letters[1:4]) # æ³¨æ„,lettersä¸æ˜¯å‡½æ•¸\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot;\rletters\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; \u0026quot;d\u0026quot; \u0026quot;e\u0026quot; \u0026quot;f\u0026quot; \u0026quot;g\u0026quot; \u0026quot;h\u0026quot; \u0026quot;i\u0026quot; \u0026quot;j\u0026quot; \u0026quot;k\u0026quot; \u0026quot;l\u0026quot; \u0026quot;m\u0026quot; \u0026quot;n\u0026quot; \u0026quot;o\u0026quot; \u0026quot;p\u0026quot; \u0026quot;q\u0026quot; \u0026quot;r\u0026quot; \u0026quot;s\u0026quot;\r#\u0026gt; [20] \u0026quot;t\u0026quot; \u0026quot;u\u0026quot; \u0026quot;v\u0026quot; \u0026quot;w\u0026quot; \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;z\u0026quot;\rtypeof(letters)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rclass(letters)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r â›³  å› ç‚ºcå‡½æ•¸çš„é‹ç®—çµæœç‚ºvector,å› æ­¤ä¸‹ä¾‹ä¸­,å…¶å…ƒç´ éƒ½æ˜¯å­—ä¸²ï¼ˆå‰é¢è¬›éåœ¨ï¼²ä¸­çš„vectorå¿…é ˆæ˜¯åŒé¡ï¼‰\n(a\u0026lt;-c(\u0026quot;d\u0026quot;,4,TRUE))\r#\u0026gt; [1] \u0026quot;d\u0026quot; \u0026quot;4\u0026quot; \u0026quot;TRUE\u0026quot;\r å•é¡Œ: æ€æ¨£çŸ¥é“ræ˜¯ç©ºé›†åˆ?\ny \u0026lt;- letters[1:3] z \u0026lt;- letters[4:6] r\u0026lt;-intersect(y,z) r\r#\u0026gt; character(0)\ris.na(r)\r#\u0026gt; logical(0)\rlength(r)\r#\u0026gt; [1] 0\r å¦å¤–,ç•¶vectoræœ‰å¤šå€‹å­—ä¸²,è€Œä½¿ç”¨ç´¢å¼•0çš„æ™‚å€™,ä¹Ÿæœƒå‡ºç¾ character(0),ä¾‹å¦‚:\nstring \u0026lt;- c('sun', 'sky', 'clouds')\rstring[0]\r#\u0026gt; character(0)\r æ›´å¤švector ç›¸é—œçš„é‹ç®— é€£çºŒæ•¸å­—å¯ä»¥åˆ©ç”¨æ“ä½œå…ƒ:,ä¾‹å¦‚:\nx \u0026lt;- 1:7; x\ry \u0026lt;- 2:-2; y\r æ¯”è¼ƒè¤‡é›œçš„åºåˆ—å¯ä»¥åˆ©ç”¨å‡½æ•¸ seq() ,ä¾‹å¦‚\nseq(1, 3, by=0.2) # specify step size\r#\u0026gt; [1] 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0\rseq(1, 5, length.out=4) # specify length of the vector\r#\u0026gt; [1] 1.000000 2.333333 3.666667 5.000000\r ç·´ç¿’ç¯„ä¾‹ Q1. a,a1,a2 å±¬æ–¼ç”šéº¼å‹æ…‹\na = 1:4\ra1 = c(1, 2, 3, 4)\ra2 = numeric(4)\r æç¤º\r A1: åªæ˜¯è¦è¨˜ä½å‡½æ•¸typeof\na = 1:4\ra1 = c(1, 2, 3, 4)\ra2 = numeric(4)\rtypeof(a)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rtypeof(a1)\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rtypeof(a2)\r#\u0026gt; [1] \u0026quot;double\u0026quot;\r \nQ2:a3çš„é•·åº¦æ˜¯ç”šéº¼?2,æˆ–6\na1\u0026lt;-c(1,2,3)\ra2\u0026lt;-c(2,3,4)\ra3\u0026lt;-c(a1,a2)\r æç¤º\r HINT: åªæ˜¯è¦è¨˜ä½å‡½æ•¸length a1 a2 a3;length(a3)\na = character(5)\rb\u0026lt;-\u0026quot;12345\u0026quot;\rc\u0026lt;-c(\u0026quot;1\u0026quot;,\u0026quot;2\u0026quot;,\u0026quot;3\u0026quot;,\u0026quot;4\u0026quot;,\u0026quot;5\u0026quot;)\r å•\n length(a),length(b),length(c)åˆ†åˆ¥æ˜¯å¤šå°‘ï¼Ÿ nchar(a),nchar(b),nchar(c)?  æç¤º\r æç¤º length: 5,1,5 nzchar: 0,0,0,0,0, 5,0,0,0,0,0\nå¦‚ä½•å­˜å–vectorä¸­çš„å…ƒç´  å…ƒç´ ç´¢å¼•å¯ä»¥åˆ©ç”¨ logical, integer or character vector.\nå¦‚æœåˆ©ç”¨æ•´æ•¸ç´¢å¼•,å‰‡å¾1é–‹å§‹.ä½†æ˜¯,å¦‚æœç´¢å¼•å€¼çµ¦çš„æ˜¯è² æ•¸(ä¾‹å¦‚-2),å‰‡é™¤äº†2è™Ÿå…ƒç´ ä»¥å¤–,éƒ½æœƒè¢«å‚³å›ã€‚ä½†æ˜¯ä¸èƒ½åŒæ™‚æœ‰æ­£è² ã€‚åŒæ™‚,æµ®é»æ•¸æœƒè¢«truncatedã€‚\n\u0026gt; x\r[1] 0 2 4 6 8 10\r\u0026gt; x[3] # access 3rd element\r[1] 4\r\u0026gt; x[c(2, 4)] # access 2nd and 4th element\r[1] 2 6\r\u0026gt; x[-1] # access all but 1st element\r[1] 2 4 6 8 10\r\u0026gt; x[c(2, -4)] # ä¸èƒ½æ··åˆæ­£è² \rError in x[c(2, -4)] : only 0's may be mixed with negative subscripts\r\u0026gt; x[c(2.4, 3.54)] # real numbers are truncated to integers\r[1] 2 4\r ç¯©é¸ ç¯©é¸é™£åˆ—ä¸­çš„å…ƒç´ ğŸ·ğŸ‘å¯ä»¥æ‡‰ç”¨åœ¨æŠ½æ¨£ã€‚ä¾‹å¦‚\n\u0026gt; x[c(TRUE, FALSE, FALSE, TRUE)]\r[1] -3 3\r\u0026gt; x[x \u0026lt; 0] # filtering vectors based on conditions\r[1] -3 -1\r\u0026gt; x[x \u0026gt; 0]\r[1] 3\r å¯¦éš›å¯«ç¨‹å¼ç¤ºç¯„ æˆ‘æƒ³è¦å¾å…©å€‹é …ç›®é‡è¤‡æŠ½æ¨£(å¦‚ä¸‹),é‡è¤‡æŠ½10å€‹ã€‚æˆ‘çš„æ‰“ç®—æ˜¯åˆ©ç”¨çœŸå‡å€¼éæ¿¾,ä¾‹å¦‚æˆ‘çš„è¨­æƒ³æ˜¯é€™æ¨£\nkind\u0026lt;-c(\u0026quot;æ°´å£º\u0026quot;,\u0026quot;éµç¶²\u0026quot;)\rkind[c(T,F,T,T,F,T,F,T,F,F)]\r ğŸ˜œå…¶å¯¦ä¸Šé¢çš„ç¨‹å¼ç¢¼æ˜¯matlabçš„å¯«æ³•,æˆ‘ç›´æ¥å¥—åœ¨Rä¸Šã€‚\nkind\u0026lt;-c(\u0026quot;æ°´å£º\u0026quot;,\u0026quot;éµç¶²\u0026quot;)\rx\u0026lt;-rnorm(10)ã€€#10 random number\rkind[x\u0026lt;0.5] # é è¨ˆå°æ–¼ï¼•å¯ä»¥æŠ½å‡ºä¾†ï¼ˆå› ç‚ºæˆ‘è¨˜å¾—å¯ä»¥å¾ªç’°è£œï¼‰\r#\u0026gt; [1] \u0026quot;éµç¶²\u0026quot; NA NA NA NA NA NA\r é€™æ˜¯ç”šéº¼ï¼ŸğŸ‘ºğŸ˜’ æˆ‘çŸ¥é“ï¼®ï¼¡æ˜¯è¶…å‡ºç¯„åœçš„æ„æ€ï¼Œå¯æ˜¯ä¸çŸ¥é“ç‚ºç”šéº¼ä»–è¶…å‡ºç¯„åœ\n#\u0026gt; [1] \u0026quot;éµç¶²\u0026quot; NA NA NA NA NA NA NA\r å¯æ˜¯æˆ‘è¨˜å¾—æ•¸å­—å¯ä»¥ï¼Œä¾‹å¦‚\nkind\u0026lt;-c(\u0026quot;æ°´å£º\u0026quot;,\u0026quot;éµç¶²\u0026quot;)\rx\u0026lt;-c(1,2,1,2,1,1)\rkind[x]  åŸ·è¡Œçµæœ ğŸ’¯\n[1] \u0026quot;æ°´å£º\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot;\r â“â“â“â“â“ é‚£æˆ‘è¨˜å¾—ï¼ŒçœŸå‡å€¼å¯ä»¥è½‰ï¼ï¼Œï¼‘æˆä½æ•¸å­—ï¼Œæ‰€ä»¥\nkind[as.numeric(x\u0026lt;0.5)]\r çµæœ\n[1] \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot;\r ç‚ºç”šéº¼â“æç¤º\r å› ç‚ºï¼²æ˜¯ï¼‘ç‚ºåŸºåº•\nkind[as.numeric(x\u0026lt;0.5)+1]\r#\u0026gt; [1] \u0026quot;éµç¶²\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;æ°´å£º\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;éµç¶²\u0026quot; \u0026quot;æ°´å£º\u0026quot;\r \nåˆ©ç”¨å­—ä¸²( character vector) ä½œç‚ºç´¢å¼• æ¯å€‹å…ƒç´ å¯ä»¥æœ‰åç¨±:\n\u0026gt; x \u0026lt;- c(\u0026quot;first\u0026quot;=3, \u0026quot;second\u0026quot;=0, \u0026quot;third\u0026quot;=9)\r\u0026gt; x\r#\u0026gt; first second third #\u0026gt; 3 0 9 \u0026gt; class(x) # æ³¨æ„:ä¸æ˜¯list #\u0026gt; [1] \u0026quot;numeric\u0026quot;\r\u0026gt; names(x)\r#\u0026gt; [1] \u0026quot;first\u0026quot; \u0026quot;second\u0026quot; \u0026quot;third\u0026quot; \u0026gt; x[\u0026quot;second\u0026quot;]\r#\u0026gt; second #\u0026gt; 0 \u0026gt; x[c(\u0026quot;first\u0026quot;, \u0026quot;third\u0026quot;)]\r#\u0026gt; first third #\u0026gt; 3 9\r a\u0026lt;-c(x=1:2,y=3:4)\ra[\u0026quot;x1\u0026quot;] # ä¸æ˜¯a[x1]\r#\u0026gt; x1 #\u0026gt; 1\r â“ a[\u0026quot;x1\u0026quot;]å“ªè£¡ä¾†çš„x1?æç¤º\r \u0026gt; a\r#\u0026gt; x1 x2 y1 y2 #\u0026gt; 1 2 3 4\r\u0026gt; names(a)\r\u0026gt; # [1] \u0026quot;x1\u0026quot; \u0026quot;x2\u0026quot; \u0026quot;y1\u0026quot; \u0026quot;y2\u0026quot;\r \n[] å’Œ[[]]çš„å·®åˆ¥:\nåŸä¾†çš„typeæ˜¯ç”šéº¼(ä¾‹å¦‚,list æˆ–vector),[]åªæ˜¯è¿”å›å­é›†åˆ(ä»ç„¶æ˜¯listæˆ–vector),ä½†æ˜¯[[]]å‰‡æ˜¯è¿”å›å…§å®¹.\n\u0026gt; x \u0026lt;- c(a = 1, b = 2, c = 3)\r\u0026gt; x[\u0026quot;a\u0026quot;]\r#\u0026gt; a #\u0026gt; 1 \u0026gt; x[[\u0026quot;a\u0026quot;]]\r#\u0026gt; [1] 1\r\u0026gt; x[1]\r#\u0026gt; a #\u0026gt; 1 \u0026gt; x[[1]]\r#\u0026gt; [1] 1\r ğŸ’¡ä¾‹å¦‚,æˆ‘åªè¦é™£åˆ—çš„å€¼,å‰‡x[[1]]å¯ä»¥ç”¨ä¾†å»æ‰namesã€‚ å’Œlistçš„å€åˆ¥æ˜¯\n $ ä¸å¿…æœ‰\u0026quot;\u0026quot;  a1\u0026lt;-list(x=1:2,y=3:4)\ra1$x\r#\u0026gt; [1] 1 2\r \r\ræ€æ¨£è®Šå‹•çŸ©é™£å‘é‡? We can modify a vector using the assignment operator.\nWe can use the techniques discussed above to access specific elements and modify them.\nIf we want to truncate the elements, we can use reassignments.\n\u0026gt; x\r#\u0026gt; [1] -3 -2 -1 0 1 2\r\u0026gt; x[2] \u0026lt;- 0; x # åªæ”¹è®Šç¬¬äºŒå€‹å…ƒç´ \r#\u0026gt; [1] -3 0 -1 0 1 2\r\u0026gt; x[x\u0026lt;0] \u0026lt;- 5; x # å°‡å°æ–¼0çš„å€¼,éƒ½æ”¹æˆ5\r#\u0026gt; [1] 5 0 5 0 1 2\r\u0026gt; x \u0026lt;- x[1:4]; x # åªè¦1åˆ°4\r#\u0026gt; [1] 5 0 5 0\r How to delete a Vector? We can delete a vector by simply assigning a NULL to it.\n\u0026gt; x\r#\u0026gt; [1] -3 -2 -1 0 1 2\r\u0026gt; x \u0026lt;- NULL\r\u0026gt; x\r#\u0026gt; NULL\r\u0026gt; x[4]\r#\u0026gt; NULL\r ç·´ç¿’ â“æ€æ¨£ç”¢ç”Ÿä¸‹é¢çš„å‘é‡?\nx\ra b a b a \u0026lt;NA\u0026gt; 1 2 3 4 5 6  æç¤º\r x\u0026lt;-seq(1,5)\rnames(x)\u0026lt;-rep(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;),2)\r \nå‹æ…‹æ“ä½œ  åˆ¤å®šå‹æ…‹ is family  is.numeric(), is.integer(), and is.double()   å‹æ…‹è½‰æ› as family  a\u0026lt;-c(TRUE,FALSE)\ras.numeric(a)\r#\u0026gt; [1] 1 0\ran\u0026lt;-as.logical(a)\ran\r#\u0026gt; [1] TRUE FALSE\r assignment ç·´ç¿’\nhw1\nstructure \u0026amp; attributes å‡½æ•¸structure(data, ...)\nä½¿ç”¨æ–¹æ³• å…ˆçœ‹ä¸€ä¸‹ç¯„ä¾‹\ncode=\u0026quot;é€™æ˜¯ç¯„ä¾‹\u0026quot;\rx=structure(list(src = code), ddd = 'source') x\r#\u0026gt; $src\r#\u0026gt; [1] \u0026quot;é€™æ˜¯ç¯„ä¾‹\u0026quot;\r#\u0026gt; attr(,\u0026quot;ddd\u0026quot;) ğŸ·é€™æ˜¯ç¬¬äºŒå€‹åƒæ•¸æ·»é€²ä¾†çš„\r#\u0026gt; [1] \u0026quot;source\u0026quot;\r å†çœ‹å¦ä¸€å€‹ç¯„ä¾‹\ndata=\u0026quot;é€™æ˜¯ç¯„ä¾‹\u0026quot; ğŸ·åªæ˜¯å­—ä¸²\rx=structure(data, ddd = 'source') ğŸ·æ·»åŠ å±¬æ€§ddd\rx ğŸ·çœ‹å…§å®¹\r#\u0026gt; [1] \u0026quot;é€™æ˜¯ç¯„ä¾‹\u0026quot;\r#\u0026gt; attr(,\u0026quot;ddd\u0026quot;)\r#\u0026gt; [1] \u0026quot;source\u0026quot;\rattributes(data) ğŸ·çœ‹çœ‹å±¬æ€§\r#\u0026gt; NULL ğŸ·dataä»ç„¶æ˜¯data,æ²’æœ‰æ–°å¢çš„å±¬æ€§\rattributes(x) ğŸ·å‚³å›ä¾†çš„ä¸åƒ…æœ‰åŸä¾†çš„data,é‚„å¤šäº†ä¸€å€‹å±¬æ€§\r#\u0026gt; $ddd\r#\u0026gt; [1] \u0026quot;source\u0026quot;\r ç™½è©±æ–‡å°±æ˜¯ å‡è¨­dataæ˜¯ä¸€å€‹ç‰©ä»¶,å‰‡structure(data,xxx=\u0026quot;dd\u0026quot;),æœƒæ ¹æ“šé€™å€‹ç‰©ä»¶å†æ·»åŠ ä¸€å€‹å±¬æ€§xxx,ç„¶å¾Œå‚³å›é€™å€‹ç‰©ä»¶ã€‚\nå› æ­¤è¦æ³¨æ„çš„æ˜¯classé€™å€‹attributeã€‚åœ¨ï¼²ä¸­ï¼Œclassæœ‰å¦ä¸€å€‹æ„æ€ï¼Œç”¨ä¾†ä»£è¡¨ç‰©ä»¶é¡åˆ¥ï¼ˆä¾‹å¦‚è¦è‡ªè¨‚é¡åˆ¥ï¼Œå¯ä»¥åˆ©ç”¨é€™å€‹class)\ndata=\u0026quot;string\u0026quot;\rclass(data)\r#\u0026gt; character ğŸ·é€™æ˜¯å­—ä¸²\rx=structure(data,class=\u0026quot;risk\u0026quot;) #ğŸ·ğŸ‘ç¾åœ¨ç‰©ä»¶xçš„é¡åˆ¥ä¸å†æ˜¯å­—ä¸²ï¼Œè€Œæ˜¯é¡åˆ¥risk\rclass(x)\r#\u0026gt; risk ğŸ·æ­¤æ™‚çš„é¡åˆ¥è¢«è®Šæ›´æˆrisk\r"},
{"uri": "/blogR//rlang/4_1_2_type%E7%B7%B4%E7%BF%92.html","title": "4.1.2 ç·´ç¿’",
	"tags": [],
	"description": "4_1_1_typeç·´ç¿’",
	"content": "åœ¨Rä¸­,options()ç¶“å¸¸ç”¨ä¾†è¨­å®šç¸½é«”è®Šæ•¸,ä¾‹å¦‚å¥—ä»¶blogdownå¯ä»¥è¨­å®šoptions(blogdown.method = 'custom')ã€‚\nå¦‚æœæƒ³è¦çŸ¥é“ç›®å‰çš„è¨­å®šæƒ…æ³,å¯ä»¥ä¸‹æŒ‡ä»¤options()ï¼Œä¾‹å¦‚\noptions() # ğŸ·è¨»è§£é€™æ˜¯åœ¨è¦–çª—ä¸‹åŸ·è¡Œçš„çµæœ\r \roptions()çš„åŸ·è¡Œçµæœ\r$add.smooth\r[1] TRUE\r$blogdown.author\r[1] \u0026quot;\u0026quot;\r$blogdown.ext\r[1] \u0026quot;.md\u0026quot;\r$blogdown.filename.pre_processor\r[1] NA\r$blogdown.files_filter\r[1] NA\r$blogdown.generator\r[1] NA\r$blogdown.hugo.args\r[1] NA\r$blogdown.hugo.dir\r[1] NA\r$blogdown.hugo.server\r[1] NA\r$blogdown.hugo.version\r[1] \u0026quot;0.84.4\u0026quot;\r$blogdown.initial_files\r[1] NA\r$blogdown.knit.on_save\r[1] TRUE\r$blogdown.knit.serve_site\r[1] NA\r(...çœç•¥...)\r$warning.length\r[1] 1000\r$width\r[1] 80\r$windowsTimeouts\r[1] 100 500\r  å¦‚ä¸Šå¯ä»¥çŸ¥é“æœ‰ä¸€å¤§ä¸²åˆ—è¡¨,å¦‚æœæˆ‘åªæƒ³çŸ¥é“å¥—ä»¶blogdownçš„è¨­å®šåˆ—è¡¨ï¼Œè¦æ€æ¨£åš? ä¹Ÿå°±æ˜¯æ€æ¨£ç¯©é¸å‡ºæˆ‘è¦çš„è¨­å®š?\n è§£æ³•1:åˆ©ç”¨grep(),grepl() è§£æ³•2:sapply , ä¹Ÿæ˜¯ç”¨åˆ°grep() ä¸èƒ½ç”¨ %in%  å¯ä»¥åƒè€ƒé€™è£¡\næç¤º\r  è§£æ³•1  olist\u0026lt;-options() # list\rokey\u0026lt;-names(olist) # vector # \u0026quot;blogdown\u0026quot; %in% okey\ridx\u0026lt;-grep(\u0026quot;blogdown\u0026quot;,okey)\rolist[idx]\r #\u0026gt; $blogdown.method\r#\u0026gt; [1] \u0026quot;markdown\u0026quot;\r#\u0026gt; #\u0026gt; $blogdown.serve_site.startup\r#\u0026gt; [1] FALSE\r  è§£æ³•2:çœ‹ä¸€ä¸‹ç‚ºç”šéº¼ä¸èƒ½ç”¨ %in%  olist\u0026lt;-options() # list\rokey\u0026lt;-names(olist) # vector rst \u0026lt;- sapply(okey,function(item){\u0026quot;blogdown\u0026quot; %in% unlist(strsplit(item,\u0026quot;\\\\.\u0026quot;)) })\rolist[rst]\r #\u0026gt; $blogdown.method\r#\u0026gt; [1] \u0026quot;markdown\u0026quot;\r#\u0026gt; #\u0026gt; $blogdown.serve_site.startup\r#\u0026gt; [1] FALSE\r  è§£é‡‹é€™è¡Œ: rst \u0026lt;- sapply(okey,function(item){\u0026quot;blogdown\u0026quot; %in% unlist(strsplit(item,\u0026quot;\\\\.\u0026quot;)) })\n  \\\\.è€Œä¸æ˜¯åªæœ‰. strsplit()åŸ·è¡Œçš„çµæœæ˜¯ä¸€å€‹listè€Œåˆ†é›¢çš„å…ƒç´ åœ¨ç¬¬ä¸€å€‹nodeæ‰€ä»¥,ç”¨unlist %in%çš„ç”¨æ³•  v=c(\u0026quot;1.2\u0026quot;,\u0026quot;1.3\u0026quot;)\r\u0026quot;1\u0026quot; %in% v\r #\u0026gt; [1] FALSE\r \nâ›³ â“åœ¨ä¸»æ§å°ä¸Šçš„æ¯”è¼ƒå¤š,ä½†æ˜¯åœ¨rmarkdown chunkåªæœ‰çœ‹åˆ°å¹¾å€‹,å› ç‚ºåœ¨rmarkdownä¸­æ²’æœ‰è¼‰å…¥blogdownå¥—ä»¶ã€‚\nç·´ç¿’:æ‰¾å‡ºç›®å‰çš„èªç³» åˆ©ç”¨l10n_info() æ‰¾å‡ºç›®å‰çš„èªç³»,è€Œä¸æ˜¯ä¸€é€£ä¸²çœŸå‡å€¼ã€‚æç¤º\r l10n_info()[2:3][(l10n_info()[2:3])==TRUE]\r \n"},
{"uri": "/blogR//rlang/4_15_json.html","title": "4.15 json",
	"tags": [],
	"description": "4_15_json",
	"content": "if(!require(\u0026quot;rjson\u0026quot;)){\rinstall.packages(\u0026quot;rjson\u0026quot;)\r}\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šrjson\rx \u0026lt;- list( alpha = 1:5, beta = \u0026quot;Bravo for nonthing\u0026quot;, gamma = list(a=1:3, b=NULL), delta = c(TRUE, FALSE) )\rjson \u0026lt;- toJSON( x )\rhugocmd(\u0026quot;expand\u0026quot; ,'title=\u0026quot;\u0026quot; incode=true')\r#\u0026gt; \rå±•é–‹\rjson# \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026#34;codenote nopre\u0026#34;\u0026gt;ğŸ·\u0026lt;span class=\u0026#34;tooltiptext\u0026#34; \u0026gt;ä½ å¥½\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] \u0026#34;{\\\u0026#34;alpha\\\u0026#34;:[1,2,3,4,5],\\\u0026#34;beta\\\u0026#34;:\\\u0026#34;Bravo for nonthing\\\u0026#34;,\\\u0026#34;gamma\\\u0026#34;:{\\\u0026#34;a\\\u0026#34;:[1,2,3],\\\u0026#34;b\\\u0026#34;:null},\\\u0026#34;delta\\\u0026#34;:[true,false]}\u0026#34;\rhugocmd(m=\u0026#34;expand\u0026#34; ,end=T)\r#\u0026gt; \rfromJSON( json )\r#\u0026gt; $alpha\r#\u0026gt; [1] 1 2 3 4 5\r#\u0026gt; #\u0026gt; $beta\r#\u0026gt; [1] \u0026quot;Bravo for nonthing\u0026quot;\r#\u0026gt; #\u0026gt; $gamma\r#\u0026gt; $gamma$a\r#\u0026gt; [1] 1 2 3\r#\u0026gt; #\u0026gt; $gamma$b\r#\u0026gt; NULL\r#\u0026gt; #\u0026gt; #\u0026gt; $delta\r#\u0026gt; [1] TRUE FALSE\r"},
{"uri": "/blogR//rlang/4_3_type_matrix.html","title": "4.3 çŸ©é™£",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "matrix çŸ©é™£çš„å»ºç«‹æœ‰å¤šç¨®æ–¹å¼,å…¶ä¸­ä¸€ç¨®æ˜¯åˆ©ç”¨å‘é‡å¡«å……çŸ©é™£ï¼Œå¡«å…¥çš„æ–¹å¼é è¨­æ˜¯ä»¥coumnç‚ºä¸»è¦æ–¹å‘ã€‚\nmatrix(c(1,2,3,4,5,6),2,3)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 3 5\r#\u0026gt; [2,] 2 4 6\r å•é¡Œ: æ€æ¨£ç”¢ç”Ÿ\n$$ \\begin{bmatrix}1 \u0026amp; 2 \u0026amp; 3 \\\\ 4 \u0026amp; 5 \u0026amp; 6\\end{bmatrix} $$ çš„çŸ©é™£æç¤º\r \nå…¶ä»–ç·´ç¿’\nmatrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow = 3, byrow = TRUE, dimnames = list(c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;)))\r #\u0026gt; c1 c2 c3\r#\u0026gt; r1 1 2 3\r#\u0026gt; r2 4 5 6\r#\u0026gt; r3 7 8 9\r çŸ©é™£çš„ç›´è¡Œåç¨±å’Œæ©«è¡Œåç¨±\nm1 \u0026lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol = 3)\rrownames(m1) \u0026lt;- c(\u0026quot;r1\u0026quot;, \u0026quot;r2\u0026quot;, \u0026quot;r3\u0026quot;)\rcolnames(m1) \u0026lt;- c(\u0026quot;c1\u0026quot;, \u0026quot;c2\u0026quot;, \u0026quot;c3\u0026quot;)\rm1\r #\u0026gt; c1 c2 c3\r#\u0026gt; r1 1 4 7\r#\u0026gt; r2 2 5 8\r#\u0026gt; r3 3 6 9\r c(1,2,3) åœ¨æ•¸å­¸ä¸­åˆ°åº•æ˜¯ç›´è¡Œæˆ–æ©«è¡Œçš„æ¸¬è©¦\na\u0026lt;-c(1,2,3) t(a) %*% a # 1x1  #\u0026gt; [,1]\r#\u0026gt; [1,] 14\r a %*% t(a) # 3x3\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 2 3\r#\u0026gt; [2,] 2 4 6\r#\u0026gt; [3,] 3 6 9\r åˆä½µçŸ©é™£ åˆ©ç”¨å‡½æ•¸cbind() å¯ä»¥åˆä½µåŒæ¨£æ©«è¡Œæ•¸ç›®çš„å…©å€‹çŸ©é™£,ä¾‹å¦‚é€™è£¡Cä¹Ÿæ˜¯3å€‹æ©«è¡Œ:\nB = matrix( c(2, 4, 3, 1, 5, 7), nrow=3, ncol=2) B # ğŸ·ğŸ‘è¦åˆä½µçš„çŸ©é™£\r #\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 2 1\r#\u0026gt; [2,] 4 5\r#\u0026gt; [3,] 3 7\r C = matrix( c(7, 4, 2), nrow=3, ncol=1) C # ğŸ·ğŸ‘è¦åˆä½µçš„çŸ©é™£\r #\u0026gt; [,1]\r#\u0026gt; [1,] 7\r#\u0026gt; [2,] 4\r#\u0026gt; [3,] 2\r # Cå’ŒBåˆä½µ\rcbind(B, C)  #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 2 1 7\r#\u0026gt; [2,] 4 5 4\r#\u0026gt; [3,] 3 7 2\r åŒæ¨£çš„,rbind() ä¹Ÿå¯ä»¥åˆä½µç›´è¡Œæ•¸ç›®ç›¸åŒçš„å…©å€‹çŸ©é™£:\nD = matrix( c(6, 2), nrow=1, ncol=2) D\r #\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 6 2\r rbind(B, D)  #\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 2 1\r#\u0026gt; [2,] 4 5\r#\u0026gt; [3,] 3 7\r#\u0026gt; [4,] 6 2\r åˆä½µæ–¹å‘çš„ç¶­åº¦è¦ä¸€æ¨£ã€‚æ€æ¨£çŸ¥é“ç¶­åº¦?\ndim(B) # ğŸ·ğŸ‘ä¸€æ¬¡è¦çŸ¥é“å¤šå€‹çŸ©é™£çš„ç¶­åº¦,å¯ä»¥æ‡‰ç”¨lapplyã€‚ ä¾‹å¦‚,lapply(list(B,C),dim)  #\u0026gt; [1] 3 2\r ğŸ˜’ dim(c(1,2,3)) çµæœæ˜¯NULL , vector çš„ç¶­åº¦ç„¡æ³•ç¶“ç”±å‡½æ•¸dimå–å¾—ğŸ¤·â€â™€ï¸ã€‚\nå°‡çŸ©é™£è§£æ§‹å›å‘é‡:\n  æ–¹æ³•1:å¯ä»¥åˆ©ç”¨c() æœƒæŠŠçŸ©é™£æ‰€æœ‰çš„ç›´è¡Œéƒ½åˆä½µæˆä¸€å€‹ç›´è¡Œ.\nc(B)  #\u0026gt; [1] 2 4 3 1 5 7\r c(B,C)\r #\u0026gt; [1] 2 4 3 1 5 7 7 4 2\r   as.vector()\nas.vector(B)\r #\u0026gt; [1] 2 4 3 1 5 7\r   å¦‚æœæˆ‘è¦çš„æ˜¯æ©«è¡Œ?æç¤º\r \nå–®ä½çŸ©é™£ \\(5\\times5\\)çš„å–®ä½çŸ©é™£\ndiag(1, nrow = 5)\r #\u0026gt; [,1] [,2] [,3] [,4] [,5]\r#\u0026gt; [1,] 1 0 0 0 0\r#\u0026gt; [2,] 0 1 0 0 0\r#\u0026gt; [3,] 0 0 1 0 0\r#\u0026gt; [4,] 0 0 0 1 0\r#\u0026gt; [5,] 0 0 0 0 1\r Transpose t(B)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 2 4 3\r#\u0026gt; [2,] 1 5 7\r é€†çŸ©é™£   solve() å› ç‚º $$ AA^{-1}=I\na1 \u0026lt;- c(3, 2, 8)\ra2 \u0026lt;- c(6, 3, 2)\ra3 \u0026lt;- c(5, 2, 4)\rA \u0026lt;- rbind(a1, a2, a3)\rAinv\u0026lt;-solve(A,diag(3)) #ğŸ·ğŸ‘å¯ä»¥çœç•¥ç¬¬äºŒå€‹åƒæ•¸\rii\u0026lt;-A %*% Ainv\rprint(ii)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; a1 1.000000e+00 0.000000e+00 -1.110223e-16\r#\u0026gt; a2 8.326673e-17 1.000000e+00 -1.387779e-16\r#\u0026gt; a3 1.665335e-16 -2.220446e-16 1.000000e+00\r   inv() det() ğŸ˜’ğŸ·ğŸ‘library(matlab)\nprint(det(A)) #ğŸ·ğŸ‘det!=0 æ‰€ä»¥æœ‰é€†çŸ©é™£\r #\u0026gt; [1] -28\r print(solve(A))\r #\u0026gt; a1 a2 a3\r#\u0026gt; [1,] -0.2857143 -0.2857143 0.7142857\r#\u0026gt; [2,] 0.5000000 1.0000000 -1.5000000\r#\u0026gt; [3,] 0.1071429 -0.1428571 0.1071429\r   æˆ‘æƒ³è¦çŸ¥é“ä¸Šé¢çš„iiåˆ°åº•æ˜¯ä¸æ˜¯å–®ä½çŸ©é™£,è€Œæˆ‘çŸ¥é“å¯¦æ•¸çš„æ¯”å°å¯ä»¥ç”¨all.equal()\nall.equal(ii,diag(3))  ä½†æ˜¯å‡ºç¾é€™å€‹è¨Šæ¯ #\u0026gt; [1] \u0026quot;Attributes: \u0026lt; Length mismatch: comparison on first 1 components \u0026gt;\u0026quot;\næç¤º\r all.equal(unname(ii),diag(3))\r #\u0026gt; [1] TRUE\r \nç·´ç¿’:è§£æ–¹ç¨‹ $$ \\mathbf{A x} = \\mathbf{b} \\Rightarrow \\mathbf{A}^{-1} \\mathbf{A x} = \\mathbf{A}^{-1} \\mathbf{b} \\Rightarrow \\mathbf{x} = \\mathbf{A}^{-1} \\mathbf{b} $$\n$$ \\begin{bmatrix}14 \u0026amp; 32 \\\\ 32 \u0026amp; 77 \\end{bmatrix}X = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} $$\næç¤º\r m2\u0026lt;-cbind(c(14,32),c(32,77))\rb\u0026lt;-c(1,1)\rsolve(m2,b)\r #\u0026gt; [1] 0.8333333 -0.3333333\r \nå¸¸æ•¸é …çŸ©é™£çš„é€†: inv( kA ) = (1/k) * inv(A)\nif(!require(\u0026quot;matlib\u0026quot;)){\rinstall.packages(\u0026quot;matlab\u0026quot;,repos = \u0026quot;http://cran.us.r-project.org\u0026quot;)\r}\r #\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šmatlib\r library(matlib)\rA \u0026lt;- matrix( c(5, 1, 0,\r3,-1, 2,\r4, 0,-1), nrow=3, byrow=TRUE)\rsolve(5 * A)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.0125 0.0125 0.025\r#\u0026gt; [2,] 0.1375 -0.0625 -0.125\r#\u0026gt; [3,] 0.0500 0.0500 -0.100\r (1/5) * solve(A)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.0125 0.0125 0.025\r#\u0026gt; [2,] 0.1375 -0.0625 -0.125\r#\u0026gt; [3,] 0.0500 0.0500 -0.100\r inverse of diagonal matrix = diag( 1/ diagonal) å› ç‚ºæ˜¯åˆ†æ•¸, æ‰€ä»¥å¯ä»¥è€ƒæ…®ä½¿ç”¨ MASS::fractions().\nD \u0026lt;- diag(c(1, 2, 4))\rsolve(D)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 0.0 0.00\r#\u0026gt; [2,] 0 0.5 0.00\r#\u0026gt; [3,] 0 0.0 0.25\r MASS::fractions( diag(1 / c(1, 2, 4)) )\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 0 0 #\u0026gt; [2,] 0 1/2 0 #\u0026gt; [3,] 0 0 1/4\r inv(A) is symmetric if and only if A is symmetric\ninv( t(A) )  #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.0625 0.6875 0.25\r#\u0026gt; [2,] 0.0625 -0.3125 0.25\r#\u0026gt; [3,] 0.1250 -0.6250 -0.50\r is_symmetric_matrix(A)\r #\u0026gt; [1] FALSE\r is_symmetric_matrix( inv( t(A) ) )\r #\u0026gt; [1] FALSE\r Here is a symmetric case:\nB \u0026lt;- matrix( c(4, 2, 2,\r2, 3, 1,\r2, 1, 3), nrow=3, byrow=TRUE)\rinv(B)\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.50 -0.25 -0.25\r#\u0026gt; [2,] -0.25 0.50 0.00\r#\u0026gt; [3,] -0.25 0.00 0.50\r inv( t(B) )\r #\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.50 -0.25 -0.25\r#\u0026gt; [2,] -0.25 0.50 0.00\r#\u0026gt; [3,] -0.25 0.00 0.50\r is_symmetric_matrix(B)\r #\u0026gt; [1] TRUE\r is_symmetric_matrix( inv( t(B) ) )\r #\u0026gt; [1] TRUE\r all.equal( inv(B), inv( t(B) ) )  #\u0026gt; [1] TRUE\r ç·´ç¿’   åˆ©ç”¨ä¸Šé¢çš„m1 å›ç­”ä¸‹é¢çš„å•é¡Œ:\nm1[1, 2]\rm1[1:2, 2:3]\rm1[1,]\rm1[,2]\rm1[1:2,]\rm1[, 2:3]\rm1[-1,]\rm1[,-2]\rm1[c(\u0026quot;r1\u0026quot;, \u0026quot;r3\u0026quot;), c(\u0026quot;c1\u0026quot;, \u0026quot;c3\u0026quot;)]\rm1[1]\rm1[9]\rm1[3:7]\rm1 \u0026gt; 3\rm1[m1 \u0026gt; 3]\rm1 + m1\rm1 - 2*m1\rm1 * m1\rm1 / m1\rm1 ^ 2\rm1 %*% m1\rt(m1)\r   åˆ©ç”¨A,B,Cè­‰æ˜: inverse of a matrix product: ğŸ·ğŸ‘æ³¨æ„ç­‰è™Ÿå¾Œé¢çš„é †åº $$ (ABC)^{-1} = C^{-1} \\times B^{-1} \\times A^{-1} $$ ABCå¦‚ä¸‹:\nA \u0026lt;- matrix( c(5, 1, 0,\r3,-1, 2,\r4, 0,-1), nrow=3, byrow=TRUE)\rB \u0026lt;- matrix(c(1, 2, 3, 1, 3, 2, 2, 4, 1), nrow=3, byrow=TRUE)\rC \u0026lt;- B[, 3:1]\r  "},
{"uri": "/blogR//rlang/4_4_type_list.html","title": "4.4 ä¸²åˆ— list",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "List Lists æ˜¯ä¸€å€‹Rç‰©ä»¶ã€‚å…¶å…ƒç´ å…§å®¹å¯ä»¥æ˜¯ä¸åŒå‹æ…‹,ä¾‹å¦‚ numbers, strings, vectors,matrix æˆ–è€…æ˜¯å¦ä¸€å€‹ listï¼Œç”šè‡³æ˜¯å‡½æ•¸ã€‚\nåœ¨Rèªè¨€ä¸­,çŸ©é™£å‘é‡é€šå¸¸æ˜¯ç”¨ä¾†è¨ˆç®—,è€Œä¸²åˆ—å‰‡æ˜¯ç”¨ä¾†çµ„ç¹”å‰å…©è€…çš„ä¸€ç¨®æœ€åŸºæœ¬çµæ§‹æ–¹å¼ã€‚\nå»ºç«‹ List å‡½æ•¸list() å¯ä»¥å»ºç«‹list. list()ä¸­çš„åƒæ•¸ç”¨é€—é»éš”é–‹,å¹¾å€‹åƒæ•¸å°±å¹¾å€‹Nodeã€‚\n#å»ºç«‹ä¸²åˆ—,å…¶ä¸­çš„å…ƒç´ æœ‰å‘é‡,çŸ©é™£,å’Œä¸€å€‹ä¸²åˆ—\rlist_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), #ğŸ·ğŸ‘vector\rmatrix(c(3,9,5,1,-2,8), nrow = 2), #ğŸ·ğŸ‘matrix\rlist(\u0026quot;green\u0026quot;,12.3)) #ğŸ·ğŸ‘list\r çµ¦ä¸²åˆ—ä¸­çš„æ¯å€‹å…ƒç´ å‘½å listä¸­çš„å…ƒç´ å¯ä»¥å‘½å,ç„¶å¾Œç¶“ç”±åç¨±å­˜å–ã€‚ä¹Ÿå¯ä»¥èªªæ˜¯çµ¦æ¯å€‹å…ƒç´ è®Šæ•¸åç¨±ã€‚\n#å»ºç«‹ä¸²åˆ—,å…¶ä¸­çš„å…ƒç´ æœ‰å‘é‡,çŸ©é™£,å’Œä¸€å€‹ä¸²åˆ—\rlist_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), #ğŸ·ğŸ‘ å‘é‡\rmatrix(c(3,9,5,1,-2,8), nrow = 2), #ğŸ·ğŸ‘ çŸ©é™£\rlist(\u0026quot;green\u0026quot;,12.3)) #ğŸ·ğŸ‘ ä¸²åˆ—\r# çµ¦æ¯å€‹NODEå‘½å ğŸ·ğŸ‘ä¸Šé¢åªæ˜¯å»ºç«‹list,è£¡é¢çš„å…ƒç´ å¯ä»¥ç”±ç·¨è™Ÿå­˜å–\rnames(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;) #ğŸ·ğŸ‘ç¬¬1å€‹å’Œç¬¬3å€‹éƒ½æ˜¯ä¸åˆæ³•çš„è®Šæ•¸åç¨±\r#Show the list.\rprint(list_data)\r#\u0026gt; $`1st Quarter` ğŸ·ğŸ‘æ³¨æ„åé “è™Ÿ,ç”¨ä¾†æ¨™ç¤ºä¸åˆæ³•çš„è®Šæ•¸åç¨±\r#\u0026gt; [1] \u0026quot;Jan\u0026quot; \u0026quot;Feb\u0026quot; \u0026quot;Mar\u0026quot;\r#\u0026gt; #\u0026gt; $A_Matrix ğŸ·ğŸ‘ç¬¬2å€‹å…ƒç´ \r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 3 5 -2\r#\u0026gt; [2,] 9 1 8\r#\u0026gt; #\u0026gt; $`A Inner list` ğŸ·ğŸ‘ç¬¬3å€‹å…ƒç´ \r#\u0026gt; $`A Inner list`[[1]] ğŸ·ğŸ‘å› ç‚ºç¬¬3å€‹å…ƒç´ æ˜¯list,è€Œåˆæ²’æœ‰åç¨±,å› æ­¤ç·¨è™Ÿ1,æ³¨æ„[[]]\r#\u0026gt; [1] \u0026quot;green\u0026quot;\r#\u0026gt; #\u0026gt; $`A Inner list`[[2]]\r#\u0026gt; [1] 12.3\r å¸¶åçŸ©é™£ã€å‘é‡ã€ä¸²åˆ—çš„æ¯”è¼ƒ listå¯ä»¥å¸¶æœ‰è®Šæ•¸åç¨±,vecotr,matrix,data.frame ä¹Ÿå¯ä»¥ã€‚\n  vector:\nx=c(1,2,3)\rnames(x)\u0026lt;-c('a','b','c')\rx\r#\u0026gt; a b c #\u0026gt; 1 2 3\r \ræŒ‡æ´¾ç¬¦è™Ÿ\u0026lt;-çš„è¨è«–\ré€™è£¡è¨è«–ä¸€ä¸‹ç‚ºç”šéº¼åœ¨Rèªè¨€å …æŒ`\u0026lt;-`è€Œä¸æ˜¯`=`çš„ä¸€å€‹åŸå› \rä¸€èˆ¬çš„ç¨‹å¼èªè¨€,ä¸æœƒç”¨åˆ°é€™ç¨®æ–‡æ³•,ä¾‹å¦‚,åœ¨å…¶ä»–ç¨‹å¼èªè¨€ä¸­,ç›´è¦ºä¸Šæ‡‰è©²æ˜¯æœ‰ä¸€å€‹`names()`,ç„¶å¾Œç”¨æ³•å¦‚ä¸‹:\r```c names(x,c('a','b','c') )\r```\rğŸ‘¹å› æ­¤`\u0026lt;-`ä¸é¡ä¼¼æŒ‡æ´¾,è€Œæ˜¯é¡ä¼¼æµå‘æŸå€‹ç‰©ä»¶çš„å±¬æ€§ã€‚     matrix: names()çš„åƒæ•¸å¦‚æœæ˜¯matrix,æ˜¯âœ”ï¸çµ¦çŸ©é™£çš„æ¯å€‹å…ƒç´ å‘½åã€‚è€Œä¸æ˜¯âŒæ¬„ä½(column)æˆ–æ˜¯ç´€éŒ„(row)çš„åç¨±\nx\u0026lt;-matrix(runif(9),nrow=3)\rnames(x)\u0026lt;-c('a','b','c')\rx\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 0.9139203 0.8162566 0.7813051\r#\u0026gt; [2,] 0.8105450 0.3592360 0.5047523\r#\u0026gt; [3,] 0.4284657 0.6444916 0.6322681\r#\u0026gt; attr(,\u0026quot;names\u0026quot;)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; NA NA NA NA NA NA\r names \u0026amp; matrix\r rownames(x)\u0026lt;-c('x','y','z')\rprint(x,row.names=T) #ğŸ·ğŸ‘row.names=T æ˜¯é è¨­\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; x 0.9139203 0.8162566 0.7813051\r#\u0026gt; y 0.8105450 0.3592360 0.5047523\r#\u0026gt; z 0.4284657 0.6444916 0.6322681\r#\u0026gt; attr(,\u0026quot;names\u0026quot;)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; NA NA NA NA NA NA\r åœ–\r   data.frame: ä½†æ˜¯åœ¨data.frameçš„çµæ§‹ä¸­,names()\u0026lt;- çµ¦å®šçš„æ˜¯æ¬„ä½åç¨±\nxd\u0026lt;-data.frame(x)\rnames(xd)\u0026lt;-c('a','b','c')\rxd\r#\u0026gt; Error in str(list(...)): '...' çš„ä¸Šä¸‹æ–‡ç”¨å¾—ä¸æ­£ç¢º\r   â“å•:åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­xæ˜¯ä¸€å€‹çŸ©é™£,x[\u0026quot;a\u0026quot;]æœƒå‚³å›ç”šéº¼?æç¤º\r ğŸ“ x[\u0026quot;a\u0026quot;] ä»ç„¶å¸¶åç¨±ï¼Œä½†æ˜¯x[[\u0026quot;a\u0026quot;]]åƒ…åƒ…å‚³å›å…§å®¹(ä¸å¸¶åç¨±)\ndata\u0026lt;-runif(9)\rnames(data) \u0026lt;- letters[5:7]\rdata[\u0026quot;e\u0026quot;]\r#\u0026gt; e #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ ä»ç„¶å¸¶æœ‰åç¨±\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; 0.04835572 data[[\u0026quot;e\u0026quot;]]\r#\u0026gt; [1] 0.04835572 # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ åªæœ‰å…§å®¹\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\ris.vector(data[\u0026quot;e\u0026quot;])\r#\u0026gt; [1] TRUE\ris.vector(data[[\u0026quot;e\u0026quot;]])\r#\u0026gt; [1] TRUE\ridentical(data[\u0026quot;e\u0026quot;],data[[\u0026quot;e\u0026quot;]])\r#\u0026gt; [1] FALSE\rx\u0026lt;-matrix(data,nrow=3) #è½‰æˆçŸ©é™£\rx\r#\u0026gt; [,1] [,2] [,3] \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ä¸Šé¢çš„åç¨±ä¸æœƒè¢«è½‰å…¥ğŸ¤·â€â™€ï¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1,] 0.04835572 0.9641557 0.5600760\r#\u0026gt; [2,] 0.46890756 0.9957986 0.3604039\r#\u0026gt; [3,] 0.56452261 0.6176634 0.7830758\rnames(x)\u0026lt;-c('a','b','c')\rrownames(x)\u0026lt;-c('x','y','z')\rx\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; x 0.04835572 0.9641557 0.5600760 \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™ä¸€ç­†ç´€éŒ„åç¨±ç‚ºx\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; y 0.46890756 0.9957986 0.3604039\r#\u0026gt; z 0.56452261 0.6176634 0.7830758\r#\u0026gt; attr(,\u0026quot;names\u0026quot;)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot; NA NA NA NA NA NA \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘å‰ä¸‰å€‹å…ƒç´ æœ‰åç¨±å…¶ä»–æ²’æœ‰,é€™è£¡çš„çµæ§‹æ˜¯string vectoré•·åº¦9\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rx[\u0026quot;a\u0026quot;]\r#\u0026gt; a \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ ä»ç„¶å¸¶æœ‰åç¨±\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; 0.04835572\rx[[\u0026quot;a\u0026quot;]]\r#\u0026gt; 0.04835572 \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ ä¸å¸¶åç¨±,ç´”ç²¹æ˜¯å…§å®¹\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rstr(x[\u0026quot;a\u0026quot;]) \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ å¸¶æœ‰åç¨±çš„çµæ§‹\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; Named num 0.0484\r#\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr \u0026quot;a\u0026quot; \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ attr(*,\u0026amp;quot;names\u0026amp;quot;)è¡¨ç¤ºå¸¶å±¬æ€§names,å…¶å…§å®¹ç‚ºåç¨±å‘é‡(å› ç‚ºchr \u0026amp;quot;a\u0026amp;quot;)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rclass(x[\u0026quot;a\u0026quot;])\r#\u0026gt; [1] \u0026quot;numeric\u0026quot; #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åªæœ‰å…§å®¹,ç‚ºæ•¸å€¼å‘é‡,è€Œä¸æ˜¯æ•¸å€¼çŸ©é™£\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\ris.vector(x[\u0026quot;a\u0026quot;])\r#\u0026gt; [1] TRUE\ris.matrix(x[\u0026quot;a\u0026quot;])\r#\u0026gt; [1] FALSE #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘supprisedğŸ‘º ä¸æ˜¯çŸ©é™£ğŸ¤·â€â™€ï¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rx[\u0026quot;x\u0026quot;,1] # ğŸ·\r#\u0026gt; x #\u0026gt; 0.04835572\ris.vector(x[\u0026quot;x\u0026quot;,1])\r#\u0026gt; [1] TRUE\ris.matrix(x[\u0026quot;x\u0026quot;,1])\r#\u0026gt; [1] FALSE\r \nå­˜å– List å…ƒç´  # 3å€‹å…ƒç´ ,åˆ†åˆ¥æ˜¯list, matrix, list\rlist_data \u0026lt;- list(c(\u0026quot;Jan\u0026quot;,\u0026quot;Feb\u0026quot;,\u0026quot;Mar\u0026quot;), matrix(c(3,9,5,1,-2,8), nrow = 2),\rlist(\u0026quot;green\u0026quot;,12.3))\r# çµ¦åç¨±\rnames(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;)\r# Access the first element of the list.\rprint(list_data[1])\r#\u0026gt; $`1st Quarter`\r#\u0026gt; [1] \u0026quot;Jan\u0026quot; \u0026quot;Feb\u0026quot; \u0026quot;Mar\u0026quot;\r# Access the thrid element. As it is also a list, all its elements will be printed.\rprint(list_data[3])\r#\u0026gt; $`A Inner list`\r#\u0026gt; $`A Inner list`[[1]]\r#\u0026gt; [1] \u0026quot;green\u0026quot;\r#\u0026gt; #\u0026gt; $`A Inner list`[[2]]\r#\u0026gt; [1] 12.3\r# Access the list element using the name of the element.\rprint(list_data$A_Matrix)\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 3 5 -2\r#\u0026gt; [2,] 9 1 8\r list å…ƒç´ çš„å­˜å–å¯ä»¥æ˜¯[[]] æˆ– $ ä¾‹å¦‚x[[\u0026quot;a\u0026quot;]], x$a (æˆ–x$`a`)ã€‚\n[] å’Œ [[]] çš„ä¸»è¦åˆ†åˆ¥æ˜¯,å‰è€…æ‹¿åˆ°å­é›†åˆ,å¾Œè€…æ‹¿åˆ°å…§å®¹ã€‚\r\r\rè™•ç†list å…ƒç´  listçš„åŠ å…¥å’Œåˆªé™¤,åªèƒ½åœ¨å°¾ç«¯ï¼Œä½†æ˜¯æ›´æ”¹è³‡æ–™ä¸å—é™åˆ¶ã€‚\n# Create a list containing a vector, a matrix and a list.\rlist_data \u0026lt;- list(1,2,3) # # Give names to the elements in the list.\rnames(list_data) \u0026lt;- c(\u0026quot;1st Quarter\u0026quot;, \u0026quot;A_Matrix\u0026quot;, \u0026quot;A Inner list\u0026quot;)\r# åŠ å…¥å…ƒç´ \rlist_data[4] \u0026lt;- \u0026quot;New element\u0026quot;\rprint(list_data[4])\r#\u0026gt; [[1]]\r#\u0026gt; [1] \u0026quot;New element\u0026quot;\r# ğŸ”‘ç§»é™¤æœ€å¾Œä¸€å€‹å…ƒç´ \rlist_data[4] \u0026lt;- NULL\r# Print the 4th Element.\rprint(list_data[4])\r#\u0026gt; $\u0026lt;NA\u0026gt;\r#\u0026gt; NULL\r# Update the 3rd Element.\rlist_data[3] \u0026lt;- \u0026quot;updated element\u0026quot;\rprint(list_data[3])\r#\u0026gt; $`A Inner list`\r#\u0026gt; [1] \u0026quot;updated element\u0026quot;\r å•é¡Œ\n list(1,2,3) å’Œ list(1:3) æœ‰ç”šéº¼ä¸åŒ c(1,2,3) å’Œ c(1:3) æœ‰ç”šéº¼ä¸åŒ  æç¤º\r list(1,2,3)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] 2\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 3\rlist(1:3)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1 2 3\rc(1:3)\r#\u0026gt; [1] 1 2 3\rc(1,2,3)\r#\u0026gt; [1] 1 2 3\r \nåˆä½µ Lists You can merge many lists into one list by placing all the lists inside one list() function.\n# Create two lists.\rlist1 \u0026lt;- list(1,2,3)\rlist2 \u0026lt;- list(\u0026quot;Sun\u0026quot;,\u0026quot;Mon\u0026quot;,\u0026quot;Tue\u0026quot;)\r# Merge the two lists.\rmerged.list \u0026lt;- c(list1,list2)\r# Print the merged list.\rprint(merged.list)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] 2\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 3\r#\u0026gt; #\u0026gt; [[4]]\r#\u0026gt; [1] \u0026quot;Sun\u0026quot;\r#\u0026gt; #\u0026gt; [[5]]\r#\u0026gt; [1] \u0026quot;Mon\u0026quot;\r#\u0026gt; #\u0026gt; [[6]]\r#\u0026gt; [1] \u0026quot;Tue\u0026quot;\r â“ åœ¨å¤§éƒ¨åˆ†ç¨‹å¼èªè¨€ä¸­,å‘é‡çš„æ„æ€,åªè¦å…ƒç´ åŒå‹æ…‹å°±è¡Œã€‚åˆï¼Œæˆ‘å€‘å·²ç¶“çŸ¥é“,å‡½æ•¸cå¯ä»¥ç”¢ç”Ÿå‘é‡ã€‚ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­,åˆ©ç”¨cå°‡å…©å€‹list åˆä½µ,æˆ‘å€‘æŒ‰ç…§å¤§éƒ¨åˆ†ç¨‹å¼èªè¨€çš„è§€å¿µçŸ¥é“,æ—¢ç„¶å…ƒç´ éƒ½æ˜¯ç›¸åŒå‹æ…‹(éƒ½æ˜¯list),é‚£å°±æ˜¯2å€‹å…ƒç´ ï¼Œä½†æ˜¯ç¾åœ¨æ˜¯6å€‹,ç‚ºç”šéº¼?\nğŸ‘ å‡½æ•¸c()æ˜¯ä¸€å€‹å¤šå‹å‡½æ•¸(ç‰©ä»¶èªè¨€ä¸­çš„è¬›æ³•å°±æ˜¯æ ¹æ“šåƒæ•¸çš„ä¸åŒ,è€Œæœ‰ä¸åŒçš„çµæœ)ã€‚é€™è£¡çš„çµæœæ˜¯6å€‹å…ƒç´ ã€‚æ¯å€‹å…ƒç´ éƒ½æ˜¯list(è­‰æ˜:list)ã€‚\n\r\r â“å¦‚æœè¦2å€‹?  ğŸ“ é‚£å°±æ˜¯merged.list2\u0026lt;-list(list1,list2)ã€‚   â“ merge.list\u0026lt;-c(x,y) ä¸­çš„mergeæ˜¯ä¸æ˜¯ç‰©ä»¶çš„æ„æ€?  ğŸ‘ ä¸æ˜¯ã€‚åªæ˜¯å€‹åˆæ³•çš„è®Šæ•¸ã€‚    \r\râ“ å¯«ä¸€å€‹å‡½æ•¸,åˆä½µå…©å€‹list,ä½†æ˜¯è¦æ±‚å…©å€‹listä¸­æœ‰åŒåçš„å…ƒç´ å¿…é ˆæ˜¯ç¬¬2å€‹ä¸­çš„åç¨±ã€‚ä¾‹å¦‚ list(a=1,b=2,c=3), list(b=4) åˆä½µå¾Œè®Šæˆ a=1,b=4,c=3ã€‚\nğŸ“\nmerge_list = function(x, y) {\rx[names(y)] = y\rx\r}\r \r\rList è½‰ Vector å‡½æ•¸ unlist()\n# Create lists.\rlist1 \u0026lt;- list(1:5) # ğŸ·ä¸æ˜¯ç”¢ç”Ÿ5å€‹NODEçš„ä¸²åˆ—,è€Œæ˜¯å…ˆç”¢ç”Ÿ5å€‹å…ƒç´ çš„å‘é‡,ç„¶å¾Œæ”¾åˆ°ç¬¬ä¸€å€‹ç¯€é»\rprint(list1)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1 2 3 4 5\rlist2 \u0026lt;-list(10:14)\rprint(list2)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 10 11 12 13 14\r# Convert the lists to vectors.\rv1 \u0026lt;- unlist(list1)\rv2 \u0026lt;- unlist(list2)\rprint(v1)\r#\u0026gt; [1] 1 2 3 4 5\rprint(v2)\r#\u0026gt; [1] 10 11 12 13 14\r# Now add the vectors\rresult \u0026lt;- v1+v2\rprint(result)\r#\u0026gt; [1] 11 13 15 17 19\r â“ å¦‚æœæ˜¯listä¸­çš„å…§å®¹æœ‰ä¸ä¸€æ¨£çš„å‹æ…‹å‘¢?ä¾‹å¦‚\nx\u0026lt;-list(\u0026quot;a\u0026quot;,1)\ry\u0026lt;-unlist(x)\rtypeof (y)\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r \r\ræ¯”è¼ƒvector, listä¸­,å­—ä¸²çš„å•é¡Œ  Q length()å‡½æ•¸å¯ä»¥çŸ¥é“vector,list çš„é•·åº¦,ä½†æ˜¯ç‚ºç”šéº¼length(\u0026quot;hello\u0026quot;)çš„é•·åº¦æ˜¯1?  a\u0026lt;-c(\u0026quot;hello\u0026quot;,\u0026quot;r\u0026quot;)\rlength(a) #ğŸ’¡\r#\u0026gt; [1] 2\rlength(a[1]) #ğŸ’¡\r#\u0026gt; [1] 1\rlength(a[[1]]) #ğŸ’¡\r#\u0026gt; [1] 1\rnchar(a[1]) #ğŸ”‘\r#\u0026gt; [1] 5\rlength(\u0026quot;hello\u0026quot;) #â“\r#\u0026gt; [1] 1\r åœ–\r  Q  a\u0026lt;-list(\u0026quot;hello\u0026quot;,\u0026quot;r\u0026quot;)\rlength(a)\r#\u0026gt; [1] 2\rlength(a[1])\r#\u0026gt; [1] 1\rlength(a[[1]])\r#\u0026gt; [1] 1\rtypeof(\u0026quot;xxx\u0026quot;) #ğŸ’¡\r#\u0026gt; [1] \u0026quot;character\u0026quot;\rtypeof(1) #ğŸ’¡\r#\u0026gt; [1] \u0026quot;double\u0026quot;\rtypeof(1L) #ğŸ’¡\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\r ä¸Šé¢å…©å€‹ç­”æ¡ˆçš„å•é¡Œ,å’ŒRæ€æ¨£å»ºç«‹å­—ä¸²æœ‰é—œ ğŸ“ç¸½ä¹‹,å­—ä¸²é•·åº¦å‡½æ•¸ğŸ”‘nchar()ã€‚\nç·´ç¿’ data set build in å¦‚æœç¾åœ¨è¦åšä¸€å€‹æ¸…å–®,åˆ—å‡ºæœ‰å“ªäº›å…§å»ºè³‡æ–™å¯ä»¥ç”¨,æœ‰ç©ºå¯ä»¥ä¾†æŸ¥ä¸€ä¸‹,è¦æ€éº¼åš?æˆ‘å€‘å¯ä»¥æ‰“æŒ‡ä»¤data(),ä½†æ˜¯ä»–æœƒå‡ºç¾åœ¨è¦–çª—ä¸­ã€‚\n  æˆ‘å€‘çŸ¥é“å¯ä»¥æŒ‡æ´¾çµ¦æŸå€‹è®Šæ•¸,å°±ä¸æœƒé¡¯ç¤ºçµæœ(å°±æ˜¯ä¸æœƒå‡ºç¾è¦–çª—),æ‰€ä»¥\nbuilding_data\u0026lt;-data()    çœ‹ä¸€ä¸‹çµæ§‹\nstr(building_data)\r#\u0026gt; List of 4\r#\u0026gt; $ title : chr \u0026quot;Data sets\u0026quot;\r#\u0026gt; $ header : NULL\r#\u0026gt; $ results: chr [1:104, 1:4] \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; ... #ğŸ·ğŸ‘æ‡‰è©²åœ¨é€™è£¡,ä½†æ˜¯é€™æ˜¯ç”šéº¼\r#\u0026gt; ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; .. ..$ : NULL\r#\u0026gt; .. ..$ : chr [1:4] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot;\r#\u0026gt; $ footer : chr \u0026quot;Use 'data(package = .packages(all.available = TRUE))'\\nto list the data sets in all *available* packages.\u0026quot;\r#\u0026gt; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;packageIQR\u0026quot;\r   æƒ³è¦çŸ¥é“resultsçš„çµæ§‹\nstr(building_data$results)\r#\u0026gt; chr [1:104, 1:4] \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; \u0026quot;datasets\u0026quot; ...\r#\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r#\u0026gt; ..$ : NULL\r#\u0026gt; ..$ : chr [1:4] \u0026quot;Package\u0026quot; \u0026quot;LibPath\u0026quot; \u0026quot;Item\u0026quot; \u0026quot;Title\u0026quot;\rclass(building_data$results)\r#\u0026gt; [1] \u0026quot;matrix\u0026quot; \u0026quot;array\u0026quot;\r   çŸ¥é“æ˜¯çŸ©é™£\nas.data.frame(building_data$results)\r#\u0026gt; Error in str(list(...)): '...' çš„ä¸Šä¸‹æ–‡ç”¨å¾—ä¸æ­£ç¢º\r   å…¶ä»–ç›¸é—œæŒ‡ä»¤\ndata(mtcars)\rnrow(mtcars)\r#\u0026gt; [1] 32\rncol(mtcars)\r#\u0026gt; [1] 11\r ç·´ç¿’ æ‹¿å…ƒç´  [ å¤§æ¦‚æ¶µè“‹äº†æ‰€æœ‰å­˜å–å…ƒç´ çš„æ–¹æ³•åƒè€ƒ\nâ“å¦‚æœè³‡æ–™å¦‚ä¸‹,\n\u0026gt; data\rV1 V2\r1 12.448 13.919\r2 22.242 4.606\r3 24.509 0.176\r å‰‡ä¸‹é¢æŒ‡ä»¤åˆ†åˆ¥æ‹¿åˆ°ç”šéº¼?\ndata[1,1]\rdata[1,\u0026quot;V1\u0026quot;]\rdata$V1[1]\rdata[[1]][1]\rdata[[\u0026quot;V1\u0026quot;]][1]\r alist å¦‚ä¸‹\nalist \u0026lt;- list(x1=numeric(0), x2=\u0026quot;foo\u0026quot;, x3=numeric(0), x4=2:5)\r  æ‰¾å‡ºé•·åº¦ä¸æ˜¯0çš„å…ƒç´  æ‰¾å‡ºé•·åº¦æ˜¯0çš„å…ƒç´ åç¨±  æç¤º\r  æ‰¾å‡ºé•·åº¦ä¸æ˜¯0çš„å…ƒç´  alist[lapply(alist, length) \u0026gt; 0]\r  æ‰¾å‡ºé•·åº¦æ˜¯0çš„å…ƒç´ åç¨± names(l)[lapply(l, length) == 0]\r   \nå¦‚ä½•æª¢æŸ¥ä¸‹é¢çš„fooæ˜¯å¦åŒ…å«a,b,c ?\nfoo \u0026lt;- list(a=42, b=NULL)\r æç¤º\r  æ–¹æ³•1 is.null(foo[[\u0026quot;a\u0026quot;]]) # FALSE\ris.null(foo[[\u0026quot;b\u0026quot;]]) # TRUE, but the element \u0026quot;exists\u0026quot;...\ris.null(foo[[\u0026quot;c\u0026quot;]]) # TRUE\r  æ–¹æ³•2 \u0026quot;a\u0026quot; %in% names(foo) # TRUE\r\u0026quot;b\u0026quot; %in% names(foo) # TRUE\r\u0026quot;c\u0026quot; %in% names(foo) # FALSE\r   \n"},
{"uri": "/blogR//rlang/4_5_type_string_function.html","title": "4.5 å­—ä¸²è™•ç†å‡½æ•¸",
	"tags": ["å­—ä¸²"],
	"description": "4_5_type_string_function",
	"content": " title: 4_5_type_string_function description: 4_5_type_string_function tags: [] categories: [] series: [] editext: Rmarkdown \rå­—ä¸²å‡½æ•¸ ç›¸é—œå¥—ä»¶  package glu  å‡½æ•¸ paste æœ€ç°¡å–®çš„ç¯„ä¾‹\npaste0(\u0026quot;x\u0026quot;,\u0026quot;y\u0026quot;,\u0026quot;z\u0026quot;)\r#\u0026gt; [1] \u0026quot;xyz\u0026quot;\r ç¯„ä¾‹\ns1 = c('hello','Copy') s2 = c('john','pen') print(paste(s1,s2,sep=\u0026quot; \u0026quot;,collapse=\u0026quot;-\u0026quot;))\r#\u0026gt; \u0026quot;hello john-Copy pen\u0026quot;  s1 s2   hello john  copy pen     åœ–\r ç¯„ä¾‹è§£èªª:\n paste0(c(1,2),c(3,4),collapse='') æœƒæœ‰ç”šéº¼ç­”æ¡ˆ? æ€æ¨£å¾—åˆ°\u0026quot;1234\u0026quot;  çµæœç‚º1324 (ä¸æ˜¯ 1234)\n å…ˆå…©å€‹åƒæ•¸ä¹‹é–“çš„ç›¸é€£,çµæœæ˜¯(\u0026quot;13\u0026quot;,\u0026quot;24\u0026quot;)ï¼Œé•·åº¦ç‚º2çš„å‘é‡ã€‚ ç„¶å¾Œå¦‚æœé‚„è¦æˆç‚ºä¸€å€‹å‘é‡,å¯ä»¥çµ¦å®šåƒæ•¸collaose=\u0026quot;\u0026quot;,å› æ­¤ä¸Šä¾‹çš„åŸ·è¡Œçµæœç‚º \u0026quot;1324\u0026quot;ã€‚ å¦‚æœæ²’æœ‰çµ¦åƒæ•¸,collapse=\u0026quot;any\u0026quot;å‰‡,ä¸æœƒcollapseã€‚ä¾‹å¦‚ä¸Šä¾‹å¦‚æœä¸çµ¦collapse,å‰‡åŸ·è¡Œçµæœæ˜¯(\u0026quot;13\u0026quot;,\u0026quot;24\u0026quot;)  ğŸ’¡ paste0()æ˜¯paste()çš„ç°¡åŒ–ç‰ˆã€‚paste0()é è¨­åˆ†éš”å­—å…ƒ(separator)ç‚º\u0026quot;\u0026quot;(ç„¡æ³•æ›´æ”¹),å¦‚æœè¦ç”¨å…¶ä»–çš„åˆ†éš”å­—å…ƒå¿…é ˆä½¿ç”¨å‡½æ•¸paste()ã€‚\nrst=paste0(c(1,2)) rst # ğŸ·âœ”rst=c(\u0026quot;1\u0026quot;,\u0026quot;2\u0026quot;) é•·åº¦ç‚º2(å› ç‚ºåªæœ‰ä¸€å€‹åƒæ•¸,åˆæ²’æœ‰æŒ‡å®šåƒæ•¸collapse)\r#\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;2\u0026quot;\rlength(rst)\r#\u0026gt; [1] 2\rrst=paste0(c(1,2),c(3,4),collapse=\u0026quot;*\u0026quot;)\rrst\r#\u0026gt; [1] \u0026quot;13*24\u0026quot;\rlength(rst)\r#\u0026gt; [1] 1\rrst=paste(c(1,2),c(3,4),collapse=\u0026quot;*\u0026quot;)\rrst\r#\u0026gt; [1] \u0026quot;1 3*2 4\u0026quot;\rlength(rst)\r#\u0026gt; [1] 1\r Ræä¾›çš„å­—ä¸²å‡½æ•¸(ascii)  nchar: string length paste: concatenate strings substr: substring toupper: convert entire string to uppercase tolower: convert entire string to lowercase chartr: character map replacement (like \u0026quot;tr\u0026quot;) strtrimï¼štrunates string  nchar, substr, toupper, tolower will accept string vectors as arguments and return vector results.\nstrtrim accepts both a vector of strings and a vector of truncation positions.\n \\': ç­‰åŒæ–¼ \u0026quot;'\u0026quot; . \\\u0026quot;: ç­‰åŒæ–¼ '\u0026quot;'. \\n: newline. \\r: carriage return. \\t: tab character.   Note: cat() and print() è™•ç†é€ƒé€¸å­—å…ƒçš„æ–¹å¼ä¸ä¸€æ¨£å¦‚æœè¦åœ¨è¢å¹•ä¸Šè§£è®€ä¸Šé¢çš„å­—ä¸²,éœ€è¦çš„æ˜¯ cat().\n print(\u0026quot;a\\nb\u0026quot;)\r#\u0026gt; [1] \u0026quot;a\\nb\u0026quot;\rcat(\u0026quot;a\\nb\u0026quot;)\r#\u0026gt; a\r#\u0026gt; b\r ç·´ç¿’ collapse çš„ç¯„ä¾‹,å•ä¸‹é¢çš„ç¨‹å¼çš„åŸ·è¡Œçµæœ\npaste(c('A', 'B', 'C'), 1:7, sep=\u0026quot;-\u0026quot;, collapse=\u0026quot;/\u0026quot;)\r æç¤º\r # [1] \u0026quot;A-1/B-2/C-3/A-4/B-5/C-6/A-7\u0026quot;\r \næ‡‰ç”¨ç¯„ä¾‹macro   version 1\nx\u0026lt;- \u0026quot;${1} is good\u0026quot;\rgsub(\u0026quot;\\\\$\\\\{1\\\\}\u0026quot;,\u0026quot;dog\u0026quot;,x)\r#\u0026gt; [1] \u0026quot;dog is good\u0026quot;\r   version 2 æ”¹æˆå‡½æ•¸\nmstr\u0026lt;-function (src,mto)\r{\rreturn (gsub(\u0026quot;\\\\$\\\\{1\\\\}\u0026quot;,mto,src))\r}\rx\u0026lt;- \u0026quot;${1} is good\u0026quot;\rmstr(x,\u0026quot;dog\u0026quot;)\r#\u0026gt; [1] \u0026quot;dog is good\u0026quot;\r   å‡½æ•¸ sprintf() Specifier Value Type   %c Character  %d or %i Signed Decimal Integer  %e or %E Scientific notation  %f Decimal Floating Point  %u Unsigned Decimal Integer  %p Pointer address     å‡½æ•¸ strsplit() åˆ©ç”¨é€—è™Ÿåˆ†è§£,ç„¶å¾Œæå–KEY,VALUEã€‚\nstr= \u0026quot;cmd=bstable,class=\\\u0026quot;d-block w-50\\\u0026quot;,style=\\\u0026quot;display:none\\\u0026quot;\u0026quot;\rstrsplit(str,\u0026quot;,\u0026quot;) #ğŸ·å¦‚æœstr æ˜¯å­—ä¸²é™£åˆ—,é‚£éº¼Nå€‹å­—ä¸²å°±æœƒæœ‰Nå€‹åˆ†å‰²,é€™è£¡åªæœ‰ä¸€å€‹åˆ†å‰²,å› æ­¤ç”¢ç”Ÿ1å€‹ç¯€é»,é€™å€‹ç¯€é»æ˜¯3å…ƒç´ çš„å­—ä¸²é™£åˆ—ã€‚\r#\u0026gt; [[1]]\r#\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot; \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot; \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot;\runlist(strsplit(str,\u0026quot;,\u0026quot;)) # ğŸ·ç”¢ç”Ÿå‘é‡\r#\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot; \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot; \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot;\ras.list(unlist(strsplit(str,\u0026quot;,\u0026quot;)))\r#\u0026gt; [[1]]\r#\u0026gt; [1] \u0026quot;cmd=bstable\u0026quot;\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] \u0026quot;class=\\\u0026quot;d-block w-50\\\u0026quot;\u0026quot;\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] \u0026quot;style=\\\u0026quot;display:none\\\u0026quot;\u0026quot;\r misc å‡½æ•¸ get() assign() ç”¨ä¾†åˆ©ç”¨å­—ä¸²è€Œä¸æ˜¯è®Šæ•¸ä¾†å­˜å–ç‰©ä»¶ã€‚è€Œ as.name() å¯ä»¥ç”¨ä¾†å°‡å­—ä¸²è½‰ç‚ºè®Šæ•¸ã€‚ (å¯ä»¥é…åˆ substitute() å»ºç«‹ expression ç„¶å¾Œeval() ã€‚\nä¾‹å¦‚ assign(\u0026quot;a\u0026quot;,get(\u0026quot;b\u0026quot;)) ç›¸ç•¶æ–¼ a\u0026lt;-b ã€‚\næ¯”è¼ƒå¸¸è¦‹çš„æ–¹æ³•æ˜¯åˆ©ç”¨list()ï¼Œä¾‹å¦‚\nobj\u0026lt;-list(a=1,b=2)\robj[[\u0026quot;a\u0026quot;]]\u0026lt;-otherobj[[\u0026quot;b\u0026quot;]]\r æ­¤æ™‚obj[[\u0026quot;a\u0026quot;]] æ˜¯å°å…ƒç´ açš„åƒè€ƒã€‚\n"},
{"uri": "/blogR//rlang/4_6_type_dataframe.html","title": "4.6 è³‡æ–™é›† data frame",
	"tags": [],
	"description": "4_6_Type_DataFrame",
	"content": "ç°¡å–®ä»‹ç´¹ä¸€ä¸‹æ‰‹å‹•å»ºç«‹data.frame 3å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯a,b,f\na \u0026lt;- c(1, 2, 3, 4)\rb \u0026lt;- c(2, 4, 6, 8)\rlevels \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;))\rbubba \u0026lt;- data.frame(first = a,\rsecond = b,\rf = levels)\rbubba\r first second f   1 2 A  2 4 B  3 6 A  4 8 B     summary(bubba)\r#\u0026gt; first second f #\u0026gt; Min. :1.00 Min. :2.0 A:2 #\u0026gt; 1st Qu.:1.75 1st Qu.:3.5 B:2 #\u0026gt; Median :2.50 Median :5.0 #\u0026gt; Mean :2.50 Mean :5.0 #\u0026gt; 3rd Qu.:3.25 3rd Qu.:6.5 #\u0026gt; Max. :4.00 Max. :8.0\rbubba$first\r#\u0026gt; [1] 1 2 3 4\rbubba$second\r#\u0026gt; [1] 2 4 6 8\rbubba$f\r#\u0026gt; [1] A B A B\r#\u0026gt; Levels: A B\r å‡½æ•¸attach(): å¦‚æœä¸æƒ³è¦æ‰“$å­—è™Ÿ,å‰‡ç”¨attach(è³‡æ–™é›†åç¨±)å…ˆæŠŠè³‡æ–™é›†è¼‰å…¥\nattach(mtcars)\rplot(wt, mpg) abline(lm(mpg~wt))\rtitle(\u0026quot;Regression of MPG on Weight\u0026quot;)\r data frame çš„å¸¸ç”¨å‡½æ•¸ï¼š  head() - shows first 6 rows tail() - shows last 6 rows dim() - returns the dimensions of data frame (i.e. number of rows and number of columns) nrow() - number of rows ncol() - number of columns str() - structure of data frame - name, type and preview of data in each column names() - shows the names attribute for a data frame, which gives the column names. sapply(dataframe, class) - shows the class of each column in the data frame    åˆ©ç”¨read.csvè®€å…¥çš„data.frame : tree\ntree = read.csv(\u0026quot;./resources/trees91.csv\u0026quot;, header = TRUE, sep = \u0026quot;,\u0026quot;);\r# é †ä¾¿çœ‹çœ‹çµæ§‹\rtypeof(tree)\r#\u0026gt; [1] \u0026quot;list\u0026quot;\rclass(tree)\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\ris.data.frame(tree)\r#\u0026gt; [1] TRUE\r   treeæ˜¯ä¸€å€‹data.frame, ä½†ä¹Ÿæ˜¯list,é‚£éº¼[]å’Œ[[]]çš„æ‡‰ç”¨å°±å’Œä¹‹å‰è¨è«–çš„ä¸€æ¨£ï¼š\ntree[1] #\r \rå±•é–‹\rC   1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  3  3  3  3  3  3  3  3  3  3  4  4  4  4  4  4  4  4  4  4  4  4  4    \r tree[[1]] #\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3\r#\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4\rclass(tree[1]) # data.frame\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\rclass(tree[[1]]) # integer\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rtypeof(tree[1]) # list\r#\u0026gt; [1] \u0026quot;list\u0026quot;\rtypeof(tree$C) # integer\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rtypeof(tree[[1]]) # integer\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\r  tree[1] æ˜¯ä¸€å€‹list tree[[1]] å¤–åœçš„tree[]é¦–å…ˆè¢«è§£è®€ç‚ºlisté¡åˆ¥,ç„¶å¾Œ[1]å‚³åˆ°é¡åˆ¥     è¤‡ç¿’ä¸€ä¸‹:[[ vs [\nç”±typeof,classçœ‹èµ·ä¾†\n  [[æŠ½å–listä¸­çš„å…ƒç´  [åªæ˜¯åˆ†å‰²list,ä¸­çš„subset  ç¯„ä¾‹\nL3 \u0026lt;- LETTERS[1:3]\rfac \u0026lt;- sample(L3, 10, replace = TRUE)\r(d \u0026lt;- data.frame(x = 1, y = 1:10, fac = fac)) #ğŸ·ğŸ‘é€™è£¡åˆåŠ ä¸€å€‹æ‹¬è™Ÿ,è¡¨ç¤ºæœƒæœ‰è¿”å›å€¼,ä¹Ÿå°±æ˜¯åˆ—å°çš„æ„æ€\r x y fac   1 1 C  1 2 A  1 3 A  1 4 C  1 5 A  1 6 A  1 7 A  1 8 B  1 9 B  1 10 A     data.frame(1, 1:10, sample(L3, 10, replace = TRUE)) # ğŸ·ğŸ‘åƒæ•¸é¡å‹ä¸ä½¿ç”¨x=1:10 ğŸ‘å¦‚æœç›´æ¥çµ¦å€¼,æœƒè‡ªå‹•çµ¦æ¬„ä½åç¨± #  \rè³‡æ–™(æ³¨æ„æ¬„ä½åç¨±)\rX1 X1.10 sample.L3..10..replace...TRUE.   1 1 A  1 2 C  1 3 B  1 4 B  1 5 C  1 6 B  1 7 A  1 8 B  1 9 A  1 10 C    \r is.data.frame(d)\r#\u0026gt; [1] TRUE\r(dd \u0026lt;- cbind(d, char = I(letters[1:10]))) # ğŸ·ğŸ‘Rèªè¨€çš„é€™å€‹è‡ªå‹•è½‰æ›,å¸¸å‡ºå•é¡Œ,åˆ©ç”¨å‡½æ•¸I()è¡¨ç¤ºä¸è¦è½‰æ›\r x y fac char   1 1 C a  1 2 A b  1 3 A c  1 4 C d  1 5 A e  1 6 A f  1 7 A g  1 8 B h  1 9 B i  1 10 A j     rbind(class = sapply(dd, class), mode = sapply(dd, mode))\r#\u0026gt; x y fac char #\u0026gt; class \u0026quot;numeric\u0026quot; \u0026quot;integer\u0026quot; \u0026quot;character\u0026quot; \u0026quot;AsIs\u0026quot; #\u0026gt; mode \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;character\u0026quot; \u0026quot;character\u0026quot;\rstopifnot(1:10 == row.names(d)) # #ğŸ·ğŸ‘å‡½æ•¸stopifnot()éŒ¯èª¤æª¢æŸ¥ç”¨,å¦‚æœåƒæ•¸ä¸æ˜¯Tå°±åœæ­¢{coercion}\rstr(d0 \u0026lt;- d[, FALSE]) # data frame with 0 columns and 10 rows\r#\u0026gt; 'data.frame':\t10 obs. of 0 variables\rstr(d00 \u0026lt;- d0[FALSE, ]) # data frame with 0 columns and 0 rows\r#\u0026gt; 'data.frame':\t0 obs. of 0 variables\rstr(d.0 \u0026lt;- d[FALSE, ]) # \u0026lt;0 rows\u0026gt; data frame (3 named cols)\r#\u0026gt; 'data.frame':\t0 obs. of 3 variables:\r#\u0026gt; $ x : num #\u0026gt; $ y : int #\u0026gt; $ fac: chr\rd[,c(T,F)] # ğŸ·ğŸ‘ä¸Šé¢3å€‹,åªæ˜¯ç”¨ä¾†é©—è­‰å¾ªç’°å¡«è£œ\r x fac   1 C  1 A  1 A  1 C  1 A  1 A  1 A  1 B  1 B  1 A    "},
{"uri": "/blogR//rlang/4_7_type_factor.html","title": "4.7 å› å­",
	"tags": [],
	"description": "4_7_type_factor",
	"content": "\ré™„ä»¶\r\rJournals.csv\r\rsample1.csv\r\rsample2.csv\r\rsample3.csv\r\rsimple.csv\r\rsmoker.csv\r\rtrees91.csv\r\rwh.csv\r\rwh_zh_950.csv\r\rwh_zh_utf8.csv\r\r Factors Rä¹Ÿèƒ½æŠŠè³‡æ–™å­˜ç‚ºfactorã€‚\nåœ¨å¤§éƒ¨åˆ†å¯¦é©—ä¸­,æŸäº›è§£é‡‹è®Šæ•¸ç¶“å¸¸æœ‰ä¸åŒç¨‹åº¦çš„æ¸¬è©¦,ç¨±ç‚ºå› å­ã€‚ å¤§æ„å¦‚ä¸‹ï¼š\n ... includes trials for different levels of some explanatory variable. The different levels are also called factors.\n factor , levels fert = c(10,20,20,50,10,20,10,50,20)\rfert = factor(fert,levels=c(10,20,50),ordered=TRUE) #ğŸ·ğŸ‘é€™è£¡æœ‰æ²’æœ‰çµ¦levelsç„¡å·®åˆ¥,å› ç‚ºå…§å®šå°±æ˜¯unique valueç‚ºæ¨™ç±¤\rstr(fert)\r#\u0026gt; Ord.factor w/ 3 levels \u0026quot;10\u0026quot;\u0026lt;\u0026quot;20\u0026quot;\u0026lt;\u0026quot;50\u0026quot;: 1 2 2 3 1 2 1 3 2\r   levels()å¯ä»¥é¡¯ç¤ºè®Šæ•¸é¡åˆ¥ç‚ºfactorçš„æ¨™ç±¤ã€‚ç™½è©±æ–‡å°±æ˜¯ç”¨åœ¨factor()å‡½æ•¸ä¹‹å¾Œã€‚\n  levels(fert) ç”¢ç”Ÿä¸€å€‹ã€Œå­—ä¸²å‘é‡ã€\nlevels(fert) #ğŸ·ğŸ‘å‡½æ•¸levels()çš„åƒæ•¸æ˜¯factorå¦‚æœå‚³æ•¸å­—å‘é‡,çµæœæ˜¯NULL\r#\u0026gt; [1] \u0026quot;10\u0026quot; \u0026quot;20\u0026quot; \u0026quot;50\u0026quot;\rstr(levels(fert)) # ğŸ·ğŸ‘åªæ˜¯å­—ä¸²å‘é‡\r#\u0026gt; chr [1:3] \u0026quot;10\u0026quot; \u0026quot;20\u0026quot; \u0026quot;50\u0026quot;\r     fert çš„å…§å®¹ï¼Œå¦‚æœå¿½ç•¥æ¨™ç±¤æœ¬èº«ï¼Œå…¶å¯¦æ˜¯æ•¸å­—\nfert\r#\u0026gt; [1] 10 20 20 50 10 20 10 50 20\r#\u0026gt; Levels: 10 \u0026lt; 20 \u0026lt; 50\rtypeof(fert)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rclass(fert)\r#\u0026gt; [1] \u0026quot;ordered\u0026quot; \u0026quot;factor\u0026quot;\rstr(fert)\r#\u0026gt; Ord.factor w/ 3 levels \u0026quot;10\u0026quot;\u0026lt;\u0026quot;20\u0026quot;\u0026lt;\u0026quot;50\u0026quot;: 1 2 2 3 1 2 1 3 2\r  ğŸ’¡ å› æ­¤, attr(x,\u0026quot;levels\u0026quot;)=levels(x)ã€‚    ä¸Šé¢çš„typeof(fert)èªªæ˜¯æ•¸å­—,ä½†æ˜¯å¦‚æœçœŸçš„æŠŠå®ƒç•¶æˆæ•¸å­—å‘é‡,åˆç„¡æ³•åˆ©ç”¨å‡½æ•¸meanè¨ˆç®—å¹³å‡ğŸ’£\nmean(fert)\r#\u0026gt; Warning in mean.default(fert): å¼•æ•¸ä¸æ˜¯æ•¸å€¼ä¹Ÿä¸æ˜¯é‚è¼¯å€¼ï¼šå›è¦† NA\r#\u0026gt; [1] NA #ğŸ·ğŸ‘ç„¡æ³•è¨ˆç®—å¹³å‡,å› ç‚ºfactorä¸æ˜¯æ•¸å€¼\r   å¿…é ˆè½‰æ›:\nmean(as.numeric(levels(fert)[fert]))\r#\u0026gt; [1] 23.33333\r   é‚£éº¼æœ€å°å€¼å‘¢?\nmin(fert)\r#\u0026gt; [1] 10\r#\u0026gt; Levels: 10 \u0026lt; 20 \u0026lt; 50\r   â“ç‚ºç”šéº¼ä¸Šé¢çš„æ±‚æœ€å°å¯ä»¥,é€™è£¡åˆä¸è¡Œ?\nfert = c(10,20,20,50,10,20,10,50,20)\rfert = factor(fert,levels=c(10,20,50) ) # ğŸ·ğŸ‘é€™è£¡çš„å› å­æ²’æœ‰æŒ‡å®šé †åº,æ‰€ä»¥ä¹Ÿæ²’æœ‰æœ€å°,æœ€å¤§\rmin(fert)\r#\u0026gt; Error in Summary.factor(structure(c(1L, 2L, 2L, 3L, 1L, 2L, 1L, 3L, 2L: 'min' å°å› å­æ²’æœ‰æ„ç¾©\r æ¢ç´¢ a \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;))\r é æœŸç­”æ¡ˆæ˜¯factor,okã€‚\nclass(a)\r#\u0026gt; [1] \u0026quot;factor\u0026quot;\r å› ç‚ºaå·²ç¶“è¢«ç·¨ç¢¼ï¼Œé æœŸæ˜¯numericï¼Œé€™è£¡ç­”æ¡ˆç›´æ¥çµ¦å®šinteger:\ntypeof(a)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\r aæ˜¯ä¸€å€‹factor,æ‰€ä»¥a[]ä»£è¡¨açš„ä¸€å€‹å­é›†åˆï¼Œå› æ­¤çµæœçœ‹èµ·ä¾†ä¹Ÿæ˜¯é¡ä¼¼åŸä¾†açš„å‹æ…‹ï¼š\na[1]\r#\u0026gt; [1] A\r#\u0026gt; Levels: A B C\r é©—è­‰æ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„è¡¨ç¤ºæ–¹å¼ä¸€æ¨£ï¼š\na\r#\u0026gt; [1] A A B A B B C A C\r#\u0026gt; Levels: A B C\r æ‰€ä»¥ï¼Œa,a[]éƒ½æ˜¯é¡å‹ç‚ºfactorçš„è®Šæ•¸ã€‚\næŒ‰ç…§ä¹‹å‰[]å’Œ[[]]çš„è¦å‰‡ï¼Œé€™è£¡æœƒå‡ºç¾ä»€éº¼ï¼Ÿ\na[[1]]\r#\u0026gt; [1] A\r#\u0026gt; Levels: A B C\r å‡ºç¾çš„çµæœå’Œa[1]ä¸€æ¨£ï¼Œé€™èªªæ˜äº†ï¼Œaçš„çµæ§‹ä¸æ˜¯list,åˆ©ç”¨str()å‡½æ•¸çœ‹ä¸€ä¸‹ç¢ºèªï¼š\nstr(a)\r#\u0026gt; Factor w/ 3 levels \u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;: 1 1 2 1 2 2 3 1 3\r ç¸½ä¹‹ï¼Œa[1] a[[1]] éƒ½æ˜¯Factor æ²’æœ‰[ å’Œ [[ çš„åˆ†åˆ¥ã€‚é€™å€‹factorä¹Ÿæ˜¯rçš„å…§å»ºè³‡æ–™å‹æ…‹ã€‚ å…¶ä»–é©—è­‰å¦‚ä¸‹ï¼Œè‡ªè¡Œæ¨æ•²ï¼š\n\u0026gt; typeof(a[[1]])\r[1] \u0026quot;integer\u0026quot;\r\u0026gt; typeof(a[1])\r[1] \u0026quot;integer\u0026quot;\r\u0026gt; class(a[[1]])\r[1] \u0026quot;factor\u0026quot;\r\u0026gt; class(a[1])\r[1] \u0026quot;factor\u0026quot;\r å¸¸ç”¨ä¾†å’Œtableé…åˆ\ntable(a) #ğŸ·ğŸ‘ABCåˆ†åˆ¥å‡ºç¾å¹¾æ¬¡\r#\u0026gt; a\r#\u0026gt; A B C #\u0026gt; 4 3 2\r åˆ©ç”¨summaryå‡½æ•¸çš„æ™‚å€™,é€™è£¡ä¸å†åˆ—å‡º5å€‹çµ±è¨ˆé‡:\nsummary(a) #ğŸ·ğŸ‘ABCåˆ†åˆ¥å‡ºç¾å¹¾æ¬¡\r#\u0026gt; A B C #\u0026gt; 4 3 2\r \rtable,summary\rçœ‹ä¸€ä¸‹table(a),summary(a)çš„è³‡æ–™çµæ§‹æ˜¯ä»€éº¼ï¼Ÿ\nstr(table(a))\r#\u0026gt; 'table' int [1:3(1d)] 4 3 2\r#\u0026gt; - attr(*, \u0026quot;dimnames\u0026quot;)=List of 1\r#\u0026gt; ..$ a: chr [1:3] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;\rstr(summary(a))\r#\u0026gt; Named int [1:3] 4 3 2\r#\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr [1:3] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;\r class(table(a))\r#\u0026gt; [1] \u0026quot;table\u0026quot;\rclass(summary(a))\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\r è¼¸å‡ºæ¨£å­çœ‹èµ·ä¾†å¾ˆåƒï¼Œä½†æ˜¯çµæ§‹ä¸€å€‹æ˜¯é¡åˆ¥tableä¸€å€‹æ˜¯ã€Œæ•´æ•¸å‘é‡ã€ï¼Œç„¶å¾Œæ¯å€‹å…ƒç´ éƒ½æ˜¯å› å­çš„ç™¼ç”Ÿæ¬¡æ•¸ï¼Œå¸¶æœ‰å› å­åå­—ï¼Œé€™è£¡æ˜¯\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;ã€‚\n ç·´ç¿’ â“æ‰¾å›åŸä¾†é‚„æ²’è¢«factorçš„å‘é‡ã€‚\nx\u0026lt;-c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;) fx\u0026lt;-factor(x) # ç¾åœ¨xæ˜¯ä¸€å€‹factor  ç¾åœ¨å‡å®š,æˆ‘å€‘åªæœ‰fx,è¦æ‰¾å›xçš„å…§å®¹ã€‚\nğŸ’¡ hint:c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;)[c(1,1,2,3,2)] ==\u0026gt; a,a,b,c,b ã€‚\næç¤º\r x\u0026lt;-c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;)\rfx\u0026lt;-factor(x) # ç¾åœ¨xæ˜¯ä¸€å€‹factor\r#ğŸ’¡\rx\u0026lt;-levels(fx)[fx] #ç¾åœ¨åˆè¢«è½‰å›åŸä¾†çš„x\r \nfactor å’Œå‡½æ•¸read.csv() read.csv() çš„å‚³å›å€¼çš„é¡åˆ¥æ˜¯data.frameã€‚ä½†æ˜¯åœ¨è®€æª”çš„æ™‚å€™ï¼Œå¦‚æœé‡åˆ°å­—ä¸²æ¬„ä½ï¼ŒğŸ‘ºè¦æ³¨æ„æ˜¯å¦æœƒå°‡å­—ä¸²æ¬„ä½é è¨­è½‰ç‚ºfactoræ¬„ä½ğŸ‘ºã€‚\nè§€å¯Ÿcarbon dioxide å°æ¨¹æœ¨çš„ç”Ÿé•·é€Ÿç‡ trees91.csv ã€‚é™„ä»¶ \rè³‡æ–™è¨»è§£\r The original spreadsheet is located at http://cdiac.ornl.gov/ftp/ndp061a/trees91.wk1. A description of the data file is located at http://cdiac.ornl.gov/ftp/ndp061a/ndp061a.txt .  \ntree = read.csv(\u0026quot;./resources/trees91.csv\u0026quot;, header = TRUE, sep = \u0026quot;,\u0026quot;);\r \rçµæ§‹\rattributes(tree)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;C\u0026quot; \u0026quot;N\u0026quot; \u0026quot;CHBR\u0026quot; \u0026quot;REP\u0026quot; \u0026quot;LFBM\u0026quot; \u0026quot;STBM\u0026quot; \u0026quot;RTBM\u0026quot; \u0026quot;LFNCC\u0026quot; #\u0026gt; [9] \u0026quot;STNCC\u0026quot; \u0026quot;RTNCC\u0026quot; \u0026quot;LFBCC\u0026quot; \u0026quot;STBCC\u0026quot; \u0026quot;RTBCC\u0026quot; \u0026quot;LFCACC\u0026quot; \u0026quot;STCACC\u0026quot; \u0026quot;RTCACC\u0026quot;\r#\u0026gt; [17] \u0026quot;LFKCC\u0026quot; \u0026quot;STKCC\u0026quot; \u0026quot;RTKCC\u0026quot; \u0026quot;LFMGCC\u0026quot; \u0026quot;STMGCC\u0026quot; \u0026quot;RTMGCC\u0026quot; \u0026quot;LFPCC\u0026quot; \u0026quot;STPCC\u0026quot; #\u0026gt; [25] \u0026quot;RTPCC\u0026quot; \u0026quot;LFSCC\u0026quot; \u0026quot;STSCC\u0026quot; \u0026quot;RTSCC\u0026quot; #\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\r#\u0026gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50\r#\u0026gt; [51] 51 52 53 54\rnames(tree)\r#\u0026gt; [1] \u0026quot;C\u0026quot; \u0026quot;N\u0026quot; \u0026quot;CHBR\u0026quot; \u0026quot;REP\u0026quot; \u0026quot;LFBM\u0026quot; \u0026quot;STBM\u0026quot; \u0026quot;RTBM\u0026quot; \u0026quot;LFNCC\u0026quot; #\u0026gt; [9] \u0026quot;STNCC\u0026quot; \u0026quot;RTNCC\u0026quot; \u0026quot;LFBCC\u0026quot; \u0026quot;STBCC\u0026quot; \u0026quot;RTBCC\u0026quot; \u0026quot;LFCACC\u0026quot; \u0026quot;STCACC\u0026quot; \u0026quot;RTCACC\u0026quot;\r#\u0026gt; [17] \u0026quot;LFKCC\u0026quot; \u0026quot;STKCC\u0026quot; \u0026quot;RTKCC\u0026quot; \u0026quot;LFMGCC\u0026quot; \u0026quot;STMGCC\u0026quot; \u0026quot;RTMGCC\u0026quot; \u0026quot;LFPCC\u0026quot; \u0026quot;STPCC\u0026quot; #\u0026gt; [25] \u0026quot;RTPCC\u0026quot; \u0026quot;LFSCC\u0026quot; \u0026quot;STSCC\u0026quot; \u0026quot;RTSCC\u0026quot;\rstr(tree)\r#\u0026gt; 'data.frame':\t54 obs. of 28 variables:\r#\u0026gt; $ C : int 1 1 1 1 1 1 1 1 2 2 ...\r#\u0026gt; $ N : int 1 1 2 2 2 2 3 3 1 1 ...\r#\u0026gt; $ CHBR : chr \u0026quot;CL6\u0026quot; \u0026quot;CL7\u0026quot; \u0026quot;A1\u0026quot; \u0026quot;A1\u0026quot; ...\r#\u0026gt; $ REP : int 1 1 9 14 20 NA NA NA 9 14 ...\r#\u0026gt; $ LFBM : num 0.43 0.4 0.45 0.82 0.52 1.32 0.9 1.18 0.48 0.21 ...\r#\u0026gt; $ STBM : num 0.13 0.15 0.2 0.26 0.19 0.46 0.42 0.53 0.2 0.07 ...\r#\u0026gt; $ RTBM : num 0.29 0.25 0.21 0.29 0.25 0.48 0.47 0.78 0.28 0.22 ...\r#\u0026gt; $ LFNCC : num 1.84 1.82 1.54 1.75 2.01 1.45 1.8 1.53 1.58 1.26 ...\r#\u0026gt; $ STNCC : num 0.4 0.37 0.96 0.97 1.29 0.92 1.19 0.84 0.89 0.66 ...\r#\u0026gt; $ RTNCC : num 0.96 0.95 0.69 0.83 0.8 0.72 0.84 0.77 0.98 0.77 ...\r#\u0026gt; $ LFBCC : int 39 36 34 34 34 28 33 40 41 41 ...\r#\u0026gt; $ STBCC : int 18 26 19 19 19 15 20 27 17 17 ...\r#\u0026gt; $ RTBCC : int 41 35 22 22 22 21 21 23 16 16 ...\r#\u0026gt; $ LFCACC: num 0.26 0.28 0.29 0.29 0.29 0.36 0.26 0.3 0.3 0.3 ...\r#\u0026gt; $ STCACC: num 0.16 0.2 0.16 0.16 0.16 0.22 0.21 0.19 0.18 0.18 ...\r#\u0026gt; $ RTCACC: num 0.16 0.17 0.17 0.17 0.17 0.24 0.17 0.13 0.18 0.18 ...\r#\u0026gt; $ LFKCC : num 0.88 0.93 0.9 0.9 0.9 1 0.8 0.73 0.88 0.88 ...\r#\u0026gt; $ STKCC : num 1.19 1.34 1.28 1.28 1.28 1.08 1.04 1.12 0.93 0.93 ...\r#\u0026gt; $ RTKCC : num 0.62 0.49 0.64 0.64 0.64 0.42 0.53 0.45 0.38 0.38 ...\r#\u0026gt; $ LFMGCC: num 0.11 0.1 0.12 0.12 0.12 0.13 0.13 0.12 0.12 0.12 ...\r#\u0026gt; $ STMGCC: num 0.13 0.18 0.16 0.16 0.16 0.14 0.19 0.17 0.15 0.15 ...\r#\u0026gt; $ RTMGCC: num 0.06 0.06 0.08 0.08 0.08 0.07 0.09 0.06 0.08 0.08 ...\r#\u0026gt; $ LFPCC : num 0.23 0.22 0.3 0.3 0.3 0.23 0.25 0.21 0.24 0.24 ...\r#\u0026gt; $ STPCC : num 0.31 0.22 0.35 0.35 0.35 0.25 0.35 0.27 0.32 0.32 ...\r#\u0026gt; $ RTPCC : num 0.17 0.13 0.21 0.21 0.21 0.15 0.19 0.12 0.17 0.17 ...\r#\u0026gt; $ LFSCC : num 0.13 0.22 0.15 0.15 0.15 0.15 0.16 0.12 0.22 0.22 ...\r#\u0026gt; $ STSCC : num 0.17 0.28 0.19 0.19 0.19 0.16 0.17 0.18 0.2 0.2 ...\r#\u0026gt; $ RTSCC : num 0.14 0.13 0.15 0.15 0.15 0.13 0.15 0.11 0.13 0.13 ...\r    åœ¨CHBRé€™å€‹æ¬„ä½ä¸­,å› ç‚ºä¸å…¨éƒ½æ˜¯æ•¸å­—,å› æ­¤Rè‡ªå‹•å‡å®šé€™æ˜¯ä¸€å€‹factorã€‚\n å› æ­¤é‡å°é€™å€‹æ¬„ä½summary()å‡½æ•¸ä¸æœƒåˆ—å‡º5å€‹çµ±è¨ˆé‡,è€Œæ˜¯åˆ—å‡ºæ¬¡æ•¸è¡¨ã€‚å› ç‚ºï¼Œä¸€æ—¦å‘é‡è½‰ç‚ºä¸€çµ„factors, 5å€‹åŸºæœ¬çµ±è¨ˆé‡ä¸å†æœ‰æ„ç¾©ã€‚  summary(tree$CHBR)\r#\u0026gt; Length Class Mode #\u0026gt; 54 character character\r#ğŸ·åœ¨CHBRé€™å€‹æ¬„ä½ä¸­,å› ç‚ºä¸å…¨éƒ½æ˜¯æ•¸å­—,å› æ­¤Rè‡ªå‹•å‡å®šé€™æ˜¯ä¸€å€‹factorã€‚\r   ä½†æœ‰äº›æ¬„ä½ä¾‹å¦‚C,ä¹Ÿæ˜¯ä¸€å€‹factorã€‚ä½†æ˜¯,Rèªå®šç‚ºæ•¸å­—,é€™æ™‚å¿…é ˆæ‰‹å‹•è™•ç†ã€‚ ä»¥ä¸‹å°‡ tree$C è½‰ç‚º factor:\ntree$C #ğŸ·é€™æ˜¯1å€‹factor,ä½†æ˜¯è½‰é€²ä¾†çš„æ™‚å€™,è¢«èªå®šç‚ºæ•¸å­—\r#\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3\r#\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4\rsummary(tree$C)\r#\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 1.000 2.000 2.000 2.519 3.000 4.000\rtree$C \u0026lt;- factor(tree$C)\rtree$C\r#\u0026gt; [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3\r#\u0026gt; [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4\r#\u0026gt; Levels: 1 2 3 4\rsummary(tree$C)\r#\u0026gt; 1 2 3 4 #\u0026gt; 8 23 10 13\rlevels(tree$C)\r#\u0026gt; [1] \u0026quot;1\u0026quot; \u0026quot;2\u0026quot; \u0026quot;3\u0026quot; \u0026quot;4\u0026quot;\r   plot\nbarplot(table(tree$C))\r figure\r   Table() table()æŒ‡ä»¤:\né€™å€‹æŒ‡ä»¤é€šå¸¸ç”¨ä¾†å»ºç«‹å› å­ä¹‹é–“çš„é—œè¯è¡¨(contingency table)ã€‚åƒæ•¸é€šå¸¸æ˜¯ä¸€å€‹ã€Œå› å­å‘é‡ã€(factor vector)ã€‚\nOne Way Tables å»ºç«‹ä¸€å€‹å–®å› å­é—œè¯è¡¨ï¼ˆone way tableï¼‰:\na \u0026lt;- factor(c(\u0026quot;A\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;, \u0026quot;A\u0026quot;, \u0026quot;C\u0026quot;))\rtable_a \u0026lt;- table(a)\rtable_a\r#\u0026gt; a\r#\u0026gt; A B C #\u0026gt; 4 3 2\r attributeså¯ä»¥çœ‹å‡ºtable_aè£¡é¢æœ‰å“ªäº›å¸¶åå…ƒç´ \nattributes(table_a)\r#\u0026gt; $dim\r#\u0026gt; [1] 3\r#\u0026gt; #\u0026gt; $dimnames\r#\u0026gt; $dimnames$a\r#\u0026gt; [1] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;\r#\u0026gt; #\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;table\u0026quot;\r summary(table_a)\r#\u0026gt; Number of cases in table: 9 #\u0026gt; Number of factors: 1\r å°ç…§table(a)ï¼Œç›´æ¥æŠŠfactor è®Šæ•¸ï¼Œä»£å…¥summary()çœ‹ä¸€ä¸‹ï¼Œçµæœæ˜¯æ¬¡æ•¸åˆ†é…è¡¨ï¼ˆå¦‚ä¸‹ï¼‰\ntable(a)\r#\u0026gt; a\r#\u0026gt; A B C #\u0026gt; 4 3 2\rsummary(a)\r#\u0026gt; A B C #\u0026gt; 4 3 2\r Two Way Tables é€™å€‹ä¾‹å­ä¸­æœ‰å…©å€‹å•é¡Œ:ç¬¬1å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰â€œNever,â€ â€œSometimes,â€ or â€œAlways.â€\nç¬¬2å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰ â€œYes,â€ â€œNo,â€ or â€œMaybe.â€ å…©å€‹å•é¡Œåˆ†åˆ¥ä»¥å‘é‡a,bå­˜æ”¾( The set of vectors â€œa,â€ and â€œb,â€ contain the response for each measurement.)\na \u0026lt;- c(\u0026quot;Sometimes\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Never\u0026quot;, \u0026quot;Always\u0026quot;, \u0026quot;Always\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Sometimes\u0026quot;, \u0026quot;Never\u0026quot;)\rb \u0026lt;- c(\u0026quot;Maybe\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;Yes\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;Maybe\u0026quot;, \u0026quot;No\u0026quot;, \u0026quot;Yes\u0026quot;, \u0026quot;No\u0026quot;)\rresults \u0026lt;- table(a, b)\rresults\r#\u0026gt; b\r#\u0026gt; a Maybe No Yes\r#\u0026gt; Always 2 0 0\r#\u0026gt; Never 0 1 1\r#\u0026gt; Sometimes 2 1 1\r åœ¨è¡¨æ ¼ä¸­,å¯ä»¥çœ‹åˆ°åŒæ™‚å›ç­” â€œMaybeâ€ â€œSometimesâ€ çš„å€‹æ•¸æœ‰å¹¾å€‹ã€‚\né€™è£¡æ˜¯å¦ä¸€å€‹ç›´æ¥ç”±æˆ‘å€‘çŸ¥é“çš„æ•¸æ“šå»ºç«‹tableçš„ä¾‹å­\nsexsmoke \u0026lt;- matrix(c(70, 120, 65, 140), ncol = 2, byrow = TRUE)\rrownames(sexsmoke) \u0026lt;- c(\u0026quot;male\u0026quot;, \u0026quot;female\u0026quot;)\rcolnames(sexsmoke) \u0026lt;- c(\u0026quot;smoke\u0026quot;, \u0026quot;nosmoke\u0026quot;)\rsexsmoke \u0026lt;- as.table(sexsmoke)\rsexsmoke\r#\u0026gt; smoke nosmoke\r#\u0026gt; male 70 120\r#\u0026gt; female 65 140\r ğŸ’¡é›™è®Šé‡åˆ†ææ–¹å¼å¯åŒ…æ‹¬:\nåˆ—è¯è¡¨ Crosstabs table(), ftable(), prop.table()\ndata.table  å…¶ä»–åƒè€ƒ  \ras.table()\ras.table()\nå•é¡Œï¼šå¦‚æœæˆ‘å€‘çŸ¥é“Aæœ‰4,å€‹,Bæœ‰3å€‹,Cæœ‰2å€‹,èƒ½ä¸èƒ½ç›´æ¥å»ºç«‹table?\n å…ˆå»ºç«‹matrix å†åŠ å…¥æ¬„ä½åç¨± åˆ©ç”¨å‡½æ•¸as.table()  # step 1\roccur \u0026lt;- matrix(c(4, 3, 2), ncol = 3, byrow = TRUE)\roccur\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 4 3 2\r#step 2\rcolnames(occur) \u0026lt;- c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;)\roccur\r#\u0026gt; A B C\r#\u0026gt; [1,] 4 3 2\r#step 3\roccur \u0026lt;- as.table(occur)\roccur\r#\u0026gt; A B C\r#\u0026gt; A 4 3 2\rattributes(occur)\r#\u0026gt; $dim\r#\u0026gt; [1] 1 3\r#\u0026gt; #\u0026gt; $dimnames\r#\u0026gt; $dimnames[[1]]\r#\u0026gt; [1] \u0026quot;A\u0026quot;\r#\u0026gt; #\u0026gt; $dimnames[[2]]\r#\u0026gt; [1] \u0026quot;A\u0026quot; \u0026quot;B\u0026quot; \u0026quot;C\u0026quot;\r#\u0026gt; #\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;table\u0026quot;\r  if(!require(\u0026quot;data.table\u0026quot;)) install.packages(\u0026quot;data.table\u0026quot;)\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šdata.table\rDT = data.table(\rID = c(\u0026quot;b\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;a\u0026quot;,\u0026quot;a\u0026quot;,\u0026quot;c\u0026quot;),\ra = 1:6,\rb = 7:12,\rc = 13:18\r)\rDT\r ID a b c   b 1 7 13  b 2 8 14  b 3 9 15  a 4 10 16  a 5 11 17  c 6 12 18     class(DT$ID) #ğŸ·ğŸ‘ä¸æœƒè¢«è½‰ç‚ºfactor\r#\u0026gt; [1] \u0026quot;character\u0026quot;\r"},
{"uri": "/blogR//rlang/6_1_programming.html","title": "6.1 Programming basic",
	"tags": [],
	"description": "åŸºæœ¬èªæ³•",
	"content": "æ¢ä»¶æŒ‡ä»¤ if ä¸€èˆ¬ä¾†è¬›ï¼Œé€šç”¨å¯«æ³•å¦‚ä¸‹ï¼š\nif(åˆ¤æ–·å¼){\ræˆåŠŸ\r}else{\rå¤±æ•—\r}\r å¤šè¡Œå¯«æ³•\nif(4 \u0026gt; 3){\rTRUE\r}else{\rFALSE\r}\r å¦å¤–ï¼Œå¦‚æœå€å¡Šå…§åªæœ‰ä¸€è¡Œ\nif(4 \u0026gt; 3) TRUE else FALSE  ifelseçš„å¯«æ³• ifelse('åˆ¤æ–·å¼','æˆåŠŸ','å¤±æ•—')\nä¾‹å¦‚ï¼Œ ifelse(4 \u0026gt; 3, T, F)\nswitchçš„å¯«æ³• switch('åˆ¤æ–·å¼', 'åˆ¤æ–·å€¼1'={}, 'åˆ¤æ–·å€¼2'={},\r...,\r\u0026quot;å…¶ä»–åˆ¤æ–·å€¼\u0026quot;={}\r)\r   ç›´æ¥æŒ‡å®šå“ªä¸€å€‹\nswitch(2,\u0026quot;red\u0026quot;,\u0026quot;green\u0026quot;,\u0026quot;blue\u0026quot;)\r#\u0026gt; [1] \u0026quot;green\u0026quot;\rswitch(1,\u0026quot;red\u0026quot;,\u0026quot;green\u0026quot;,\u0026quot;blue\u0026quot;) #ğŸ·ğŸ‘\r#\u0026gt; [1] \u0026quot;red\u0026quot;\ry\u0026lt;-switch(1,\u0026quot;red\u0026quot;,\u0026quot;green\u0026quot;,\u0026quot;blue\u0026quot;) #ğŸ·ğŸ‘å› ç‚ºæ˜¯å‡½æ•¸,å¯ä»¥ç›´æ¥æŒ‡æ´¾åŸ·è¡Œçµæœ\ry\r#\u0026gt; [1] \u0026quot;red\u0026quot;\r   ä¸Šé¢å‚³å›å­—ä¸²,é€™è£¡å‚³å›æ•¸å­—\nswitch(2, 1, 2, #å› ç‚ºåˆ¤æ–·å¼ç‚º2ï¼Œå› æ­¤ï¼ŒåŸ·è¡Œå‹•ä½œ2\r3) #ğŸ·ğŸ‘é€™å€‹switchå‚³å›æ•¸å­—,\r#\u0026gt; [1] 2\r   ä¹Ÿå¯ä»¥åˆ©ç”¨å­—ä¸²\nx=\u0026quot;a\u0026quot;\rswitch(x, \u0026quot;a\u0026quot; = 1, \u0026quot;b\u0026quot; = 2, \u0026quot;c\u0026quot; = \u0026quot;why\u0026quot;)\r#\u0026gt; [1] 1\rx=\u0026quot;b\u0026quot;\rswitch(x, \u0026quot;a\u0026quot; = 1, \u0026quot;b\u0026quot; = 2, \u0026quot;c\u0026quot; = \u0026quot;why\u0026quot;)\r#\u0026gt; [1] 2\rx=\u0026quot;c\u0026quot;\rswitch(x, \u0026quot;a\u0026quot; = 1, \u0026quot;b\u0026quot; = 2, \u0026quot;c\u0026quot; = \u0026quot;why\u0026quot;)\r#\u0026gt; [1] \u0026quot;why\u0026quot;\r   å†ä¸€å€‹ä¾‹å­\nx=\u0026quot;c\u0026quot;\rswitch(x, \u0026quot;a\u0026quot; = 1, \u0026quot;b\u0026quot; = 2, \u0026quot;c\u0026quot; = {\u0026quot;why\u0026quot;}) #ğŸ·ğŸ‘ å¤§æ‹¬è™Ÿ,å¯ä»¥è®“æˆ‘å€‘æœ‰å…©è¡Œä»¥ä¸Šçš„ç¨‹å¼ç¢¼\r#\u0026gt; [1] \u0026quot;why\u0026quot;\rx=\u0026quot;c\u0026quot;\rswitch(x, \u0026quot;a\u0026quot; = 1, \u0026quot;b\u0026quot; = 2, \u0026quot;c\u0026quot; = {x\u0026lt;-3;x+1}) #ğŸ·ğŸ‘ åˆ©ç”¨åˆ†è™Ÿåˆ†éš”\r#\u0026gt; [1] 4\rx #ğŸ·ğŸ‘ xä¸æ˜¯\u0026quot;c\u0026quot;äº†,è®Šæˆ4\r#\u0026gt; [1] 3\r   é€™å€‹switch ä¸¦ä¸æ˜¯ä¸€å€‹èªæ³•ï¼Œè€Œæ˜¯ä¸€å€‹å‡½æ•¸ï¼ŒåŸç†å¤§æ¦‚æ˜¯ ç¬¬1å€‹åƒæ•¸ä»¥å¾Œçš„æ±è¥¿ï¼Œæœƒè¢«è®Šæˆæ˜¯ä¸€å€‹named listã€‚ ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­\nalist \u0026lt;-list(a=1,b=2,c=\u0026quot;why\u0026quot;)\r ç„¶å¾Œåˆ©ç”¨åˆ¤æ–·å¼ æŸ¥æ‰¾è¦è¿”å›å°æ‡‰çš„å€¼ã€‚ä¾‹å¦‚\nswitch(\u0026quot;a\u0026quot;, a = 1, b = 2, c = \u0026quot;why\u0026quot;)\r#\u0026gt; [1] 1\rswitch(\u0026quot;b\u0026quot;, a = 1, b = 2, c = \u0026quot;why\u0026quot;)\r#\u0026gt; [1] 2\r è¿´åœˆæŒ‡ä»¤ R èªè¨€çš„è¿´åœˆï¼Œå¯ä»¥æ­é… breakå’Œnextï¼Œå‰è€…è·³å‡ºè¿´åœˆï¼Œå¾Œè€…ç¹¼çºŒä¸‹ä¸€å€‹è¿´åœˆã€‚\nfor-loop è¨ˆç®— 1+2+3+4. çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ\nrst \u0026lt;- 0\rfor(i in c(1:4)){ rst \u0026lt;- rst + i\r}\r while-loop i \u0026lt;- 1\rresult \u0026lt;- 0\rwhile(i \u0026lt; 5){ rst \u0026lt;- rst + i\ri \u0026lt;- i + 1\r}\r repeat-loop i \u0026lt;- 1\rrst \u0026lt;- 0\rrepeat{ if(i \u0026gt; 4) break rst \u0026lt;- rst + i\ri \u0026lt;- i + 1\r}\r å¸¸è¦‹å•é¡Œ ç‚ºç”šéº¼æœ‰äº›å‡½æ•¸æ‰¾ä¸åˆ°?\nå¥—ä»¶\n"},
{"uri": "/blogR//rlang/6_3_apply_family.html","title": "6.3 function - apply family",
	"tags": [],
	"description": "list çš„æ‡‰ç”¨",
	"content": " å…¶ä»–åƒè€ƒ  apply å¯ä»¥è™•ç†çš„å°è±¡åŒ…æ‹¬ çŸ©é™£ã€è³‡æ–™é›†ã€é™£åˆ—(äºŒç¶­ã€å¤šç¶­)ï¼Œå¯ä»¥æŒ‡å®šç›´è¡Œã€æ©«è¡Œã€‚\nå‡½æ•¸å®šç¾©ï¼š\napply(X, MARGIN, FUN, ...)\r åƒæ•¸åˆ—è¡¨ï¼š\n X : çŸ©é™£matrixã€è³‡æ–™é›†dataframe ã€é™£åˆ— array MARGIN : 1è¡¨ç¤ºæ©«è¡Œï¼Œ2è¡¨ç¤ºç›´è¡Œ FUN : the function to be applied ... : optional arguments to FUN  åœ¨matlab ä¸­,sum(çŸ©é™£,åƒæ•¸2) åƒæ•¸2çš„å¯èƒ½å€¼ç‚º1æˆ–2ï¼Œåˆ†åˆ¥æŒ‡å®šæ¬„ä½åŠ ç¸½æˆ–æ˜¯æ©«è¡ŒåŠ ç¸½,ä½†æ˜¯åœ¨Rä¸­sum(çŸ©é™£),å»æ˜¯æ•´å€‹çŸ©é™£å…ƒç´ çš„åŠ ç¸½ã€‚\nç¯„ä¾‹1: æ©«è¡ŒåŠ ç¸½\nx\u0026lt;-matrix(1,ncol=4,nrow=3);x\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 1 1 1 1\r#\u0026gt; [2,] 1 1 1 1\r#\u0026gt; [3,] 1 1 1 1\rapply(x,1,sum)\r#\u0026gt; [1] 4 4 4\r ç¯„ä¾‹ï¼š\næœ‰ä¸€å€‹list,è£¡é¢æœ‰2å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯x1,x2,æƒ³è¦åˆ†åˆ¥ç®—å‡ºæ¯å€‹æ¬„ä½çš„æœ€å°å’Œæœ€å¤§\nx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£\rf1\u0026lt;- function(col) {\rc(min(col),max(col)) }\rapply(x,2,f1)\r#\u0026gt; x1 x2\r#\u0026gt; [1,] 3 1\r#\u0026gt; [2,] 3 6\r ç·´ç¿’ï¼šå¦‚æœç”¨for loop?\nç·´ç¿’ï¼šå“ªç¨®æ–¹å¼æ¯”è¼ƒå¿«ï¼Ÿhint:åˆ©ç”¨ system.time(a function)\nlapplyå‡½æ•¸ å¤§ç¶±ï¼šlapply(),sapply(),vapply() éƒ½åƒæ•¸éƒ½åƒlist æˆ–è€…vectorã€‚\nå‡½æ•¸å®šç¾©ï¼š\nlapply(X, FUN, ...)\r åƒæ•¸åˆ—è¡¨ï¼š\n X: listã€vectorã€data.frame FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸  è¼¸å…¥ è¼¸å‡º   vector list  list list  data.frame list     å‡½æ•¸æ¯”è¼ƒ\n lapply(), sapply()å·®åˆ¥æ˜¯ å‰è€…è¿”å›list,å¾Œè€…è¿”å›matrix; sapply(), vapply() å·®åˆ¥æ˜¯ï¼Œå¾Œè€…å¯ä»¥åŠ å…¥row namesã€‚  ç¯„ä¾‹:è¨ˆç®—listä¸­çš„æ¯å€‹KEYå°æ‡‰ çš„5å€‹Tukeyåˆ†ä½æ•¸ (minimum, lower-hinge, median, upper-hinge, maximum) ã€‚åˆ©ç”¨fivenum()\nx \u0026lt;- list(a = 1:6, b = rnorm(2,6,8));x\r#\u0026gt; $a\r#\u0026gt; [1] 1 2 3 4 5 6\r#\u0026gt; #\u0026gt; $b\r#\u0026gt; [1] 0.480388 8.458378\rlapply(x,fivenum)\r#\u0026gt; $a\r#\u0026gt; [1] 1.0 2.0 3.5 5.0 6.0\r#\u0026gt; #\u0026gt; $b\r#\u0026gt; [1] 0.480388 0.480388 4.469383 8.458378 8.458378\r lapply çš„åƒæ•¸å¦‚æœæ˜¯ listã€data.frameï¼Œè¿”å›å’Œåƒæ•¸é•·åº¦åŒæ¨£çš„listçµæ§‹ä½œç‚ºçµæœ(æ¬„ä½æ•¸)ã€‚\nä¾‹å¦‚ï¼Œå‚³å…¥çš„åƒæ•¸æ˜¯data.frame(),å¦‚ä¸‹ï¼Œå°è³‡æ–™é›†çš„æ¯å€‹æ¬„ä½æ±‚å’Œã€‚\nlapply(data.frame(x), sum)\r#\u0026gt; $a\r#\u0026gt; [1] 21\r#\u0026gt; #\u0026gt; $b\r#\u0026gt; [1] 26.8163\r applyä¸åŒçš„åœ°æ–¹æ˜¯,å¦‚æœåƒæ•¸æ˜¯çŸ©é™£æ²’è¾¦æ³•æŒ‡å®šæ©«è¡Œæˆ–æ˜¯ç›´è¡Œçš„å€åˆ¥,åªèƒ½æ˜¯é€å€‹å…ƒç´ é‹ç®—ã€‚å°±æ˜¯å‰‡æœƒå°æ¯å€‹å…ƒç´ æ±‚å‡½æ•¸å€¼ã€‚\nx \u0026lt;- matrix(rnorm(4,5,10),nrow=2);x\r#\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 4.069977 12.197633\r#\u0026gt; [2,] -2.729655 -4.606058\rlapply(x, sum)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 4.069977\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] -2.729655\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 12.19763\r#\u0026gt; #\u0026gt; [[4]]\r#\u0026gt; [1] -4.606058\r sapplyå‡½æ•¸ sapplyå‡½æ•¸åŒ…è£¹äº†ä¸€ä¸Šé¢æåˆ°çš„lapply()ï¼Œè¿”å›å€¼ç‚ºå‘é‡ï¼Œè€Œä¸æ˜¯listå°è±¡ã€‚sapplyå¢åŠ äº†2å€‹åƒæ•¸simplifyå’ŒUSE.NAMESï¼Œ\nå‡½æ•¸å®šç¾©ï¼š\nsapply(X, FUN, ..., simplify=TRUE, USE.NAMES = TRUE)\r åƒæ•¸åˆ—è¡¨ï¼š\n X: listã€matrixã€data.frame FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸ simplify: é è¨­ç‚ºT,è¿”ç‚ºå€¼ç‚ºå‘é‡ï¼›å¦‚æœæ˜¯Fæˆlistã€‚? è¨­å®šç‚º\u0026quot;array\u0026quot;æ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„ USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®  è¼¸å…¥ è¼¸å‡º   vector vector,matrix,array,list  list vector,matrix,array,list  data.frame vector,matrix,array,list     simplify=FALSEå’ŒUSE.NAMES=FALSEï¼Œå‰‡ sapplyå‡½æ•¸ ï¼lapplyå‡½æ•¸ã€‚\nå¦‚æœæˆ‘å€‘åˆ©ç”¨å‡½æ•¸unlist é…åˆ lapply çš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°å‘é‡ï¼Œä¾‹å¦‚ï¼š unlist(lapply(1:3, function(x) x^2))\n\r\rå¸¸è¦‹ç¯„ä¾‹\nsapply(2:4, seq)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1 2\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] 1 2 3\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 1 2 3 4\r# data.frame\rsapply(data.frame(x), sum)\r#\u0026gt; X1 X2 #\u0026gt; 1.340322 7.591574\r# ç¢ºèªè¿”å›é¡åˆ¥\rlapply(x, sum)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 4.069977\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] -2.729655\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 12.19763\r#\u0026gt; #\u0026gt; [[4]]\r#\u0026gt; [1] -4.606058\rclass(lapply(x, sum))\r#\u0026gt; [1] \u0026quot;list\u0026quot;\rsapply(x, sum)\r#\u0026gt; [1] 4.069977 -2.729655 12.197633 -4.606058\rclass(sapply(x, sum))\r#\u0026gt; [1] \u0026quot;numeric\u0026quot;\rsapply(x, sum, simplify=FALSE, USE.NAMES=FALSE)\r#\u0026gt; [[1]]\r#\u0026gt; [1] 4.069977\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] -2.729655\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 12.19763\r#\u0026gt; #\u0026gt; [[4]]\r#\u0026gt; [1] -4.606058\rclass(sapply(x, sum, simplify=FALSE, USE.NAMES=FALSE))\r#\u0026gt; [1] \u0026quot;list\u0026quot;\r âŒå°æ¬„ä½ä½œçµ±è¨ˆé‹ç®—çš„éŒ¯èª¤ç¯„ä¾‹\nx \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£\rx\r#\u0026gt; x1 x2\r#\u0026gt; [1,] 3 1\r#\u0026gt; [2,] 3 2\r#\u0026gt; [3,] 3 3\r#\u0026gt; [4,] 3 4\r#\u0026gt; [5,] 3 5\r#\u0026gt; [6,] 3 6\rsapply(x, sum) #çµæœé¡ä¼¼lapply() ğŸ·å°‡é™£åˆ—å…ƒç´ å¸¶å…¥å‡½æ•¸\r#\u0026gt; [1] 3 3 3 3 3 3 1 2 3 4 5 6\rsapply(x, quantile) #\u0026gt; [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\r#\u0026gt; 0% 3 3 3 3 3 3 1 2 3 4 5 6\r#\u0026gt; 25% 3 3 3 3 3 3 1 2 3 4 5 6\r#\u0026gt; 50% 3 3 3 3 3 3 1 2 3 4 5 6\r#\u0026gt; 75% 3 3 3 3 3 3 1 2 3 4 5 6\r#\u0026gt; 100% 3 3 3 3 3 3 1 2 3 4 5 6\r è§£é‡‹ä¸Šé¢å‡ºéŒ¯çš„åŸå› ã€‚æç¤º\r hint: sapplyæœƒèª¿ç”¨å‡½æ•¸lapply()(ğŸ·ğŸ±â€ğŸ‘¤ç°¡åŒ–çš„sapplyä¾†è‡ªæ–¼è¤‡é›œçš„lapply)ï¼Œè€Œå·²ç¶“çŸ¥é“lapply()çš„åƒæ•¸æ˜¯çŸ©é™£çš„æ™‚å€™ï¼Œæ¯å€‹å…ƒç´ éƒ½æœƒè¢«å‚³åˆ°å‡½æ•¸ã€‚å› æ­¤æ¬„ä½æœ‰12å€‹ï¼›\nåˆï¼Œæ¯å€‹quantile()å‚³å›5å€‹å…ƒç´ ï¼Œå› æ­¤ï¼Œæ©«è¡Œæœ‰5å€‹ã€‚ æ­£ç¢ºçš„ä½œæ³•æ˜¯ï¼š\nx \u0026lt;- list(x1 = 3, x2 = c(1:6))\rsapply(x, quantile) #\u0026gt; x1 x2\r#\u0026gt; 0% 3 1.00\r#\u0026gt; 25% 3 2.25\r#\u0026gt; 50% 3 3.50\r#\u0026gt; 75% 3 4.75\r#\u0026gt; 100% 3 6.00\r  å¦ä¸€å€‹ç¯„ä¾‹\nlocaleCategories \u0026lt;- c(\u0026quot;LC_COLLATE\u0026quot;,\u0026quot;LC_CTYPE\u0026quot;,\u0026quot;LC_MONETARY\u0026quot;,\u0026quot;LC_NUMERIC\u0026quot;,\u0026quot;LC_TIME\u0026quot;)\rlocales \u0026lt;- setNames(sapply(localeCategories, Sys.getlocale), localeCategories)\r ç¯„ä¾‹ï¼šUSE.NAMES=TRUE\nalist\u0026lt;-list(a=c(1,1,1),b=c(2,2,2),c=c(3,3,3))\rf2\u0026lt;-function(x)\r{\rmean(alist[[x]]) #ğŸ·ğŸ‘å‚³é€²ä¾†çš„åƒæ•¸,æ˜¯åç¨±\r}\rsapply(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;),f2,USE.NAMES = T) # ğŸ·ğŸ‘æˆ‘å€‘çš„f2å‡½æ•¸,åƒè®Šæ•¸åç¨±,è€Œä¸æ˜¯å­—ä¸² #\u0026gt; a b c #\u0026gt; 1 2 3\rsapply(c(a,b,c),f2,USE.NAMES = T) # ğŸ·ğŸ‘æˆ‘å€‘çš„f2å‡½æ•¸,åƒè®Šæ•¸åç¨±,è€Œä¸æ˜¯å­—ä¸² #\u0026gt; Error in lapply(X = X, FUN = FUN, ...): æ‰¾ä¸åˆ°ç‰©ä»¶ 'a'\rsapply(c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;),f2,USE.NAMES = F) #\u0026gt; [1] 1 2 3\r å°æ–¼simplifyç‚ºarrayæ™‚ï¼Œæˆ‘å€‘å¯ä»¥åƒè€ƒä¸‹é¢çš„ä¾‹å­ï¼Œæ§‹å»ºä¸€å€‹ä¸‰ç¶­æ•¸çµ„ï¼Œå…¶ä¸­äºŒå€‹ç¶­åº¦ç‚ºæ–¹é™£ã€‚\na\u0026lt;-1:2\r# æŒ‰æ•¸çµ„åˆ†çµ„\rsapply(a,function(x) matrix(x,2,2), simplify='array')\r#\u0026gt; , , 1\r#\u0026gt; #\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 1 1\r#\u0026gt; [2,] 1 1\r#\u0026gt; #\u0026gt; , , 2\r#\u0026gt; #\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 2 2\r#\u0026gt; [2,] 2 2\r# é»˜èªæƒ…æ³ï¼Œå‰‡è‡ªå‹•åˆä½µåˆ†çµ„\rsapply(a,function(x) matrix(x,2,2))\r#\u0026gt; [,1] [,2]\r#\u0026gt; [1,] 1 2\r#\u0026gt; [2,] 1 2\r#\u0026gt; [3,] 1 2\r#\u0026gt; [4,] 1 2\r æ¯”è¼ƒ    Function Arguments Objective Input Output     apply apply(x, MARGIN, FUN) Apply a function to the rows or columns or both Data frame or matrix vector, list, array   lapply lapply(X, FUN) Apply a function to all the elements of the input List, vector or data frame list   sapply sappy(X FUN) Apply a function to all the elements of the input List, vector or data frame vector or matrix    m\u0026lt;-matrix(1:4,4,3);m\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 1 1\r#\u0026gt; [2,] 2 2 2\r#\u0026gt; [3,] 3 3 3\r#\u0026gt; [4,] 4 4 4\rsapply(1:3, function(x) mean(m[,x]))\r#\u0026gt; [1] 2.5 2.5 2.5\r m\u0026lt;-matrix(1:4,4,3);\rlapply(1:3, function(x) mean(m[,x]))\r#\u0026gt; [[1]]\r#\u0026gt; [1] 2.5\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] 2.5\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 2.5\r vapplyå‡½æ•¸ vapplyé¡ä¼¼æ–¼sapplyï¼Œæä¾›äº†FUN.VALUEåƒæ•¸ï¼Œç”¨ä¾†æ§åˆ¶è¿”å›å€¼çš„è¡Œåã€‚\nnote: sapply() é…ä¸Šrownames\u0026lt;- å¯ä»¥é”åˆ°ä¸€æ¨£çš„æ•ˆæœã€‚\nå‡½æ•¸å®šç¾©ï¼š\nvapply(X, FUN, FUN.VALUE, ..., USE.NAMES = TRUE)\r åƒæ•¸åˆ—è¡¨(å‰3å€‹éœ€è¦)ï¼š\n X:arrayã€matrixã€data.frame FUN: ä½¿ç”¨è€…æŒ‡å®šçš„å‡½æ•¸,å¯ä»¥æ˜¯è‡ªå®šç¾©çš„å‡½æ•¸ FUN.VALUE:  ä¾‹å¦‚,logistic(1),ä¹Ÿå°±æ˜¯å°å‚³é€²ä¾†çš„æ¯å€‹åƒæ•¸,éƒ½è¦ç”¢ç”Ÿé‚è¼¯å€¼å‘é‡,ä¸”é•·åº¦ç‚º1ã€‚ å¯ä»¥è¨˜ç‚ºå°æ¯ä¸€ç´€éŒ„çµ¦åç¨±(e.g. row.names)   â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸ USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®  x \u0026lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£\rx\u0026lt;-data.frame(x) # âœ”å› ç‚ºåœ¨f1()ä¸­è¦å°æ¯å€‹æ¬„ä½æ±‚æœ€å°æœ€å¤§,ä¸èƒ½æ˜¯çŸ©é™£(æœƒå°æ•´å€‹çŸ©é™£æ‰¾æœ€å°æœ€å¤§) f1\u0026lt;- function(col) {\rc(min(col),max(col)) }\rr1\u0026lt;-vapply(x,f1, numeric(2)) # # âŒvapply(x,f1, numeric(1)) âŒvapply(x,f1) # â“ç‚ºç”šéº¼éŒ¯èª¤ # ğŸ·#ğŸ‘å› ç‚ºf1çš„è¿”å›å€¼ç‚ºå‘é‡,ä¸”é•·åº¦ç‚º2\rr1\r#\u0026gt; x1 x2\r#\u0026gt; [1,] 3 1\r#\u0026gt; [2,] 3 6\r vapplyç·´ç¿’â“ æƒ³è¦åˆ—å‡ºæ¯å€‹æ¬„ä½çš„é¡åˆ¥,ä»¥å…§å»ºè³‡æ–™é›†mtcars ä½œç‚ºç·´ç¿’ã€‚æç¤º\r fieldType\u0026lt;-vapply(mtcars,class,character(1))\rprint(fieldType)\r#\u0026gt; mpg cyl disp hp drat wt qsec vs #\u0026gt; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; #\u0026gt; am gear carb #\u0026gt; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot; \u0026quot;numeric\u0026quot;\r \nmapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š\nmapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE,USE.NAMES = TRUE)\r åƒæ•¸åˆ—è¡¨ï¼š\n  FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸\n  â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š\n  MoreArgs: åƒæ•¸åˆ—è¡¨\n  SIMPLIFY: æ˜¯å¦è½‰çŸ©é™£ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„\n  USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½®\n  å¦‚æœFun=f(x)ï¼Œå‰‡ mapply(f,a1)çš„åŸ·è¡Œæ˜¯ï¼š\n f(a1)    å¦‚æœFun=f(x,y)ï¼Œå‰‡ mapply(f,a1,a2)çš„åŸ·è¡Œæ˜¯ï¼š\n f(a1, a2)    æ¯”å¦‚ï¼Œæ¯”è¼ƒ3å€‹å‘é‡å¤§å°ï¼ŒæŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚\nset.seed(1)\r# å®šç¾©3å€‹å‘é‡\rx\u0026lt;-1:10\ry\u0026lt;-5:-4\rz\u0026lt;-round(runif(10,-5,5))\r# æŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚\rmapply(max,x,y,z) #ğŸ·ğŸ‘ç­‰åŒ max(x,y,z),å› ç‚ºmaxçš„åƒæ•¸ç‚º ...\r#\u0026gt; [1] 5 4 3 4 5 6 7 8 9 10\r#âŒå‡ºéŒ¯ç¤ºç¯„\rmymax \u0026lt;-function(x){\rmax(x)\r}\rmapply(mymax,x,y,z) #\u0026gt; Error in (function (x) : æœªä½¿ç”¨çš„å¼•æ•¸ (dots[[2]][[1]], dots[[3]][[1]])\r å†çœ‹ä¸€å€‹ä¾‹å­ï¼Œç”Ÿæˆ4å€‹ç¬¦åˆæ­£æ…‹åˆ†ä½ˆçš„æ•¸æ“šé›†ï¼Œåˆ†åˆ¥å°æ‡‰çš„å‡å€¼å’Œæ–¹å·®ç‚ºc(1,10,100,1000)ã€‚\nset.seed(1)\r# é•·åº¦ç‚º4\rn\u0026lt;-rep(4,4)\r# mç‚ºå‡å€¼ï¼Œvç‚ºæ–¹å·®\rm\u0026lt;-v\u0026lt;-c(1,10,100,1000)\r# ç”Ÿæˆ4çµ„æ•¸æ“šï¼ŒæŒ‰åˆ—åˆ†çµ„\rmapply(rnorm,n,m,v)\r#\u0026gt; [,1] [,2] [,3] [,4]\r#\u0026gt; [1,] 0.3735462 13.295078 157.57814 378.7594\r#\u0026gt; [2,] 1.1836433 1.795316 69.46116 -1214.6999\r#\u0026gt; [3,] 0.1643714 14.874291 251.17812 2124.9309\r#\u0026gt; [4,] 2.5952808 17.383247 138.98432 955.0664\r tapplyå‡½æ•¸ tapplyç”¨æ–¼åˆ†çµ„çš„å¾ªç’°è¨ˆç®—ï¼Œé€šéINDEXåƒæ•¸å¯ä»¥æŠŠæ•¸æ“šé›†Xé€²è¡Œåˆ†çµ„ï¼Œç›¸ç•¶æ–¼group byçš„æ“ä½œã€‚\nå‡½æ•¸å®šç¾©ï¼š\ntapply(X, INDEX, FUN = NULL, ..., simplify = TRUE)\r åƒæ•¸åˆ—è¡¨ï¼š\n X: å‘é‡ INDEX: ç”¨æ–¼åˆ†çµ„çš„ç´¢å¼• FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š simplify : æ˜¯å¦æ•¸çµ„åŒ–ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„  æ¯”å¦‚ï¼Œè¨ˆç®—ä¸åŒå“ç¨®çš„é³¶å°¾èŠ±çš„èŠ±ç“£(iris)é•·åº¦çš„å‡å€¼ã€‚\n# é€šéiris$Specieså“ç¨®é€²è¡Œåˆ†çµ„\rtapply(iris$Petal.Length,iris$Species,mean)\r#\u0026gt; setosa versicolor virginica #\u0026gt; 1.462 4.260 5.552\r åˆ†çµ„æ±‚å’Œçš„ç¯„ä¾‹ã€‚\nset.seed(1)\rx\u0026lt;-1:10\r# äº‚è¡“åˆ†æˆ3çµ„ï¼Œåˆ†åˆ¥æ˜¯0,1,2 t\u0026lt;-round(runif(10,1,100)%%2);t\r#\u0026gt; [1] 1 2 2 1 1 2 1 0 1 1\r# å°xé€²è¡Œåˆ†çµ„æ±‚å’Œ\rtapply(x,t,sum)\r#\u0026gt; 0 1 2 #\u0026gt; 8 36 11\r rapplyå‡½æ•¸ eapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š\neapply(env, FUN, ..., all.names = FALSE, USE.NAMES = TRUE)\r ç·´ç¿’ï¼š\n1 æŠŠiris æ¯å€‹æ¬„ä½çš„åŠ ç¸½åˆ—å‡º iris æœ‰ä¸€å€‹æ¬„ä½æ˜¯factor\nç¯„ä¾‹ å°‡æ¯å€‹rmdæª”æ¡ˆä¸­éœ€è¦çš„å‡½æ•¸åº«åˆ—è¡¨ #setwd(~/directory1/)\rlibs = lapply(list.files(pattern = \u0026quot;\\\\.Rmd$\u0026quot;),\rfunction(x){\rd = readLines(x)\rd = d[grepl(\u0026quot;library\\\\(.*\\\\)\u0026quot;, d)]\rgsub(\u0026quot;library\\\\((.*)\\\\)\u0026quot;, \u0026quot;\\\\1\u0026quot;, d)\r})\runique(unlist(libs))\r note:\ngrepl :ã€€é‚è¼¯å€¼\ngsub :ã€€åªæ‹¿å–library(\u0026quot;å‡½æ•¸åº«åç¨±\u0026quot;)ä¸­çš„\u0026quot;å‡½æ•¸åº«åç¨±\u0026quot;ã€‚\n"},
{"uri": "/blogR//rlang/7_1_function.html","title": "7.1 R å‡½æ•¸çš„åŸºæœ¬æ’°å¯«",
	"tags": [],
	"description": "",
	"content": "ç°¡å–®çš„å‡½æ•¸ç¯„ä¾‹   æ±‚å¹³å‡,æ¨™æº–å·®\nmymean\u0026lt;-function(x){\rsum(x)/length(x) #ğŸ·ğŸ‘æœ€å¾Œä¸€å€‹åŸ·è¡Œçš„expresså…¶çµæœæœƒè¢«å›å‚³\r}\rstd \u0026lt;-function(x){\rsd(x)\r}\rdata\u0026lt;-runif(10)\rmymean(data)\r#\u0026gt; [1] 0.3969562\rmean(data) # ğŸ·ğŸ‘æ¯”è¼ƒåŸä¾†çš„mean\r#\u0026gt; [1] 0.3969562\rstd(data)\r#\u0026gt; [1] 0.2328856\rsd(data) # ğŸ·ğŸ‘æ¯”è¼ƒåŸä¾†çš„sd\r#\u0026gt; [1] 0.2328856\r   å¦ä¸€ç¯„ä¾‹\npower \u0026lt;- function(exponent) {\rfunction(x) x^exponent\r}\rsquare \u0026lt;- power(2)\rsquare(2) # -\u0026gt; [1] 4\rsquare(4) # -\u0026gt; [1] 16\rcube \u0026lt;- power(3)\rcube(2) # -\u0026gt; [1] 8\rcube(4) # -\u0026gt; [1] 64\r   ä»¥ä¸‹æ˜¯Rå…§å»ºçš„å‡½æ•¸fivenumå…§å®¹)\nmyfun\u0026lt;- function (x, na.rm = TRUE) #ğŸ·ğŸ‘ç¬¬äºŒå€‹åƒæ•¸æœ‰é è¨­å€¼\r{\rxna \u0026lt;- is.na(x)\rif (any(xna)) {\rif (na.rm) x \u0026lt;- x[!xna]\relse return(rep.int(NA, 5))\r}\rx \u0026lt;- sort(x) #ğŸ·ğŸ‘æ’åº\rn \u0026lt;- length(x)\rif (n == 0) rep.int(NA, 5)\relse {\rn4 \u0026lt;- floor((n + 3)/2)/2\rd \u0026lt;- c(1, n4, (n + 1)/2, n + 1 - n4, n)\r0.5 * (x[floor(d)] + x[ceiling(d)])\r}\r}\r   è‡ªå·±å¯«ä¸€å€‹é¡ä¼¼which()çš„å‡½æ•¸ã€‚\nx\u0026lt;-c(T,F,T,F)\rwhich(x)\r#\u0026gt; [1] 1 3\r æç¤º\r å°šæœªå®Œæˆ\nå…¨å±€è®Šæ•¸å’Œå±€éƒ¨è®Šæ•¸   åœ¨å‡½æ•¸ä¸­ä½¿ç”¨çš„è®Šæ•¸,æ˜¯å±€éƒ¨è®Šæ•¸ ä¾‹å¦‚æœ¬ä¾‹ä¸­çš„yã€‚\nx \u0026lt;- 2 ls() #ğŸ·ğŸ‘å…¨å±€è®Šæ•¸xï¼Œâœ”å¯ä»¥åœ¨å·¥ä½œå€é–“çœ‹åˆ°x\r#\u0026gt; [1] \u0026quot;data\u0026quot; \u0026quot;mymean\u0026quot; \u0026quot;std\u0026quot; \u0026quot;x\u0026quot;\rg \u0026lt;- function() { #ğŸ·ğŸ‘å…¨å±€è®Šæ•¸gï¼Œâœ”å¯ä»¥åœ¨å·¥ä½œå€é–“çœ‹åˆ°\ry \u0026lt;- 1 #ğŸ·ğŸ‘å±€éƒ¨è®Šæ•¸yï¼ŒâŒåœ¨å…¨å±€å€çœ‹ä¸åˆ°,åªæœ‰åœ¨ç›®å‰çš„å‡½æ•¸å€å¯ä»¥çœ‹åˆ°\rc(x, y) #ğŸ·ğŸ‘åœ¨å‡½æ•¸ä¸­ä½¿ç”¨å…¨å±€è®Šæ•¸x\r}\rg()\r#\u0026gt; [1] 2 1\ry # ğŸ·ğŸæœƒå‡ºç¾éŒ¯èª¤\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'y'\rls() # å·¥ä½œå€å‡ºç¾x,g,ä½†æ˜¯æ²’æœ‰y\r#\u0026gt; [1] \u0026quot;data\u0026quot; \u0026quot;g\u0026quot; \u0026quot;mymean\u0026quot; \u0026quot;std\u0026quot; \u0026quot;x\u0026quot;\rrm(x, g)\rls()\r#\u0026gt; [1] \u0026quot;data\u0026quot; \u0026quot;mymean\u0026quot; \u0026quot;std\u0026quot;\r   å±€éƒ¨å‡½æ•¸å·¥ä½œå€ä¸­,æƒ³è¦æ›´æ”¹å…¨å±€è®Šæ•¸\nx\u0026lt;-3\rf1\u0026lt;-function (){\rx\u0026lt;-4+x # ğŸ·ğŸ‘ä¸æœƒæ›´æ”¹å…¨å±€è®Šæ•¸x,åªæ˜¯å±€éƒ¨è®Šæ•¸,çš„ç¢ºæ˜¯7\r}\rf1()\rx #ğŸ·ğŸ‘ä»ç„¶æ˜¯3,çœ‹èµ·ä¾†æ˜¯Rçš„åƒæ•¸å‚³éæ–¹æ³•æ˜¯å‚³å€¼è€Œä¸æ˜¯å‚³å€\r#\u0026gt; [1] 3\r   ä¸Šè¿°ç¨‹å¼ç¢¼å¦‚æœè¦åœ¨å‡½æ•¸ä¸­æ›´æ”¹å…¨å±€è®Šæ•¸,å‰‡\nx\u0026lt;-3\rf1\u0026lt;-function (){\rx\u0026lt;\u0026lt;-4+x #ğŸ·ğŸ‘é€™æœƒæ›´æ”¹å…¨å±€è®Šæ•¸xâœ”ï¸\r}\rf1()\rx # 7\r#\u0026gt; [1] 7\r   ä¸²åˆ—å‘¢\nx\u0026lt;-list(1,2,3)\rf1\u0026lt;-function (){\rx[[4]]\u0026lt;\u0026lt;-\u0026quot;a4\u0026quot; # ğŸ·ğŸ‘âœ”ï¸\r}\rf1()\rx # 7\r#\u0026gt; [[1]]\r#\u0026gt; [1] 1\r#\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] 2\r#\u0026gt; #\u0026gt; [[3]]\r#\u0026gt; [1] 3\r#\u0026gt; #\u0026gt; [[4]]\r#\u0026gt; [1] \u0026quot;a4\u0026quot;\r   å‚³å€¼,å‚³å€ é€™è£¡é©—è­‰Rèªè¨€çš„å‡½æ•¸æ˜¯å‚³å€¼é‚„æ˜¯å‚³å€\nä¾‹å¦‚ä¸‹é¢çš„ç¨‹å¼ç¢¼,å‚³é€²å»çš„ä¸ç®¡æ˜¯å‘é‡é‚„æ˜¯è³‡æ–™é›†,æ›´æ”¹è£¡é¢çš„å…§å®¹éƒ½ç„¡æ•ˆ\ntest1 \u0026lt;- function(x ){\rx[1,1]\u0026lt;-2\r}\rx\u0026lt;-matrix(rnorm(10),2,5)\rx\r#\u0026gt; [,1] [,2] [,3] [,4] [,5]\r#\u0026gt; [1,] 0.1207716 1.0091269 -0.1913277 -0.6707347 -0.4523616\r#\u0026gt; [2,] 1.9011509 -0.1679119 -0.2994890 0.1736809 0.6093707\rtest1(x)\rx\r#\u0026gt; [,1] [,2] [,3] [,4] [,5]\r#\u0026gt; [1,] 0.1207716 1.0091269 -0.1913277 -0.6707347 -0.4523616\r#\u0026gt; [2,] 1.9011509 -0.1679119 -0.2994890 0.1736809 0.6093707\rx\u0026lt;-as.data.frame(x)\rtest1(x)\rx\r V1 V2 V3 V4 V5   0.1207716 1.0091269 -0.1913277 -0.6707347 -0.4523616  1.9011509 -0.1679119 -0.2994890 0.1736809 0.6093707     parent.frame parentls \u0026lt;- function() {\rls(envir=parent.frame())\r}\ra\u0026lt;-function() {\rx \u0026lt;- 5\rparentls()\r}\rb \u0026lt;- function() {\rz \u0026lt;- 10\rparentls()\r}\ra()\r#\u0026gt; [1] \u0026quot;x\u0026quot;\rb()\r#\u0026gt; [1] \u0026quot;z\u0026quot;\rparentls()\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;data\u0026quot; \u0026quot;f1\u0026quot; \u0026quot;mymean\u0026quot; \u0026quot;parentls\u0026quot; \u0026quot;std\u0026quot; #\u0026gt; [8] \u0026quot;test1\u0026quot; \u0026quot;x\u0026quot;\r ç‰¹æ®Šç¬¦è™Ÿ 3å€‹é€—é» (dots) 3å€‹é€—é»å¯ä»¥åˆ©ç”¨?dotsæŸ¥è©¢ã€‚\nç¯„ä¾‹\nf \u0026lt;- function(x, ...)\r{\rdots \u0026lt;- list(...) #1\rif(length(dots) == 0) return(NULL) cat(\u0026quot;The arguments in ... are\\n\u0026quot;)\rprint(x)\rf(...) #2\r}\rf(1,2,3,\u0026quot;a\u0026quot;, list(\u0026quot;monkey\u0026quot;))\r#\u0026gt; The arguments in ... are\r#\u0026gt; [1] 1\r#\u0026gt; The arguments in ... are\r#\u0026gt; [1] 2\r#\u0026gt; The arguments in ... are\r#\u0026gt; [1] 3\r#\u0026gt; The arguments in ... are\r#\u0026gt; [1] \u0026quot;a\u0026quot;\r#\u0026gt; NULL\r operator %\u0026gt;% %\u0026gt;% ä¸æ˜¯RåŸºç¤å¥—ä»¶ è€Œæ˜¯å®šç¾©åœ¨å¥—ä»¶ magrittr (CRAN) ä¹‹ä¸­ ä¸”å¸¸è·Ÿ dplyr (CRAN)æ­é…ã€‚\næ„æ€æ˜¯æŠŠå·¦é‚Š(LHS)ç•¶æˆå³é‚Š(RHS)å‡½æ•¸ä¸­çš„ç¬¬ä¸€å€‹åƒæ•¸ã€‚\nä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­:\nlibrary(magrittr)\riris %\u0026gt;% head() #ğŸ·ğŸ‘ iris %\u0026gt;% head() ç›¸ç•¶æ–¼ head(iris)\rSepal.Length Sepal.Width Petal.Length Petal.Width Species\r1 5.1 3.5 1.4 0.2 setosa\r2 4.9 3.0 1.4 0.2 setosa\r3 4.7 3.2 1.3 0.2 setosa\r4 4.6 3.1 1.5 0.2 setosa\r5 5.0 3.6 1.4 0.2 setosa\r6 5.4 3.9 1.7 0.4 setosa\r ç‚ºç”šéº¼éœ€è¦é€™æ¨£ç”¨,ä¸‹é¢æ˜¯ä¸€å€‹ä¾‹å­\niris %\u0026gt;% head() %\u0026gt;% summary()\r é¡ä¼¼çš„è§€å¿µ,\niris %\u0026gt;% head() %\u0026gt;% summary() # ç­‰åŒæ–¼summary(head(iris)).  ä¹Ÿå°±æ˜¯èªª,é¿å…äº†ä½¿ç”¨å·¢ç‹€å‘¼å«ã€‚\noperator %in% closure ox\u0026lt;-function (arg=3) {\rx\u0026lt;-0\ro1\u0026lt;-function(){\rx\u0026lt;\u0026lt;-x+arg;\r} list(go=o1)\r}\robj\u0026lt;-ox(4)\robj$go()\r example of closure make.accumulator\u0026lt;-function(){\ra\u0026lt;-0\rfunction(x) {\ra\u0026lt;\u0026lt;-a+x\ra\r}\r}\rf\u0026lt;-make.accumulator()\rf(1)\r#\u0026gt; [1] 1\rf(1)\r#\u0026gt; [1] 2\rf(1)\r#\u0026gt; [1] 3\r â“ åˆ©ç”¨ä¸Šè¿°è§€å¿µå»ºç«‹ä¸€å€‹è¨ˆæ•¸å™¨ã€‚\nğŸ’¡ ä¾‹å¦‚ç”¢ç”Ÿçš„æª”æ¡ˆå€‹æ•¸ä¸å®š,ä½†æ˜¯æƒ³è¦æ¯æ¬¡é–‹å§‹åŸ·è¡Œçš„æ™‚å€™éƒ½æœ‰ä¸€å€‹å›ºå®šç·¨è™Ÿã€‚\næç¤º\r new_counter \u0026lt;- function() {\ri \u0026lt;- 0\rfunction() {\r# do something useful, then ...\ri \u0026lt;\u0026lt;- i + 1\ri\r}\r}\r \nsource è‡ªå·±çš„å‡½æ•¸å­˜æˆæª”æ¡ˆ(ä¾‹å¦‚åç¨±ç‚ºmyfun.R)ä»¥å¾Œ,å¦‚ä½•å‘¼å«? åˆ©ç”¨source(\u0026quot;myfun.R\u0026quot;) å¯ä»¥è¼‰å…¥è¨˜æ†¶é«”ä¸­,æ­¤æ™‚åœ¨æ•´é«”å·¥ä½œç’°å¢ƒä¸­å¯ä»¥çœ‹åˆ°å‡½æ•¸å®šç¾©ã€‚\nå•é¡Œæ˜¯,ä¸‹æ¬¡æˆ‘åˆç¹¼çºŒåŒä¸€å€‹å°ˆæ¡ˆçš„æ™‚å€™å‘¢,é€™äº›æˆ‘å·²ç¶“å®šç¾©éçš„å‡½æ•¸èƒ½ä¸èƒ½çºŒçºŒä½¿ç”¨?æœ‰ä¸‹åˆ—å¹¾ç¨®æ–¹æ³•\n é›¢é–‹å°ˆæ¡ˆçš„æ™‚å€™,å¦‚æœå„²å­˜å·¥ä½œç’°å¢ƒ(ç³»çµ±å•ä½ æ˜¯ä¸æ˜¯save workspace to .Rdata?),å¦‚æœå›ç­”æ˜¯,å‰‡ä¸‹æ¬¡å¯ä»¥ä¸ç”¨source(),ç›´æ¥å¯ä»¥ä½¿ç”¨ã€‚ åœ¨.Rprofile åŠ å…¥ä¸€è¡Œsource(\u0026quot;myfun.R\u0026quot;) ä½†æ˜¯åœ¨RMDæª”æ¡ˆä¸­,å› ç‚ºæ¯æ¬¡éƒ½æ˜¯æ–°sessionå› æ­¤,å¿…é ˆè¦å…ˆæ‰¾åœ°æ–¹source(ä¾‹å¦‚åœ¨ç¬¬ä¸€å€‹chunk)ã€‚  OOP åƒè€ƒadvance R\nBase objects vs OO objects è¾¨åˆ¥è®Šæ•¸æ˜¯åŸºç¤å‹åˆ¥æˆ–æ˜¯ç‰©ä»¶å‹åˆ¥ï¼Œå¯ä»¥ç°¡å–®åˆ©ç”¨å‡½æ•¸ï¼š is.object():\nåŸºç¤ç‰©ä»¶base object:\nis.object(1:10)\r#\u0026gt; [1] FALSE\r ç‰©ä»¶å°å‘ç‰©ä»¶ OO object\nis.object(mtcars)\r#\u0026gt; [1] TRUE\r ä¸»è¦çš„å€åˆ¥åœ¨æ–¼åŸºæœ¬ç‰©ä»¶æ²’æœ‰class é€™å€‹attribute\nattr(1:10, \u0026quot;class\u0026quot;) # NULL\r#\u0026gt; NULL\rattr(mtcars, \u0026quot;class\u0026quot;) # [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r ä¹Ÿå¯ä»¥ç”¨attributes() ,class()\nattributes(1:10)\r#\u0026gt; NULL\rattributes(mtcars)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;mpg\u0026quot; \u0026quot;cyl\u0026quot; \u0026quot;disp\u0026quot; \u0026quot;hp\u0026quot; \u0026quot;drat\u0026quot; \u0026quot;wt\u0026quot; \u0026quot;qsec\u0026quot; \u0026quot;vs\u0026quot; \u0026quot;am\u0026quot; \u0026quot;gear\u0026quot;\r#\u0026gt; [11] \u0026quot;carb\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] \u0026quot;Mazda RX4\u0026quot; \u0026quot;Mazda RX4 Wag\u0026quot; \u0026quot;Datsun 710\u0026quot; #\u0026gt; [4] \u0026quot;Hornet 4 Drive\u0026quot; \u0026quot;Hornet Sportabout\u0026quot; \u0026quot;Valiant\u0026quot; #\u0026gt; [7] \u0026quot;Duster 360\u0026quot; \u0026quot;Merc 240D\u0026quot; \u0026quot;Merc 230\u0026quot; #\u0026gt; [10] \u0026quot;Merc 280\u0026quot; \u0026quot;Merc 280C\u0026quot; \u0026quot;Merc 450SE\u0026quot; #\u0026gt; [13] \u0026quot;Merc 450SL\u0026quot; \u0026quot;Merc 450SLC\u0026quot; \u0026quot;Cadillac Fleetwood\u0026quot; #\u0026gt; [16] \u0026quot;Lincoln Continental\u0026quot; \u0026quot;Chrysler Imperial\u0026quot; \u0026quot;Fiat 128\u0026quot; #\u0026gt; [19] \u0026quot;Honda Civic\u0026quot; \u0026quot;Toyota Corolla\u0026quot; \u0026quot;Toyota Corona\u0026quot; #\u0026gt; [22] \u0026quot;Dodge Challenger\u0026quot; \u0026quot;AMC Javelin\u0026quot; \u0026quot;Camaro Z28\u0026quot; #\u0026gt; [25] \u0026quot;Pontiac Firebird\u0026quot; \u0026quot;Fiat X1-9\u0026quot; \u0026quot;Porsche 914-2\u0026quot; #\u0026gt; [28] \u0026quot;Lotus Europa\u0026quot; \u0026quot;Ford Pantera L\u0026quot; \u0026quot;Ferrari Dino\u0026quot; #\u0026gt; [31] \u0026quot;Maserati Bora\u0026quot; \u0026quot;Volvo 142E\u0026quot; #\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\rclass(1:10) #ğŸ·ğŸ‘class()é€™å€‹å‡½æ•¸,ä¸è¦‹å¾—ç¸½æ˜¯æœƒå’Œattr()çš„çµæœä¸€è‡´,å› ç‚ºï¼Œå°åŸºæœ¬ç‰©ä»¶è€Œè¨€,å‚³å›çš„æ˜¯å…¶æœ¬å‹æ…‹(ä¾‹å¦‚é€™è£¡çš„integer),è€Œä¸æ˜¯ NULL(åƒçœ‹å‰é¢)ã€‚\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rclass(mtcars)\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r è®Šæ•¸å±¬æ€§æŸ¥è©¢å‡½æ•¸  names() dimnames() length() dim(): å„ç¶­åº¦é•·åº¦ class() : è®Šæ•¸é¡åˆ¥ table()ï¼šå„é¡è³‡æ–™è¨ˆæ•¸ str()ï¼šè®Šæ•¸çš„è³‡æ–™çµæ§‹(å…¶å¯¦æ˜¯ä¸€å€‹list)  é€énames()å‡½æ•¸ï¼Œå¯å–å¾—å„ç¨®listå…ƒç´ çš„åç¨±,ä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡æ˜¯é¡¯ç¤ºæ¬„ä½åç¨±\nstr(islands) # ğŸ·ğŸ‘islandsæ˜¯å…§å»ºè³‡æ–™\r#\u0026gt; Named num [1:48] 11506 5500 16988 2968 16 ...\r#\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr [1:48] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; ...\rhead(names(islands)) #\u0026gt; [1] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; \u0026quot;Axel Heiberg\u0026quot;\r#\u0026gt; [6] \u0026quot;Baffin\u0026quot;\r æ–¹å½¢è³‡æ–™ï¼ˆä¾‹å¦‚ï¼ŒçŸ©é™£ï¼Œtable, data.frame)ï¼Œå¯ä»¥é€édimnames()å‡½æ•¸å¯é¡¯ç¤ºdata.frame æ©«è¡Œå’Œç›´è¡Œçš„åç¨± å…ˆæ©«è¡Œï¼Œç„¶å¾Œç›´è¡Œã€‚\ndimnames(USArrests) #\u0026gt; [[1]]\r#\u0026gt; [1] \u0026quot;Alabama\u0026quot; \u0026quot;Alaska\u0026quot; \u0026quot;Arizona\u0026quot; \u0026quot;Arkansas\u0026quot; #\u0026gt; [5] \u0026quot;California\u0026quot; \u0026quot;Colorado\u0026quot; \u0026quot;Connecticut\u0026quot; \u0026quot;Delaware\u0026quot; #\u0026gt; [9] \u0026quot;Florida\u0026quot; \u0026quot;Georgia\u0026quot; \u0026quot;Hawaii\u0026quot; \u0026quot;Idaho\u0026quot; #\u0026gt; [13] \u0026quot;Illinois\u0026quot; \u0026quot;Indiana\u0026quot; \u0026quot;Iowa\u0026quot; \u0026quot;Kansas\u0026quot; #\u0026gt; [17] \u0026quot;Kentucky\u0026quot; \u0026quot;Louisiana\u0026quot; \u0026quot;Maine\u0026quot; \u0026quot;Maryland\u0026quot; #\u0026gt; [21] \u0026quot;Massachusetts\u0026quot; \u0026quot;Michigan\u0026quot; \u0026quot;Minnesota\u0026quot; \u0026quot;Mississippi\u0026quot; #\u0026gt; [25] \u0026quot;Missouri\u0026quot; \u0026quot;Montana\u0026quot; \u0026quot;Nebraska\u0026quot; \u0026quot;Nevada\u0026quot; #\u0026gt; [29] \u0026quot;New Hampshire\u0026quot; \u0026quot;New Jersey\u0026quot; \u0026quot;New Mexico\u0026quot; \u0026quot;New York\u0026quot; #\u0026gt; [33] \u0026quot;North Carolina\u0026quot; \u0026quot;North Dakota\u0026quot; \u0026quot;Ohio\u0026quot; \u0026quot;Oklahoma\u0026quot; #\u0026gt; [37] \u0026quot;Oregon\u0026quot; \u0026quot;Pennsylvania\u0026quot; \u0026quot;Rhode Island\u0026quot; \u0026quot;South Carolina\u0026quot;\r#\u0026gt; [41] \u0026quot;South Dakota\u0026quot; \u0026quot;Tennessee\u0026quot; \u0026quot;Texas\u0026quot; \u0026quot;Utah\u0026quot; #\u0026gt; [45] \u0026quot;Vermont\u0026quot; \u0026quot;Virginia\u0026quot; \u0026quot;Washington\u0026quot; \u0026quot;West Virginia\u0026quot; #\u0026gt; [49] \u0026quot;Wisconsin\u0026quot; \u0026quot;Wyoming\u0026quot; #\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] \u0026quot;Murder\u0026quot; \u0026quot;Assault\u0026quot; \u0026quot;UrbanPop\u0026quot; \u0026quot;Rape\u0026quot;\r æ–¹å½¢è³‡æ–™ï¼Œå¯ä»¥é€élength()å‡½æ•¸å¯é¡¯ç¤ºè³‡æ–™é•·åº¦ï¼Œä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡é¡¯ç¤ºæ¬„ä½æ•¸ã€‚\nlength(islands) #\u0026gt; [1] 48\r é€édim() é¡¯ç¤ºæ–¹å½¢è³‡æ–™çš„ã€Œè³‡æ–™ç­†æ•¸ã€å’Œã€Œæ¬„ä½æ•¸ç›®ã€ï¼Œå…ˆã€Œæ©«è¡Œã€ï¼Œå¾Œã€Œç›´è¡Œã€\ndim(USArrests) #\u0026gt; [1] 50 4\r ä½¿ç”¨class()å‡½æ•¸å¯çŸ¥é“è®Šæ•¸é¡åˆ¥\nclass(pi)\r#\u0026gt; [1] \u0026quot;numeric\u0026quot;\rclass(Sys.Date())\r#\u0026gt; [1] \u0026quot;Date\u0026quot;\r ä½¿ç”¨table()å‡½æ•¸å¯çŸ¥é“å‘é‡ä¸­æ¯å€‹å€¼å‡ºç¾å¹¾æ¬¡\ntable(iris$Species) ##çµ±è¨ˆçµæœ\r#\u0026gt; #\u0026gt; setosa versicolor virginica #\u0026gt; 50 50 50\r"},
{"uri": "/blogR//rlang/7_2_function.html","title": "7.2 æ›´å¤šRå‡½æ•¸",
	"tags": [],
	"description": "7_2_function",
	"content": "Function fundamentals å¹¾å€‹é‡è¦è§€å¿µ\n å‡½æ•¸ä¹Ÿæ˜¯ç‰©ä»¶,å°±åƒæ˜¯vectors ä¹Ÿæ˜¯ç‰©ä»¶ã€‚ ç”±ä¸‰å€‹éƒ¨ä»½çµ„æˆ: arguments, body, and environment.  ä½†æ˜¯è¦å‰‡éƒ½æœƒè¢«æ‰“ç ´,ä¾‹å¤–å¤§æ¦‚éƒ½åˆ©ç”¨Cå¯«æˆçš„ \u0026quot;primitive\u0026quot; base functionsã€‚\nFirst-class functions åœ¨Rä¸­,å‡½æ•¸ä¹Ÿæ˜¯ç‰©ä»¶,é€™ç¨®ç‰¹æ€§ä¹Ÿå«åš \u0026quot;first-class functions\u0026quot;.\nä¾‹å¦‚åœ¨listä¸­,ä¹Ÿå¯ä»¥æ”¾å…¥å‡½æ•¸:\nfuns \u0026lt;- list(\rhalf = function(x) x / 2,\rdouble = function(x) x * 2\r)\rfuns$double(10)\r#\u0026gt; [1] 20\r åŒ¿åå‡½æ•¸:\nlapply(mtcars, function(x) length(unique(x)))\rFilter(function(x) !is.numeric(x), mtcars)\rintegrate(function(x) sin(x) ^ 2, 0, pi)\r \rèª¿ç”¨åŒ¿åå‡½æ•¸\rå¦‚æœè¦èª¿ç”¨åŒ¿åå‡½æ•¸,åƒè€ƒä¸‹é¢çš„æ–¹å¼\n(function(x) 3)()\r  åœ¨Rèªè¨€ä¸­,å‡½æ•¸æœ‰æ™‚å«åšclosureå› ç‚º,å› ç‚ºRå‡½æ•¸åŒ…å«(enclose)å®ƒå€‘çš„ç’°å¢ƒ environments.\n01\u0026lt;-function() {3}\rtypeof(f01)\r#\u0026gt; [1] \u0026quot;closure\u0026quot; #ğŸ·ğŸ‘å°ç…§å¾Œé¢classçš„çµæœ\rstr(f01)\r#\u0026gt; function () #\u0026gt; - attr(*, \u0026quot;srcref\u0026quot;)= 'srcref' int [1:8] 1 6 1 19 6 19 1 1\r#\u0026gt; ..- attr(*, \u0026quot;srcfile\u0026quot;)=Classes 'srcfilecopy', 'srcfile' \u0026lt;environment: 0x00000000188ac3c8=\u0026quot;\u0026quot;\u0026gt;\rclass(f01)\r#\u0026gt; [1] \u0026quot;function\u0026quot; #ğŸ·ğŸ‘æ˜¯function,åŒæ™‚ç¹¼æ‰¿è‡ªclosure\r#\u0026gt; [1] \u0026quot;closure\u0026quot;  å‡½æ•¸çš„çµ„æˆ 1å€‹å‡½æ•¸æœ‰3å€‹éƒ¨åˆ†:\n formals(), åƒæ•¸ body(), {}å…§éƒ¨. environment(), æ±ºå®šå‡½æ•¸æ€æ¨£æ‰¾å‡ºè®Šæ•¸(names)çš„å…§å®¹ã€‚.  æ¸¬è©¦3éƒ¨åˆ†\nf02 \u0026lt;- function(x) {\r3\r}\rformals(f02)\r#\u0026gt; $x\rbody(f02)\r#\u0026gt; {\r#\u0026gt; 3\r#\u0026gt; }\renvironment(f02) #ğŸ·ğŸ‘æœ¬å‡½æ•¸f(02)æœƒå»æœå°‹çš„è®Šæ•¸ç©ºé–“\r#\u0026gt; \u0026lt;environment: 0x0000000019cdc128\u0026gt;\r ğŸ‘å°±åƒæ‰€ä»¥å…¶ä»–Rçš„ç‰©ä»¶,å‡½æ•¸ä¹Ÿæœ‰å¾ˆå¤š attributes(). å…¶ä¸­ä¸€å€‹ \u0026quot;srcref\u0026quot;, æ˜¯ source referenceçš„ç¸®å¯«ã€‚ attr(f02, \u0026quot;srcref\u0026quot;)\r#\u0026gt; function(x) {\r#\u0026gt; 3\r#\u0026gt; }\r \rä¾‹å¤–\rä½†æ˜¯æœ‰äº›å‡½æ•¸åƒæ˜¯ sum() and [ï¼Œé€™äº›æ‰€è¬‚çš„åŸå§‹å‡½æ•¸(Primitive functions)ï¼Œç„¡æ³•åˆ©ç”¨ä¸Šé¢çš„ä¸‰å€‹å‡½æ•¸é¡¯ç¤ºå…¶å…§å®¹,å› ç‚ºé€™äº›å‡½æ•¸å­˜åœ¨æ–¼åŸºæœ¬å¥—ä»¶(base packages) è€Œä¸”é€šå¸¸ç”¨ï¼£èªè¨€å¯«æˆã€‚\nsum\r#\u0026gt; function (..., na.rm = FALSE) .Primitive(\u0026quot;sum\u0026quot;)\r`[` # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™ä¹Ÿæ˜¯å‡½æ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; .Primitive(\u0026quot;[\u0026quot;)\r çœ‹ä¸€ä¸‹type åˆ†åˆ¥å±¬æ–¼ \u0026quot;builtin\u0026quot; or \u0026quot;special\u0026quot;:\ntypeof(sum)\r#\u0026gt; [1] \u0026quot;builtin\u0026quot;\rtypeof(`[`)\r#\u0026gt; [1] \u0026quot;special\u0026quot;\r å› ç‚ºbuild-inï¼Œ æ‰€ä»¥é€™äº›å‡½æ•¸çš„formals(), body(), and environment() éƒ½å›å‚³ NULL:\nformals(sum)\r#\u0026gt; NULL\rbody(sum)\r#\u0026gt; NULL\renvironment(sum)\r#\u0026gt; NULL\rattr(sum, \u0026quot;srcref\u0026quot;) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘Cå¯«çš„,è‡ªç„¶ä¹Ÿæ²’æœ‰åƒè€ƒç¨‹å¼ç¢¼\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; NULL\r  ç·´ç¿’\n  This code makes a list of all functions in the base package.\nobjs \u0026lt;- mget(ls(\u0026quot;package:base\u0026quot;), inherits = TRUE)\rfuns \u0026lt;- Filter(is.function, objs)\r Use it to answer the following questions:\n Which base function has the most arguments? How many base functions have no arguments? What's special about those functions? How could you adapt the code to find all primitive functions?    è®Šæ•¸å’Œå‡½æ•¸çš„æœå°‹ Rçš„'s lexical scoping éµå¾ª4å€‹ä¸»è¦è¦å‰‡::\n Name masking Functions vs. variables A fresh start Dynamic lookup  ä¸‹é¢çš„åŸ·è¡Œçµæœå‚³å›10é‚„æ˜¯20?\nx \u0026lt;- 10\rg01 \u0026lt;- function() {\rx \u0026lt;- 20\rx\r}\rg01()\r æç¤º\r 20\nName masking å…§éƒ¨ç¯„åœçš„å®£å‘Š(ç¬¬ä¸€æ¬¡ä½¿ç”¨)è¦†è“‹å¤–éƒ¨ç¯„åœçš„å®£å‘Šã€‚.\nx \u0026lt;- 10\ry \u0026lt;- 20\rg02 \u0026lt;- function() {\rx \u0026lt;- 1\ry \u0026lt;- 2\rc(x, y)\r}\rg02()\r#\u0026gt; [1] 1 2\r å¦‚æœåœ¨å…§éƒ¨å®£å‘Šæ‰¾ä¸åˆ°,å°±æ‰¾å¤–ä¸€å±¤ï¼Œä¸€ç›´åˆ°global environmentã€‚\nx \u0026lt;- 2\rg03 \u0026lt;- function() {\ry \u0026lt;- 1\rc(x, y)\r}\rg03()\r#\u0026gt; [1] 2 1\r ä¸Šé¢çš„è¦å‰‡ä»ç„¶é©ç”¨æ–¼å‡½æ•¸ä¸­çš„å‡½æ•¸. ä¾‹å¦‚ä¸‹ä¾‹ä¸­çš„å‡½æ•¸i()\nx \u0026lt;- 1\rg04 \u0026lt;- function() {\ry \u0026lt;- 2\ri \u0026lt;- function() {\rz \u0026lt;- 3\rc(x, y, z)\r}\ri()\r}\rg04() # ğŸ·ğŸ‘g04() returns c(1, 2, 3).\r åŒæ¨£ä¹Ÿé©ç”¨æ–¼å»ºç«‹å‡½æ•¸çš„å‡½æ•¸( closures); ä¸‹ä¾‹ä¸­çš„g06()\nx \u0026lt;- 10\ry \u0026lt;- 20\rg05 \u0026lt;- function() {\ry \u0026lt;- 2\rfunction() {\rc(x, y)\r}\r}\rg06 \u0026lt;- g05()\rg06() # ğŸ·ğŸ‘g06() returns c(10, 2).\r æ—¢ç„¶å‡½æ•¸ä¹Ÿåªæ˜¯æ™®é€šçš„ç‰©ä»¶,é‚£éº¼åŒæ¨£çš„åç¨±å°‹æ‰¾è¦å‰‡ä¹Ÿé©ç”¨æ–¼å‡½æ•¸ã€‚\nä¾‹å¦‚ä¸‹é¢é€™å€‹ä¾‹å­ä¸­,g07åœ¨å¤–éƒ¨å’Œå…§éƒ¨çš†æœ‰å®šç¾©ã€‚\ng07 \u0026lt;- function(x) x + 1 # ğŸ·ğŸ‘å…¨å±€g07()\rg08 \u0026lt;- function() {\rg07 \u0026lt;- function(x) x + 100 # ğŸ·ğŸ‘å±€éƒ¨g07()\rg07(10) #ğŸ·ğŸ‘é€™è£¡èª¿ç”¨çš„æ˜¯å±€éƒ¨g07()\r}\rg08()\r#\u0026gt; [1] 110\r ä½†æ˜¯å¦‚æœåŒä¸€å€‹åç¨±,åœ¨ä¸åŒç¯„åœæœ‰ä¸ä¸€æ¨£çš„å‹æ…‹å‘¢?ä¾‹å¦‚g9ä¸€å€‹æ˜¯è®Šæ•¸,ä¸€å€‹æ˜¯å‡½æ•¸:\ng09 \u0026lt;- function(x) x + 100\rg10 \u0026lt;- function() {\rg09 \u0026lt;- 10\rg09(g09)\r}\rg10()\r#\u0026gt; [1] 110\r ä¸€èˆ¬ä¾†è¬›,ä¸Šé¢çš„ç”¨æ³•åœ¨èªæ³•ä¸Šæ˜¯æ²’å•é¡Œ,ä½†æ˜¯æœ€å¥½é¿å…ã€‚\nA fresh start å•é¡Œ:ä¸‹ä¾‹ä¸­çš„å‡½æ•¸g11()ç¬¬ä¸€æ¬¡åŸ·è¡Œå’Œç¬¬äºŒæ¬¡åŸ·è¡Œæœ‰ç”šéº¼ä¸åŒ?\ng11 \u0026lt;- function() {\rif (!exists(\u0026quot;a\u0026quot;)) {\ra \u0026lt;- 1\r} else {\ra \u0026lt;- a + 1\r}\ra\r}\rg11()\rg11()  â“g11() æ¯æ¬¡è¢«èª¿ç”¨éƒ½æ˜¯å‚³å› 1ã€‚ç‚ºç”šéº¼?æç¤º\r æ¯æ¬¡åŸ·è¡Œg11()çš„æ™‚å€™,ä¸€å€‹æ–°çš„environmentæœƒè¢«å»ºç«‹,ä¹Ÿå°±æ˜¯é€™å€‹å‡½æ•¸çš„å±€éƒ¨ç©ºé–“ã€‚ è€Œé€™å€‹å±€éƒ¨ç©ºé–“æœƒåœ¨å‡½æ•¸çµæŸçš„æ™‚å€™âœ”ï¸æ¶ˆå¤±ã€‚\nå‡½æ•¸ exists(x) :æœƒå°‹æ‰¾è®Šæ•¸åç¨±xæ˜¯å¦å­˜åœ¨,å­˜åœ¨å‰‡ç„¡å› TRUE,å¦å‰‡å‚³å› FALSE. è€Œexists(x)çš„æœå°‹è·¯å¾‘,å¯ä»¥ç”¨search()âœ”ï¸çŸ¥é“ã€‚\r\r\rDynamic lookup ä½†æ˜¯å¦‚æœå‡½æ•¸åŸ·è¡Œçš„æ™‚å€™åœ¨å±€éƒ¨ç’°å¢ƒæ‰¾ä¸åˆ°çš„è®Šæ•¸çš„æ™‚å€™,æœƒæ–¼ç›®å‰çš„ç¸½é«”ç’°å¢ƒ(ä¹Ÿå°±æ˜¯å‡½æ•¸æ‰€åœ¨çš„ç’°å¢ƒ)æ‰¾è®Šæ•¸å€¼ã€‚\ng12 \u0026lt;- function() x + 1 #ğŸ·ğŸ‘g12()å®šç¾©åœ¨ç¸½é«”ç’°å¢ƒä¸­\rx \u0026lt;- 15 #ğŸ·ğŸ‘xå®šç¾©åœ¨ç¸½é«”ç’°å¢ƒä¸­\rg12()\r#\u0026gt; [1] 16\rx \u0026lt;- 20\rg12()\r#\u0026gt; [1] 21\r \rå±•é–‹\rä¸Šé¢çš„å‡½æ•¸g12()ç”¨åˆ°è®Šæ•¸xï¼Œå› æ­¤éœ€è¦åœ¨æœå°‹è·¯å¾‘ä¸­,æœ‰è®Šæ•¸xçš„å­˜åœ¨ã€‚å› æ­¤åœ¨ç¬¬äºŒè¡Œä¸­,å®šç¾©äº†x,é€™å€‹xå­˜åœ¨æ–¼å¤–éƒ¨ç¸½é«”ç’°å¢ƒä¸­ã€‚\né¡ä¼¼é€™ç¨®æƒ…æ³,å¦‚æœæ˜¯æ•…æ„çš„,é‚£å°±ä¸éœ€æª¢æŸ¥ã€‚ä½†å¦‚æœä¸æ˜¯ç‰¹æ„çš„,æœ‰å¯èƒ½æœƒå‡ºéŒ¯ã€‚é€™ç¨®è®Šæ•¸ç¨±ç‚ºunbound symbols(ç°¡å–®è¬›,å°±æ˜¯æ˜¯ä¸å®£å‘Šè€Œä½¿ç”¨)ã€‚ å¦‚æœè¦æª¢æŸ¥å‡½æ•¸ä¸­æœ‰æ²’æœ‰é€™ç¨®è®Šæ•¸ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…· codetools::findGlobals(). é€™å€‹å‡½æ•¸å¯ä»¥åˆ—å‡ºå‡½æ•¸ä¸­æ˜¯å¦æœ‰unbound symbols :\ncodetools::findGlobals(g12)\r#\u0026gt; [1] \u0026quot;+\u0026quot; \u0026quot;x\u0026quot;\r ä¹Ÿå¯ä»¥ä¸ä¾è³´å¥—ä»¶,è€Œåˆ©ç”¨å‡½æ•¸ emptyenv() :\ng12 \u0026lt;- function() x + 1 #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ­¤æ™‚,environment(g12) ç‚º \u0026amp;lt;environment: R_GlobalEnv\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rx=4\renvironment(g12) \u0026lt;- emptyenv() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ­¤æ™‚,environment(g12) ç‚º \u0026amp;lt;environment: R_EmptyEnv\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rg12()\r#\u0026gt; Error in x + 1: æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;+\u0026quot;\r ğŸ‘environment(g12) \u0026lt;- emptyenv()é€™ä¸€è¡Œçš„æ„æ€ğŸ‘ºä¸æ˜¯æ¸…æ‰g12()æ‰€åœ¨ç’°å¢ƒçš„çš„è®Šæ•¸,è€Œæ˜¯å°‡emptyenv()é€™å€‹æ–°ç©ºé–“æŒ‡æ´¾çµ¦g12()è®“ä»–ä¸è¦å»æœå°‹ç¸½é«”ç’°å¢ƒ(R_globalEnv)ã€‚\n Exercises   What does the following code return? Why? Describe how each of the three c's is interpreted.\nc \u0026lt;- 10\rc(c = c)\r   What are the four principles that govern how R looks for values?\n  What does the following function return? Make a prediction before running the code yourself.\nf \u0026lt;- function(x) {\rf \u0026lt;- function(x) {\rf \u0026lt;- function() {\rx ^ 2\r}\rf() + 1\r}\rf(x) * 2\r}\rf(10)\r   åƒæ•¸ Lazy evaluation lazily evaluated: å¦‚æœåƒæ•¸æ²’æœ‰åœ¨å‡½æ•¸ä¸­è¢«å­˜å–,å°±ä¸æœƒåŸ·è¡Œã€‚\n åˆ©ç”¨debugè§€å¯Ÿ h01 \u0026lt;- function(x) {\r10\r}\rh01(x=runif(10))\r  å¦ä¸€å€‹ä¾‹å­,é€™è£¡çš„stop()ä¸æœƒè¢«åŸ·è¡Œã€‚å› ç‚ºæ²’ç”¨åˆ°åƒæ•¸x h01 \u0026lt;- function(x) {\r10\r}\rh01(stop(\u0026quot;This is an error!\u0026quot;))\r   Forcing evaluation å¼·è¿«åƒæ•¸è¨ˆç®—ä¸¦å–å€¼å¯ä»¥åˆ©ç”¨å‡½æ•¸ force():\nh02 \u0026lt;- function(x) {\rforce(x)\r10\r}\rh02(stop(\u0026quot;This is an error!\u0026quot;))\r   çœ‹ä¸€ä¸‹ç‚ºç”šéº¼éœ€è¦force()\ncapture1 \u0026lt;- function(x) {\rfunction() {\rx\r}\r}\r   ç”±æ–¼lazy evaluation ,åœ¨èª¿ç”¨capture1()çš„æ™‚å€™,xä¸æœƒè¢«åŸ·è¡Œ\nx \u0026lt;- 10\rh03 \u0026lt;- capture1(x) #ğŸ·ğŸ‘ xæ²’æœ‰è¢«åŸ·è¡Œ\rh04 \u0026lt;- capture1(x) #ğŸ·ğŸ‘ xæ²’æœ‰è¢«åŸ·è¡Œ\rh03() #ğŸ·ğŸ‘ xåœ¨é€™è£¡evaluated\r#\u0026gt; [1] 10\rx \u0026lt;- 20\rh04() #ğŸ·ğŸ‘ xåœ¨é€™è£¡evaluated\r#\u0026gt; [1] 20    ä½†æ˜¯ç•¶æˆ‘å€‘èª¿ç”¨h03(),h04()ç¬¬äºŒæ¬¡çš„æ™‚å€™,éƒ½æ˜¯ç¬¬ä¸€æ¬¡æ”¾é€²å»çš„å€¼\nx \u0026lt;- 30\rh03()\r#\u0026gt; [1] 10 #ğŸ·ğŸ‘ xä»ç„¶æ˜¯ç¬¬ä¸€æ¬¡çš„å€¼\rh04()\r#\u0026gt; [1] 20\r   ä¸Šé¢æ˜¯å› ç‚ºlazy evaluation. åœ¨ç¬¬ä¸€æ¬¡åŸ·è¡Œä»¥å¾Œ,å°±è¢«cachedã€‚å› æ­¤æˆ‘å€‘éœ€è¦ forcing x:\ncapture2 \u0026lt;- function(x) {\rforce(x)\rfunction() {\rx\r}\r}\rx \u0026lt;- 10\rh05 \u0026lt;- capture2(x)\rx \u0026lt;- 20\rh05()\r#\u0026gt; [1] 10\r   é è¨­åƒæ•¸å€¼ h07x \u0026lt;-function(x=1){\rx+1\r}\rh07x() # return 2\r#\u0026gt; [1] 2\rh07 \u0026lt;- function(x = 1, y = x * 2) { # ğŸ·ğŸ‘ç¬¬äºŒå€‹åƒæ•¸,åˆ©ç”¨äº†ç¬¬ä¸€å€‹åƒæ•¸\rc(x, y)\r}\rh07()\r#\u0026gt; [1] 1 2\r ç¼ºå¤±åƒæ•¸å€¼Missing arguments missing(): ç”¨ä¾†åˆ¤æ–·åƒæ•¸å…§å®¹ä¾†è‡ªä½¿ç”¨è€…æˆ–è€…é è¨­çš„å‡½æ•¸\nh09 \u0026lt;- function(x = 10) {\rlist(missing(x), x)\r}\rstr(h09()) # é è¨­\r#\u0026gt; List of 2\r#\u0026gt; $ : logi TRUE #ğŸ·ğŸ‘å› ç‚ºä½¿ç”¨è€…æ²’å‚³åƒæ•¸,ç”¨äº†é è¨­å€¼,å› è€…æ˜¯TRUE\r#\u0026gt; $ : num 10\rstr(h09(10)) # ä½¿ç”¨è€…\r#\u0026gt; List of 2\r#\u0026gt; $ : logi FALSE\r#\u0026gt; $ : num 10\r è„«é›¢å‡½æ•¸ å‡½æ•¸çµæŸçš„æ™‚å€™,å¤§éƒ¨åˆ†æ˜¯ä¸‹é¢å…©å€‹ç‹€æ…‹ä¸­çš„ä¸€ç¨®:\n å‚³å›å€¼: è¡¨ç¤ºæˆåŠŸåŸ·è¡Œ,é€™è£¡è¨è«–  implicit vs explicit. visible vs. invisible.   ä¸Ÿå‡ºéŒ¯èª¤è¨Šè™Ÿ: è¡¨ç¤ºç„¡æ³•åŸ·è¡Œã€‚è¨è«–  éŒ¯èª¤ç™¼ç”Ÿæ™‚çš„è™•ç†ã€‚å‡½æ•¸çš„éŒ¯èª¤è„«é›¢ç‹€æ…‹å¯ä»¥æ˜¯ç”¢ç”Ÿä¸€å€‹æ——è™Ÿ,ç”¨ä¾†è§¸ç™¼æ—¢æœ‰çš„è™•ç†å‡½æ•¸,å¯ä»¥æ˜¯é‡æ–°å•Ÿå‹•,æˆ–æ˜¯äº’å‹•è¨Šæ¯å‘æ˜¯æŒ‰Qè„«é›¢ã€‚    Implicit vs. explict returns å‡½æ•¸çš„è¿”å›å€¼æœ‰å…©ç¨®æ–¹å¼:\n  Implicitly, æœ€å¾Œä¸€å€‹ expression è®Šæˆå‚³å›å€¼:\nf \u0026lt;- function(x) {\rif (x \u0026lt; 10) {\r0\r} else {\r10\r}\r}\rf(5)\r#\u0026gt; [1] 0\rf(15)\r#\u0026gt; [1] 10\r   Explicitly, åˆ©ç”¨ return():\nf \u0026lt;- function(x) {\rif (x \u0026lt; 10) {\rreturn(0)\r} else {\rreturn(10)\r}\r}\r   Invisible values å¤§éƒ¨åˆ†å‡½æ•¸å†å‚³å›å€¼çš„æ™‚å€™éƒ½æœƒé¡¯ç¤ºåœ¨ä¸»æ§å°ä¸Š:\nf \u0026lt;- function() 1\rf()\r#\u0026gt; [1] 1\r ä½†æ˜¯ä¹Ÿå¯ä»¥ä¸ç”¨é¡¯ç¤º:åˆ©ç”¨å‡½æ•¸ invisible()ã€‚\nj04 \u0026lt;- function() invisible(1)\rj04()\r é€™ç¨®ä¸æœƒé¡¯ç¤ºå‚³å›å€¼çš„å‡½æ•¸,å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•é©—è­‰:\nprint(j04())\r#\u0026gt; [1] 1\r(j04())\r#\u0026gt; [1] 1\r# æˆ–è€…åˆ©ç”¨å‡½æ•¸ `withVisible():\rstr(withVisible(j04()))\r#\u0026gt; List of 2\r#\u0026gt; $ value : num 1\r#\u0026gt; $ visible: logi FALSE\r âœ”ï¸åœ¨Rèªè¨€ä¸­,å‚³å›å€¼æ˜¯ä¸å¯è¦‹çš„å‡½æ•¸æ˜¯ \u0026lt;-:\na \u0026lt;- 2\r(a \u0026lt;- 2)\r#\u0026gt; [1] 2\ra \u0026lt;- b \u0026lt;- c \u0026lt;- d \u0026lt;- 2\r ä¸€èˆ¬è€Œè¨€ï¼Œåƒæ˜¯ ( \u0026lt;-, print(), or plot()) éƒ½æ˜¯å‚³å›ä¸å¯è¦‹çµæœã€‚\nErrors å‡½æ•¸å¯ä»¥åˆ©ç”¨å‡½æ•¸ stop()çµæŸä¸€å€‹å‡½æ•¸çš„åŸ·è¡Œã€‚\nj05 \u0026lt;- function() {\rstop(\u0026quot;I'm an error\u0026quot;)\rreturn(10)\r}\rj05()\r#\u0026gt; Error in j05(): I'm an error\r Exit handlers è¨­å®šå‡½æ•¸åŸ·è¡Œå®Œç•¢æ™‚è¦åŸ·è¡Œçš„çµæŸå‡½æ•¸ã€‚ä¾‹å¦‚,æœ‰äº›è¨­å®šå€¼,åœ¨æœ¬å‡½æ•¸ä¸­è¢«æš«æ™‚ä¿®æ”¹,ä½†æ˜¯åœ¨çµæŸåŸ·è¡Œçš„æ™‚å€™,æƒ³è¦å›å¾©åŸç‹€ï¼Œæˆ–è€…è¦æ¸…é™¤æœ¬å‡½æ•¸ç”¢ç”Ÿçš„ä¸€äº›åƒåœ¾æª”æ¡ˆ,éƒ½å¯ä»¥è¨­å®šé€™è„«é›¢å‡½æ•¸.é€™ç¨®è„«é›¢å‡½æ•¸,ä¸ç®¡å‡½æ•¸åŸ·è¡Œå®Œç•¢æ™‚,æ˜¯å¦éŒ¯èª¤,éƒ½æœƒåŸ·è¡Œã€‚\nf \u0026lt;- function(x) {\rcat(\u0026quot;Hello\\n\u0026quot;)\ron.exit(cat(\u0026quot;Goodbye!\\n\u0026quot;), add = TRUE)\rif (x) {\rreturn(10)\r} else {\rstop(\u0026quot;Error\u0026quot;) #ğŸ·ğŸ‘ç”¢ç”ŸéŒ¯èª¤è¨Šè™Ÿ,æœƒçµæŸå‡½æ•¸åŸ·è¡Œ\r}\r}\rf(TRUE)\r#\u0026gt; Hello\r#\u0026gt; Goodbye!\r#\u0026gt; [1] 10\rf(FALSE)\r#\u0026gt; Hello\r#\u0026gt; Error in f(FALSE): Error\r#\u0026gt; Goodbye!\r on.exit() çš„ç¬¬äºŒå€‹åƒæ•¸å¹¾ä¹éƒ½æ˜¯è¨­å®šç‚ºadd = TRUEã€‚å¦‚æœä¸è¨­å®šç‚ºT,å…ˆå‰çš„ exiting handler æœƒè¢«è“‹éå»ã€‚\r\r\ron.exit() æ¸…é™¤ä¸­é–“æª”æ¡ˆçš„ç¯„ä¾‹:\ncleanup \u0026lt;- function(dir, code) {\rold_dir \u0026lt;- setwd(dir)\ron.exit(setwd(old), add = TRUE)\rold_opt \u0026lt;- options(stringsAsFactors = FALSE)\ron.exit(options(old_opt), add = TRUE)\r}\r ç¯„ä¾‹:æŸå€‹å‡½æ•¸å¿…é ˆåˆ‡æ›å·¥ä½œç›®éŒ„,ç„¶å¾ŒåŸ·è¡ŒæŸäº›å·¥ä½œ,ä½†æ˜¯åœ¨å‡½æ•¸åŸ·è¡Œå®Œç•¢å¾Œ,è¦è¨­å®šç‚ºåŸå…ˆçš„å·¥ä½œç›®éŒ„,å‰‡\nwith_dir \u0026lt;- function(dir, code) {\rold \u0026lt;- setwd(dir) # ğŸ·ğŸ‘æœƒæŠŠç›®å‰çš„å·¥ä½œç›®éŒ„è¨˜éŒ„åœ¨old\ron.exit(setwd(old), add = TRUE) # ğŸ·ğŸ‘åˆ‡æ›å›å»\rforce(code)\r}\rgetwd()\r#\u0026gt; [1] \u0026quot;D:/work/rmi_r/content/rlang\u0026quot;\rwith_dir(\u0026quot;~\u0026quot;, getwd())\r#\u0026gt; [1] \u0026quot;C:/Users/linchao/Documents\u0026quot;\r æŒ‡å®šå¤šå€‹on.exit()å‡½æ•¸çš„æ™‚å€™,æœƒæŒ‰ç…§æŒ‡å®šçš„é †åºFIFOåŸ·è¡Œã€‚\nf \u0026lt;- function() {\ron.exit(message(\u0026quot;a\u0026quot;), add = TRUE)\ron.exit(message(\u0026quot;b\u0026quot;), add = TRUE)\r}\rf()\r#\u0026gt; a\r#\u0026gt; b\r åœ¨FILOçš„æ¼”ç®—æ³•ä¸­,å‰è¿°çš„FIFOæœƒé€ æˆå›°æ“¾,å¯ä»¥åˆ©ç”¨ after = FALSE,ä¾†æ”¾åœ¨æœ€å‰é¢:\nf \u0026lt;- function() {\ron.exit(message(\u0026quot;a\u0026quot;), add = TRUE, after = FALSE)\ron.exit(message(\u0026quot;b\u0026quot;), add = TRUE, after = FALSE)\r}\rf()\r#\u0026gt; b\r#\u0026gt; a\r \rè·³é\r  What does load() return? Why don't you normally see these values?\n  What does write.table() return? What would be more useful?\n  How does the chdir parameter of source() compare to in_dir()? Why might you prefer one approach to the other?\n  Write a function that opens a graphics device, runs the supplied code, and closes the graphics device (always, regardless of whether or not the plotting code worked).\n  We can use on.exit() to implement a simple version of capture.output().\ncapture.output2 \u0026lt;- function(code) {\rtemp \u0026lt;- tempfile()\ron.exit(file.remove(temp), add = TRUE, after = TRUE)\rsink(temp)\ron.exit(sink(), add = TRUE, after = TRUE)\rforce(code)\rreadLines(temp)\r}\rcapture.output2(cat(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;, sep = \u0026quot;\\n\u0026quot;))\r#\u0026gt; Warning in file.remove(temp): ç„¡æ³•ç§»é™¤æª”æ¡ˆ 'C:\r#\u0026gt; \\Users\\linchao\\AppData\\Local\\Temp\\RtmpADUc8P\\file24e85549534a' ï¼ŒåŸå› æ˜¯\r#\u0026gt; 'Permission denied'\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot;\r   Compare capture.output() to capture.output2(). How do the functions differ? What features have I removed to make the key ideas easier to see?\nHow have I rewritten the key ideas to be easier to understand?\n"},
{"uri": "/blogR//rlang/7_3_function.html","title": "7.3 R å‡½æ•¸å®šç¾©çš„å¹¾ç¨®åˆ†é¡",
	"tags": [],
	"description": "7_3_function",
	"content": "å‡½æ•¸çš„å‹æ…‹  æ‰€æœ‰è®Šæ•¸éƒ½æ˜¯ç‰©ä»¶ æ‰€æœ‰è®Šæ•¸ä¹‹é–“çš„è¨ˆç®—éƒ½ä¾†è‡ªå‡½æ•¸  å‡½æ•¸çš„å‹æ…‹\n prefix: å¤§éƒ¨åˆ†éƒ½æ˜¯é€™ç¨®å½¢å¼,ä¾‹å¦‚ foo(a, b, c). infix : ä¾‹å¦‚ x + y.å¦å¤–åƒæ˜¯%*% replacement: ä¾‹å¦‚ names(df) \u0026lt;- c(\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;). Special forms: ä¾‹å¦‚ [[, if, for.  å¾Œ3ç¨®å½¢å¼,éƒ½å¯ä»¥ç¿»è­¯æˆprefix form,ä¾‹å¦‚\nx + y #ğŸ·ğŸ‘infix form\r`+`(x, y)\rnames(df) \u0026lt;- c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;, \u0026quot;z\u0026quot;) #ğŸ·ğŸ‘replacement form\r`names\u0026lt;-`(df, c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;, \u0026quot;z\u0026quot;))\rfor(i in 1:10) print(i) #ğŸ·ğŸ‘special form\r`for`(i, 1:10, print(i))\r \rè£œå……\rğŸ˜œKnowing the function name of a non-prefix function allows you to override its behaviour. For example, if you're ever feeling particularly evil, run the following code while a friend is away from their computer. It will introduce a fun bug: 10% of the time, 1 will be added to any numeric calculation inside of parentheses.\n`(` \u0026lt;- function(e1) {\rif (is.numeric(e1) \u0026amp;\u0026amp; runif(1) \u0026lt; 0.1) {\re1 + 1\r} else {\re1\r}\r}\rreplicate(50, (1 + 2))\r#\u0026gt; [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3 3 3 4 3\r#\u0026gt; [39] 3 3 3 3 3 3 3 3 3 3 3 3\rrm(\u0026quot;(\u0026quot;)\r  é€™è£¡èˆ‰å€‹ä¾‹å­,èªªæ˜æ€æ¨£é‹ç”¨æˆ‘å€‘å¾—åˆ°çš„çŸ¥è­˜ä¾†è®“ç¨‹å¼ç¢¼æ›´ç°¡æ½”:\n  ä¾‹å¦‚ä¸‹é¢çš„åŸ·è¡Œçµæœæœƒå°‡å‚³é€²å»çš„x(é€™è£¡æ˜¯1:10)ä¸­çš„æ¯å€‹å…ƒç´ éƒ½åŠ 3ã€‚\nadd \u0026lt;- function(x, y) x + y\rsapply(1:10, add, 3)\r#\u0026gt; [1] 4 5 6 7 8 9 10 11 12 13\r   çŸ¥é“æ‰€æœ‰çš„é‹ç®—éƒ½ä¾†è‡ªæ–¼å‡½æ•¸ä»¥å¾Œ,æˆ‘å€‘è—‰ç”± + å‡½æ•¸,å¯ä»¥ä¸ç”¨å¯«ä¸Šé¢é‚£å€‹add()å‡½æ•¸:\nsapply(1:5, `+`, 3)\r#\u0026gt; [1] 4 5 6 7 8\r   Prefix form The prefix form å‡½æ•¸çš„é¡å‹é€šå¸¸æŒ‡çš„æ˜¯å‡½æ•¸åœ¨å‰é¢,ç„¶å¾Œå¾Œé¢æ¥åƒæ•¸,ä½¿ç”¨æ–¹å¼æœ‰ä¸‰ç¨®:\n By position, like help(mean). By name, like help(topic = mean). Using partial matching, like help(to = mean). help(topic, package = NULL, lib.loc = NULL,\rverbose = getOption(\u0026quot;verbose\u0026quot;),\rtry.all.packages = getOption(\u0026quot;help.try.all.packages\u0026quot;),\rhelp_type = getOption(\u0026quot;help_type\u0026quot;))\r   Rå°å‡½æ•¸åƒæ•¸çš„è§£è®€é †åºæ˜¯1)æ˜¯å¦å®Œå…¨ç¬¦åˆ2)æ˜¯å¦éƒ¨ä»½ç¬¦åˆ(ä¸å¯æ··æ·†)3)ä½ç½®\nk01 \u0026lt;- function(abcdef, bcde1, bcde2) {\rlist(a = abcdef, b1 = bcde1, b2 = bcde2)\r}\rstr(k01(1, 2, 3)) # ğŸ·ğŸ‘ä½ç½®\r#\u0026gt; List of 3\r#\u0026gt; $ a : num 1\r#\u0026gt; $ b1: num 2\r#\u0026gt; $ b2: num 3\rstr(k01(2, 3, abcdef = 1)) # # ğŸ·ğŸ‘å…ˆåç¨±,ç„¶å¾Œä½ç½®\r#\u0026gt; List of 3\r#\u0026gt; $ a : num 1\r#\u0026gt; $ b1: num 2\r#\u0026gt; $ b2: num 3\rstr(k01(2, 3, a = 1)) # ğŸ·ğŸ‘éƒ¨åˆ†ç¬¦åˆ\r#\u0026gt; List of 3\r#\u0026gt; $ a : num 1\r#\u0026gt; $ b1: num 2\r#\u0026gt; $ b2: num 3\rstr(k01(1, 3, b = 1)) # âŒğŸ·ğŸ‘æ··æ·†,å…©å€‹åƒæ•¸æœ‰bé–‹é ­\r#\u0026gt; Error in k01(1, 3, b = 1): å¼•æ•¸ 3 æœ‰å¤šå€‹èˆ‡ä¹‹ç›¸å°æ‡‰çš„å½¢å¼å¼•æ•¸\r Infix functions Rçš„å…§å»º infix operators: :, ::, :::, $, @, ^, *, /, +, -, \u0026gt;, \u0026gt;=, \u0026lt;, \u0026lt;=, ==, !=, !, \u0026amp;, \u0026amp;\u0026amp;, |, ||, ~, \u0026lt;-, and \u0026lt;\u0026lt;-.\nå»ºç«‹infixå‡½æ•¸,1)å…©å€‹åƒæ•¸,2)å‡½æ•¸åç¨±å…©é‚Šæœ‰%, base R ä¹Ÿé¡å¤–å®šç¾©äº† %%, %*%, %/%, %in%, %o%, and %x%.\n`%+%` \u0026lt;- function(a, b) paste0(a, b)\r\u0026quot;new \u0026quot; %+% \u0026quot;string\u0026quot;\r#\u0026gt; [1] \u0026quot;new string\u0026quot;\r è‡ªè¨‚çš„infix operators å…©é‚Šæ˜¯%,ä¸­é–“ä¸èƒ½æœ‰%,å…¶ä»–éƒ½å¯ä»¥,ä½†æ˜¯å¦‚æœæœ‰ç‰¹æ®Šå­—å…ƒå¿…é ˆä½¿ç”¨é€ƒé€¸å­—å…ƒ,å¦‚ä¸‹ç¯„ä¾‹:\n`% %` \u0026lt;- function(a, b) paste(a, b) #ğŸ·å®šç¾©æ–°å‡½æ•¸% %\r`%/\\\\%` \u0026lt;- function(a, b) paste(a, b) #ğŸ·å®šç¾©æ–°å‡½æ•¸%/\\%\r\u0026quot;a\u0026quot; % % \u0026quot;b\u0026quot;\r#\u0026gt; [1] \u0026quot;a b\u0026quot;\r\u0026quot;a\u0026quot; %/\\% \u0026quot;b\u0026quot;\r#\u0026gt; [1] \u0026quot;a b\u0026quot;\r infix å‡½æ•¸å®šç¾©çš„operators é‹ç®—é †åºç”±å·¦åˆ°å³ã€‚\n`%-%` \u0026lt;- function(a, b) paste0(\u0026quot;(\u0026quot;, a, \u0026quot; %-% \u0026quot;, b, \u0026quot;)\u0026quot;)\r\u0026quot;a\u0026quot; %-% \u0026quot;b\u0026quot; %-% \u0026quot;c\u0026quot;\r#\u0026gt; [1] \u0026quot;((a %-% b) %-% c)\u0026quot;\r å…©å€‹ä¾‹å¤–çš„INFIXå‡½æ•¸å¯ä»¥åªæœ‰ä¸€åƒæ•¸: + and -.\n-1\r#\u0026gt; [1] -1\r+10\r#\u0026gt; [1] 10\r Replacement functions Replacement functions çš„å‡½æ•¸åç¨±å¿…é ˆæ˜¯é¡ä¼¼ xxx\u0026lt;-.\n å¿…é ˆè¦æœ‰å…©å€‹åƒæ•¸ x å’Œ value, ä¸” å¿…é ˆå›å‚³æ›´æ”¹éçš„ç‰©ä»¶ã€‚  ä¾‹å¦‚æˆ‘å€‘æƒ³å¯«ä¸€å€‹å‡½æ•¸,è®“ä½¿ç”¨è€…å¯ä»¥æŒ‡æ´¾ä¸€å€‹å‘é‡çš„ç¬¬äºŒå€‹å…ƒç´  :\n`second\u0026lt;-` \u0026lt;- function(x, value) {\rx[2] \u0026lt;- value #åªæ›´å‹•ç¬¬äºŒå€‹å…ƒç´ \rx\r}\r# ä½¿ç”¨æ–¹æ³•\rx \u0026lt;- 1:10 #åŸä¾†çš„å€¼\rsecond(x) \u0026lt;- 5L #åˆ©ç”¨æ–°çš„æŒ‡æ´¾é‹ç®—\rx # æ–°å€¼ç‚º5L\r#\u0026gt; [1] 1 5 3 4 5 6 7 8 9 10\r \rå±•é–‹\råˆ©ç”¨ tracemem()è¿½è¹¤:\nx \u0026lt;- 1:10\rtracemem(x)\r#\u0026gt; \u0026lt;0x7ffae71bd880\u0026gt; #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘1\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rsecond(x) \u0026lt;- 6L\r#\u0026gt; tracemem[0x7ffae71bd880 \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘1\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; -\u0026gt; 0x7ffae61b5480]: \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘2\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; #\u0026gt; tracemem[0x7ffae61b5480 \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘2\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; -\u0026gt; 0x7ffae73f0408]\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘2\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; : second\u0026lt;-   ä¸Šé¢çš„å‡½æ•¸,åªèƒ½æŒ‡æ´¾ç¬¬2å€‹å…ƒç´ ,å¦‚æœè¦è®“ä½¿ç”¨è€…èƒ½æŒ‡å®šå…¶ä»–å…ƒç´ ,å°±è¦å¦å¤–æ–°å¢ä¸€å€‹åƒæ•¸,é€™æ™‚å€™é€™å€‹åƒæ•¸,è¦æ”¾åœ¨è®Šæ•¸ x,å’Œå€¼valueçš„ä¸­é–“ :\n`modify\u0026lt;-` \u0026lt;- function(x, position, value) {\rx[position] \u0026lt;- value\rx\r}\rmodify(x, 1) \u0026lt;- 10\rx\r#\u0026gt; [1] 10 5 3 4 5 6 7 8 9 10\r \rå±•é–‹\rmodify(x, 1) \u0026lt;- 10\r å…¶å¯¦åœ¨Rçš„å¹•å¾Œè§£è­¯ä¸­è¢«è½‰ç‚º\nx \u0026lt;- `modify\u0026lt;-`(x, 1, 10)\r  \ræ›´è¤‡é›œçš„ç¿»è­¯\rx \u0026lt;- c(a = 1, b = 2, c = 3)\rnames(x)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;b\u0026quot; \u0026quot;c\u0026quot;\rnames(x)[2] \u0026lt;- \u0026quot;two\u0026quot;\rnames(x)\r#\u0026gt; [1] \u0026quot;a\u0026quot; \u0026quot;two\u0026quot; \u0026quot;c\u0026quot;\r æœƒè¢«è§£è­¯ç‚º\n`*tmp*` \u0026lt;- x #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘Rå°±æ˜¯ç”¨é€™å€‹è®Šæ•¸\u0026lt;code\u0026gt;*tmp*\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rx \u0026lt;- `names\u0026lt;-`(`*tmp*`, `[\u0026lt;-`(names(`*tmp*`), 2, \u0026quot;two\u0026quot;))\rrm(`*tmp*`)\r  Special forms åƒè€ƒ\nInvoking a function å¦ä¸€å€‹do.call()çš„åƒè€ƒ\nSuppose you had a list of function arguments:\nargs \u0026lt;- list(1:10, na.rm = TRUE)\r How could you then send that list to mean()? In base R, you need do.call():\ndo.call(mean, args)\r#\u0026gt; [1] 5.5\r# Equivalent to\rmean(1:10, na.rm = TRUE)\r#\u0026gt; [1] 5.5\r ç°¡å–®æ¸¬è©¦   Rewrite the following code snippets into prefix form:\n1 + 2 + 3\r1 + (2 + 3)\rif (length(x) \u0026lt;= 5) x[[5]] else x[[n]]\r   Clarify the following list of odd function calls:\nx \u0026lt;- sample(replace = TRUE, 20, x = c(1:10, NA))\ry \u0026lt;- runif(min = 0, max = 1, 20)\rcor(m = \u0026quot;k\u0026quot;, y = y, u = \u0026quot;p\u0026quot;, x = x)\r   ç›¸é—œä¿‚æ•¸ cor(x, y = NULL, use = \u0026quot;everything\u0026quot;, method = c(\u0026quot;pearson\u0026quot;, \u0026quot;kendall\u0026quot;, \u0026quot;spearman\u0026quot;)) if method is \u0026quot;kendall\u0026quot; or \u0026quot;spearman\u0026quot;, Kendall's tau or Spearman's rho statistic is used to estimate a rank-based measure of association\r\r\r  Explain why the following code fails:\nmodify(get(\u0026quot;x\u0026quot;), 1) \u0026lt;- 10\r#\u0026gt; Error: target of assignment expands to non-language object\r   Create a replacement function that modifies a random location in a vector.\n  é‡æ–°è¨­è¨ˆä½ è‡ªå·±æœ‰é—œ + é‹ç®—çš„ç‰ˆæœ¬,ä¾‹å¦‚å¯ä»¥æ•´åˆå­—ä¸²:\n1 + 2\r#\u0026gt; [1] 3\r\u0026quot;a\u0026quot; + \u0026quot;b\u0026quot;\r#\u0026gt; [1] \u0026quot;ab\u0026quot;\r   Create a list of all the replacement functions found in the base package. Which ones are primitive functions? (Hint use apropros())\n  What are valid names for user-created infix functions?\n  Create an infix xor() operator.\n  Create infix versions of the set functions intersect(), union(), and setdiff(). You might call them %n%, %u%, and %/% to match conventions from mathematics.\n  Answer the following questions to see if you can safely skip this chapter. You can find the answers in\n  What are the three components of a function?\n  What does the following code return?\nx \u0026lt;- 10\rf1 \u0026lt;- function(x) {\rfunction() {\rx + 10\r}\r}\rf1(1)()\r   How would you usually write this code?\n`+`(1, `*`(2, 3))\r   How could you make this call easier to read?\nmean(, TRUE, x = c(1:10, NA))\r   Does the following code throw an error when executed? Why/why not?\nf2 \u0026lt;- function(a, b) {\ra * 10\r}\rf2(10, stop(\u0026quot;This is an error!\u0026quot;))\r   What is an infix function? How do you write it? What's a replacement function? How do you write it?\n  How do you ensure that cleanup action occurs regardless of how a function exits?\n  æç¤º\r   The three components of a function are its body, arguments, and environment.\n  f1(1)() returns 11.\n  You'd normally write it in infix style: 1 + (2 * 3).\n  Rewriting the call to mean(c(1:10, NA), na.rm = TRUE) is easier to understand.\n  No, it does not throw an error because the second argument is never used so it's never evaluated.\n  See infix and replacement functions.\n  You use on.exit(); see on exit for details.\n  \n"},
{"uri": "/blogR//rlang/7_8_objectbasic.html","title": "7.8 Rçš„ç‰©ä»¶ç›¸é—œæ¦‚å¿µ",
	"tags": [],
	"description": "7_8_objectBasic",
	"content": "\rattribute ç°¡å–®ç†è§£ç‚ºç‰©ä»¶å±¬æ€§,ä¾‹å¦‚çŸ©é™£(matrix)é™£åˆ—(array)çš„nameså’Œdimenstionsã€‚\nDefinitions:\n å‡½æ•¸ attributes è¨­å®šæˆ–åˆ—å‡ºç‰©ä»¶çš„æ‰€æœ‰attributesã€‚ å‡½æ•¸ attr ç‰©ä»¶ä¸­æŸå€‹æŒ‡å®šçš„attribute. å‡½æ•¸ structure è¨­å®šè³‡æ–™ç‰©ä»¶ä¸­å…¶ä»–é¡å¤–çš„ attributesã€‚  ä½¿ç”¨æ–¹æ³•\nattributes(my.array) ğŸ·ğŸ‘åˆ—å‡ºæ‰€æœ‰å±¬æ€§\r#\u0026gt; $dim\r#\u0026gt; [1] 3 4 2\r è¨­å®šå’Œå­˜å–å…¶ä¸­ä¸€å€‹å±¬æ€§:\nattr(baskets.team,'season') \u0026lt;- '2010-2011'\rattr(baskets.team,'season')\r#\u0026gt; [1] \u0026quot;2010-2011\u0026quot;\r å¦‚æœè¦åˆªé™¤,å‰‡\nattr(baskets.team,'season') \u0026lt;- NULL\r å…¶ä»– attr() \u0026amp; attributes()ã€€ç¯„ä¾‹\nattributes(data) #ğŸ·æ‰€æœ‰çš„attributes\rattr(x = data, which = \u0026quot;attribute_name\u0026quot;) # ğŸ·åªæ˜¯å…¶ä¸­ä¹‹ä¸€,ç¬¬äºŒå€‹åƒæ•¸æŒ‡å®š\r# æ¯”è¼ƒ structure(data, dim = c(2, 6))\r ç¯„ä¾‹ è¼‰å…¥è³‡æ–™é›†ç„¶å¾Œåˆ©ç”¨å‡½æ•¸çœ‹çœ‹data.frameæœ‰ç”šéº¼attributeã€‚\ndata(cars) attributes(cars) #\u0026gt; $names\r#\u0026gt; [1] \u0026quot;speed\u0026quot; \u0026quot;dist\u0026quot; #\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\r#\u0026gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50\rattr(x = cars, which = \u0026quot;names\u0026quot;) #ğŸ·ğŸ‘æˆ–æ˜¯å¯«æˆã€€attr(cars,\u0026quot;names\u0026quot;)\r#\u0026gt; [1] \u0026quot;speed\u0026quot; \u0026quot;dist\u0026quot;\r æ¯”è¼ƒä¸€ä¸‹names,å¯ä»¥ç™¼ç¾,names åªæ˜¯ä¸€å€‹data.frameä¸­çš„attribute\nclass(cars)\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\rstr(cars)\r#\u0026gt; 'data.frame':\t50 obs. of 2 variables:\r#\u0026gt; $ speed: num 4 4 7 7 8 9 10 10 10 11 ...\r#\u0026gt; $ dist : num 2 10 4 22 16 10 18 26 34 17 ...\rnames(cars)\r#\u0026gt; [1] \u0026quot;speed\u0026quot; \u0026quot;dist\u0026quot;\r \r\rç¯„ä¾‹ attributes_list \u0026lt;- list(names = c(\u0026quot;col1\u0026quot;, \u0026quot;col2\u0026quot;), #è¨­å®šä¸åŒçš„æ¬„ä½åç¨±\rclass = \u0026quot;data.frame\u0026quot;, # ä¿ç•™é¡åˆ¥\rrow.names = nrow(cars):1) # åå‘\rattributes(cars) \u0026lt;- attributes_list # ğŸ·ğŸ‘è¨­å®šå±¬æ€§\rattributes(cars) #\u0026gt; $names\r#\u0026gt; [1] \u0026quot;col1\u0026quot; \u0026quot;col2\u0026quot;\r#\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26\r#\u0026gt; [26] 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1\r åˆ©ç”¨attr() æ”¹è®Šå…¶ä¸­ä¸€å€‹Attribute attr(x = cars, which = \u0026quot;names\u0026quot;) \u0026lt;- c(\u0026quot;aaa\u0026quot;, \u0026quot;bbb\u0026quot;) # Set only names attribute\rx\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x'\r æª¢æŸ¥çœ‹çœ‹çµæœ\nattributes(cars) # Apply attributes function\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;aaa\u0026quot; \u0026quot;bbb\u0026quot;\r#\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26\r#\u0026gt; [26] 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1\r ã€€The R structure Function å’Œattributes() attr() ç›¸é—œçš„å‘½ä»¤æ˜¯ structure() ã€‚\nset.seed(12345) vec \u0026lt;- round(runif(15, 0, 10)) # 1D å‘é‡ vec\r#\u0026gt; [1] 7 9 8 9 5 2 3 5 7 10 0 2 7 0 4\r æ”¹è®ŠæˆçŸ©é™£:\nvec_dim \u0026lt;- structure(vec, dim = c(3, 5)) # Change dimension of vector\rvec_dim # Print updated vector\r#\u0026gt; [,1] [,2] [,3] [,4] [,5]\r#\u0026gt; [1,] 7 9 3 10 7\r#\u0026gt; [2,] 9 5 5 0 0\r#\u0026gt; [3,] 8 2 7 2 4\r æ¯”è¼ƒä¹‹å‰çš„å¯«æ³•:\nmatrix(vec,nrow=3)\r Example: é€™è£¡å»ºç«‹ä¸€å€‹listï¼Œç„¶å¾ŒæŠŠå…¶é¤˜çš„åƒæ•¸ç•¶ä½œå±¬æ€§ï¼Œç¶ä¸Šé€™å€‹list\ndd \u0026lt;- structure(\rlist(year = c(2001, 2002, 2004, 2006) ,\rlength_days = c(366.3240, 365.4124, 366.5323423, 364.9573234)) ,.Names = c(\u0026quot;year\u0026quot;, \u0026quot;length of days\u0026quot;) ,row.names = c(NA, -4L) ,class = \u0026quot;data.frame\u0026quot;)\rstr(dd)\r#\u0026gt; 'data.frame':\t4 obs. of 2 variables:\r#\u0026gt; $ year : num 2001 2002 2004 2006\r#\u0026gt; $ length of days: num 366 365 367 365\rattributes(dd)\r#\u0026gt; $names\r#\u0026gt; [1] \u0026quot;year\u0026quot; \u0026quot;length of days\u0026quot;\r#\u0026gt; #\u0026gt; $row.names\r#\u0026gt; [1] 1 2 3 4\r#\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\rdd\r year length of days   2001 366.3240  2002 365.4124  2004 366.5323  2006 364.9573     åˆ©ç”¨structure()å»ºç«‹çš„ç‰©ä»¶,ä¸ç®¡æ˜¯åŒè³ª(vector,matrix)é‚„æ˜¯ç•°è³ª(data.frame,list) éƒ½æœƒåˆ©ç”¨attributeså„²å­˜meta dataã€‚ä¾‹å¦‚,\njust_vector \u0026lt;- structure(1:10, comment = \u0026quot;This is my simple vector with info\u0026quot;)\rjust_vector\r#\u0026gt; [1] 1 2 3 4 5 6 7 8 9 10\rstr(just_vector)\r#\u0026gt; int [1:10] 1 2 3 4 5 6 7 8 9 10\r#\u0026gt; - attr(*, \u0026quot;comment\u0026quot;)= chr \u0026quot;This is my simple vector with info\u0026quot;\rattributes(just_vector)ã€€# ğŸ·ğŸ‘æ³¨æ„:attributes()çš„å‚³å›çµæœç‚ºlist,å› æ­¤æœ‰$comment\r#\u0026gt; $comment\r#\u0026gt; [1] \u0026quot;This is my simple vector with info\u0026quot;\r å‡½æ•¸structure() vs str() é€™æ˜¯å¦ä¸€å€‹åˆ©ç”¨å‡½æ•¸structure()çš„ä¾‹å­ã€‚å…ˆçœ‹ä¸€ä¸‹ä¸€èˆ¬å»ºç«‹data.frameç‰©ä»¶çš„æ–¹æ³•:\nyear = c(1999, 2002, 2005, 2008)\rpollution = c(346.82,134.308821199349, 130.430379885892, 88.275457392443)\rdd2 \u0026lt;- data.frame(year,pollution)\rdd2$year \u0026lt;- as.factor(dd2$year)\r åˆ©ç”¨ structure, ä¸€æ­¥å°±å¯ä»¥å®Œæˆ:\ndd \u0026lt;- structure(list( year = as.factor(c(2001, 2002, 2004, 2006))\r,length_days = c(366.3240, 365.4124, 366.5323423, 364.9573234)) ,.Names = c(\u0026quot;year\u0026quot;, \u0026quot;length of days\u0026quot;) ,row.names = c(NA, -4L) ,class = \u0026quot;data.frame\u0026quot;)\r ä¸ä¾é è½‰æ›å‡½æ•¸as.data.frame()è‡ªè¡Œå»ºç«‹ data.frameç‰©ä»¶ã€‚\ndd3 \u0026lt;- structure(list(\rv1 = as.factor(c(2001, 2002, 2004, 2006))\r,v2 = I(c(2001, 2002, 2004, 2006))\r,v3 = ordered(c(2001, 2002, 2004, 2006))\r,v4 = as.double(c(366.3240, 365.4124, 366.5323423, 364.9573234)))\r,.Names = c(\u0026quot;year\u0026quot;, \u0026quot;AsIs Year\u0026quot;,\u0026quot;yearO\u0026quot;, \u0026quot;length of days\u0026quot;)\r,.typeOf = c(\u0026quot;factor\u0026quot;, \u0026quot;numeric\u0026quot;, \u0026quot;ordered\u0026quot;,\u0026quot;numeric\u0026quot;)\r,row.names = c(NA, -4L)\r,class = \u0026quot;data.frame\u0026quot;\r,comment = \u0026quot;Ordered YearO for categorical analysis and other variables\u0026quot;)\rattributes(dd3)$comment # ğŸ·ğŸ‘çœ‹ä¸€ä¸‹çµæœ\r#\u0026gt; [1] \u0026quot;Ordered YearO for categorical analysis and other variables\u0026quot;\rattr(dd3, which=\u0026quot;comment\u0026quot;)\r#\u0026gt; [1] \u0026quot;Ordered YearO for categorical analysis and other variables\u0026quot;\r"},
{"uri": "/blogR//rlang/7_9_%E7%89%A9%E4%BB%B6%E5%B0%8E%E5%90%91s3.html","title": "7.9 ç‰©ä»¶å°å‘S3",
	"tags": [],
	"description": "7_9_ç‰©ä»¶å°å‘S3",
	"content": "OOP advance R S3 generic method\nBase objects vs OO objects è¾¨åˆ¥è®Šæ•¸æ˜¯åŸºç¤å‹åˆ¥æˆ–æ˜¯ç‰©ä»¶å‹åˆ¥ï¼Œå¯ä»¥ç°¡å–®åˆ©ç”¨å‡½æ•¸ï¼š is.object():\nåŸºç¤ç‰©ä»¶base object:\nis.object(1:10)\r#\u0026gt; [1] FALSE\r [1] FALSE\nç‰©ä»¶å°å‘ç‰©ä»¶ OO object\nis.object(mtcars)\r#\u0026gt; [1] TRUE\r [1] TRUE\nä¸»è¦çš„å€åˆ¥åœ¨æ–¼åŸºæœ¬ç‰©ä»¶æ²’æœ‰class é€™å€‹attribute\nattr(1:10, \u0026quot;class\u0026quot;) # NULL\r#\u0026gt; NULL\rattr(mtcars, \u0026quot;class\u0026quot;) # [1] \u0026quot;data.frame\u0026quot;\r#\u0026gt; [1] \u0026quot;data.frame\u0026quot;\r class()é€™å€‹å‡½æ•¸,ä¸è¦‹å¾—ç¸½æ˜¯æœƒå’Œattr()çš„çµæœä¸€è‡´,å› ç‚ºï¼Œå°åŸºæœ¬ç‰©ä»¶è€Œè¨€,å‚³å›çš„æ˜¯å¾Œé¢è¨è«–,è€Œä¸æ˜¯ NULLã€‚\nè®Šæ•¸å±¬æ€§æŸ¥è©¢å‡½æ•¸  names() dimnames() length() dim(): å„ç¶­åº¦é•·åº¦ class() : è®Šæ•¸é¡åˆ¥ table()ï¼šå„é¡è³‡æ–™è¨ˆæ•¸ str()ï¼šè®Šæ•¸çš„è³‡æ–™çµæ§‹(å…¶å¯¦æ˜¯ä¸€å€‹list)  é€énames()å‡½æ•¸ï¼Œå¯å–å¾—å„ç¨®listå…ƒç´ çš„åç¨±,ä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡æ˜¯é¡¯ç¤ºæ¬„ä½åç¨± islandsæ˜¯å…§å»ºè³‡æ–™\nstr(islands)\r#\u0026gt; Named num [1:48] 11506 5500 16988 2968 16 ...\r#\u0026gt; - attr(*, \u0026quot;names\u0026quot;)= chr [1:48] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; ...\r head(names(islands)) #\u0026gt; [1] \u0026quot;Africa\u0026quot; \u0026quot;Antarctica\u0026quot; \u0026quot;Asia\u0026quot; \u0026quot;Australia\u0026quot; \u0026quot;Axel Heiberg\u0026quot;\r#\u0026gt; [6] \u0026quot;Baffin\u0026quot;\r æ–¹å½¢è³‡æ–™ï¼ˆä¾‹å¦‚ï¼ŒçŸ©é™£ï¼Œtable, data.frame)ï¼Œå¯ä»¥é€édimnames()å‡½æ•¸å¯é¡¯ç¤ºdata.frame æ©«è¡Œå’Œç›´è¡Œçš„åç¨± å…ˆæ©«è¡Œï¼Œç„¶å¾Œç›´è¡Œã€‚\ndimnames(USArrests) #\u0026gt; [[1]]\r#\u0026gt; [1] \u0026quot;Alabama\u0026quot; \u0026quot;Alaska\u0026quot; \u0026quot;Arizona\u0026quot; \u0026quot;Arkansas\u0026quot; #\u0026gt; [5] \u0026quot;California\u0026quot; \u0026quot;Colorado\u0026quot; \u0026quot;Connecticut\u0026quot; \u0026quot;Delaware\u0026quot; #\u0026gt; [9] \u0026quot;Florida\u0026quot; \u0026quot;Georgia\u0026quot; \u0026quot;Hawaii\u0026quot; \u0026quot;Idaho\u0026quot; #\u0026gt; [13] \u0026quot;Illinois\u0026quot; \u0026quot;Indiana\u0026quot; \u0026quot;Iowa\u0026quot; \u0026quot;Kansas\u0026quot; #\u0026gt; [17] \u0026quot;Kentucky\u0026quot; \u0026quot;Louisiana\u0026quot; \u0026quot;Maine\u0026quot; \u0026quot;Maryland\u0026quot; #\u0026gt; [21] \u0026quot;Massachusetts\u0026quot; \u0026quot;Michigan\u0026quot; \u0026quot;Minnesota\u0026quot; \u0026quot;Mississippi\u0026quot; #\u0026gt; [25] \u0026quot;Missouri\u0026quot; \u0026quot;Montana\u0026quot; \u0026quot;Nebraska\u0026quot; \u0026quot;Nevada\u0026quot; #\u0026gt; [29] \u0026quot;New Hampshire\u0026quot; \u0026quot;New Jersey\u0026quot; \u0026quot;New Mexico\u0026quot; \u0026quot;New York\u0026quot; #\u0026gt; [33] \u0026quot;North Carolina\u0026quot; \u0026quot;North Dakota\u0026quot; \u0026quot;Ohio\u0026quot; \u0026quot;Oklahoma\u0026quot; #\u0026gt; [37] \u0026quot;Oregon\u0026quot; \u0026quot;Pennsylvania\u0026quot; \u0026quot;Rhode Island\u0026quot; \u0026quot;South Carolina\u0026quot;\r#\u0026gt; [41] \u0026quot;South Dakota\u0026quot; \u0026quot;Tennessee\u0026quot; \u0026quot;Texas\u0026quot; \u0026quot;Utah\u0026quot; #\u0026gt; [45] \u0026quot;Vermont\u0026quot; \u0026quot;Virginia\u0026quot; \u0026quot;Washington\u0026quot; \u0026quot;West Virginia\u0026quot; #\u0026gt; [49] \u0026quot;Wisconsin\u0026quot; \u0026quot;Wyoming\u0026quot; #\u0026gt; #\u0026gt; [[2]]\r#\u0026gt; [1] \u0026quot;Murder\u0026quot; \u0026quot;Assault\u0026quot; \u0026quot;UrbanPop\u0026quot; \u0026quot;Rape\u0026quot;\r æ–¹å½¢è³‡æ–™ï¼Œå¯ä»¥é€élength()å‡½æ•¸å¯é¡¯ç¤ºè³‡æ–™é•·åº¦ï¼Œä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡é¡¯ç¤ºæ¬„ä½æ•¸ã€‚\nlength(islands) #\u0026gt; [1] 48\r é€édim() é¡¯ç¤ºæ–¹å½¢è³‡æ–™çš„ã€Œè³‡æ–™ç­†æ•¸ã€å’Œã€Œæ¬„ä½æ•¸ç›®ã€ï¼Œå…ˆã€Œæ©«è¡Œã€ï¼Œå¾Œã€Œç›´è¡Œã€\ndim(USArrests) #\u0026gt; [1] 50 4\r ä½¿ç”¨class()å‡½æ•¸å¯çŸ¥é“è®Šæ•¸é¡åˆ¥\nclass(pi)\r#\u0026gt; [1] \u0026quot;numeric\u0026quot;\rclass(Sys.Date())\r#\u0026gt; [1] \u0026quot;Date\u0026quot;\r ä½¿ç”¨table()å‡½æ•¸å¯çŸ¥é“å‘é‡ä¸­æ¯å€‹å€¼å‡ºç¾å¹¾æ¬¡\ntable(iris$Species) ##çµ±è¨ˆçµæœ\r#\u0026gt; #\u0026gt; setosa versicolor virginica #\u0026gt; 50 50 50\r S3 Prerequisites We'll use the sloop package to fill in some missing pieces when it comes to S3.\n# install_github(\u0026quot;hadley/sloop\u0026quot;)\rlibrary(sloop)\r Basics åŸºæœ¬ä¸Šæ˜¯çµæ§‹çš„ä¸€ç¨®å”å®šã€‚æˆ‘çš„æ„æ€é€™å€‹ç‰©ä»¶æ˜¯åŸºæ–¼çµæ§‹è€Œè¦å®šï¼Œæ˜¯èªæ„ä¸Šçš„å…§è¦è€Œä¸æ˜¯èªæ³•ä¸Šçš„è¦å®šã€‚ ä¾‹å¦‚ï¼Œæ‰€è¬‚çš„é¡åˆ¥ï¼Œåªä¸éæ˜¯çµæ§‹ä¸Šçš„ä¸€å€‹å…¶ä¸­ä¸€å€‹æ¬„ä½ï¼Œè€Œé€™å€‹æ¬„ä½åç¨±ç‚ºclass\nf \u0026lt;- factor(\u0026quot;a\u0026quot;)\rtypeof(f)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rattributes(f)\r#\u0026gt; $levels\r#\u0026gt; [1] \u0026quot;a\u0026quot;\r#\u0026gt; #\u0026gt; $class\r#\u0026gt; [1] \u0026quot;factor\u0026quot;\r é…åˆé€šç”¨å‡½æ•¸generic functionçš„è§€å¿µ(ä¾‹å¦‚å¸¸è¦‹çš„print())ï¼Œè€Œé”åˆ°ï¼¯ï¼¯ï¼°çš„ç›®çš„ã€‚\nprint(f)\r#\u0026gt; [1] a\r#\u0026gt; Levels: a\rclass(unclass(f))\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rprint(unclass(f))ã€€#ğŸ·ğŸ‘unclassæœƒå»æ‰å±¬æ€§class\r#\u0026gt; [1] 1\r#\u0026gt; attr(,\u0026quot;levels\u0026quot;)\r#\u0026gt; [1] \u0026quot;a\u0026quot;\r time \u0026lt;- strptime(\u0026quot;2017-01-01\u0026quot;, \u0026quot;%Y-%m-%d\u0026quot;)\rstr(time)\r#\u0026gt; POSIXlt[1:1], format: \u0026quot;2017-01-01\u0026quot;\rstr(unclass(time), list.len = 5)\r#\u0026gt; List of 11\r#\u0026gt; $ sec : num 0\r#\u0026gt; $ min : int 0\r#\u0026gt; $ hour : int 0\r#\u0026gt; $ mday : int 1\r#\u0026gt; $ mon : int 0\r#\u0026gt; [list output truncated]\r A generic and its methods are functions that operate on classes. The role of a generic is to find the right method for the arguments that it is provided, the process of method dispatch. A method is a function that implements the generic behaviour for a specific class. In other words the job of the generic is to find the right method; the job of the method is to do the work.\nYou can find some S3 methods (those in the base package and those that you've created) by typing their names. However, this will not work with most packages because S3 methods are not exported: they live only inside the package, and are not available from the global environment. Instead, you can use getS3method(), which will work regardless of where the method lives:\nS3 methods æ˜¯æˆ‘å€‘å®šç¾©äº†ä¸€å€‹é€šç”¨åç¨±ï¼Œç„¶å¾Œç¶“ç”±é€™å€‹é€šç”¨åç¨±ï¼Œæ‰¾åˆ°ç‰¹å®šå‡½æ•¸é€šç”¨.é¡åˆ¥()ï¼Œä¾‹å¦‚ ç•¶æˆ‘è¦è¨ˆç®—æ—¥æœŸçš„å¹³å‡ï¼Œæˆ‘æŠŠä¸€å€‹æ—¥æœŸè®Šæ•¸å‚³åˆ°å‡½æ•¸mean()ï¼Œé€šç”¨å‡½æ•¸mean()åˆå‘¼å«äº† mean.Date()ï¼ˆå› ç‚ºæ—¥æœŸè®Šæ•¸çš„é¡åˆ¥æ˜¯Dateï¼‰, åˆä¾‹å¦‚factorè®Šæ•¸ï¼Œè¦åˆ—å°çš„æ™‚å€™æˆ‘å€‘æœƒæ‰“print(factor var) æ­¤æ™‚print()åˆæœƒå‘¼å« print.factor().\nmean.Date #ğŸ·ğŸ‘\r#\u0026gt; function (x, ...) #\u0026gt; .Date(mean(unclass(x), ...))\r#\u0026gt; \u0026lt;bytecode: 0x0000000017c30d30=\u0026quot;\u0026quot;\u0026gt;\r#\u0026gt; \u0026lt;environment: namespace:base=\u0026quot;\u0026quot;\u0026gt;\r# Always works\rgetS3method(\u0026quot;mean\u0026quot;, \u0026quot;Date\u0026quot;)\r#\u0026gt; function (x, ...) #\u0026gt; .Date(mean(unclass(x), ...))\r#\u0026gt; \u0026lt;bytecode: 0x0000000017c30d30=\u0026quot;\u0026quot;\u0026gt;\r#\u0026gt; \u0026lt;environment: namespace:base=\u0026quot;\u0026quot;\u0026gt;\r\u0026lt;/environment:\u0026gt;\u0026lt;/bytecode:\u0026gt;\u0026lt;/environment:\u0026gt;\u0026lt;/bytecode:\u0026gt;\r note: é™¤äº†è‡ªå·±å®šç¾©çš„å‡½æ•¸å’Œåœ¨baseå¥—ä»¶çš„å‡½æ•¸ä»¥å¤–ï¼Œå¤§éƒ¨åˆ†éƒ½æ‹¿ä¸åˆ°ï¼Œè€Œè¦é€é getS3method(\u0026quot;generic\u0026quot;, \u0026quot;class\u0026quot;) ä¾†çœ‹åˆ°ç¨‹å¼ç¢¼\nClasses è‡ªè¡Œå»ºç«‹è‡ªå·±çš„é¡åˆ¥ï¼Œåˆ©ç”¨structure()\n# Create and assign class in one step\rfoo \u0026lt;- structure(list(), class = \u0026quot;foo\u0026quot;)\r# Create, then set class\rfoo \u0026lt;- list()\rclass(foo) \u0026lt;- \u0026quot;foo\u0026quot;\r é¡åˆ¥å¯èƒ½å…©ç¨®ä»¥ä¸Šï¼Œæ­¤æ™‚å¯ä»¥ç”¨å‡½æ•¸inherits()\nclass(foo)\r#\u0026gt; [1] \u0026quot;foo\u0026quot;\rinherits(foo, \u0026quot;foo\u0026quot;)\r#\u0026gt; [1] TRUE\r ä¸€æ¬¡å®šç¾©å¤šå€‹é¡åˆ¥çš„ä¾‹å­ï¼š\nstructure(x, class = c(\u0026quot;POSIXct\u0026quot;, \u0026quot;POSIXt\u0026quot;),\rtzone = tzone\r)\r S3 has no checks for correctness. This means you can change the class of existing objects:\n# Create a linear model\rmod \u0026lt;- lm(log(mpg) ~ log(disp), data = mtcars)\rclass(mod)\r#\u0026gt; [1] \u0026quot;lm\u0026quot;\rprint(mod)\r#\u0026gt; #\u0026gt; Call:\r#\u0026gt; lm(formula = log(mpg) ~ log(disp), data = mtcars)\r#\u0026gt; #\u0026gt; Coefficients:\r#\u0026gt; (Intercept) log(disp) #\u0026gt; 5.3810 -0.4586\r# Turn it into a data frame (?!)\rclass(mod) \u0026lt;- \u0026quot;data.frame\u0026quot;\r# Unsurprisingly this doesn't work very well\rprint(mod)\r#\u0026gt; [1] coefficients residuals effects rank fitted.values\r#\u0026gt; [6] assign qr df.residual xlevels call #\u0026gt; [11] terms model #\u0026gt; \u0026lt;0 åˆ—\u0026gt; (æˆ–é›¶é•·åº¦çš„ row.names)\r Constructors å› ç‚ºæ˜¯èªæ„ä¸Šçš„ï¼¯ï¼¯ï¼°ï¼Œå› æ­¤ï¼Œå»ºæ§‹å­ä¹Ÿæ˜¯è‡ªå·±è¦å®šè¦æ€æ¨£ï¼Œä¾‹å¦‚æ¨¡ä»¿ï¼¯ï¼¯ï¼°çš„é€šå‰‡ç”¨newé€™å€‹é—œéµå­—\nnew_Date \u0026lt;- function(x) {\rstopifnot(is.double(x))\rstructure(x, class = \u0026quot;Date\u0026quot;)\r}\rnew_Date(c(-1, 0, 1))\r#\u0026gt; [1] \u0026quot;1969-12-31\u0026quot; \u0026quot;1970-01-01\u0026quot; \u0026quot;1970-01-02\u0026quot;\r çœ‹çœ‹æŒ‡ä»¤lm()ç”¢ç”Ÿçš„ç‰©ä»¶\nmod \u0026lt;- lm(mpg ~ wt, data = mtcars)\rtypeof(mod)\r#\u0026gt; [1] \u0026quot;list\u0026quot;\rnames(mod)\r#\u0026gt; [1] \u0026quot;coefficients\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;effects\u0026quot; \u0026quot;rank\u0026quot; #\u0026gt; [5] \u0026quot;fitted.values\u0026quot; \u0026quot;assign\u0026quot; \u0026quot;qr\u0026quot; \u0026quot;df.residual\u0026quot; #\u0026gt; [9] \u0026quot;xlevels\u0026quot; \u0026quot;call\u0026quot; \u0026quot;terms\u0026quot; \u0026quot;model\u0026quot;\r é€™è£¡èˆ‰ä¸€å€‹å­—éµé¡å‹ï¼ˆæœ¬ä¾‹ä¸­ï¼Œdf_classï¼‰çš„ä¾‹å­\nnew_df_class \u0026lt;- function(df, attr1, attr2) {\rstopifnot(is.data.frame(df))\rstructure(\rdf, attr1 = attr1,\rattr2 = attr2,\rclass = c(\u0026quot;df_class\u0026quot;, \u0026quot;data.frame\u0026quot;) )\r}\r ä¸Šé¢ä¾‹å­ä¸­ï¼Œclassçš„é †åºæ˜¯æœ‰æ„ç¾©çš„ï¼Œæ„æ€æ˜¯df_classç¹¼æ‰¿è‡ªdata.frame\nGenerics and methods é€éé€šç”¨å‡½æ•¸è¦é”æˆï¼¯ï¼¯ï¼°çš„å¤šå‹å‡½æ•¸(dispatch)ã€‚ S3é€™å€‹å¤šå‹å‡½æ•¸ï¼Œåˆ©ç”¨ UseMethod(), ä¾†å‘¼å«é¡åˆ¥å°æ‡‰çš„å‡½æ•¸ã€‚ UseMethod() å…©å€‹åƒæ•¸ï¼Œä¸€å€‹æ˜¯å‡½æ•¸åç¨±ï¼Œç„¶å¾Œæ˜¯è¦å‚³é€²å»çš„åƒæ•¸ï¼ˆå¯çœç•¥ï¼‰ã€‚\n# Dispatches on x\rgeneric \u0026lt;- function(x, y, ...) {\rUseMethod(\u0026quot;generic\u0026quot;)\r}\r# Dispatches on y\rgeneric2 \u0026lt;- function(x, y, ...) {\rUseMethod(\u0026quot;generic2\u0026quot;, y)\r}\r Note that you don't pass any of the arguments of the generic to UseMethod(); it uses black magic to pass them on automatically. Generally, you should avoid doing any computation in a generic, because the semantics are complicated and few people know the details. In general, any modifications to the arguments of the generic will be undone, leading to much confusion.\nA generic isn't useful without some methods, which are just functions that follow a naming scheme (generic.class). Because a method is just a function with a special name, you can call methods directly, but you generally shouldn't. The main reason to call the method directly is that it sometimes leads to considerable performance improvements. See performance for an example.\ngeneric.foo \u0026lt;- function(x, y, ...) {\rmessage(\u0026quot;foo method\u0026quot;)\r}\rgeneric(new_s3_scalar(class = \u0026quot;foo\u0026quot;))\r#\u0026gt; Error in new_s3_scalar(class = \u0026quot;foo\u0026quot;): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;new_s3_scalar\u0026quot;\r You can see all the methods defined for a generic with s3_methods_generic():\ns3_methods_generic(\u0026quot;generic\u0026quot;)\r#\u0026gt; Error in .S3methods(generic.function, class, envir): no function 'generic' is visible\r Coercion Many S3 objects can be naturally created from an existing object through coercion. If this is the case for your class, you should provide a coercion function, an S3 generic called as_class_name. Base R generally does not follow this convention, which can cause problems as illustrated by as.factor(): åœ¨ï¼²ä¸­as.factorä¸¦ä¸æ˜¯å‡½æ•¸asï¼ˆéé€šç”¨å‡½æ•¸ï¼‰çš„æ´¾ç™¼å‡½æ•¸ã€‚ å¦‚æœç¾åœ¨æˆ‘å€‘è¦è‡ªå·±å»ºä¸€å€‹è½‰æ›æˆfactoré¡åˆ¥çš„é€šç”¨å‡½æ•¸\nas_factor \u0026lt;- function(x, ...) {\rUseMethod(\u0026quot;as_factor\u0026quot;)\r}\r å…ˆå®šç¾©ä¸€å€‹å°å·²ç¶“æ˜¯factorçš„å‡½æ•¸ï¼Œå°±æ˜¯èªªå¦‚æœå·²ç¶“æ˜¯factoré‚£å°±ä¸åšä»»ä½•äº‹ï¼Œå› ç‚ºä¸ç”¨è½‰æ›\nas_factor.factor \u0026lt;- function(x, ...) x\r ç¾åœ¨é‡å°å­—ä¸²å’Œæ•´æ•¸å®šç¾©ç›¸å°æ‡‰çš„æ´¾ç™¼å‡½æ•¸ï¼š\nas_factor.character \u0026lt;- function(x, ...) {\rfactor(x, levels = unique(x))\r}\ras_factor.integer \u0026lt;- function(x, ...) {\rfactor(x, levels = as.character(unique(x)))\r}\r å°æ–¼ä¸è™•ç†çš„é¡åˆ¥ï¼Œå¯ä»¥åˆ©ç”¨default\nas_factor(1)\r#\u0026gt; Error in UseMethod(\u0026quot;as_factor\u0026quot;): æ²’æœ‰é©ç”¨çš„æ–¹æ³•å¯å°‡ 'as_factor' å¥—ç”¨åˆ° \u0026quot;c('double', 'numeric')\u0026quot; é¡åˆ¥çš„ç‰©ä»¶\ras_factor.default \u0026lt;- function(x, ...) {\rstop(\r\u0026quot;Don't know how to coerce object of class \u0026quot;, paste(class(x), collapse = \u0026quot;/\u0026quot;), \u0026quot; into a factor\u0026quot;, call. = FALSE\r)\r}\ras_factor(1)\r#\u0026gt; Error: Don't know how to coerce object of class numeric into a factor\r Arguments é€šå¸¸é€šç”¨å‡½æ•¸å’Œæ´¾ç™¼å‡½æ¨¹æœ‰ç›¸åŒçš„åƒæ•¸å€‹æ•¸ï¼ˆå¦‚æœæ˜¯å¥—ä»¶é–‹ç™¼ï¼Œå‰‡ R CMD check æœƒå¼·è¿«é€™å€‹è¦å®šï¼‰ï¼Œä½†æ˜¯åŠ äº† ..., å°±å¯ä»¥ä¸å—é€™å€‹é™åˆ¶ã€‚\nMethod dispatch UseMethod() and NextMethod(). UseMethod() The purpose of UseMethod() åˆ©ç”¨æŒ‡ä»¤ paste0(\u0026quot;é€šç”¨\u0026quot;, \u0026quot;.\u0026quot;, c(class(x), \u0026quot;default\u0026quot;)),ç„¶å¾Œåœ¨å…¶ä¸­æ‰¾å‡ºå°æ‡‰çš„æ´¾ç™¼å‡½æ•¸ã€‚é€™è£¡åˆ©ç”¨ sloop::s3_dispatch(). ä¾†åˆ—å‡ºæ´¾ç™¼å‡½æ•¸\nx \u0026lt;- Sys.time()\rs3_dispatch(print(x))\r#\u0026gt; =\u0026gt; print.POSIXct\r#\u0026gt; print.POSIXt\r#\u0026gt; * print.default\r å¦‚ä¸Šï¼Œç•¶æˆ‘å€‘è¦printå‡º POSIXct ç‰©ä»¶æ™‚æœƒæ€æ¨£?\nprint() will look for three possible methods, of which two exist, and one, print.POSIXct(), will be called. The last method is always the \u0026quot;default\u0026quot; method. This doesn't correspond to a specific class, so is a useful catch all.\nNextMethod() NextMethod()ç”¨ä¾†èª¿ç”¨è¦ªä»£é¡åˆ¥ä¸­çš„å°æ‡‰æ´¾ç™¼å‡½æ•¸ã€‚é”æˆï¼¯ï¼¯ï¼°ä¸­å°±æ˜¯é¡ä¼¼ç¹¼æ‰¿è¦ªä»£å‡½æ•¸çš„æ–¹æ³•ã€‚\nshowoff \u0026lt;- function(x) {\rUseMethod(\u0026quot;showoff\u0026quot;)\r}\rshowoff.default \u0026lt;- function(x) {\rmessage(\u0026quot;showoff.default\u0026quot;)\rTRUE\r}\rshowoff.a \u0026lt;- function(x) {\rmessage(\u0026quot;showoff.a\u0026quot;)\rNextMethod()ã€€#ğŸ·ğŸ‘èª¿ç”¨\r}\rshowoff.b \u0026lt;- function(x) {\rmessage(\u0026quot;showoff.b\u0026quot;)\rNextMethod()\r}\r å»ºç«‹ä¸€å€‹ç¹¼æ‰¿è‡ªbé¡åˆ¥çš„,è€Œä¸”æ˜¯açš„ç‰©ä»¶ã€‚\nx \u0026lt;- structure(1,class = c(\u0026quot;b\u0026quot;, \u0026quot;a\u0026quot;)) # ğŸ·ğŸ‘b ç¹¼æ‰¿è‡ª a\rs3_dispatch(showoff(x))ã€€#ğŸ·ğŸ‘ s3_dispatch() shows that all three potential methods are available\r#\u0026gt; =\u0026gt; showoff.b\r#\u0026gt; -\u0026gt; showoff.a\r#\u0026gt; -\u0026gt; showoff.default\r çœ‹çœ‹æœƒæ€æ¨£\nshowoff(x)\r#\u0026gt; showoff.b\r#\u0026gt; showoff.a\r#\u0026gt; showoff.default\r#\u0026gt; [1] TRUE\r Generally, you call NextMethod() without any arguments. However, if you do give arguments, they are passed on to the next method, as if they'd been supplied to the generic.\nInheritance The class attribute is not limited to a single string, but can be a character vector. This, along with S3 method dispatch and NextMethod(), gives a surprising amount of flexibility that can be used creatively to reduce code duplication. However, this flexibility can also lead to code that is hard to understand or reason about, so you are best constraining yourself to simple styles of inheritance. Here we will focus on defining subclasses that inherit their fields, and some behaviour, from a parent class.\nSubclasses use a character vector for the class attribute. There are two examples of subclasses that you might have come across in base R:\n  Generalised linear models are a generalisation of linear models that allow the error term to belong to a richer set of distributions, not just the normal distribution like the linear model. This is a natural case for the use of inheritance and indeed, in R, glm() returns objects of class c(\u0026quot;glm\u0026quot;, \u0026quot;lm\u0026quot;).\n  Ordered factors are used when the levels of a factor have some intrinsic ordering, like c(\u0026quot;Good\u0026quot;, \u0026quot;Better\u0026quot;, \u0026quot;Best\u0026quot;). Ordered factors are produced by ordered() which returns an object with class c(\u0026quot;ordered\u0026quot;, \u0026quot;factor\u0026quot;).\n  You can think of the glm class \u0026quot;inheriting\u0026quot; behaviour from the lm class, and the ordered class inheriting behaviour from the factor class because of the way method dispatch works. If there is a method available for the subclass, R will use it, otherwise it will fall back to the \u0026quot;parent\u0026quot; class. For example, if you \u0026quot;plot\u0026quot; a glm object, it falls back to the lm method, but if you compute the ANOVA, it uses a glm-specific method.\nmod1 \u0026lt;- glm(mpg ~ wt, data = mtcars)\rs3_dispatch(plot(mod1))\r#\u0026gt; plot.glm\r#\u0026gt; =\u0026gt; plot.lm\r#\u0026gt; * plot.default\rs3_dispatch(anova(mod1))\r#\u0026gt; =\u0026gt; anova.glm\r#\u0026gt; * anova.lm\r#\u0026gt; anova.default\r Constructors There are three principles to adhere to when creating a subclass:\n  A subclass should be built on the same base type as a parent.\n  The class() of the subclass should be of the form c(subclass, parent_class)\n  The fields of the subclass should include the fields of the parent.\n  And these properties should be enforced by the constructor.\nWhen you create a class, you need to decide if you want to allow subclasses, because it requires changes to the constructor and careful thought in your methods. To allow subclasses, the parent constructor needs to have ... and subclass arguments:\nnew_my_class \u0026lt;- function(x, y, ..., subclass = NULL) {\rstopifnot(is.numeric(x))\rstopifnot(is.logical(y))\rstructure(\rx,\ry = y,\r...,\rclass = c(subclass, \u0026quot;my_class\u0026quot;)\r)\r}\r Then the implementation of the subclass constructor is simple: it checks the types of the new fields, then calls the parent constructor.\nnew_subclass \u0026lt;- function(x, y, z) {\rstopifnot(is.character(z))\rnew_my_class(x, y, z, subclass = \u0026quot;subclass\u0026quot;)\r}\r If you wanted to allow this subclass to be futher subclassed, you'd need to include ... and subclass arguments:\nnew_subclass \u0026lt;- function(x, y, z, ..., subclass = NULL) {\rstopifnot(is.character(z))\rnew_my_class(x, y, z, ..., subclass = c(subclass, \u0026quot;subclass\u0026quot;))\r}\r If your subclass is more complicated, you'd also provide validator and helper functions, as described previously.\nCoercion You also need to make sure that there's some way to convert the subclass back to the parent class. The best way to do that is to add a method to the coercion generic. Generally, this method should call the parent constructor:\nas_my_class.sub_class \u0026lt;- function(x) {\rnew_my_class(attr(x, \u0026quot;x\u0026quot;), attr(x, \u0026quot;y\u0026quot;))\r}\r Methods The goal of creating a subclass is to reuse as much code as possible from the parent class. This means that you should not have to define every method that the parent class provides (if you do, reconsider if you actually need a subclass!). Generally, defining new methods is straightforward: you simply create a new method (generic.subclass) whenever the parent method doesn't do quite the right thing. In many cases, the new method will be able to call NextMethod() in order to take advantage of the computation done in the parent.\nOne wrinkle arises when you have methods that return the same type of object as the primary input. For example, dplyr has many functions (arrange(), summarise(), mutate(), ...) that input a data frame (or data frame-like object) and output a modified version of that data frame. Imagine you want to store the provenance of each data frame, i.e. who created it and when. To do so, you might create a data frame subclass called provenance:\nnew_provenance \u0026lt;- function(data, author, date = Sys.Date()) {\rstopifnot(is.data.frame(data))\rstopifnot(is.character(author), length(author) == 1)\rstopifnot(is.Date(date), length(date) == 1)\rstructure(\rdata,\rauthor = author, date = date,\rclass = c(\u0026quot;provenance\u0026quot;, \u0026quot;data.frame\u0026quot;)\r)\r}\r And now you want to make this class work with dplyr. The class doesn't change any of the computation related to the data frame, it just needs to preserve the attributes, which dplyr doesn't know anything about. That means you need to provide a method for each dplyr generic. The computation is unchanged, so you can use NextMethod() to do all the hard work, but you need to manually reconstruct the provenance object.\narrange.provenance \u0026lt;- function(.data, ...) {\rnew_provenance(\rNextMethod(), author = attr(.data, \u0026quot;author\u0026quot;),\rdate = attr(.data, \u0026quot;date\u0026quot;)\r)\r}\rmutate.provenance \u0026lt;- function(.data, ...) {\rnew_provenance(\rNextMethod(), author = attr(.data, \u0026quot;author\u0026quot;),\rdate = attr(.data, \u0026quot;date\u0026quot;)\r)\r}\r To do this for all the dplyr generics would require a lot of copying and pasting. Let's reduce some of that duplication by taking advantage of sloop::reconstruct(). reconstruct() is a generic function designed to reconstruct a subclass from an instance of the parent class, typically created by NextMethod(), and the original subclass. In other words, the job of a reconstructor is to take an object from a parent class, and copy over attributes from the subclass. (Note that reconstruct() is unusual in that it dispatches on the second argument. This allows a more natural specification.)\nreconstruct.provenance \u0026lt;- function(new, old) {\rnew_provenance(\rnew, author = attr(old, \u0026quot;author\u0026quot;),\rdate = attr(old, \u0026quot;date\u0026quot;)\r)\r}\r Now we can rewrite the methods to minimise the amount of duplicated code:\narrange.provenance \u0026lt;- function(.data, ...) {\rreconstruct(NextMethod(), .data)\r}\rmutate.provenance \u0026lt;- function(.data, ...) {\rreconstruct(NextMethod(), .data)\r}\r This duplicated code could be avoided completely if arrange.data.frame(), provided by dplyr, called reconstruct() for you. And indeed, a future version of that function will.\nWhen designing a class that can be subclassed, you need to carefully think through these issues. Generally, whenever you implement a method that returns the same type of object as the primary input, you should call reconstruct() to ensure that it also works for subclasses. That way implementors of a subclass will only need to provide methods when the computation is actually different.\nDispatch details This chapter concludes with a few additional details about method dispatch that is not well documented elsewhere. It is safe to skip these details if you're new to S3.\nEnvironments and namespaces The precise rules for where a generic looks for the methods are a little complicated because there are two paths for discovery:\n  In the calling environment of the function that called the generic.\n  In the special .__S3MethodsTable__. object in the function environment of the generic. Every package has an .__S3MethodsTable__ which lists all the S3 methods exported by the package.\n  These details are not usually important, but are necessary in order for S3 generics to find the correct method when the generic and method are in different packages.\nS3 and base types What happens when you call an S3 generic with a non-S3 object, i.e. an object that doesn't have the class attribute set? You might think it would dispatch on what class() returns:\nclass(matrix(1:5))\r#\u0026gt; [1] \u0026quot;matrix\u0026quot; \u0026quot;array\u0026quot;\r But unfortunately dispatch actually occurs on the implicit class, which has three components:\n \u0026quot;array\u0026quot; or \u0026quot;matrix\u0026quot; (if the object has dimensions). typeof() (with a few minor tweaks). If it's \u0026quot;integer\u0026quot; or \u0026quot;double\u0026quot;, \u0026quot;numeric\u0026quot;.  There is no base function that will compute the implicit class, but you can use a helper from the sloop package: \\index{implicit class} \\index{base types!implicit class}\ns3_class(matrix(1:5))\r#\u0026gt; [1] \u0026quot;matrix\u0026quot; \u0026quot;integer\u0026quot; \u0026quot;numeric\u0026quot;\r s3_dispatch() knows about the implicit class, so use it if you're ever in doubt about method dispatch:\ns3_dispatch(print(matrix(1:5)))\r#\u0026gt; print.matrix\r#\u0026gt; print.integer\r#\u0026gt; print.numeric\r#\u0026gt; =\u0026gt; print.default\r Note that this can lead to different dispatch for objects that look similar:\nx1 \u0026lt;- 1:5\rclass(x1)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rs3_dispatch(mean(x1))\r#\u0026gt; mean.integer\r#\u0026gt; mean.numeric\r#\u0026gt; =\u0026gt; mean.default\rx2 \u0026lt;- structure(x1, class = \u0026quot;integer\u0026quot;)\rclass(x2)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rs3_dispatch(mean(x2))\r#\u0026gt; mean.integer\r#\u0026gt; =\u0026gt; mean.default\r Internal generics Some S3 generics, like [, sum(), and cbind(), don't call UseMethod() because they are implemented in C. Instead, they call the C functions DispatchGroup() or DispatchOrEval(). These functions are called internal generics, because they do dispatch internally, in C code. Internal generics only exist in base R, so you can not create an internal generic in a package.\ns3_dispatch() shows internal generics by including the name of the generic at the bottom of the method class. If this method is called, all the work happens in C code, typically using [switchpatch].\ns3_dispatch(Sys.time()[1])\r#\u0026gt; =\u0026gt; [.POSIXct\r#\u0026gt; [.POSIXt\r#\u0026gt; [.default\r#\u0026gt; -\u0026gt; [ (internal)\r For performance reasons, internal generics do not dispatch to methods unless the class attribute has been set (is.object() is true). This means that internal generics do not use the implicit class. Again, if you're confused, rely on s3_dispatch() to show you the difference.\nx \u0026lt;- sample(10)\rclass(x)\r#\u0026gt; [1] \u0026quot;integer\u0026quot;\rs3_dispatch(x[1])\r#\u0026gt; [.integer\r#\u0026gt; [.numeric\r#\u0026gt; [.default\r#\u0026gt; =\u0026gt; [ (internal)\rclass(y) #\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'y'\rs3_dispatch(mtcars[1])\r#\u0026gt; =\u0026gt; [.data.frame\r#\u0026gt; [.default\r#\u0026gt; -\u0026gt; [ (internal)\r Group generics Group generics are the most complicated part of S3 method dispatch because they involve both NextMethod() and internal generics. Group generics are worth learning about, however, because they allow you to implement a whole swath of methods with one function. Like internal generics, they only exist in base R, and you can not define your own group generic.\nBase R has four group generics, which are made up of the following generics: \\index{group generics} \\index{S3!group generics}\n  Math: abs, sign, sqrt, floor, cos, sin, log, exp, ...\n  Ops: +, -, *, /, ^, %%, %/%, \u0026amp;, |, !, ==, !=, \u0026lt;, \u0026lt;=, \u0026gt;=, \u0026gt;\n  Summary: all, any, sum, prod, min, max, range\n  Complex: Arg, Conj, Im, Mod, Re\n  Defining a single group generic for your class overrides the default behaviour for all of the members of the group. Methods for group generics are looked for only if the methods for the specific generic do not exist:\ns3_dispatch(sum(Sys.time()))\r#\u0026gt; sum.POSIXct\r#\u0026gt; sum.POSIXt\r#\u0026gt; sum.default\r#\u0026gt; =\u0026gt; Summary.POSIXct\r#\u0026gt; Summary.POSIXt\r#\u0026gt; Summary.default\r#\u0026gt; -\u0026gt; sum (internal)\r Most group generics involve a call to NextMethod(). For example, take difftime() objects. If you look at the method dispatch for abs(), you'll see there's a Math group generic defined.\ny \u0026lt;- as.difftime(10, units = \u0026quot;mins\u0026quot;)\rs3_dispatch(abs(y))\r#\u0026gt; abs.difftime\r#\u0026gt; abs.default\r#\u0026gt; =\u0026gt; Math.difftime\r#\u0026gt; Math.default\r#\u0026gt; -\u0026gt; abs (internal)\r Math.difftime basically looks like this:\nMath.difftime \u0026lt;- function(x, ...) {\rnew_difftime(NextMethod(), units = attr(x, \u0026quot;units\u0026quot;))\r}\r It dispatches to the next method, here the internal default, to perform the actual computation, then copies back over the the class and attributes.\nNote that inside a group generic function a special variable .Generic provides the actual generic function called. This can be useful when producing error messages, and can sometimes be useful if you need to manually re-call the generic with different arguments.\nDouble dispatch Generics in the \u0026quot;Ops\u0026quot; group, which includes the two-argument mathematical and logical operators like - and \u0026amp;, implement a special type of method dispatch. They dispatch on the type of both of the arguments, so called double dispatch. This is necessary to preserve the commutative property of many operators, i.e. a + b should equal b + a. Take the following simple example:\ndate \u0026lt;- as.Date(\u0026quot;2017-01-01\u0026quot;)\rinteger \u0026lt;- 1L\rdate + integer\r#\u0026gt; [1] \u0026quot;2017-01-02\u0026quot;\rinteger + date\r#\u0026gt; [1] \u0026quot;2017-01-02\u0026quot;\r If + dispatched only on the first argument, it would return different values for the two cases. To overcome this problem, generics in the Ops group use a slightly different strategy from usual. Rather than doing a single method dispatch, they do two, one for each input. There are three possible outcomes of this lookup:\n  The methods are the same, so it doesn't matter which method is used.\n  The methods are different, and R calls the first method with a warning.\n  One method is internal, in which case R calls the other method.\n  For the example above, we can look at the possible methods for each argument, taking advantage of the fact that we can call + with a single argument. In this case, the second argument would dispatch to the internal + function, so R will call +.Date.\ns3_dispatch(+date)\r#\u0026gt; =\u0026gt; +.Date\r#\u0026gt; +.default\r#\u0026gt; * Ops.Date\r#\u0026gt; Ops.default\r#\u0026gt; * + (internal)\rs3_dispatch(+integer)\r#\u0026gt; +.integer\r#\u0026gt; +.numeric\r#\u0026gt; +.default\r#\u0026gt; Ops.integer\r#\u0026gt; Ops.numeric\r#\u0026gt; Ops.default\r#\u0026gt; =\u0026gt; + (internal)\r Let's take a look at another case. What happens if you try to add a date to a factor? There is no method in common, so R calls the internal + method (which preserves the attributes of the LHS), with a warning.\nfactor \u0026lt;- factor(\u0026quot;a\u0026quot;)\rs3_dispatch(+factor)\r#\u0026gt; +.factor\r#\u0026gt; +.default\r#\u0026gt; =\u0026gt; Ops.factor\r#\u0026gt; Ops.default\r#\u0026gt; -\u0026gt; + (internal)\rdate + factor\r#\u0026gt; Warning: ä¸ç›¸å®¹çš„æ–¹æ³• (\u0026quot;+.Date\u0026quot;, \u0026quot;Ops.factor\u0026quot;) ç”¨æ–¼ \u0026quot;+\u0026quot;\r#\u0026gt; [1] \u0026quot;2017-01-02\u0026quot;\rfactor + date\r#\u0026gt; Warning: ä¸ç›¸å®¹çš„æ–¹æ³• (\u0026quot;Ops.factor\u0026quot;, \u0026quot;+.Date\u0026quot;) ç”¨æ–¼ \u0026quot;+\u0026quot;\r#\u0026gt; Error in as.character.factor(x): ç•°å¸¸çš„å› å­\r Finally, what happens if we try to substract a POSIXct from a POSIXlt? A common -.POSIXt method is found and called.\ndt1 \u0026lt;- as.POSIXct(date)\rdt2 \u0026lt;- as.POSIXlt(date)\rs3_dispatch(-dt1)\r#\u0026gt; -.POSIXct\r#\u0026gt; =\u0026gt; -.POSIXt\r#\u0026gt; -.default\r#\u0026gt; Ops.POSIXct\r#\u0026gt; * Ops.POSIXt\r#\u0026gt; Ops.default\r#\u0026gt; * - (internal)\rs3_dispatch(-dt2)\r#\u0026gt; -.POSIXlt\r#\u0026gt; =\u0026gt; -.POSIXt\r#\u0026gt; -.default\r#\u0026gt; Ops.POSIXlt\r#\u0026gt; * Ops.POSIXt\r#\u0026gt; Ops.default\r#\u0026gt; * - (internal)\rdt1 - dt2\r#\u0026gt; Time difference of 0 secs\r"},
{"uri": "/blogR//rlang/9_1_plot.html","title": "9.1 åŸºæœ¬ç¹ªåœ–",
	"tags": [],
	"description": "åŸºæœ¬ç¹ªåœ–",
	"content": "æé»å’Œåƒè€ƒ  Quick R   åŸºæœ¬  plot() lines() curves()   çµ±è¨ˆ  boxplot() pair() hist()    ğŸ’¡ æ€æ¨£å¿«é€ŸæŸ¥è©¢ï¼Ÿ\n ??draw ?plot : åƒè€ƒå…¶ä¸­çš„plot.default æŸ¥çœ‹åœ–å½¢é¸é …  å‡½æ•¸plot() å¯èƒ½æœ€å¸¸ç”¨çš„ç¹ªåœ–å‡½æ•¸å°±æ˜¯plot(),è€Œé€™å€‹å‡½æ•¸æ¯”è¼ƒå¸¸ç”¨çš„é¸é …æœ‰ï¼š\n type: åƒ…åˆ†ä½ˆé»ï¼ˆé è¨­ï¼‰æ˜¯å¦é€£ç·šç­‰åŸºæœ¬æ¨¡æ¿ã€‚ pch: mark cex: æ”¾å¤§å€æ•¸ lty: ç·šæ¢æ¨£å¼line style lwd: ç·šæ¢å¯¬åº¦line width col:  type type description   p points(*)  l lines  o é»+ç·š é‡åˆ  b, c b(bothçš„æ„æ€) é»+ç·š,ä½†æ˜¯ä¸é‡åˆ(ä¸Šé¢çš„oæ˜¯é‡åˆ) (å¦‚æœæ˜¯\u0026quot;c\u0026quot; å‰‡æ²’æœ‰é»)  s, S stair steps  h histogram-like vertical lines  n does not produce any points or lines     figure\r pch è³‡æ–™é» ç¬¦è™Ÿ è¨­å®šæ¨£æœ¬é»çš„ç¬¦è™Ÿ,å¯ä»¥ç”¨ pch (point character).\npch çš„å€¼é™¤äº†å¾ 0 åˆ° 24 å…±25å€‹ç¬¦è™Ÿå¤–ï¼Œé‚„æœ‰ \u0026quot;*\u0026quot;, \u0026quot;+\u0026quot;, \u0026quot;o\u0026quot;, \u0026quot;@\u0026quot;, \u0026quot;#\u0026quot; å¯ä»¥ç”¨ã€‚\npch=0 square\rpch=1(*) circle\rpch=2 triangle point up\rpch=3 plus\rpch=4 cross\rpch=5 diamond\rpch=6 triangle point down\rpch=7 square cross\rpch=8 star\rpch=9 diamond plus\rpch=10 circle plus\rpch=11 triangles up and down\rpch=12 square plus\rpch=13 circle cross\rpch=14 square and triangle down\rpch=15 filled square blue\rpch=16 filled circle blue\rpch=17 filled triangle point up blue\rpch=18 filled diamond blue\rpch=19 solid circle blue\rpch=20 bullet (smaller circle)\rpch=21 filled circle red\rpch=22 filled square red\rpch=23 filled diamond red\rpch=24 filled triangle point up red\rpch=25 filled triangle point down red\r cex è³‡æ–™é»å¤§å° cex ç”¨ä¾†æ”¾å¤§æ–‡å­—æˆ–ç¬¦è™Ÿçš„å€æ•¸\nå› æ­¤,\ncex = 1(*) is default size cex = 1.5 is 150% of default size cex = 0.5 is 50% of default size\r[Note : cex.axis --\u0026gt; scales the axis cex.lab ---\u0026gt; scales the label cex.main --\u0026gt; scales main title cex.sub ---\u0026gt; scales the subtitle ]\r lty ç·šæ¢å‹æ…‹ lty = 0 or lty = \u0026quot;blank\u0026quot;\rlty = 1(*) or lty = \u0026quot;solid\u0026quot;\rlty = 2 or lty = \u0026quot;dashed\u0026quot;\rlty = 3 or lty = \u0026quot;dotted\u0026quot;\rlty = 4 or lty = \u0026quot;dotdash\u0026quot;\rlty = 5 or lty = \u0026quot;longdash\u0026quot;\rlty = 6 or lty = \u0026quot;twodash\u0026quot;\r é¡è‰² col col = \u0026quot;blue\ncol = \u0026quot;red\u0026quot;\ncol å¾Œçš„å€¼,å¯ç”¨å‡½æ•¸colors() ä¾†æŸ¥è©¢é¡è‰²,æœƒå‚³å› 657 å€‹ä»£è¡¨é¡è‰²çš„åƒæ•¸ã€‚æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ç”¨16é€²ä½æ•¸å­—ï¼Œä¾‹å¦‚\ncol = \u0026quot;#A9F3BB\u0026quot; ------\u0026gt; åˆ†åˆ¥å°æ‡‰ Red=A9, Green=F3, Blue=BB 16é€²ä½æ•¸å­—.\ncolors() #çœ‹çœ‹æœ‰ç”šéº¼é¡è‰²\u0026lt;!--html_preserve--\u0026gt;\u0026lt;div class=\u0026quot;expand ms-0 \u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;expand-label\u0026quot; onclick=\u0026quot;vexpand(this)\u0026quot;\u0026gt;\r\u0026lt;i style=\u0026quot;font-size:x-small;color:yellow\u0026quot; class=\u0026quot;fa fa-chevron-right\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\r\u0026lt;span \u0026gt;å±•é–‹\u0026lt;/span\u0026gt;\r\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;expand-content incode\u0026quot; style=\u0026quot;overflow-x:auto\u0026quot;\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;#\u0026gt; [1] \u0026quot;white\u0026quot; \u0026quot;aliceblue\u0026quot; \u0026quot;antiquewhite\u0026quot; #\u0026gt; [4] \u0026quot;antiquewhite1\u0026quot; \u0026quot;antiquewhite2\u0026quot; \u0026quot;antiquewhite3\u0026quot; #\u0026gt; [7] \u0026quot;antiquewhite4\u0026quot; \u0026quot;aquamarine\u0026quot; \u0026quot;aquamarine1\u0026quot; #\u0026gt; [10] \u0026quot;aquamarine2\u0026quot; \u0026quot;aquamarine3\u0026quot; \u0026quot;aquamarine4\u0026quot; #\u0026gt; [13] \u0026quot;azure\u0026quot; \u0026quot;azure1\u0026quot; \u0026quot;azure2\u0026quot; #\u0026gt; [16] \u0026quot;azure3\u0026quot; \u0026quot;azure4\u0026quot; \u0026quot;beige\u0026quot; #\u0026gt; [19] \u0026quot;bisque\u0026quot; \u0026quot;bisque1\u0026quot; \u0026quot;bisque2\u0026quot; #\u0026gt; [22] \u0026quot;bisque3\u0026quot; \u0026quot;bisque4\u0026quot; \u0026quot;black\u0026quot; #\u0026gt; [25] \u0026quot;blanchedalmond\u0026quot; \u0026quot;blue\u0026quot; \u0026quot;blue1\u0026quot; #\u0026gt; [28] \u0026quot;blue2\u0026quot; \u0026quot;blue3\u0026quot; \u0026quot;blue4\u0026quot; #\u0026gt; [31] \u0026quot;blueviolet\u0026quot; \u0026quot;brown\u0026quot; \u0026quot;brown1\u0026quot; #\u0026gt; [34] \u0026quot;brown2\u0026quot; \u0026quot;brown3\u0026quot; \u0026quot;brown4\u0026quot; #\u0026gt; [37] \u0026quot;burlywood\u0026quot; \u0026quot;burlywood1\u0026quot; \u0026quot;burlywood2\u0026quot; #\u0026gt; [40] \u0026quot;burlywood3\u0026quot; \u0026quot;burlywood4\u0026quot; \u0026quot;cadetblue\u0026quot; #\u0026gt; [43] \u0026quot;cadetblue1\u0026quot; \u0026quot;cadetblue2\u0026quot; \u0026quot;cadetblue3\u0026quot; #\u0026gt; [46] \u0026quot;cadetblue4\u0026quot; \u0026quot;chartreuse\u0026quot; \u0026quot;chartreuse1\u0026quot; #\u0026gt; [49] \u0026quot;chartreuse2\u0026quot; \u0026quot;chartreuse3\u0026quot; \u0026quot;chartreuse4\u0026quot; #\u0026gt; [52] \u0026quot;chocolate\u0026quot; \u0026quot;chocolate1\u0026quot; \u0026quot;chocolate2\u0026quot; #\u0026gt; [55] \u0026quot;chocolate3\u0026quot; \u0026quot;chocolate4\u0026quot; \u0026quot;coral\u0026quot; #\u0026gt; [58] \u0026quot;coral1\u0026quot; \u0026quot;coral2\u0026quot; \u0026quot;coral3\u0026quot; #\u0026gt; [61] \u0026quot;coral4\u0026quot; \u0026quot;cornflowerblue\u0026quot; \u0026quot;cornsilk\u0026quot; #\u0026gt; [64] \u0026quot;cornsilk1\u0026quot; \u0026quot;cornsilk2\u0026quot; \u0026quot;cornsilk3\u0026quot; #\u0026gt; [67] \u0026quot;cornsilk4\u0026quot; \u0026quot;cyan\u0026quot; \u0026quot;cyan1\u0026quot; #\u0026gt; [70] \u0026quot;cyan2\u0026quot; \u0026quot;cyan3\u0026quot; \u0026quot;cyan4\u0026quot; #\u0026gt; [73] \u0026quot;darkblue\u0026quot; \u0026quot;darkcyan\u0026quot; \u0026quot;darkgoldenrod\u0026quot; #\u0026gt; [76] \u0026quot;darkgoldenrod1\u0026quot; \u0026quot;darkgoldenrod2\u0026quot; \u0026quot;darkgoldenrod3\u0026quot; #\u0026gt; [79] \u0026quot;darkgoldenrod4\u0026quot; \u0026quot;darkgray\u0026quot; \u0026quot;darkgreen\u0026quot; #\u0026gt; [82] \u0026quot;darkgrey\u0026quot; \u0026quot;darkkhaki\u0026quot; \u0026quot;darkmagenta\u0026quot; #\u0026gt; [85] \u0026quot;darkolivegreen\u0026quot; \u0026quot;darkolivegreen1\u0026quot; \u0026quot;darkolivegreen2\u0026quot; #\u0026gt; [88] \u0026quot;darkolivegreen3\u0026quot; \u0026quot;darkolivegreen4\u0026quot; \u0026quot;darkorange\u0026quot; #\u0026gt; [91] \u0026quot;darkorange1\u0026quot; \u0026quot;darkorange2\u0026quot; \u0026quot;darkorange3\u0026quot; #\u0026gt; [94] \u0026quot;darkorange4\u0026quot; \u0026quot;darkorchid\u0026quot; \u0026quot;darkorchid1\u0026quot; #\u0026gt; [97] \u0026quot;darkorchid2\u0026quot; \u0026quot;darkorchid3\u0026quot; \u0026quot;darkorchid4\u0026quot; #\u0026gt; [100] \u0026quot;darkred\u0026quot; \u0026quot;darksalmon\u0026quot; \u0026quot;darkseagreen\u0026quot; #\u0026gt; [103] \u0026quot;darkseagreen1\u0026quot; \u0026quot;darkseagreen2\u0026quot; \u0026quot;darkseagreen3\u0026quot; #\u0026gt; [106] \u0026quot;darkseagreen4\u0026quot; \u0026quot;darkslateblue\u0026quot; \u0026quot;darkslategray\u0026quot; #\u0026gt; [109] \u0026quot;darkslategray1\u0026quot; \u0026quot;darkslategray2\u0026quot; \u0026quot;darkslategray3\u0026quot; #\u0026gt; [112] \u0026quot;darkslategray4\u0026quot; \u0026quot;darkslategrey\u0026quot; \u0026quot;darkturquoise\u0026quot; #\u0026gt; [115] \u0026quot;darkviolet\u0026quot; \u0026quot;deeppink\u0026quot; \u0026quot;deeppink1\u0026quot; #\u0026gt; [118] \u0026quot;deeppink2\u0026quot; \u0026quot;deeppink3\u0026quot; \u0026quot;deeppink4\u0026quot; #\u0026gt; [121] \u0026quot;deepskyblue\u0026quot; \u0026quot;deepskyblue1\u0026quot; \u0026quot;deepskyblue2\u0026quot; #\u0026gt; [124] \u0026quot;deepskyblue3\u0026quot; \u0026quot;deepskyblue4\u0026quot; \u0026quot;dimgray\u0026quot; #\u0026gt; [127] \u0026quot;dimgrey\u0026quot; \u0026quot;dodgerblue\u0026quot; \u0026quot;dodgerblue1\u0026quot; #\u0026gt; [130] \u0026quot;dodgerblue2\u0026quot; \u0026quot;dodgerblue3\u0026quot; \u0026quot;dodgerblue4\u0026quot; #\u0026gt; [133] \u0026quot;firebrick\u0026quot; \u0026quot;firebrick1\u0026quot; \u0026quot;firebrick2\u0026quot; #\u0026gt; [136] \u0026quot;firebrick3\u0026quot; \u0026quot;firebrick4\u0026quot; \u0026quot;floralwhite\u0026quot; #\u0026gt; [139] \u0026quot;forestgreen\u0026quot; \u0026quot;gainsboro\u0026quot; \u0026quot;ghostwhite\u0026quot; #\u0026gt; [142] \u0026quot;gold\u0026quot; \u0026quot;gold1\u0026quot; \u0026quot;gold2\u0026quot; #\u0026gt; [145] \u0026quot;gold3\u0026quot; \u0026quot;gold4\u0026quot; \u0026quot;goldenrod\u0026quot; #\u0026gt; [148] \u0026quot;goldenrod1\u0026quot; \u0026quot;goldenrod2\u0026quot; \u0026quot;goldenrod3\u0026quot; #\u0026gt; [151] \u0026quot;goldenrod4\u0026quot; \u0026quot;gray\u0026quot; \u0026quot;gray0\u0026quot; #\u0026gt; [154] \u0026quot;gray1\u0026quot; \u0026quot;gray2\u0026quot; \u0026quot;gray3\u0026quot; #\u0026gt; [157] \u0026quot;gray4\u0026quot; \u0026quot;gray5\u0026quot; \u0026quot;gray6\u0026quot; #\u0026gt; [160] \u0026quot;gray7\u0026quot; \u0026quot;gray8\u0026quot; \u0026quot;gray9\u0026quot; #\u0026gt; [163] \u0026quot;gray10\u0026quot; \u0026quot;gray11\u0026quot; \u0026quot;gray12\u0026quot; #\u0026gt; [166] \u0026quot;gray13\u0026quot; \u0026quot;gray14\u0026quot; \u0026quot;gray15\u0026quot; #\u0026gt; [169] \u0026quot;gray16\u0026quot; \u0026quot;gray17\u0026quot; \u0026quot;gray18\u0026quot; #\u0026gt; [172] \u0026quot;gray19\u0026quot; \u0026quot;gray20\u0026quot; \u0026quot;gray21\u0026quot; #\u0026gt; [175] \u0026quot;gray22\u0026quot; \u0026quot;gray23\u0026quot; \u0026quot;gray24\u0026quot; #\u0026gt; [178] \u0026quot;gray25\u0026quot; \u0026quot;gray26\u0026quot; \u0026quot;gray27\u0026quot; #\u0026gt; [181] \u0026quot;gray28\u0026quot; \u0026quot;gray29\u0026quot; \u0026quot;gray30\u0026quot; #\u0026gt; [184] \u0026quot;gray31\u0026quot; \u0026quot;gray32\u0026quot; \u0026quot;gray33\u0026quot; #\u0026gt; [187] \u0026quot;gray34\u0026quot; \u0026quot;gray35\u0026quot; \u0026quot;gray36\u0026quot; #\u0026gt; [190] \u0026quot;gray37\u0026quot; \u0026quot;gray38\u0026quot; \u0026quot;gray39\u0026quot; #\u0026gt; [193] \u0026quot;gray40\u0026quot; \u0026quot;gray41\u0026quot; \u0026quot;gray42\u0026quot; #\u0026gt; [196] \u0026quot;gray43\u0026quot; \u0026quot;gray44\u0026quot; \u0026quot;gray45\u0026quot; #\u0026gt; [199] \u0026quot;gray46\u0026quot; \u0026quot;gray47\u0026quot; \u0026quot;gray48\u0026quot; #\u0026gt; [202] \u0026quot;gray49\u0026quot; \u0026quot;gray50\u0026quot; \u0026quot;gray51\u0026quot; #\u0026gt; [205] \u0026quot;gray52\u0026quot; \u0026quot;gray53\u0026quot; \u0026quot;gray54\u0026quot; #\u0026gt; [208] \u0026quot;gray55\u0026quot; \u0026quot;gray56\u0026quot; \u0026quot;gray57\u0026quot; #\u0026gt; [211] \u0026quot;gray58\u0026quot; \u0026quot;gray59\u0026quot; \u0026quot;gray60\u0026quot; #\u0026gt; [214] \u0026quot;gray61\u0026quot; \u0026quot;gray62\u0026quot; \u0026quot;gray63\u0026quot; #\u0026gt; [217] \u0026quot;gray64\u0026quot; \u0026quot;gray65\u0026quot; \u0026quot;gray66\u0026quot; #\u0026gt; [220] \u0026quot;gray67\u0026quot; \u0026quot;gray68\u0026quot; \u0026quot;gray69\u0026quot; #\u0026gt; [223] \u0026quot;gray70\u0026quot; \u0026quot;gray71\u0026quot; \u0026quot;gray72\u0026quot; #\u0026gt; [226] \u0026quot;gray73\u0026quot; \u0026quot;gray74\u0026quot; \u0026quot;gray75\u0026quot; #\u0026gt; [229] \u0026quot;gray76\u0026quot; \u0026quot;gray77\u0026quot; \u0026quot;gray78\u0026quot; #\u0026gt; [232] \u0026quot;gray79\u0026quot; \u0026quot;gray80\u0026quot; \u0026quot;gray81\u0026quot; #\u0026gt; [235] \u0026quot;gray82\u0026quot; \u0026quot;gray83\u0026quot; \u0026quot;gray84\u0026quot; #\u0026gt; [238] \u0026quot;gray85\u0026quot; \u0026quot;gray86\u0026quot; \u0026quot;gray87\u0026quot; #\u0026gt; [241] \u0026quot;gray88\u0026quot; \u0026quot;gray89\u0026quot; \u0026quot;gray90\u0026quot; #\u0026gt; [244] \u0026quot;gray91\u0026quot; \u0026quot;gray92\u0026quot; \u0026quot;gray93\u0026quot; #\u0026gt; [247] \u0026quot;gray94\u0026quot; \u0026quot;gray95\u0026quot; \u0026quot;gray96\u0026quot; #\u0026gt; [250] \u0026quot;gray97\u0026quot; \u0026quot;gray98\u0026quot; \u0026quot;gray99\u0026quot; #\u0026gt; [253] \u0026quot;gray100\u0026quot; \u0026quot;green\u0026quot; \u0026quot;green1\u0026quot; #\u0026gt; [256] \u0026quot;green2\u0026quot; \u0026quot;green3\u0026quot; \u0026quot;green4\u0026quot; #\u0026gt; [259] \u0026quot;greenyellow\u0026quot; \u0026quot;grey\u0026quot; \u0026quot;grey0\u0026quot; #\u0026gt; [262] \u0026quot;grey1\u0026quot; \u0026quot;grey2\u0026quot; \u0026quot;grey3\u0026quot; #\u0026gt; [265] \u0026quot;grey4\u0026quot; \u0026quot;grey5\u0026quot; \u0026quot;grey6\u0026quot; #\u0026gt; [268] \u0026quot;grey7\u0026quot; \u0026quot;grey8\u0026quot; \u0026quot;grey9\u0026quot; #\u0026gt; [271] \u0026quot;grey10\u0026quot; \u0026quot;grey11\u0026quot; \u0026quot;grey12\u0026quot; #\u0026gt; [274] \u0026quot;grey13\u0026quot; \u0026quot;grey14\u0026quot; \u0026quot;grey15\u0026quot; #\u0026gt; [277] \u0026quot;grey16\u0026quot; \u0026quot;grey17\u0026quot; \u0026quot;grey18\u0026quot; #\u0026gt; [280] \u0026quot;grey19\u0026quot; \u0026quot;grey20\u0026quot; \u0026quot;grey21\u0026quot; #\u0026gt; [283] \u0026quot;grey22\u0026quot; \u0026quot;grey23\u0026quot; \u0026quot;grey24\u0026quot; #\u0026gt; [286] \u0026quot;grey25\u0026quot; \u0026quot;grey26\u0026quot; \u0026quot;grey27\u0026quot; #\u0026gt; [289] \u0026quot;grey28\u0026quot; \u0026quot;grey29\u0026quot; \u0026quot;grey30\u0026quot; #\u0026gt; [292] \u0026quot;grey31\u0026quot; \u0026quot;grey32\u0026quot; \u0026quot;grey33\u0026quot; #\u0026gt; [295] \u0026quot;grey34\u0026quot; \u0026quot;grey35\u0026quot; \u0026quot;grey36\u0026quot; #\u0026gt; [298] \u0026quot;grey37\u0026quot; \u0026quot;grey38\u0026quot; \u0026quot;grey39\u0026quot; #\u0026gt; [301] \u0026quot;grey40\u0026quot; \u0026quot;grey41\u0026quot; \u0026quot;grey42\u0026quot; #\u0026gt; [304] \u0026quot;grey43\u0026quot; \u0026quot;grey44\u0026quot; \u0026quot;grey45\u0026quot; #\u0026gt; [307] \u0026quot;grey46\u0026quot; \u0026quot;grey47\u0026quot; \u0026quot;grey48\u0026quot; #\u0026gt; [310] \u0026quot;grey49\u0026quot; \u0026quot;grey50\u0026quot; \u0026quot;grey51\u0026quot; #\u0026gt; [313] \u0026quot;grey52\u0026quot; \u0026quot;grey53\u0026quot; \u0026quot;grey54\u0026quot; #\u0026gt; [316] \u0026quot;grey55\u0026quot; \u0026quot;grey56\u0026quot; \u0026quot;grey57\u0026quot; #\u0026gt; [319] \u0026quot;grey58\u0026quot; \u0026quot;grey59\u0026quot; \u0026quot;grey60\u0026quot; #\u0026gt; [322] \u0026quot;grey61\u0026quot; \u0026quot;grey62\u0026quot; \u0026quot;grey63\u0026quot; #\u0026gt; [325] \u0026quot;grey64\u0026quot; \u0026quot;grey65\u0026quot; \u0026quot;grey66\u0026quot; #\u0026gt; [328] \u0026quot;grey67\u0026quot; \u0026quot;grey68\u0026quot; \u0026quot;grey69\u0026quot; #\u0026gt; [331] \u0026quot;grey70\u0026quot; \u0026quot;grey71\u0026quot; \u0026quot;grey72\u0026quot; #\u0026gt; [334] \u0026quot;grey73\u0026quot; \u0026quot;grey74\u0026quot; \u0026quot;grey75\u0026quot; #\u0026gt; [337] \u0026quot;grey76\u0026quot; \u0026quot;grey77\u0026quot; \u0026quot;grey78\u0026quot; #\u0026gt; [340] \u0026quot;grey79\u0026quot; \u0026quot;grey80\u0026quot; \u0026quot;grey81\u0026quot; #\u0026gt; [343] \u0026quot;grey82\u0026quot; \u0026quot;grey83\u0026quot; \u0026quot;grey84\u0026quot; #\u0026gt; [346] \u0026quot;grey85\u0026quot; \u0026quot;grey86\u0026quot; \u0026quot;grey87\u0026quot; #\u0026gt; [349] \u0026quot;grey88\u0026quot; \u0026quot;grey89\u0026quot; \u0026quot;grey90\u0026quot; #\u0026gt; [352] \u0026quot;grey91\u0026quot; \u0026quot;grey92\u0026quot; \u0026quot;grey93\u0026quot; #\u0026gt; [355] \u0026quot;grey94\u0026quot; \u0026quot;grey95\u0026quot; \u0026quot;grey96\u0026quot; #\u0026gt; [358] \u0026quot;grey97\u0026quot; \u0026quot;grey98\u0026quot; \u0026quot;grey99\u0026quot; #\u0026gt; [361] \u0026quot;grey100\u0026quot; \u0026quot;honeydew\u0026quot; \u0026quot;honeydew1\u0026quot; #\u0026gt; [364] \u0026quot;honeydew2\u0026quot; \u0026quot;honeydew3\u0026quot; \u0026quot;honeydew4\u0026quot; #\u0026gt; [367] \u0026quot;hotpink\u0026quot; \u0026quot;hotpink1\u0026quot; \u0026quot;hotpink2\u0026quot; #\u0026gt; [370] \u0026quot;hotpink3\u0026quot; \u0026quot;hotpink4\u0026quot; \u0026quot;indianred\u0026quot; #\u0026gt; [373] \u0026quot;indianred1\u0026quot; \u0026quot;indianred2\u0026quot; \u0026quot;indianred3\u0026quot; #\u0026gt; [376] \u0026quot;indianred4\u0026quot; \u0026quot;ivory\u0026quot; \u0026quot;ivory1\u0026quot; #\u0026gt; [379] \u0026quot;ivory2\u0026quot; \u0026quot;ivory3\u0026quot; \u0026quot;ivory4\u0026quot; #\u0026gt; [382] \u0026quot;khaki\u0026quot; \u0026quot;khaki1\u0026quot; \u0026quot;khaki2\u0026quot; #\u0026gt; [385] \u0026quot;khaki3\u0026quot; \u0026quot;khaki4\u0026quot; \u0026quot;lavender\u0026quot; #\u0026gt; [388] \u0026quot;lavenderblush\u0026quot; \u0026quot;lavenderblush1\u0026quot; \u0026quot;lavenderblush2\u0026quot; #\u0026gt; [391] \u0026quot;lavenderblush3\u0026quot; \u0026quot;lavenderblush4\u0026quot; \u0026quot;lawngreen\u0026quot; #\u0026gt; [394] \u0026quot;lemonchiffon\u0026quot; \u0026quot;lemonchiffon1\u0026quot; \u0026quot;lemonchiffon2\u0026quot; #\u0026gt; [397] \u0026quot;lemonchiffon3\u0026quot; \u0026quot;lemonchiffon4\u0026quot; \u0026quot;lightblue\u0026quot; #\u0026gt; [400] \u0026quot;lightblue1\u0026quot; \u0026quot;lightblue2\u0026quot; \u0026quot;lightblue3\u0026quot; #\u0026gt; [403] \u0026quot;lightblue4\u0026quot; \u0026quot;lightcoral\u0026quot; \u0026quot;lightcyan\u0026quot; #\u0026gt; [406] \u0026quot;lightcyan1\u0026quot; \u0026quot;lightcyan2\u0026quot; \u0026quot;lightcyan3\u0026quot; #\u0026gt; [409] \u0026quot;lightcyan4\u0026quot; \u0026quot;lightgoldenrod\u0026quot; \u0026quot;lightgoldenrod1\u0026quot; #\u0026gt; [412] \u0026quot;lightgoldenrod2\u0026quot; \u0026quot;lightgoldenrod3\u0026quot; \u0026quot;lightgoldenrod4\u0026quot; #\u0026gt; [415] \u0026quot;lightgoldenrodyellow\u0026quot; \u0026quot;lightgray\u0026quot; \u0026quot;lightgreen\u0026quot; #\u0026gt; [418] \u0026quot;lightgrey\u0026quot; \u0026quot;lightpink\u0026quot; \u0026quot;lightpink1\u0026quot; #\u0026gt; [421] \u0026quot;lightpink2\u0026quot; \u0026quot;lightpink3\u0026quot; \u0026quot;lightpink4\u0026quot; #\u0026gt; [424] \u0026quot;lightsalmon\u0026quot; \u0026quot;lightsalmon1\u0026quot; \u0026quot;lightsalmon2\u0026quot; #\u0026gt; [427] \u0026quot;lightsalmon3\u0026quot; \u0026quot;lightsalmon4\u0026quot; \u0026quot;lightseagreen\u0026quot; #\u0026gt; [430] \u0026quot;lightskyblue\u0026quot; \u0026quot;lightskyblue1\u0026quot; \u0026quot;lightskyblue2\u0026quot; #\u0026gt; [433] \u0026quot;lightskyblue3\u0026quot; \u0026quot;lightskyblue4\u0026quot; \u0026quot;lightslateblue\u0026quot; #\u0026gt; [436] \u0026quot;lightslategray\u0026quot; \u0026quot;lightslategrey\u0026quot; \u0026quot;lightsteelblue\u0026quot; #\u0026gt; [439] \u0026quot;lightsteelblue1\u0026quot; \u0026quot;lightsteelblue2\u0026quot; \u0026quot;lightsteelblue3\u0026quot; #\u0026gt; [442] \u0026quot;lightsteelblue4\u0026quot; \u0026quot;lightyellow\u0026quot; \u0026quot;lightyellow1\u0026quot; #\u0026gt; [445] \u0026quot;lightyellow2\u0026quot; \u0026quot;lightyellow3\u0026quot; \u0026quot;lightyellow4\u0026quot; #\u0026gt; [448] \u0026quot;limegreen\u0026quot; \u0026quot;linen\u0026quot; \u0026quot;magenta\u0026quot; #\u0026gt; [451] \u0026quot;magenta1\u0026quot; \u0026quot;magenta2\u0026quot; \u0026quot;magenta3\u0026quot; #\u0026gt; [454] \u0026quot;magenta4\u0026quot; \u0026quot;maroon\u0026quot; \u0026quot;maroon1\u0026quot; #\u0026gt; [457] \u0026quot;maroon2\u0026quot; \u0026quot;maroon3\u0026quot; \u0026quot;maroon4\u0026quot; #\u0026gt; [460] \u0026quot;mediumaquamarine\u0026quot; \u0026quot;mediumblue\u0026quot; \u0026quot;mediumorchid\u0026quot; #\u0026gt; [463] \u0026quot;mediumorchid1\u0026quot; \u0026quot;mediumorchid2\u0026quot; \u0026quot;mediumorchid3\u0026quot; #\u0026gt; [466] \u0026quot;mediumorchid4\u0026quot; \u0026quot;mediumpurple\u0026quot; \u0026quot;mediumpurple1\u0026quot; #\u0026gt; [469] \u0026quot;mediumpurple2\u0026quot; \u0026quot;mediumpurple3\u0026quot; \u0026quot;mediumpurple4\u0026quot; #\u0026gt; [472] \u0026quot;mediumseagreen\u0026quot; \u0026quot;mediumslateblue\u0026quot; \u0026quot;mediumspringgreen\u0026quot; #\u0026gt; [475] \u0026quot;mediumturquoise\u0026quot; \u0026quot;mediumvioletred\u0026quot; \u0026quot;midnightblue\u0026quot; #\u0026gt; [478] \u0026quot;mintcream\u0026quot; \u0026quot;mistyrose\u0026quot; \u0026quot;mistyrose1\u0026quot; #\u0026gt; [481] \u0026quot;mistyrose2\u0026quot; \u0026quot;mistyrose3\u0026quot; \u0026quot;mistyrose4\u0026quot; #\u0026gt; [484] \u0026quot;moccasin\u0026quot; \u0026quot;navajowhite\u0026quot; \u0026quot;navajowhite1\u0026quot; #\u0026gt; [487] \u0026quot;navajowhite2\u0026quot; \u0026quot;navajowhite3\u0026quot; \u0026quot;navajowhite4\u0026quot; #\u0026gt; [490] \u0026quot;navy\u0026quot; \u0026quot;navyblue\u0026quot; \u0026quot;oldlace\u0026quot; #\u0026gt; [493] \u0026quot;olivedrab\u0026quot; \u0026quot;olivedrab1\u0026quot; \u0026quot;olivedrab2\u0026quot; #\u0026gt; [496] \u0026quot;olivedrab3\u0026quot; \u0026quot;olivedrab4\u0026quot; \u0026quot;orange\u0026quot; #\u0026gt; [499] \u0026quot;orange1\u0026quot; \u0026quot;orange2\u0026quot; \u0026quot;orange3\u0026quot; #\u0026gt; [502] \u0026quot;orange4\u0026quot; \u0026quot;orangered\u0026quot; \u0026quot;orangered1\u0026quot; #\u0026gt; [505] \u0026quot;orangered2\u0026quot; \u0026quot;orangered3\u0026quot; \u0026quot;orangered4\u0026quot; #\u0026gt; [508] \u0026quot;orchid\u0026quot; \u0026quot;orchid1\u0026quot; \u0026quot;orchid2\u0026quot; #\u0026gt; [511] \u0026quot;orchid3\u0026quot; \u0026quot;orchid4\u0026quot; \u0026quot;palegoldenrod\u0026quot; #\u0026gt; [514] \u0026quot;palegreen\u0026quot; \u0026quot;palegreen1\u0026quot; \u0026quot;palegreen2\u0026quot; #\u0026gt; [517] \u0026quot;palegreen3\u0026quot; \u0026quot;palegreen4\u0026quot; \u0026quot;paleturquoise\u0026quot; #\u0026gt; [520] \u0026quot;paleturquoise1\u0026quot; \u0026quot;paleturquoise2\u0026quot; \u0026quot;paleturquoise3\u0026quot; #\u0026gt; [523] \u0026quot;paleturquoise4\u0026quot; \u0026quot;palevioletred\u0026quot; \u0026quot;palevioletred1\u0026quot; #\u0026gt; [526] \u0026quot;palevioletred2\u0026quot; \u0026quot;palevioletred3\u0026quot; \u0026quot;palevioletred4\u0026quot; #\u0026gt; [529] \u0026quot;papayawhip\u0026quot; \u0026quot;peachpuff\u0026quot; \u0026quot;peachpuff1\u0026quot; #\u0026gt; [532] \u0026quot;peachpuff2\u0026quot; \u0026quot;peachpuff3\u0026quot; \u0026quot;peachpuff4\u0026quot; #\u0026gt; [535] \u0026quot;peru\u0026quot; \u0026quot;pink\u0026quot; \u0026quot;pink1\u0026quot; #\u0026gt; [538] \u0026quot;pink2\u0026quot; \u0026quot;pink3\u0026quot; \u0026quot;pink4\u0026quot; #\u0026gt; [541] \u0026quot;plum\u0026quot; \u0026quot;plum1\u0026quot; \u0026quot;plum2\u0026quot; #\u0026gt; [544] \u0026quot;plum3\u0026quot; \u0026quot;plum4\u0026quot; \u0026quot;powderblue\u0026quot; #\u0026gt; [547] \u0026quot;purple\u0026quot; \u0026quot;purple1\u0026quot; \u0026quot;purple2\u0026quot; #\u0026gt; [550] \u0026quot;purple3\u0026quot; \u0026quot;purple4\u0026quot; \u0026quot;red\u0026quot; #\u0026gt; [553] \u0026quot;red1\u0026quot; \u0026quot;red2\u0026quot; \u0026quot;red3\u0026quot; #\u0026gt; [556] \u0026quot;red4\u0026quot; \u0026quot;rosybrown\u0026quot; \u0026quot;rosybrown1\u0026quot; #\u0026gt; [559] \u0026quot;rosybrown2\u0026quot; \u0026quot;rosybrown3\u0026quot; \u0026quot;rosybrown4\u0026quot; #\u0026gt; [562] \u0026quot;royalblue\u0026quot; \u0026quot;royalblue1\u0026quot; \u0026quot;royalblue2\u0026quot; #\u0026gt; [565] \u0026quot;royalblue3\u0026quot; \u0026quot;royalblue4\u0026quot; \u0026quot;saddlebrown\u0026quot; #\u0026gt; [568] \u0026quot;salmon\u0026quot; \u0026quot;salmon1\u0026quot; \u0026quot;salmon2\u0026quot; #\u0026gt; [571] \u0026quot;salmon3\u0026quot; \u0026quot;salmon4\u0026quot; \u0026quot;sandybrown\u0026quot; #\u0026gt; [574] \u0026quot;seagreen\u0026quot; \u0026quot;seagreen1\u0026quot; \u0026quot;seagreen2\u0026quot; #\u0026gt; [577] \u0026quot;seagreen3\u0026quot; \u0026quot;seagreen4\u0026quot; \u0026quot;seashell\u0026quot; #\u0026gt; [580] \u0026quot;seashell1\u0026quot; \u0026quot;seashell2\u0026quot; \u0026quot;seashell3\u0026quot; #\u0026gt; [583] \u0026quot;seashell4\u0026quot; \u0026quot;sienna\u0026quot; \u0026quot;sienna1\u0026quot; #\u0026gt; [586] \u0026quot;sienna2\u0026quot; \u0026quot;sienna3\u0026quot; \u0026quot;sienna4\u0026quot; #\u0026gt; [589] \u0026quot;skyblue\u0026quot; \u0026quot;skyblue1\u0026quot; \u0026quot;skyblue2\u0026quot; #\u0026gt; [592] \u0026quot;skyblue3\u0026quot; \u0026quot;skyblue4\u0026quot; \u0026quot;slateblue\u0026quot; #\u0026gt; [595] \u0026quot;slateblue1\u0026quot; \u0026quot;slateblue2\u0026quot; \u0026quot;slateblue3\u0026quot; #\u0026gt; [598] \u0026quot;slateblue4\u0026quot; \u0026quot;slategray\u0026quot; \u0026quot;slategray1\u0026quot; #\u0026gt; [601] \u0026quot;slategray2\u0026quot; \u0026quot;slategray3\u0026quot; \u0026quot;slategray4\u0026quot; #\u0026gt; [604] \u0026quot;slategrey\u0026quot; \u0026quot;snow\u0026quot; \u0026quot;snow1\u0026quot; #\u0026gt; [607] \u0026quot;snow2\u0026quot; \u0026quot;snow3\u0026quot; \u0026quot;snow4\u0026quot; #\u0026gt; [610] \u0026quot;springgreen\u0026quot; \u0026quot;springgreen1\u0026quot; \u0026quot;springgreen2\u0026quot; #\u0026gt; [613] \u0026quot;springgreen3\u0026quot; \u0026quot;springgreen4\u0026quot; \u0026quot;steelblue\u0026quot; #\u0026gt; [616] \u0026quot;steelblue1\u0026quot; \u0026quot;steelblue2\u0026quot; \u0026quot;steelblue3\u0026quot; #\u0026gt; [619] \u0026quot;steelblue4\u0026quot; \u0026quot;tan\u0026quot; \u0026quot;tan1\u0026quot; #\u0026gt; [622] \u0026quot;tan2\u0026quot; \u0026quot;tan3\u0026quot; \u0026quot;tan4\u0026quot; #\u0026gt; [625] \u0026quot;thistle\u0026quot; \u0026quot;thistle1\u0026quot; \u0026quot;thistle2\u0026quot; #\u0026gt; [628] \u0026quot;thistle3\u0026quot; \u0026quot;thistle4\u0026quot; \u0026quot;tomato\u0026quot; #\u0026gt; [631] \u0026quot;tomato1\u0026quot; \u0026quot;tomato2\u0026quot; \u0026quot;tomato3\u0026quot; #\u0026gt; [634] \u0026quot;tomato4\u0026quot; \u0026quot;turquoise\u0026quot; \u0026quot;turquoise1\u0026quot; #\u0026gt; [637] \u0026quot;turquoise2\u0026quot; \u0026quot;turquoise3\u0026quot; \u0026quot;turquoise4\u0026quot; #\u0026gt; [640] \u0026quot;violet\u0026quot; \u0026quot;violetred\u0026quot; \u0026quot;violetred1\u0026quot; #\u0026gt; [643] \u0026quot;violetred2\u0026quot; \u0026quot;violetred3\u0026quot; \u0026quot;violetred4\u0026quot; #\u0026gt; [646] \u0026quot;wheat\u0026quot; \u0026quot;wheat1\u0026quot; \u0026quot;wheat2\u0026quot; #\u0026gt; [649] \u0026quot;wheat3\u0026quot; \u0026quot;wheat4\u0026quot; \u0026quot;whitesmoke\u0026quot; #\u0026gt; [652] \u0026quot;yellow\u0026quot; \u0026quot;yellow1\u0026quot; \u0026quot;yellow2\u0026quot; #\u0026gt; [655] \u0026quot;yellow3\u0026quot; \u0026quot;yellow4\u0026quot; \u0026quot;yellowgreen\u0026quot;\u0026lt;!--html_preserve--\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r \r\rç¹ªè£½å‘é‡ä¸­çš„è³‡æ–™\nx \u0026lt;- c(1,3,4,7,8,9)\ry \u0026lt;- c(0,3,6,9,7,8)\rplot(x,y,main='plot(x,y)')\r figure\r ç¹ªè£½data.frame ä¸­çš„è³‡æ–™\nattach(mtcars)\rplot(mtcars$wt, mtcars$mpg) plot(mpg~wt,data=mtcars) # ğŸ·ğŸ‘å’Œä¸Šé¢çš„åœ–æ²’ä»€éº¼ä¸åŒ\r  plot()å‡½æ•¸ï¼Œæ–°å»ºè¦–çª—ç„¶å¾Œç•«å‡º weight vs. miles per gallon. abline() ä¸æœƒé–‹å•Ÿæ–°è¦–çª—åšåœ–ï¼Œabline()çš„èªæ³•å¦‚ä¸‹: abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,coef = NULL, untf = FALSE, â€¦)    ä»£è¡¨çš„æ„æ€æ˜¯ç•«å‡ºä¸€æ¢ç›´ç·ša+bx ï¼Œå…¶ä¸­aä»£è¡¨æˆªè·å¸¸æ•¸ï¼Œbå‰‡æ˜¯æ–œç‡å¸¸æ•¸ã€‚ä¾‹å¦‚\n Y=2X+1ï¼Œå‰‡å°æ‡‰çš„å‡½æ•¸ç‚º abline(a=1,b=2) ã€‚ abline(h=3),æ°´å¹³ç·š abline(v=2) å‚ç›´  plot(mpg~wt,data=mtcars) # ğŸ·ğŸ‘åªæœƒæœ‰è³‡æ–™é»,åŒä¸Š\r# ğŸ‘ä¸‹é¢3è¡Œç–Šåœ¨ä¸Šé¢çš„åœ–å½¢ä¸Š\rabline(lm(mtcars$mpg~mtcars$wt)) #ğŸ·è¨»è§£ğŸ‘âŒ abline(mtcars$mpg~mtcars$wt)\rtitle(\u0026quot;Regression of MPG on Weight\u0026quot;)\r figure\r     â“ ç•«å‡ºä¸‹é¢çš„åœ–,é©—è­‰å›æ­¸ç·šç¶“éx,yçš„å¹³å‡å€¼ã€‚\nplot(mpg~wt,data=mtcars) abline(lm(mtcars$mpg~mtcars$wt)) title(\u0026quot;Regression of MPG on Weight\u0026quot;)\rabline(h=mean(mpg),col=\u0026quot;red\u0026quot;) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘è¡¨ç¤ºDV(mpg)å¹³å‡çš„æ°´å¹³ç·š\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rabline(v=mean(wt),col=\u0026quot;red\u0026quot;) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘è¡¨ç¤ºIV(wt)å¹³å‡çš„å‚ç›´ç·š\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r  figure\n\ræç¤º\r paired pairs(~wt+mpg+disp+cyl,data = mtcars, main = \u0026quot;Scatterplot Matrix\u0026quot;)\r figure\r å¦‚æœæ˜¯è³‡æ–™é›†\nplot(mtcars)\r figure\r å‡½æ•¸ç•«åœ– sin\n x: -pi ~ 2*pi y: sin(x)  plot(sin, -pi, 2*pi)  figure\r line() ç¯„ä¾‹ å¦å¤–åƒè€ƒcurve()\nrequire(stats) # for lowess, rpois, rnorm\rsummary(cars)\r#\u0026gt; speed dist #\u0026gt; Min. : 4.0 Min. : 2.00 #\u0026gt; 1st Qu.:12.0 1st Qu.: 26.00 #\u0026gt; Median :15.0 Median : 36.00 #\u0026gt; Mean :15.4 Mean : 42.98 #\u0026gt; 3rd Qu.:19.0 3rd Qu.: 56.00 #\u0026gt; Max. :25.0 Max. :120.00\r#plot(cars) # å› ç‚ºåªæœ‰å…©å€‹æ¬„ä½,ç›´æ¥ä¸Ÿé€²å»,ä¸åˆ†åˆ¥æ”¾x,y\rplot(cars$dist~cars$speed)\rabline(lm(cars$dist~cars$speed),col=\u0026quot;red\u0026quot;) #æ²’æœ‰dataé€™å€‹åƒæ•¸,æ‰€ä»¥è¦åŠ ä¸Šcars\rlines(lowess(cars),col=\u0026quot;blue\u0026quot;) #ğŸ·ç–Šä¸Šé¡å¤–çš„ç·šæ¢\r figure\r â›³ éŒ¯èª¤ä¾‹ \r âŒabline(cars$dist ~ cars$speed) ğŸ‘è¦æœ‰lm,å› ç‚ºè¦æ‰¾a,b âŒabline(lowness(cars)) ğŸ‘ä¹Ÿæ˜¯æ²’æœ‰a,b :å› ç‚ºlownessæ˜¯éåƒæ•¸ä¼°è¨ˆ,å‚³å›ä¾†çš„æ˜¯æ¨£æœ¬é»  \r\r LOWESS, locally weighted scatter plot smoothingã€‚ ç›¸é—œé–±è®€ lowessç¯„ä¾‹ attach(cars)\rplot(speed,dist,main=\u0026quot;Stopping Distance\u0026quot;, xlab=\u0026quot;Speed\u0026quot;, ylab=\u0026quot;Distance\u0026quot;, pch=21, bg=2, col=2)\rlines(lowess(cars, f=.3),col =1)\rlines(lowess(cars, f=.5),col =4)\rlines(lowess(cars, f=.1),col =7)\r   Histograms å‡½æ•¸hist(x)ï¼šå…¶ä¸­xæ˜¯ä¸€å€‹æ•¸å­—å‘é‡ï¼Œ\n é¸é …freq=FALSE ç”¨ä¾†ç•«å‡º probability densities è€Œä¸æ˜¯æ¬¡æ•¸ frequencies. é¸é …ï¼šbreaks= ## å‰‡æ˜¯æ§åˆ¶åˆ†æˆå¹¾ä»½ã€‚    Simple Histogram\nhist(mtcars$mpg)\r figure\r   åˆ†æˆ12ä»½ï¼Œé¡è‰²ç´…è‰²ã€‚\nhist(mtcars$mpg, breaks=12, col=\u0026quot;red\u0026quot;)\r figure\r   è‡ªè¡Œçµ¦å®šåˆ†å‰²é»\nhist(mtcars$mpg, breaks=c(4,5,12,50), col=\u0026quot;red\u0026quot;)\r figure\r   Add a Normal Curve Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used.\nx \u0026lt;- mtcars$mpg h\u0026lt;-hist(x, breaks=10, col=\u0026quot;red\u0026quot;, xlab=\u0026quot;Miles Per Gallon\u0026quot;, main=\u0026quot;Histogram with Normal Curve\u0026quot;) xfit\u0026lt;-seq(min(x),max(x),length=40) yfit\u0026lt;-dnorm(xfit,mean=mean(x),sd=sd(x)) yfit \u0026lt;- yfit*diff(h$mids[1:2])*length(x) #ğŸ·length(X)æ˜¯å€‹æ•¸,ä¸æ˜¯é•·åº¦\rlines(xfit, yfit, col=\u0026quot;blue\u0026quot;, lwd=2)\r figure\r hint: h: æ¬¡æ•¸åˆ†é…åœ–,åˆ\n$$ pdf = \\frac{æ©Ÿç‡}{é•·åº¦} =\\frac{\\frac{n}{N}}{bin \\quad width} $$\næ‰€ä»¥\n$$ n=pdf\\times N \\times (bin \\quad width) $$\nh\r#\u0026gt; $breaks\r#\u0026gt; [1] 10 12 14 16 18 20 22 24 26 28 30 32 34\r#\u0026gt; #\u0026gt; $counts\r#\u0026gt; [1] 2 1 7 3 5 5 2 2 1 0 2 2\r#\u0026gt; #\u0026gt; $density\r#\u0026gt; [1] 0.031250 0.015625 0.109375 0.046875 0.078125 0.078125 0.031250 0.031250\r#\u0026gt; [9] 0.015625 0.000000 0.031250 0.031250\r#\u0026gt; #\u0026gt; $mids\r#\u0026gt; [1] 11 13 15 17 19 21 23 25 27 29 31 33\r#\u0026gt; #\u0026gt; $xname\r#\u0026gt; [1] \u0026quot;x\u0026quot;\r#\u0026gt; #\u0026gt; $equidist\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; attr(,\u0026quot;class\u0026quot;)\r#\u0026gt; [1] \u0026quot;histogram\u0026quot;\r Kernel Density Plot æ ¸å¯†åº¦ç•«åœ–(Kernal density plots) ç”¨ä¾†è§€å¯Ÿä¸€å€‹è®Šé‡ï¼Œæ¯”è¼ƒæœ‰æœ‰æ•ˆç‡ï¼ŒæŒ‡ä»¤å¦‚ï¼šplot(density(x)) å…¶ä¸­x æ˜¯ä¸€å€‹æ•¸å­—å‘é‡ã€‚\nd \u0026lt;- density(mtcars$mpg) # returns the density data plot(d) # plots the results\r figure\r Filled Density Plot d \u0026lt;- density(mtcars$mpg)\rplot(d, main=\u0026quot;Kernel Density of Miles Per Gallon\u0026quot;)\rpolygon(d, col=\u0026quot;red\u0026quot;, border=\u0026quot;blue\u0026quot;)\r figure\r å…¶ä»– plot(mpg): plot(~mpg) plot(mpg ~ cyl ): plot(cyl,mpg) plot(mpg ~ cyl | gear)\ndata\u0026lt;-mtcars\rattach(data)\rnames(data)\r#\u0026gt; [1] \u0026quot;mpg\u0026quot; \u0026quot;cyl\u0026quot; \u0026quot;disp\u0026quot; \u0026quot;hp\u0026quot; \u0026quot;drat\u0026quot; \u0026quot;wt\u0026quot; \u0026quot;qsec\u0026quot; \u0026quot;vs\u0026quot; \u0026quot;am\u0026quot; \u0026quot;gear\u0026quot;\r#\u0026gt; [11] \u0026quot;carb\u0026quot;\r#gear\u0026lt;-factor(gear)\r#am\u0026lt;-factor(am)\rplot(mpg ~ cyl | gear)\r figure\r"},
{"uri": "/blogR//rlang/9_2_%E5%A4%9A%E5%9C%96%E7%96%8A%E5%9C%96.html","title": "9.2 å¤šåœ–ç–Šåœ–",
	"tags": [],
	"description": "9_2_å¤šåœ–ç–Šåœ–",
	"content": "æ¦‚è«– ç•«å¸ƒå¯ä»¥åˆ†æˆå¤šå€‹ç¹ªåœ–å€(ç°¡ç¨±çµ„åˆåœ–,å¤šåœ–)ï¼Œä¸åŒæŒ‡ä»¤ç•«åœ¨åŒä¸€å€‹ç•«å¸ƒä¸Š,æ–‡ä¸­ç°¡ç¨±ç–Šåœ–ã€‚\n é«˜éšæŒ‡ä»¤,ä¾‹å¦‚:barplot, boxplot, curve, hist, plot, dotchart, image, matplot, mosaicplot, stripchart, contour,é€™äº›æŒ‡ä»¤å¤§é«”ä¸Šæœ‰å…©å€‹å‹•ä½œ:  æ–°å¢ç•«å¸ƒ canvas ç•«åœ–   ä½éšæŒ‡ä»¤å‰‡æ˜¯å¢æ·»åˆ°ç›®å‰çš„ç•«å¸ƒä¸Šã€‚ä¾‹å¦‚ï¼Œ abline, lines, segments, points,polygon, grid ã€‚é‚„æœ‰å¢æ·»æ–‡å­—çš„å‡½æ•¸,ä¾‹å¦‚t: legend, text, mtext,è€Œåº§æ¨™è»¸ç›¸é—œå‡½æ•¸,å‰‡æœ‰: axis, box, rug  é«˜éšå’Œä½éšå‡½æ•¸çš„é—œä¿‚,ä¾‹å¦‚æŒ‡ä»¤ plot, hist, boxplot, ç­‰ç­‰,æœƒåœ¨ç›®å‰çš„è¦–çª—ä¸Šæ–°å¢ç•«å¸ƒï¼Œç„¶å¾Œç•«åœ–,è€Œline(),scatterplot()å‰‡æ˜¯ç–Šåœ–ã€‚é€™è£¡å¦å¤–çœ‹çœ‹å¹¾ç¨®è‡ªè¡Œæ§åˆ¶çš„æ–¹æ³•ï¼š\n å¤šè¦–çª—(multiple windows)ã€ çµ„åˆåœ–(combining figure) ç•«å¸ƒåˆ†å‰² ç–Šåœ–(overlay)è¨è«–ã€‚åŒä¸€å¼µç•«å¸ƒå¢è£œå…¶ä»–è³‡æ–™æˆ–æ¨£æœ¬é»ã€‚  ä¸€èˆ¬è¦–çª—ä½œæ¥­ç³»çµ±çš„ç¹ªåœ–ï¼Œæœƒæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶deviceã€‚åœ¨é€™å€‹deviceä¸Šï¼Œæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶canvasï¼Œå’Œç¹ªåœ–å·¥å…·ä¾‹å¦‚ï¼Œæ°´å½©ç­†ä¹‹é¡çš„æŠ½è±¡ç‰©ä»¶å¯ä»¥æŒ‡å®šé¡è‰²ï¼Œç·šæ¢ç²—ç´°ç­‰ç­‰ã€‚\nåœ¨Rä¸­,å°æ‡‰ä¸Šè¿°ä½œæ¥­ç³»çµ±çš„é—œéµå­—.Devices(paired list)ã€.Device(é•·åº¦ç‚º1)ã€dev.cur()(ç›®å‰çš„è£ç½®active device)ã€‚é€™è£¡èªªçš„DeviceæŒ‡çš„æ˜¯è¦–çª—ã€‚åœ¨è¦–çª—è£¡é¢çš„ç•«å¸ƒ,å°±æ˜¯Ræä¾›çš„ç¹ªåœ–å‡½æ•¸è¼¸å‡ºæ‰€åœ¨,ä¾‹å¦‚plot(),hist()ç­‰ç­‰ã€‚\næ‰€ä»¥\n dev.new() æŒ‡çš„æ˜¯é–‹å•Ÿæ–°è¦–çª—ï¼ŒğŸ·ğŸ‘åœ¨Rstudioä¸­çš„å…§å®šè¦–çª—åæ˜¯RStudioGD dev.cur()æ˜¯ç›®å‰è¦–çª—è™Ÿç¢¼, dev.prev()å‰ä¸€å€‹è¦–çª—è™Ÿç¢¼ã€‚ è€Œplot.new() å‰‡æ˜¯æ–°å¢ç•«å¸ƒ(æˆ‘çŒœæ‡‰è©²æ˜¯é€æ˜,æ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨å°‡å…©å€‹é«˜éšæŒ‡ä»¤åœ–ç–Šåœ¨ä¸€èµ·)ã€‚è¦‹ç·´ç¿’  å¤šè¦–çª— é–‹å¤šè¦–çª—çš„æ–¹æ³•æ ¹æ“šOSè€Œä¸åŒï¼Œå¦‚ä¸‹ï¼š\n   Function Platform     windows() Windows   X11() Unix   quartz() Mac    è¦é—œé–‰è¦–çª—ï¼Œå¯ä»¥ç”¨å‡½æ•¸dev.off()\nå¦‚æœè¦çŸ¥é“ç›®å‰çš„è¦–çª—æ˜¯é‚£ä¸€å€‹ï¼Œå¯ä»¥åƒè€ƒ dev.cur()ã€‚ Note: å¦‚æœç›®å‰æœ‰å¤šå€‹åœ–çª—ï¼Œå‰‡ä¸€ç›´å‘¼å«é€™å€‹å‡½æ•¸dev.off()ï¼Œæœƒä¾æ¬¡é—œé–‰è¦–çª—ï¼Œç›´åˆ°å‡½æ•¸å‚³å›NULLã€‚\n\ré©—è­‰ä¸Šé¢çš„èªªæ³•å¯ä»¥åˆ©ç”¨\rdev.cur()\r#\u0026gt; png #\u0026gt; 2\rhist(mtcars$mpg) #åœ¨ç›®å‰çš„è£ç½®(è¦–çª—)ä¸Š,é–‹æ–°çš„ç•«å¸ƒ,ç„¶å¾Œç•«åœ–\rdev.cur()\r#\u0026gt; png #\u0026gt; 2\rhist(mtcars$mpg) #é‡è¤‡ä¸Šé¢çš„å‹•ä½œ,ä½†æ˜¯ä»ç„¶åœ¨åŒä¸€å€‹è£ç½®ä¸Š,æ‰€ä»¥çµæœåªçœ‹åˆ°ä¸€å€‹ç›´æ–¹åœ–\r figure\n\rdev.cur()\r#\u0026gt; png #\u0026gt; 2\rdev.off()\r#\u0026gt; null device #\u0026gt; 1\r â“ä¸Šé¢çš„ç¯„ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°åœ–è£ç½®çš„ç·¨è™Ÿéƒ½æ˜¯2ï¼Œä¹Ÿå°±æ˜¯histç•«åœ¨åŒä¸€å€‹è¦–çª—ä¸Šã€‚æœ€å¾Œä¹Ÿåªé¡¯ç¤ºä¸€å€‹åœ–(ç–Šåœ¨æœ€å¾Œé¢çš„é‚£å€‹)ã€‚å¦‚æœåœ¨Rstudioä¸Šæ¸¬è©¦,å¯ä»¥åˆ©ç”¨æŒ‰éˆ•æ¸…é™¤ç›®å‰çš„åœ–å½¢çŸ¥é“,å¦å¤–ä¸€å¼µåœ–åœ¨ä¸‹é¢ã€‚\n è¨è«–ä¸‹é¢çš„è¼¸å‡ºçµæœï¼Œï¼š\næ¯”è¼ƒç¨‹å¼ç¢¼åœ¨rmarkdownå’Œconsoleä¸­åŸ·è¡Œçš„çµæœï¼Ÿç›®çš„åªæ˜¯åœ¨èªª,åœ¨Rmarkdownä¸­windows()æ²’ä½œç”¨ã€‚\nif(.Platform$OS.type==\u0026quot;windows\u0026quot;) windows() else X11()\rhist(mtcars$mpg)  figure\n\rdev.cur() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å¦‚æœä¸åœ¨Rmarkdownä¸­ï¼Œæ‡‰è©²æ˜¯2\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; windows #\u0026gt; 3\r# é‡è¤‡ä¸Šé¢3è¡Œ\rif(.Platform$OS.type==\u0026quot;windows\u0026quot;) windows() else X11()\rhist(mtcars$mpg)\rdev.cur() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;è¦–çª—ç·¨è™Ÿæ­£å¸¸é¡¯ç¤ºå¢åŠ ,ä½†æ˜¯åœ–å½¢ä¸å‡ºä¾†ã€‚\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; windows #\u0026gt; 4\r æç¤º\r åœ¨rscriptâœ”ä¸­åŸ·è¡Œæ­£å¸¸(æœƒæœ‰å…©å€‹è¦–çª—)ã€‚ä½†æ˜¯åœ¨RMDä¸­åªæœ‰ä¸€å€‹åœ–ã€‚å‡½æ•¸windows()å¥½åƒç¬¬äºŒæ¬¡æ²’ä½œç”¨ã€‚\nâ›³ æ¸¬è©¦,ç·´ç¿’  plot.new() # åŒä¸€å€‹è¦–çª—ï¼Œæ–°å¢åœ–å±¤\rdev.new() #æ–°è¦–çª—\rplot(1:1)\rdev.new()\rplot(2,2)\r# åœ–å½¢åŒ–å®Œä»¥å¾Œ,æ‰æƒ³åˆ°è¦è£œä¸Štitle\rdev.set(dev.prev()) # åˆ°å‰ä¸€å€‹è¦–çª—\rtitle(main=\u0026quot;test dev 1\u0026quot;)\rdev.set(dev.next()) # åˆ°ç¬¬äºŒå€‹è¦–çª—\rtitle(main=\u0026quot;test dev 2\u0026quot;)\r çµ„åˆåœ– çµ„åˆåœ–çš„ä¸€å€‹é‡è¦å‡½æ•¸æ˜¯par(),å¯ä»¥åƒè€ƒ ã€‚\nåŒæ™‚é¡¯ç¤ºå¤šå€‹plotçš„çµæœï¼Œå¯ä»¥åˆ©ç”¨å‡½æ•¸par() æˆ– layout( )ã€‚å‡½æ•¸par( )çš„é¸é …æœ‰ï¼š\n mfrow=c(nrows, ncols) å¡«plotçš„æ–¹å‘ç‚ºæ©«è¡Œ(matrix flow by row)ã€‚ mfcol=c(nrows, ncols) å¡«å…¥çš„æ–¹å‘ç‚ºç›´è¡Œã€‚  ä¾‹å¦‚æƒ³è¦æŠŠä¸åŒç·šæ¢çš„plotæ”¾åœ¨åŒä¸€ç•«å¸ƒä¸Šåšæ¯”è¼ƒ,å¯ä»¥åˆ©ç”¨ä¸‹é¢çš„æŒ‡ä»¤ â›³ ç·šæ¢å½¢å¼typeçš„å¹¾ç¨®åŸºæœ¬é¡å‹ \nx \u0026lt;- c(1,3,4,7,8,9)\ry \u0026lt;- c(0,3,6,9,7,8)\rpar(mfrow=c(2,3))\rplot(x,y,main='plot(x,y)',col=\u0026quot;red\u0026quot;)\rplot(x,y,type=\u0026quot;l\u0026quot;,main=\u0026quot;plot(x,y,type='l')\u0026quot;,col=\u0026quot;green\u0026quot;)\rplot(x,y,type=\u0026quot;b\u0026quot;,main=\u0026quot;plot(x,y,type='b')\u0026quot;)\rplot(x,y,type=\u0026quot;o\u0026quot;,main=\u0026quot;plot(x,y,type='o')\u0026quot;)\rplot(x,y,type=\u0026quot;s\u0026quot;,main=\u0026quot;plot(x,y,type='s')\u0026quot;)\rplot(x,y,type=\u0026quot;h\u0026quot;,main=\u0026quot;plot(x,y,type='h')\u0026quot;)\r figure\r ç¯„ä¾‹2x2\nattach(mtcars)\rpar(mfrow=c(2,2))\rplot(wt,mpg, main=\u0026quot;Scatterplot of wt vs. mpg\u0026quot;)\rplot(wt,disp, main=\u0026quot;Scatterplot of wt vs disp\u0026quot;)\rhist(wt, main=\u0026quot;Histogram of wt\u0026quot;)\rboxplot(wt, main=\u0026quot;Boxplot of wt\u0026quot;)\r figure\r åˆ†æˆä¸‰æ ¼\n# attach(mtcars)\rpar(mfrow=c(1,3)) hist(wt)\rhist(mpg)\rhist(disp)\r figure\r åœ¨consoleåŸ·è¡Œ(èª²å ‚åŸ·è¡Œ)\n åŸ·è¡Œ par() # é¡¯ç¤ºç›®å‰çš„è¨­å®š\rdef.par\u0026lt;-par() # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å°‡ç›®å‰çš„åƒæ•¸å­˜åˆ°def.par\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rdef.par$mfrow\rdef.par2\u0026lt;-par(mfrow=c(1,3)) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å°‡é‚„æ²’æ›´æ”¹ä¹‹å‰çš„åƒæ•¸å­˜åˆ°def.par,åœ¨æœ¬ä¾‹ä¸­å’Œä¹‹å‰çš„def.paræ˜¯ä¸€æ¨£çš„ï¼Œå› ç‚ºä¹‹å‰éƒ½æ²’å‹•åˆ°åƒæ•¸ã€‚\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rdef.par$mfrow\rpar()$mfrow # ç›®å‰çš„è¨­å®š\rpar(def.par) # é‚„åŸ\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;a href=\u0026quot;#restore_par\u0026quot;\u0026gt;è¨»è§£\u0026lt;/a\u0026gt;\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;   ä¸Šé¢çš„ç¨‹å¼ç¢¼ï¼Œx\u0026lt;-par() æœƒæŠŠç›®å‰çš„åƒæ•¸æ‹¿å‡ºå­˜åˆ°è®Šæ•¸xã€‚ å¦‚æœpar() æ”¾äº†åƒæ•¸,æœƒåœ¨è¨­å®šå®Œæ–°åƒæ•¸ä»¥å¾Œï¼Œå‚³å›èˆŠç´€éŒ„(ä¸€å€‹åŸå› æ˜¯,ä¾¿æ–¼ä»¥å¾Œå†é‚„åŸ)ã€‚  â›³  ä½†æ˜¯åœ¨é€™å€‹éç¨‹ä¸­ï¼Œæœ‰äº›åƒæ•¸æ˜¯ç„¡æ³•ä¿®æ”¹çš„ï¼Œå› æ­¤\rpar() # æ²’æœ‰é‡è¨­åŠŸèƒ½,åªæ˜¯é¡¯ç¤ºç›®å‰çš„è¨­å®š\rop \u0026lt;- par(no.readonly = TRUE) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;opç¾åœ¨æ”¾çš„æ˜¯æ‰€æœ‰å¯ä»¥ä¿®æ”¹çš„åƒæ•¸å’Œåƒæ•¸å€¼ã€‚ \u0026lt;code\u0026gt;no.readonly=T\u0026lt;/code\u0026gt;æ˜¯èªªä¸è¦å”¯è®€åƒæ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; par(col.lab=\u0026quot;red\u0026quot;) # è¨­å®š x and y labels ç‚ºç´…è‰²\rhist(mtcars$mpg) # ç•«åœ–\rpar(op) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;å›å¾©åŸä¾†çš„è¨­å®š\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r   \r\rnote:\n mar: the margin size  par(mar) åˆ—å‡ºmargin par(mar=c(1,1,1,1)) æ›´å‹•margin   pch: the plotting symbol (default is open circle) lty: the line type (default is solid line), can be dashed, dotted, etc. lwd: the line width, specified as an integer multiple col: the plotting color, specified as a number, string, or hex code; the colors function gives you a vector of colors by name  par(col.lab=\u0026quot;red\u0026quot;) # red x and y labels   las: the orientation of the axis labels on the plot bg: the background color oma: the outer margin size (default is 0 for all sides) mfrow: number of plots per row, column (plots are filled row-wise) mfcol: number of plots per row, column (plots are filled column-wise)  æ˜¯ä¸æ˜¯æœ‰éœ€è¦å¯«å€‹æ–°å‡½æ•¸ï¼Œç”¨ä¾†é‡è¨­è£ç½®åƒæ•¸ï¼Ÿ ä¸‹é¢é€™å€‹å‡½æ•¸resetPar()åªæ˜¯ç·´ç¿’ç”¨(å‡è¨­æ²’æœ‰par()é‡æ–°è¨­å®šçš„åŠŸèƒ½)ï¼Œç”¨ä¾†å°‡deviceå›å¾©æˆåŸå…ˆçš„è¨­å®šå€¼:\nä¸»è¦çœ‹é€™ä¸€è¡Œ:par(no.readonly = TRUE)ã€‚ æ„æ€æ˜¯èªªï¼Œä¸è¦å‚³å› readonlyçš„è¨­å®šã€‚\nresetPar \u0026lt;- function() {\rdev.new() #é‡æ–°é–‹å§‹ä¸€å€‹è£ç½®\rop \u0026lt;- par(no.readonly = TRUE)#å› ç‚ºæ˜¯æ–°çš„è£ç½®ï¼Œæ‰€ä»¥è£¡é¢çš„è¨­å®šéƒ½æ˜¯é è¨­å€¼âœ”ï¸\rdev.off()# åªæ˜¯æŠŠä¹‹å‰çš„æ–°è£ç½®é—œæ‰\rop # å‚³å›é è¨­å€¼\r}\r# ä½¿ç”¨æ–¹æ³•\rpar(resetPar)\r plot.new()å¸¸ç™¼ç”Ÿçš„éŒ¯èª¤ : figure margins too large\næœ‰å…©å€‹åŸå› ï¼š1 æ˜¯ç•«å¸ƒéå° 2ï¼Œç•¶å‰ç•«å¸ƒçš„ä¸Šä¸‹å·¦å³è·é›¢éå¤§ é€™è£¡çœ‹çœ‹å¦‚ä½•è§£ç¬¬äºŒå€‹ç™¼ç”ŸåŸå› \né»˜èªçš„ç•«å¸ƒçš„é‚Šæ¬¾è·é›¢(margin)çš„é è¨­ç‚ºï¼š\nc(5, 4, 4, 2) + 0.1.\nå°æ‡‰ c(bottom, left, top, right)ï¼Œä¹Ÿå°±æ˜¯é †æ™‚é‡ï¼Œç”±ä¸‹åˆ°å³çµæŸä¸€åœˆã€‚\nop  \u0026lt;/div\u0026gt;\r \r\r\ræ›´å¤šçš„åœ–å½¢æ§åˆ¶: åœ¨æ•£ä½ˆåœ–ä¸­åŠ å…¥boxplot\n# windowsåœ–çš„åº§æ¨™ï¼Œå·¦ä¸‹è§’(0,0)å³ä¸Šè§’(1,1)\rpar(mar=rep(2,4)) #è¨­å®šmargin\rpar(fig=c(0,0.8,0,0.8)) #ğŸ·Xè»¸å¾0åˆ°0.8,Yè»¸ä¹Ÿæ˜¯ã€‚å› æ­¤ï¼Œå·¦ä¸‹(0,0)å³ä¸Š(0.8,0.8) # ğŸ·å·¦ä¸‹(x1,y1)å³ä¸Š(x2,y2) =\u0026gt; c(x1,x2,y1,y2) plot(mtcars$wt, mtcars$mpg, xlab=\u0026quot;Car Weight\u0026quot;,ylab=\u0026quot;Miles Per Gallon\u0026quot;)\rpar(fig=c(0,0.8,0.55,1), new=TRUE) #ğŸ·åŒä¸€å€‹åœ–,å› ç‚ºæ²’æœ‰è¨­å®šdev.new\rboxplot(mtcars$wt, horizontal=TRUE, axes=FALSE)\rpar(fig=c(0.65,1,0,0.8),new=TRUE)\rboxplot(mtcars$mpg, axes=FALSE)\rmtext(\u0026quot;Enhanced Scatterplot\u0026quot;, side=3, outer=TRUE, line=-3)\r figure\r â“ä¸Šä¾‹ä¸­çš„boxplotæ”¹ç‚ºhist() ?æç¤º\r no hint\nRMD ä¸­çš„åœ– ä¸¦æ’é¡¯ç¤ºåœ–å½¢(åƒè€ƒ):\n```{r out.width=c('50%', '50%') , fig.show='hold'}\rboxplot(1:10)\rplot(rnorm(10))\r```\r åŸ·è¡Œçµæœ\r ç–Šåœ– æœ‰äº›ç¹ªåœ–æŒ‡ä»¤çš„é¸é …ï¼Œå¯ä»¥åˆ©ç”¨add=Tã€‚\nğŸ’¥ plotæŒ‡ä»¤ä¸æ”¯æ´add=T\ncurve( dnorm(x,0,1), -5 , 5, lwd=1, lty=1)\rcurve( dnorm(x,0,2), add=TRUE, lwd=2, lty=2)\rcurve( dnorm(x,0,3) , add=TRUE, lwd=3, lty=3)\r# Add the legend\rlegend( \u0026quot;topright\u0026quot;,c(\u0026quot;sigma=1\u0026quot;,\u0026quot;sigma=2\u0026quot;,\u0026quot;sigma=3\u0026quot;) , lwd=1:3, lty=1:3)\r figure\r ç·´ç¿’ â“ç·´ç¿’1 è®“ä¸‹é¢å…©å€‹åœ–é‡ç–Š\nboxplot(mtcars$wt, axes=FALSE)\rboxplot(mtcars$mpg, axes=FALSE)\r æç¤º\r boxplot(mtcars$wt, axes=FALSE)\rpar(new=TRUE) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åœ¨åŒä¸€å€‹è¦–çª—,é–‹æ–°ç•«å¸ƒ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rboxplot(mtcars$mpg, axes=FALSE)\r \nâ“ç·´ç¿’2 è®“disp,mpg çš„histogram ç–Šåœ¨ä¸€èµ·: åˆ©ç”¨add=T\nfigure\n\ræç¤º\r xmax=max(c(disp,mpg))\rxmin=min(c(disp,mpg))\rhist(disp,xlim=c(xmin,xmax))\rhist(mpg,xlim=c(xmin,xmax),add=T)\r \nâ“ç·´ç¿’ æ¸¬è©¦é€™ç¯‡æ–‡ç« æç¤º\r ğŸ˜œ\nlayout() å‡½æ•¸ layout( ) çš„ä½¿ç”¨æ–¹æ³•ç‚º\tlayout(mat) å…¶ä¸­ mat çš„å…ƒç´ ç”¨ä¾†æŒ‡å®šåœ–å½¢è™Ÿç¢¼ã€‚\nä¾‹å¦‚åˆ†æˆ4å€‹æ ¼å­,é †åºç‚ºå·¦å³ä¸Šä¸‹(byrow=TRUE)ï¼Œå‰‡æŒ‡ä»¤ç‚º layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))\n ç¬¬ä¸€å€‹åƒæ•¸æ˜¯ç·¨è™Ÿ ç¬¬äºŒå€‹åƒæ•¸æ˜¯åˆ†å‰²æˆ2x2 å°æ‡‰å¦‚ä¸‹è¡¨     1 1  2 3      # One figure in row 1 and two figures in row 2\r#attach(mtcars)\rlayout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))\rhist(wt)\rhist(mpg)\rhist(disp)\r figure\r #dev.off()\r åœ¨layout()å‡½æ•¸ä¸­ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹åœ–å½¢å¤§å°ï¼Œå…¶åƒæ•¸ ç‚ºï¼š widths= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨column å¯¬åº¦ heights= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨row é«˜åº¦\nnote:Relative widths are specified with numeric values. Absolute widths (in centimetres) are specified with the lcm() function.\nç·´ç¿’:åˆ†çµ„ç•«åœ– sm.density.compare( ) å¯ä»¥è®“æˆ‘å€‘åˆ†çµ„ç•« kernal density ,ä¾‹å¦‚ sm.density.compare(x, factor)å¦‚ä¸‹:\nlibrary(sm)\rattach(mtcars)\r#create value labels cyl.f \u0026lt;- factor(cyl, levels= c(4,6,8),\rlabels = c(\u0026quot;4 cylinder\u0026quot;, \u0026quot;6 cylinder\u0026quot;, \u0026quot;8 cylinder\u0026quot;)) #plot densities sm.density.compare(mpg, cyl, xlab=\u0026quot;Miles Per Gallon\u0026quot;)\rtitle(main=\u0026quot;MPG Distribution by Car Cylinders\u0026quot;)\r#add legend via mouse click\rcolfill\u0026lt;-c(2:(2+length(levels(cyl.f)))) legend(locator(1), levels(cyl.f), fill=colfill)\r#\u0026gt; Error in legend(locator(1), levels(cyl.f), fill = colfill): invalid coordinate lengths\r figure\r ä¸ç”¨å¥—ä»¶ç•«ä¸Šåœ– hint: kernel density å‡½æ•¸:density()æç¤º\r cy.wk\u0026lt;-factor(mtcars$cy)\rby4\u0026lt;-mtcars[cy.wk==\u0026quot;4\u0026quot;,\u0026quot;mpg\u0026quot;]\rby6\u0026lt;-mtcars[cy.wk==\u0026quot;6\u0026quot;,\u0026quot;mpg\u0026quot;]\rby8\u0026lt;-mtcars[cy.wk==\u0026quot;8\u0026quot;,\u0026quot;mpg\u0026quot;]\rplot(density(by4))\rlines(density(by6))\rlines(density(by8))\r æˆ‘æ¸¬äº†ä¸€ä¸‹\nplot(density(by4,adjust=1),ylim=c(0,0.2),xlim=c(0,40),col=\u0026quot;red\u0026quot;)\rlines(density(by6,adjust=2),col=\u0026quot;green\u0026quot;)\rlines(density(by8,adjust=2),col=\u0026quot;blue\u0026quot;)\r \n"},
{"uri": "/blogR//rlang/9_3_plot.html","title": "9.3 ç•«åœ–ç·´ç¿’",
	"tags": [],
	"description": "9_3_Plot",
	"content": "åŠ å…¥æ–‡å­— ç¹ªåœ–å€ä¸­çš„æ–‡å­— å‡½æ•¸ text() åœ¨ç¹ªåœ–å€æ ¹æ“šåº§æ¨™å¡«å…¥å­—ä¸²,ç°¡åŒ–çš„æŒ‡ä»¤å¦‚ä¸‹:\ntext(x, y, labels)\n x and y: æ–‡å­—åº§æ¨™; labels: ä¾‹å¦‚ \u0026quot;a label\u0026quot; pos: ä¸‹å·¦ä¸Šå³ï¼Œ1234 cex: æ”¾å¤§å€æ•¸ï¼Œä¾‹å¦‚ï¼Œ0.65ã€‚\nç¯„ä¾‹ :  d\u0026lt;-head(mtcars)\rplot(d[,'wt'], d[,'mpg'], main=\u0026quot;Milage vs. Car Weight\\n~~~~~~~~~~~~~~~~~~~\u0026quot;,\rxlab=\u0026quot;Weight\u0026quot;, ylab=\u0026quot;Miles/(US) gallon\u0026quot;,\rpch=19, col=\u0026quot;darkgreen\u0026quot;)\rtext(d[,'wt'], d[,'mpg'], row.names(d), cex=1,pos=3,col=\u0026quot;red\u0026quot;) #ğŸ·ğŸ‘pos=3 é»çš„ä¸Šé¢\r figure\r åœ¨marginä¸­å¡«å…¥æ–‡å­— mtext(text, side=3)\n text : ä¾‹å¦‚\u0026quot;a label\u0026quot; side : å“ªä¸€å´ :  é †æ™‚é‡ 1: ä¸‹ 2: å·¦ 3: ä¸Š 4: å³    ç¯„ä¾‹ :\nplot(1:10, 1:10, main=\u0026quot;mtext(...) examples\\n~~~~~~~~~~~\u0026quot;)\rmtext(\u0026quot;Magic function\u0026quot;, side=3)\r figure\r Add mathematical annotation to a plot plot(1:10, 1:10, main=\u0026quot;text(...) examples\\n~~~~~~~~~~~\u0026quot;)\rtext(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y))\rtext(7, 4, expression(bar(x) == sum(frac(x[i], n), i==1, n)))\r figure\r å‡½æ•¸ç•«åœ– æ¯”è¼ƒå‡½æ•¸plot()ã€curve()\n  plot()\nx\u0026lt;-seq(1,10,0.1)\ry\u0026lt;-exp(x)\rx\u0026lt;-y\req = function(x){x*x}\rplot(x,eq(x), type='l')\rplot(eq) #ğŸ·ğŸ‘å…§å®šç¯„åœç‚º0åˆ°1\r   curve()\n  plot()çš„åƒæ•¸å¯ä»¥æ˜¯åªæœ‰ä¸€å€‹åƒæ•¸åº§æ¨™y æˆ–å…©å€‹åƒæ•¸,å¦‚äºŒç‚ºåº§æ¨™(x,y),æˆ–æ˜¯å‡½æ•¸åç¨±ã€‚ğŸ·ğŸ‘é€™æ˜¯ä¸€å€‹åˆ†é…å‡½æ•¸,å¦‚æœé‡åˆ°å‡½æ•¸å°±æœƒå‘¼å«å°æ‡‰çš„å‡½æ•¸ã€‚\n  ğŸ’¡å‡½æ•¸curve()çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯expr,ä¸æ˜¯yåº§æ¨™ã€‚\n  ãŠ™ï¸ å¦‚æœä¸æŒ‡å®šfrom,to,æˆ–è€…xlim,å…§å®šæ˜¯å¾0åˆ°1ã€‚\neq = function(x){x*x}\rcurve(eq, from=1, to=50, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;) # `eq` æ˜¯ä¸€å€‹å‡½æ•¸åç¨±\rcurve(eq, xlim=c(1,50),n=100, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;) #ğŸ·ğŸ‘xlimå¦ä¸€ç¨®æŒ‡æŒ‡å®šé–‹å§‹å’ŒçµæŸçš„æ–¹æ³•,næŒ‡å®šè¦åˆ†å‰²æˆå¹¾å€‹é»\r       â“ è§£é‡‹ç‚ºç”šéº¼ä¸‹é¢éŒ¯èª¤?å¦‚ä½•ä¿®æ­£?\neq = function(x){x*x}\ry\u0026lt;-eq(1:50)\rcurve(y, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)\r#\u0026gt; Error in y(x): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;y\u0026quot;\r   â“ è§£é‡‹ç‚ºç”šéº¼ä¸‹é¢éŒ¯èª¤?å¦‚ä½•ä¿®æ­£?\neq = function(x){x*x}\rz\u0026lt;-1:50\rcurve(eq(z), xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)\r   æç¤º\r  ç¬¬ä¸€å€‹åƒæ•¸å¿…é ˆæ˜¯expr ä¸€æ¨£çš„éŒ¯èª¤å‹æ…‹,å› ç‚ºeq(z)å·²ç¶“è®ŠæˆYåº§æ¨™ã€‚  è§£1:åˆ©ç”¨xname=\u0026quot;z\u0026quot;\neq = function(x){x*x}\rz\u0026lt;-1:50\rcurve(eq(z),xname=\u0026quot;z\u0026quot;, xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;)\r \nplot example æ­£å¸¸\npolyred = curve(dnorm(x), xlim = c(-4,4)) #ğŸ·ğŸ‘åªæœ‰ç·šæ¢\rpolyred #\rå±•é–‹\r#\u0026gt; $x\r#\u0026gt; [1] -4.00 -3.92 -3.84 -3.76 -3.68 -3.60 -3.52 -3.44 -3.36 -3.28 -3.20 -3.12\r#\u0026gt; [13] -3.04 -2.96 -2.88 -2.80 -2.72 -2.64 -2.56 -2.48 -2.40 -2.32 -2.24 -2.16\r#\u0026gt; [25] -2.08 -2.00 -1.92 -1.84 -1.76 -1.68 -1.60 -1.52 -1.44 -1.36 -1.28 -1.20\r#\u0026gt; [37] -1.12 -1.04 -0.96 -0.88 -0.80 -0.72 -0.64 -0.56 -0.48 -0.40 -0.32 -0.24\r#\u0026gt; [49] -0.16 -0.08 0.00 0.08 0.16 0.24 0.32 0.40 0.48 0.56 0.64 0.72\r#\u0026gt; [61] 0.80 0.88 0.96 1.04 1.12 1.20 1.28 1.36 1.44 1.52 1.60 1.68\r#\u0026gt; [73] 1.76 1.84 1.92 2.00 2.08 2.16 2.24 2.32 2.40 2.48 2.56 2.64\r#\u0026gt; [85] 2.72 2.80 2.88 2.96 3.04 3.12 3.20 3.28 3.36 3.44 3.52 3.60\r#\u0026gt; [97] 3.68 3.76 3.84 3.92 4.00\r#\u0026gt; #\u0026gt; $y\r#\u0026gt; [1] 0.0001338302 0.0001837125 0.0002505784 0.0003396012 0.0004573148\r#\u0026gt; [6] 0.0006119019 0.0008135212 0.0010746733 0.0014106023 0.0018397262\r#\u0026gt; [11] 0.0023840882 0.0030698133 0.0039275536 0.0049928992 0.0063067264\r#\u0026gt; [16] 0.0079154516 0.0098711538 0.0122315264 0.0150596163 0.0184233106\r#\u0026gt; [21] 0.0223945303 0.0270480995 0.0324602656 0.0387068561 0.0458610763\r#\u0026gt; [26] 0.0539909665 0.0631565614 0.0734068126 0.0847763613 0.0972822693\r#\u0026gt; [31] 0.1109208347 0.1256646368 0.1414599652 0.1582247904 0.1758474303\r#\u0026gt; [36] 0.1941860550 0.2130691468 0.2322970047 0.2516443411 0.2708639718\r#\u0026gt; [41] 0.2896915528 0.3078512605 0.3250622641 0.3410457886 0.3555325285\r#\u0026gt; [46] 0.3682701403 0.3790305262 0.3876166151 0.3938683616 0.3976677055\r#\u0026gt; [51] 0.3989422804 0.3976677055 0.3938683616 0.3876166151 0.3790305262\r#\u0026gt; [56] 0.3682701403 0.3555325285 0.3410457886 0.3250622641 0.3078512605\r#\u0026gt; [61] 0.2896915528 0.2708639718 0.2516443411 0.2322970047 0.2130691468\r#\u0026gt; [66] 0.1941860550 0.1758474303 0.1582247904 0.1414599652 0.1256646368\r#\u0026gt; [71] 0.1109208347 0.0972822693 0.0847763613 0.0734068126 0.0631565614\r#\u0026gt; [76] 0.0539909665 0.0458610763 0.0387068561 0.0324602656 0.0270480995\r#\u0026gt; [81] 0.0223945303 0.0184233106 0.0150596163 0.0122315264 0.0098711538\r#\u0026gt; [86] 0.0079154516 0.0063067264 0.0049928992 0.0039275536 0.0030698133\r#\u0026gt; [91] 0.0023840882 0.0018397262 0.0014106023 0.0010746733 0.0008135212\r#\u0026gt; [96] 0.0006119019 0.0004573148 0.0003396012 0.0002505784 0.0001837125\r#\u0026gt; [101] 0.0001338302\rpolygon(polyred$x, polyred$y, col = \u0026quot;red\u0026quot;) # ğŸ·ğŸ‘å¡«è‰²åœ¨ä¸€å€‹å°é–‰å€é–“å¡«å…¥é¡è‰²\r figure\r ç·´ç¿’:åƒç…§ä¸Šä¾‹,å‡½æ•¸æ˜¯ \\(f(x)=x^2\\) è¦åœ¨å‡½æ•¸å’ŒXè»¸ä¹‹é–“è‘—è‰² â“ è§£é‡‹ä¸‹é¢å…©å€‹,ç¬¬ä¸€å€‹æ˜¯éŒ¯çš„\n  âŒ é€™ä¸æ˜¯æˆ‘å€‘è¦çš„åœ–\neq = function(x){x*x}\ry\u0026lt;-eq(1:50)\rcurve(eq, 1,50,xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;,lwd=5,col=\u0026quot;yellow\u0026quot;)\rpolygon(1:50,y,lty=2,col=\u0026quot;red\u0026quot;)\r   â­• ä¿®æ­£\neq = function(x){x*x}\ry\u0026lt;-eq(1:50)\rcurve(eq, 1,50,xlab=\u0026quot;x\u0026quot;, ylab=\u0026quot;y\u0026quot;,lwd=5,col=\u0026quot;yellow\u0026quot;)\rpolygon(c(1:50,50),c(y,0),lty=2,col=\u0026quot;red\u0026quot;) #ğŸ·ğŸ‘å¤šåŠ ä¸€å€‹é»è®“ç¹åˆ°y=0çš„ä½ç½®ä¸Š\r ğŸ’¯ ç¬¬ä¸€å€‹é»å’Œæœ€å¾Œä¸€å€‹é»æœƒé€£åœ¨ä¸€èµ·ã€‚ç„¶å¾Œå¡«è‰²ã€‚\n  rug set.seed(3)\rx \u0026lt;- rbeta(150, 3, 25)\r#png(\u0026quot;rug.png\u0026quot;)\rhist(x)\rrug(quantile(x)[2:4], col=2, lwd=2.5) # é è¨­æ˜¯ \u0026quot;0%\u0026quot; \u0026quot;25%\u0026quot; \u0026quot;50%\u0026quot; \u0026quot;75%\u0026quot; \u0026quot;100%\u0026quot;\r figure\r set.seed(3)\rx \u0026lt;- rbeta(150, 3, 25)\r#png(\u0026quot;rug.png\u0026quot;)\rhist(x)\rabline(v= quantile(x)[2:4],lty=\u0026quot;dotted\u0026quot;,col=\u0026quot;red\u0026quot; )\rxpos= quantile(x)[2:4]\rtext(xpos[1],0, \u0026quot;25%\u0026quot;)\rtext(xpos[2],0, \u0026quot;50%\u0026quot;)\rtext(xpos[3],0, \u0026quot;75%\u0026quot;)\r figure\r ç·´ç¿’ åŠƒå‡ºå¸¸æ…‹åˆ†é…\n -4åˆ°4çš„å¯†åº¦,æ©Ÿç‡ qnorm,rnorm  figure\n\ræç¤º\r par(mfrow=c(2,2))\rplot(dnorm,xlim=c(-4,4),n=100,type=\u0026quot;l\u0026quot;)\rplot(pnorm,xlim=c(-4,4),n=100,type=\u0026quot;l\u0026quot;)\rplot(qnorm,xlim=c(0,1),n=100,type=\u0026quot;l\u0026quot;)\rplot(rnorm,xlim=c(-4,4),n=100,type=\u0026quot;p\u0026quot;)\r \nåœ–å½¢å­˜æª” å¯ä»¥åˆ©ç”¨menuå­˜æª”ï¼Œä¾‹å¦‚File -\u0026gt; Save As. ä¹Ÿå¯ä»¥åˆ©ç”¨å‡½æ•¸ï¼š Function Output to   pdf(\u0026quot;mygraph.pdf\u0026quot;) pdf file  win.metafile(\u0026quot;mygraph.wmf\u0026quot;) windows metafile  png(\u0026quot;mygraph.png\u0026quot;) png file  jpeg(\u0026quot;mygraph.jpg\u0026quot;) jpeg file  bmp(\u0026quot;mygraph.bmp\u0026quot;) bmp file  postscript(\u0026quot;mygraph.ps\u0026quot;) postscript file    \n# Give the chart file a name.\rpng(file = \u0026quot;scatterplot_matrices.png\u0026quot;)\r# Plot the matrices between 4 variables giving 12 plots.\r# One variable with 3 others and total 4 variables.\rpairs(~wt+mpg+disp+cyl,data = mtcars,\rmain = \u0026quot;Scatterplot Matrix\u0026quot;)\r# Save the file.\rdev.off()\r"},
{"uri": "/blogR//econometrics/0_prerequest.html","title": "0 å‰ç½®æº–å‚™",
	"tags": [],
	"description": "0_prerequest",
	"content": "éœ€è¦å¥—ä»¶ å¥—ä»¶\ninstall.packages(\u0026quot;wooldridge\u0026quot;)\r# è®€å–stataè³‡æ–™\r# haven,readr,rio\rinstall.packages(\u0026quot;haven\u0026quot;) # å–ä»£å¥—ä»¶ rio,readr\r# more\rinstall.packages(\u0026quot;WDI\u0026quot;)\rinstall.packages(\u0026quot;dplyr\u0026quot;)\rinstall.packages(\u0026quot;ggplot\u0026quot;)\r å…¶ä»–å¥—ä»¶\n æ›¾ç¶“ç”¨éçš„å¥—ä»¶  foreign å¯ä»¥ç”¨ä¾†å°å…¥å¤–éƒ¨è³‡æ–™(havenå°±å¯ä»¥äº†) ä¾‹å¦‚ï¼Œstata çš„è³‡æ–™ dta, SPSS, SAS, Systat, Mini tab(. mtp)ã€‚ åˆ©ç”¨foreignè®€å…¥stata çš„è³‡æ–™æª”ï¼š require(foreign)\raffairs\u0026lt;- read.dta(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/affairs.dta\u0026quot;)\rsave(affairs,file='./resources/affairs.RData')\r æ¸¬è©¦\nrm(affairs)\rload('./resources/affairs.RData')\rhead(affairs)\r    "},
{"uri": "/blogR//econometrics/1_t%E6%AA%A2%E5%AE%9A.html","title": "1.0 tæª¢å®š",
	"tags": ["t-test"],
	"description": "tæª¢å®š",
	"content": "æš«æ™‚ \ntæª¢å®š tæª¢å®š\n å–®ä¸€æ¨£æœ¬ ç¨ç«‹æ¨£æœ¬ é…å°æ¨£æœ¬ åœ¨Rä¸­,é…å°æ¨£æœ¬çš„å¹³å‡æ¯”è¼ƒ å¯ä»¥ç”¨å‡½æ•¸t.test()  t.test(x, y, paired = TRUE, alternative = \u0026quot;two.sided\u0026quot;)\r  x,y: æ•¸å­—å‘é‡ paired: æ˜¯å¦è¨ˆç®—é…å°tæª¢å®š. å°ç«‹å‡è¨­alternative hypothesis.  two.sided (*), greater less.    tæª¢å®š- å–®æ¨£æœ¬ One Sample t-test\rdata: audit$y\rt = -4.2768, df = 240, p-value = 2.739e-05\ralternative hypothesis: true mean is not equal to 0\r95 percent confidence interval:\r-0.1939385 -0.0716217 **èªªæ˜ï¼šmu +/- c.level*(se) è¦‹æ‰‹ç®—ä¾‹ **\rsample estimates:\rmean of x -0.1327801  tæª¢å®š - é…å° Is there any significant changes in the weights of mice after treatment?\n  ç”¢ç”Ÿè³‡æ–™\nbefore \u0026lt;-c(200.1, 190.9, 192.7, 213, 241.4, 196.9, 172.2, 185.5, 205.2, 193.7)\rafter \u0026lt;-c(392.9, 393.2, 345.1, 393, 434, 427.9, 422, 383.9, 392.3, 352.2)\r   æ˜¯å¦æœ‰å·®ç•°\n  æ–¹æ³•1: è³‡æ–™è¢«åˆ†æˆå…©å€‹è³‡æ–™é›†ã€‚\n# Compute t-test\rres \u0026lt;- t.test(before, after, paired = TRUE)\rres\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: before and after\r#\u0026gt; t = -20.883, df = 9, p-value = 6.2e-09\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -215.5581 -173.4219\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; -194.49\r   æ–¹æ³•2:é•·è³‡æ–™\nmy_data \u0026lt;- data.frame( group = rep(c(\u0026quot;before\u0026quot;, \u0026quot;after\u0026quot;), each = 10), weight = c(before, after)\r) # ğŸ·ğŸ‘rep() ä¸­çš„each,è¡¨ç¤ºæ¯å€‹å…ƒç´ é‡è¤‡10æ¬¡,å¦å‰‡å°±æ˜¯b,aé‡è¤‡10æ¬¡ # Compute t-test\rres \u0026lt;- t.test(weight ~ group, data = my_data, paired = TRUE)\rres\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: weight by group\r#\u0026gt; t = 20.883, df = 9, p-value = 6.2e-09\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 173.4219 215.5581\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; 194.49\r     ä¹‹å‰çš„å¹³å‡å°æ–¼ä¹‹å¾Œçš„å¹³å‡\nt.test(weight ~ group, data = my_data, paired = TRUE, alternative = \u0026quot;less\u0026quot;)\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: weight by group\r#\u0026gt; t = 20.883, df = 9, p-value = 1\r#\u0026gt; alternative hypothesis: true difference in means is less than 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -Inf 211.5623\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; 194.49\r   ä¹‹å‰çš„å¹³å‡å¤§æ–¼ä¹‹å¾Œçš„å¹³å‡\nt.test(weight ~ group, data = my_data, paired = TRUE, alternative = \u0026quot;greater\u0026quot;)\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: weight by group\r#\u0026gt; t = 20.883, df = 9, p-value = 3.1e-09\r#\u0026gt; alternative hypothesis: true difference in means is greater than 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 177.4177 Inf\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; 194.49\r   æœ€å¾Œå› ç‚ºé€™å€‹på€¼ 6.210^{-9}, å°æ–¼ significance level alpha = 0.05. å› æ­¤ä¹‹å¾Œé¡¯è‘—ç•°æ–¼ä¹‹å‰ã€‚\nçœ‹ä¸€ä¸‹æª¢å®šçš„çµæœ,ä¾‹å­ä¸­çš„res\nstr(res)\r#\u0026gt; List of 10\r#\u0026gt; $ statistic : Named num 20.9 ğŸ·ğŸ‘the value of the t test statistics\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr \u0026quot;t\u0026quot;\r#\u0026gt; $ parameter : Named num 9 ğŸ·ğŸ‘the degrees of freedom for the t test statistics\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr \u0026quot;df\u0026quot;\r#\u0026gt; $ p.value : num 6.2e-09 ğŸ·ğŸ‘the p-value for the test\r#\u0026gt; $ conf.int : num [1:2] 173 216 ğŸ·ğŸ‘a confidence interval for the mean appropriate to the specified alternative hypothesis.\r#\u0026gt; ..- attr(*, \u0026quot;conf.level\u0026quot;)= num 0.95\r#\u0026gt; $ estimate : Named num 194 ğŸ·ğŸ‘the means of the two groups being compared (in the case of independent t test) or difference in means (in the case of paired t test)\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr \u0026quot;mean of the differences\u0026quot;\r#\u0026gt; $ null.value : Named num 0\r#\u0026gt; ..- attr(*, \u0026quot;names\u0026quot;)= chr \u0026quot;difference in means\u0026quot;\r#\u0026gt; $ stderr : num 9.31\r#\u0026gt; $ alternative: chr \u0026quot;two.sided\u0026quot;\r#\u0026gt; $ method : chr \u0026quot;Paired t-test\u0026quot;\r#\u0026gt; $ data.name : chr \u0026quot;weight by group\u0026quot;\r#\u0026gt; - attr(*, \u0026quot;class\u0026quot;)= chr \u0026quot;htest\u0026quot;\r Preleminary test to check paired t-test assumptions  Assumption 1: Are the two samples paired?   Yes, since the data have been collected from measuring twice the weight of the same mice.   Assumption 2: Is this a large sample?   No, because n \u0026lt; 30. Since the sample size is not large enough (less than 30), we need to check whether the differences of the pairs follow a normal distribution.  â“How to check the normality? Use Shapiro-Wilk normality test as described at: Normality Test in R.\n Null hypothesis: the data are normally distributed Alternative hypothesis: the data are not normally distributed  # è¨ˆç®—å‰å¾Œå·®è·\rd \u0026lt;- with(my_data, weight[group == \u0026quot;before\u0026quot;] - weight[group == \u0026quot;after\u0026quot;])\r# Shapiro-Wilk normality test for the differences\rshapiro.test(d) # =\u0026gt; p-value = 0.6141\r#\u0026gt; #\u0026gt; Shapiro-Wilk normality test\r#\u0026gt; #\u0026gt; data: d\r#\u0026gt; W = 0.94536, p-value = 0.6141\r på€¼\u0026gt; significance level 0.05 å·®ç•°çš„åˆ†é…æ²’æœ‰é¡¯è‘—ç•°æ–¼å¸¸æ…‹åˆ†é…,å› æ­¤å¯ä»¥å‡è¨­æ˜¯å¸¸æ…‹åˆ†é…ã€‚ å¦‚æœä¸æ˜¯å¸¸æ…‹åˆ†é…,å¯ä»¥è€ƒæ…®ä½¿ç”¨non parametric paired two-samples Wilcoxon test.\r\r\rç·´ç¿’ ç·´ç¿’ç›®çš„ : ç†Ÿæ‚‰Rèªè¨€è€Œå·²ã€‚ â“å•é¡Œ: ä¸ç”¨sd(),mean()è¨ˆç®—å¹³å‡å€¼,æ¨™æº–å·®,æ¨™æº–èª¤å·®æç¤º\r ```r?lang=r?class=.source?preclass=\rv.n \u0026lt;- length(Change)\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Change'\rv.mean \u0026lt;- sum(Change)/v.n\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Change'\rv.std \u0026lt;-sqrt(sum((Change-v.mean)^2)/(v.n-1))\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Change'\rv.se \u0026lt;- v.std/sqrt(v.n)\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'v.std'\rrst\u0026lt;-list(v.n,v.mean,v.std,v.se)\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'v.n'\rrst\r#\u0026gt; Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'rst'\r```\r \nâ“åˆ©ç”¨å…¬å¼ è¨ˆç®—é…å°æ¨£æœ¬çš„t-test\nè¨ˆç®—t-test statistisc çš„å…¬å¼:\n$$ t = \\frac{m}{s/\\sqrt{n}} $$\nå…¶ä¸­,\n m çµ„å¹³å‡å·®å€¼ n è³‡æ–™å¤§å° s è³‡æ–™çš„standard deviation  ç·´ç¿’éœ€è¦çš„è³‡æ–™\nSR87\u0026lt;-c(10,1,6,.45,1.25,1.3,1.06,3,8.18,1.67,.98,1,.45, 5.03,8,9,18,.28,7,3.97)\rSR88\u0026lt;-c(3,1,5,.5,1.54,1.5,.8,2,.67,1.17,.51,.5,.61,6.7, 4,7,19,.2,5,3.83)\r æç¤º\r   ç›´æ¥æ‰“å…¥è³‡æ–™( Wooldridge, Table C.3):\nSR87\u0026lt;-c(10,1,6,.45,1.25,1.3,1.06,3,8.18,1.67,.98,1,.45, 5.03,8,9,18,.28,7,3.97)\rSR88\u0026lt;-c(3,1,5,.5,1.54,1.5,.8,2,.67,1.17,.51,.5,.61,6.7, 4,7,19,.2,5,3.83)\r   Calculate Change (the parentheses just display the results):\n(Change \u0026lt;- SR88 - SR87)\r#\u0026gt; [1] -7.00 0.00 -1.00 0.05 0.29 0.20 -0.26 -1.00 -7.51 -0.50 -0.47 -0.50\r#\u0026gt; [13] 0.16 1.67 -4.00 -2.00 1.00 -0.08 -2.00 -0.14\r   Ingredients to CI formula\n(avgCh\u0026lt;- mean(Change)) # Changeçš„å¹³å‡\r#\u0026gt; [1] -1.1545\r(n \u0026lt;- length(Change))\r#\u0026gt; [1] 20\r(sdCh \u0026lt;- sd(Change)) # Changeçš„æ¨™æº–å·®\r#\u0026gt; [1] 2.400639\r(se \u0026lt;- sdCh/sqrt(n)) # æ¨™æº–èª¤\r#\u0026gt; [1] 0.5367992\r(c \u0026lt;- qt(.975, n-1)) #quantile of t dist\r#\u0026gt; [1] 2.093024\r   avgChçš„95%ä¿¡è³´å€é–“\nc( avgCh - c*se, avgCh + c*se )\r#\u0026gt; [1] -2.27803369 -0.03096631\r   t statistic for H0: mu=0:\n(t \u0026lt;- avgCh/se)\r#\u0026gt; [1] -2.150711\r   é©—è­‰\nt.test(SR88,SR87,paired=T)\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: SR88 and SR87\r#\u0026gt; t = -2.1507, df = 19, p-value = 0.04458\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -2.27803369 -0.03096631\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; -1.1545\rt.test(SR87,SR88)\r#\u0026gt; #\u0026gt; Welch Two Sample t-test\r#\u0026gt; #\u0026gt; data: SR87 and SR88\r#\u0026gt; t = 0.82325, df = 37.843, p-value = 0.4155\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -1.684837 3.993837\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x mean of y #\u0026gt; 4.3810 3.2265\r    â“é»‘ç™½äººå£«ï¼Œç”¨åŒä¸€å€‹CVæ‰¾å·¥ä½œã€‚ A data.frame with 241 observations on 3 variables:\nw: =1 if white app. got job offer b: =1 if black app. got job offer y: b - w\naudit\n  çœ‹ä¸€ä¸‹è³‡æ–™\nlibrary(haven) # library(readr)\raudit\u0026lt;-read_dta('../data/audit.dta')\rhead(audit)\r#\u0026gt; # A tibble: 6 x 3\r#\u0026gt; w b y\r#\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 1 1 0\r#\u0026gt; 2 1 1 0\r#\u0026gt; 3 1 1 0\r#\u0026gt; 4 1 1 0\r#\u0026gt; 5 1 1 0\r#\u0026gt; 6 0 0 0\r yæ˜¯å‰å…©å€‹æ¬„ä½ç›¸æ¸›ã€‚ä»¥ç¬¬1ç­†è³‡æ–™ç‚ºä¾‹ï¼Œå…©å€‹éƒ½æ˜¯1ï¼Œæ²’å·®åˆ¥(y=0)ã€‚\n  æç¤º\r   è¨ˆç®—\n# Ingredients to CI formula\r(avgy\u0026lt;- mean(audit$y))\r#\u0026gt; [1] -0.1327801\r(n \u0026lt;- length(audit$y))\r#\u0026gt; [1] 241\r(sdy \u0026lt;- sd(audit$y))\r#\u0026gt; [1] 0.4819709\r(se \u0026lt;- sdy/sqrt(n))\r#\u0026gt; [1] 0.03104648\r(c \u0026lt;- qnorm(.975))\r#\u0026gt; [1] 1.959964\r# 95% Confidence intervall:\ravgy + c * c(-se,+se)\r#\u0026gt; [1] -0.19363006 -0.07193011\r# 99% Confidence intervall:\ravgy + qnorm(.995) * c(-se,+se)\r#\u0026gt; [1] -0.21275051 -0.05280966\r   t statistic for H0: mu=0:\n(t \u0026lt;- avgy/se)\r#\u0026gt; [1] -4.276816\r è‡ªç”±åº¦(d.f.)ç‚º n-1 =240 çš„tåˆ†é…ï¼Œå…¶è‡¨ç•Œå€¼Critical values(å¦‚ä¸‹):\nalpha.one.tailed = c(0.1, 0.05, 0.025, 0.01, 0.005, .001)\rCV \u0026lt;- qt(1 - alpha.one.tailed, n-1)\rcbind(alpha.one.tailed, CV)\r#\u0026gt; alpha.one.tailed CV\r#\u0026gt; [1,] 0.100 1.285089\r#\u0026gt; [2,] 0.050 1.651227\r#\u0026gt; [3,] 0.025 1.969898\r#\u0026gt; [4,] 0.010 2.341985\r#\u0026gt; [5,] 0.005 2.596469\r#\u0026gt; [6,] 0.001 3.124536\r   å‡½æ•¸t.test() H0: y=5, H1:y\u0026gt;5, ä¿¡è³´å€é–“0.99\nt.test(y, mu=5, alternative=\u0026quot;greater\u0026quot;, conf.level=0.99)\r#\u0026gt; Error in t.test(y, mu = 5, alternative = \u0026quot;greater\u0026quot;, conf.level = 0.99): æ‰¾ä¸åˆ°ç‰©ä»¶ 'y'\r   é©—è­‰åˆ©ç”¨å‡½æ•¸t.test()ç®—ï¼š\n# two-sided CI\rt.test(audit$y) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åªæœ‰ä¸€å€‹åƒæ•¸,çœ‹èµ·ä¾†å¾ˆåƒone-sample t-test å’Œ0çš„æ¯”è¼ƒ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; #\u0026gt; One Sample t-test\r#\u0026gt; #\u0026gt; data: audit$y\r#\u0026gt; t = -4.2768, df = 240, p-value = 2.739e-05\r#\u0026gt; alternative hypothesis: true mean is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -0.1939385 -0.0716217\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x #\u0026gt; -0.1327801\r# 1-sided test:\rt.test(audit$y, alternative=\u0026quot;less\u0026quot;)\r#\u0026gt; #\u0026gt; One Sample t-test\r#\u0026gt; #\u0026gt; data: audit$y\r#\u0026gt; t = -4.2768, df = 240, p-value = 1.369e-05\r#\u0026gt; alternative hypothesis: true mean is less than 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -Inf -0.08151529\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x #\u0026gt; -0.1327801\r    tæª¢å®š - ç¨ç«‹æ¨£æœ¬ åˆä½µæ¨™æº–å·®(pooled standard deviation) $$ s_p \\sqrt{\\frac{1}{n_1}+\\frac{1}{n_2}} $$ $$ s_p = \\sqrt{\\frac{(n_1 - 1) \\times s_1^2 + (n_2 - 1) \\times s_2^2}{n_1 + n_2 - 2}} $$\nåˆ©ç”¨ç®¡é“ æº–å‚™ææ–™ éœ€è¦å¥—ä»¶\nif(!reuire(ggpubr)) install.packages(\u0026quot;ggpubr\u0026quot;) \råˆ©ç”¨devtoolså®‰è£\rinstall.packages(\u0026quot;devtools\u0026quot;) devtools::install_github(\u0026quot;kassambara/ggpubr\u0026quot;)\rinstall.packages(\u0026quot;PairedData\u0026quot;) #ğŸ·ğŸ‘Box plots lose the paired information. You can use the function plot.paired() [in pairedData package] to plot paired data (â€œbefore - afterâ€ plot).\r before \u0026lt;-c(200.1, 190.9, 192.7, 213, 241.4, 196.9, 172.2, 185.5, 205.2, 193.7)\rafter \u0026lt;-c(392.9, 393.2, 345.1, 393, 434, 427.9, 422, 383.9, 392.3, 352.2)\rmy_data \u0026lt;- data.frame( group = rep(c(\u0026quot;before\u0026quot;, \u0026quot;after\u0026quot;), each = 10), weight = c(before, after)\r) # ğŸ·ğŸ‘rep() ä¸­çš„each,è¡¨ç¤ºæ¯å€‹å…ƒç´ é‡è¤‡10æ¬¡,å¦å‰‡å°±æ˜¯b,aé‡è¤‡10æ¬¡\rlibrary(\u0026quot;dplyr\u0026quot;)\r# å…ˆè¨ˆç®—å„çµ„çµ±è¨ˆè¼›\rgroup_by(my_data, group) %\u0026gt;%\rsummarise(\rcount = n(),\rmean = mean(weight, na.rm = TRUE),\rsd = sd(weight, na.rm = TRUE)\r)\r#\u0026gt; # A tibble: 2 x 4\r#\u0026gt; group count mean sd\r#\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r#\u0026gt; 1 after 10 394. 29.4\r#\u0026gt; 2 before 10 199. 18.5\r è¦–è¦ºæ¢ç´¢ Visualize your data using box plots\nlibrary(\u0026quot;ggpubr\u0026quot;)\rggboxplot(my_data, x = \u0026quot;group\u0026quot;, y = \u0026quot;weight\u0026quot;, color = \u0026quot;group\u0026quot;, palette = c(\u0026quot;#00AFBB\u0026quot;, \u0026quot;#E7B800\u0026quot;),\rorder = c(\u0026quot;before\u0026quot;, \u0026quot;after\u0026quot;),\rylab = \u0026quot;Weight\u0026quot;, xlab = \u0026quot;Groups\u0026quot;)\r figure\r Plot paired data:\n# å‡è¨­my_dataæ˜¯å¾CSVè®€å…¥,è¦åˆ†çµ„\rbefore \u0026lt;- subset(my_data, group == \u0026quot;before\u0026quot;, weight, drop = TRUE)\rafter \u0026lt;- subset(my_data, group == \u0026quot;after\u0026quot;, weight, drop = TRUE)\r# Plot paired data\rlibrary(PairedData)\rpd \u0026lt;- paired(before, after)\rplot(pd, type = \u0026quot;profile\u0026quot;) + theme_bw() #ğŸ·ğŸ‘theme_bw()é»‘ç™½ä¸»é¡Œ\r figure\r"},
{"uri": "/blogR//econometrics/2_anova.html","title": "2. ANOVA",
	"tags": [],
	"description": "1_anova",
	"content": "anova åƒè€ƒ  repeated measure ANOVA stata more type I II anova vs regression  åœ–https://online.stat.psu.edu/stat415/lesson/13/13.2\r $$ SS(TO)=\\sum\\limits_{i=1}^{m}\\sum\\limits_{j=1}^{n_i} (X_{ij}-\\bar{X}_{..})^2 $$ $$ SS(B)=\\sum\\limits_{i=1}^{m}\\sum\\limits_{j=1}^{n_i} (\\bar{X}_{i.}-\\bar{X}_{..})^2 $$ $$ SS(E)=\\sum\\limits_{i=1}^{m}\\sum\\limits_{j=1}^{n_i} (X_{ij}-\\bar{X}_{i.})^2 $$ $$ SS(TO) = SS(B) +SS(E) $$ SS(B),SS(Between) : Treatment sum of squares\nç¯„ä¾‹ stata . use https://www3.nd.edu/~rwilliam/statafiles/oneway.dta\r(One-Way Analysis of Variance)\r. summarize\rVariable | Obs Mean Std. Dev. Min Max\r-------------+---------------------------------------------------------\rscore | 20 10.35 2.254236 6 14\rprogram | 20 2.5 1.147079 1 4\r\råªæœ‰ANOVAè¡¨\r. oneway score program\rAnalysis of Variance\rSource SS df MS F Prob \u0026gt; F\r------------------------------------------------------------------------\rBetween groups 54.95 3 18.3166667 7.04 0.0031\rWithin groups 41.6 16 2.6\r------------------------------------------------------------------------\rTotal 96.55 19 5.08157895\rBartlett\u0026#39;s test for equal variances: chi2(3) = 0.5685 Prob\u0026gt;chi2 = 0.904\r\rå„çµ„åˆ—è¡¨ï¼ŒANOVAè¡¨\r. oneway score program,t //\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026#34;codenote nopre\u0026#34;\u0026gt;ğŸ·\u0026lt;span class=\u0026#34;tooltiptext\u0026#34; \u0026gt;ğŸ‘é¸é …t: åˆ†çµ„æ¯”å°\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r| Summary of score\rprogram | Mean Std. Dev. Freq.\r------------\u0026#43;------------------------------------\r1 | 11.8 1.9235384 5\r2 | 8.8 1.6431677 5\r3 | 12.2 1.3038405 5\r4 | 8.6 1.5165751 5\r------------\u0026#43;------------------------------------\rTotal | 10.35 2.2542358 20\rAnalysis of Variance\rSource SS df MS F Prob \u0026gt; F\r------------------------------------------------------------------------\rBetween groups 54.95 3 18.3166667 7.04 0.0031\rWithin groups 41.6 16 2.6\r------------------------------------------------------------------------\rTotal 96.55 19 5.08157895\rBartlett\u0026#39;s test for equal variances: chi2(3) = 0.5685 Prob\u0026gt;chi2 = 0.904\r\rå„çµ„åˆ—è¡¨ï¼ŒANOVAè¡¨ï¼Œpaired t test\r. oneway score program, t bon sid sch | Summary of score\rprogram | Mean Std. Dev. Freq.\r------------\u0026#43;------------------------------------\r1 | 11.8 1.9235384 5\r2 | 8.8 1.6431677 5\r3 | 12.2 1.3038405 5\r4 | 8.6 1.5165751 5\r------------\u0026#43;------------------------------------\rTotal | 10.35 2.2542358 20\rAnalysis of Variance\rSource SS df MS F Prob \u0026gt; F\r------------------------------------------------------------------------\rBetween groups 54.95 3 18.3166667 7.04 0.0031\rWithin groups 41.6 16 2.6\r------------------------------------------------------------------------\rTotal 96.55 19 5.08157895\rBartlett\u0026#39;s test for equal variances: chi2(3) = 0.5685 Prob\u0026gt;chi2 = 0.904\rComparison of score by program\r(Bonferroni)\rRow Mean-|\rCol Mean | 1 2 3\r---------\u0026#43;---------------------------------\r2 | -3\r| 0.057\r|\r3 | .4 3.4\r| 1.000 0.025\r|\r4 | -3.2 -.2 -3.6\r| 0.038 1.000 0.017\rComparison of score by program\r(Scheffe)\rRow Mean-|\rCol Mean | 1 2 3\r---------\u0026#43;---------------------------------\r2 | -3\r| 0.068\r|\r3 | .4 3.4\r| 0.984 0.034\r|\r4 | -3.2 -.2 -3.6\r| 0.048 0.998 0.024\rComparison of score by program\r(Sidak)\rRow Mean-|\rCol Mean | 1 2 3\r---------\u0026#43;---------------------------------\r2 | -3\r| 0.056\r|\r3 | .4 3.4\r| 0.999 0.025\r|\r4 | -3.2 -.2 -3.6\r| 0.038 1.000 0.017\r è¡¨ä¸­çš„çš„significant F 7.04 èªªçµ„å¹³å‡ä¸æ˜¯å…¨éƒ¨ç›¸ç­‰,ä¹Ÿå°±æ˜¯è‡³å°‘æœ‰ä¸€å€‹treatment effect ç•°æ–¼0ã€‚\nä¸Šé¢çš„æŒ‡ä»¤\noneway score program\roneway score program,t //ğŸ·ğŸ‘é¸é …t: åˆ†çµ„æ¯”å°\roneway score program, t bon sid sch //ğŸ·ğŸ‘Bonferroni,Scheffe, and Sidak multiple comparison tests å¯ä»¥ç”¨ä¾†åˆ¤å®šé€™å€‹ä¸åŒä¾†è‡ªæ–¼å“ªè£¡(æˆå°æ¯”è¼ƒå„çµ„, J*[J-1]/2 = 6æ¬¡æ¯”è¼ƒ)ã€‚\r Note that these tests tend to be conservative: they reduce the likelihood that you will reject the null when the null is true (i.e. they reduce the likelihood of Type I error.) However, they increase the likelihood of not rejecting the null when the null is false (i.e. they make Type II error more likely.)\r\r\r\ré€™è£¡çœ‹ä¸€ä¸‹pairedwise çš„æ¯”å°çµæœ\r. oneway score program, t bon sid sch | Summary of score #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘ä¾†è‡ªté¸é …\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rprogram | Mean Std. Dev. Freq.\r------------+------------------------------------\r1 | 11.8 1.9235384 5\r2 | 8.8 1.6431677 5\r3 | 12.2 1.3038405 5\r4 | 8.6 1.5165751 5\r------------+------------------------------------\rTotal | 10.35 2.2542358 20\rAnalysis of Variance #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é¸é …: bon sid sch\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rSource SS df MS F Prob \u0026gt; F\r------------------------------------------------------------------------\rBetween groups 54.95 3 18.3166667 7.04 0.0031\rWithin groups 41.6 16 2.6\r------------------------------------------------------------------------\rTotal 96.55 19 5.08157895 #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘Rçš„aov()æ²’æœ‰é€™è¡Œ,åƒè€ƒ\u0026lt;a href=\u0026quot;#addtotal\u0026quot;\u0026gt;ç·´ç¿’\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rBartlett's test for equal variances: chi2(3) = 0.5685 Prob\u0026gt;chi2 = 0.904\rComparison of score by program\r(Bonferroni)\rRow Mean-|\rCol Mean | 1 2 3\r---------+---------------------------------\r2 | -3 \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åƒçœ‹ä¸Šè¡¨å¯ä»¥çŸ¥é“(8.8- 11.8 )\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r| 0.057\r|\r3 | .4 3.4\r| 1.000 0.025\r|\r4 | -3.2 -.2 -3.6\r| 0.038 1.000 0.017\rComparison of score by program\r(Scheffe)\rRow Mean-|\rCol Mean | 1 2 3\r---------+---------------------------------\r2 | -3\r| 0.068\r|\r3 | .4 3.4\r| 0.984 0.034\r|\r4 | -3.2 -.2 -3.6\r| 0.048 0.998 0.024\rComparison of score by program\r(Sidak)\rRow Mean-|\rCol Mean | 1 2 3\r---------+---------------------------------\r2 | -3\r| 0.056\r|\r3 | .4 3.4\r| 0.999 0.025\r|\r4 | -3.2 -.2 -3.6\r| 0.038 1.000 0.017\r ä¸Šé¢çš„å¹¾ç¨®é©—è­‰æ–¹å¼åŸºæœ¬ä¸Šéƒ½åŒæ„ 1 vs 3, 2 vs 4 åƒ…åƒ…æœ‰äº›å¾®å·®ç•°,è€Œ1 vs 4, 2 vs 3, 3 vs 4 æœ‰é¡¯è‘—å·®ç•°; 1 vs 2 å·®é»å°±é¡¯è‘—ã€‚\n\nr å°ç…§ä¸Šé¢çš„stataçµæœ\n  ANOVA\nlibrary(haven)\rurl \u0026lt;- \u0026quot;https://www3.nd.edu/~rwilliam/statafiles/oneway.dta\u0026quot;\rdata.df \u0026lt;- read_dta(url)\rdata.df # \rå±•é–‹\r# A tibble: 20 x 2\rscore program\r\u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r1 9 1\r2 12 1\r3 14 1\r4 11 1\r5 13 1\r6 10 2\r7 6 2\r8 9 2\r9 9 2\r10 10 2\r11 12 3\r12 14 3\r13 11 3\r14 13 3\r15 11 3\r16 9 4\r17 8 4\r18 11 4\r19 7 4\r20 8 4\r \rdata.df$program \u0026lt;-factor(data.df$program) #ğŸ‘º ğŸ·ğŸ‘å¦‚æœæ²’æœ‰é€™å€‹è½‰æ›,ç®—å‡ºä¾†æ˜¯éŒ¯çš„,åˆ©ç”¨str(data)æª¢æŸ¥æ¯å€‹æ¬„ä½çš„å‹æ…‹\rANOVAresults \u0026lt;- aov(score~program,data.df) # ğŸ·ğŸ‘\rsummary(ANOVAresults)\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F) program 3 54.95 18.32 7.045 0.00311 **\rResiduals 16 41.60 2.60 ---\rSignif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r   pairwised t test\npairwise.t.test(data.df$score,data.df$program,p.adjust.method = \u0026quot;bonf\u0026quot;)\rPairwise comparisons using t tests with pooled SD data: data.df$score and data.df$program 1 2 3 2 0.057 - - 3 1.000 0.025 - 4 0.038 1.000 0.017\rP value adjustment method: bonferroni    ä¸Šé¢å‡½æ•¸çš„p.adjust.methodså¯ä»¥ç”±ä¸‹é¢çš„æŒ‡ä»¤çŸ¥é“\np.adjust.methods\r[1] \u0026quot;holm\u0026quot; \u0026quot;hochberg\u0026quot; \u0026quot;hommel\u0026quot; \u0026quot;bonferroni\u0026quot; \u0026quot;BH\u0026quot; [6] \u0026quot;BY\u0026quot; \u0026quot;fdr\u0026quot; \u0026quot;none\u0026quot;    åœ–\nplot(data.df$score~data.df$program)\r figure\r plot(ANOVAresults)\r figure\rfigure\rfigure\rfigure\r\n  â“ç·´ç¿’: åˆ©ç”¨t.test()åšå‡ºå¦‚ä¸Šè¡¨çš„çµæœ,å°±æ˜¯1å°2çµ„,1å°3çµ„,1å°4çµ„åšt-test ğŸ·ğŸ‘åˆ©ç”¨t-test å°æ¯çµ„åš,é€™è£¡åªæ˜¯ç·´ç¿’ç”¨,åœ¨çµ±è¨ˆæ‡‰ç”¨ä¸Šéæ™‚äº†ã€‚æç¤º\r pairwise.t.test(data.df$score, data.df$program, p.adjust.method=\u0026quot;none\u0026quot;, paired=T, pool.sd=FALSE) # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘pool.sd =Fï¼Œå¦å‰‡ç­”æ¡ˆå·®å¾ˆå¤š\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rPairwise comparisons using paired t tests data: data.df$score and data.df$program 1 2 3 2 0.070 - - 3 0.757 0.053 - 4 0.020 0.838 0.033\rP value adjustment method: none t.test(score~program,data=data.df[data.df$program %in% c(1,2),],paired=T)\rPaired t-test\rdata: score by program\rt = 2.4495, df = 4, p-value = 0.07048\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-0.4004369 6.4004369\rsample estimates:\rmean of the differences 3 t.test(score~program,data=data.df[data.df$program %in% c(1,3),],paired=T)\rPaired t-test\rdata: score by program\rt = -0.33104, df = 4, p-value = 0.7572\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-3.754791 2.954791\rsample estimates:\rmean of the differences -0.4 t.test(score~program,data=data.df[data.df$program %in% c(1,4),],paired=T)\rPaired t-test\rdata: score by program\rt = 3.7199, df = 4, p-value = 0.02048\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r0.8116116 5.5883884\rsample estimates:\rmean of the differences 3.2 t.test(score~program,data=data.df[data.df$program %in% c(2,3),],paired=T)\rPaired t-test\rdata: score by program\rt = -2.7222, df = 4, p-value = 0.05287\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-6.86777882 0.06777882\rsample estimates:\rmean of the differences -3.4 t.test(score~program,data=data.df[data.df$program %in% c(2,4),],paired=T)\rPaired t-test\rdata: score by program\rt = 0.21822, df = 4, p-value = 0.8379\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r-2.344654 2.744654\rsample estimates:\rmean of the differences 0.2 t.test(score~program,data=data.df[data.df$program %in% c(3,4),],paired=T)\rPaired t-test\rdata: score by program\rt = 3.2071, df = 4, p-value = 0.03268\ralternative hypothesis: true difference in means is not equal to 0\r95 percent confidence interval:\r0.4834481 6.7165519\rsample estimates:\rmean of the differences 3.6  â“å•é¡Œ:å¦‚ä½•ç”¨è¿´åœˆæ”¹é€²?\n\nâ“å•é¡Œ:â›³  å¦‚ä½•åœ¨çµæœä¸­é¡¯ç¤ºå•è™Ÿé‚£ä¸€è¡Œ?\nDf Sum Sq Mean Sq F value Pr(\u0026gt;F) program 3 54.95 18.32 7.045 0.00311 **\rResiduals 16 41.60 2.60 Total 19 96.55 #â“\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;â“è¦åŠ å…¥é€™è¡Œ\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt; ---\rSignif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r æç¤º\r anova.tab\u0026lt;-function(fm){\rtab\u0026lt;-summary(fm) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é€™æ˜¯ä¸€å€‹é•·åº¦ç‚º1çš„list\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rk\u0026lt;-length(tab[[1]])-2 #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘é•·åº¦ç‚º5(æ¬„ä½æ•¸ç›®),çœ‹ç›¸é—œè¨»è§£\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rtemp\u0026lt;-c(sum(tab[[1]][,1]), sum(tab[[1]][,2]), rep(NA,k)) #\u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æœ‰5å€‹COLUMN,æ‰€ä»¥å¡«æŠŠäº†3å€‹NA\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rtab[[1]][\u0026quot;Total\u0026quot;,]\u0026lt;-temp # \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘åŠ å…¥æ–°çš„ROW\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\rtab\r}\ranova.tab(ANOVAresults)\r ğŸ’¡å¯ä»¥çŸ¥é“\n summary()æ˜¯ä¸€å€‹åˆ†é…å‡½æ•¸,å¯¦éš›åŸ·è¡Œçš„æ˜¯summary.aov(),ç¨‹å¼ç¢¼ä¸­ç”¢ç”Ÿçš„tab  tab: æ˜¯ä¸€å€‹list tab[[1]]: åˆ©ç”¨æŒ‡ä»¤str(tab[[1]]çµæœé¡¯ç¤ºé¡åˆ¥ç‚º â€˜anovaâ€™ and 'data.frame':\t2 obs. of 5 variables: length(tab[[1]]),ç‚º5,å› ç‚ºdata.frame å¯¦éš›ä¸Šä¹Ÿæ˜¯data.frame é¡åˆ¥ã€‚æ‰€ä»¥æ˜¯è®Šæ•¸(æ¬„ä½)å€‹æ•¸ã€‚    \nç¯„ä¾‹ -é‡è¤‡æ¸¬é‡ANOVA é€™å€‹æ¡ˆä¾‹ä¸­,åŒæ¨£ä¸€å€‹å€‹é«”åœ¨ä¸åŒæ™‚é–“æˆ–æƒ…æ³çš„è®Šæ•¸ä¸‹ï¼Œæœ‰è‘—å°æ‡‰çš„æ¸¬é‡å€¼ã€‚(AKA within-subjects ANOVA or ANOVA with repeated measures)\nä¾†æº\nuse http://www.stata-press.com/data/r13/apple\rlist, abbrev(10) sepby(treatment)\rsummarize\ranova weight treatment\rregress\rregress,baselevels\r . use http://www.stata-press.com/data/r13/apple\r(Apple trees)\r. list, abbrev(10) sepby(treatment)\r+--------------------+\r| treatment weight |\r|--------------------|\r1. | 1 117.5 |\r2. | 1 113.8 |\r3. | 1 104.4 |\r|--------------------|\r4. | 2 48.9 |\r5. | 2 50.4 |\r6. | 2 58.9 |\r|--------------------|\r7. | 3 70.4 |\r8. | 3 86.9 |\r|--------------------|\r9. | 4 87.7 |\r10. | 4 67.3 |\r+--------------------+\r. summarize\rVariable | Obs Mean Std. Dev. Min Max\r-------------+---------------------------------------------------------\rtreatment | 10 2.3 1.159502 1 4\rweight | 10 80.62 25.36212 48.9 117.5\r. anova weight treatment\rNumber of obs = 10 R-squared = 0.9147\rRoot MSE = 9.07002 Adj R-squared = 0.8721\rSource | Partial SS df MS F Prob\u0026gt;F\r-----------+----------------------------------------------------\rModel | 5295.5443 3 1765.1814 21.46 0.0013\r|\rtreatment | 5295.5443 3 1765.1814 21.46 0.0013\r|\rResidual | 493.59167 6 82.265278 -----------+----------------------------------------------------\rTotal | 5789.136 9 643.23733 . regress\rSource | SS df MS Number of obs = 10\r-------------+---------------------------------- F(3, 6) = 21.46\rModel | 5295.54433 3 1765.18144 Prob \u0026gt; F = 0.0013\rResidual | 493.591667 6 82.2652778 R-squared = 0.9147\r-------------+---------------------------------- Adj R-squared = 0.8721\rTotal | 5789.136 9 643.237333 Root MSE = 9.07\r------------------------------------------------------------------------------\rweight | Coef. Std. Err. t P\u0026gt;|t| [95% Conf. Interval]\r-------------+----------------------------------------------------------------\rtreatment |\r2 | -59.16667 7.405641 -7.99 0.000 -77.28762 -41.04572\r3 | -33.25 8.279758 -4.02 0.007 -53.50984 -12.99016\r4 | -34.4 8.279758 -4.15 0.006 -54.65984 -14.14016\r|\r_cons | 111.9 5.236579 21.37 0.000 99.08655 124.7134\r------------------------------------------------------------------------------\r. regress,baselevels\rSource | SS df MS Number of obs = 10\r-------------+---------------------------------- F(3, 6) = 21.46\rModel | 5295.54433 3 1765.18144 Prob \u0026gt; F = 0.0013\rResidual | 493.591667 6 82.2652778 R-squared = 0.9147\r-------------+---------------------------------- Adj R-squared = 0.8721\rTotal | 5789.136 9 643.237333 Root MSE = 9.07\r------------------------------------------------------------------------------\rweight | Coef. Std. Err. t P\u0026gt;|t| [95% Conf. Interval]\r-------------+----------------------------------------------------------------\rtreatment |\r1 | 0 (base)\r2 | -59.16667 7.405641 -7.99 0.000 -77.28762 -41.04572\r3 | -33.25 8.279758 -4.02 0.007 -53.50984 -12.99016\r4 | -34.4 8.279758 -4.15 0.006 -54.65984 -14.14016\r|\r_cons | 111.9 5.236579 21.37 0.000 99.08655 124.7134\r------------------------------------------------------------------------------\r  repeated measure  use http://www.stata-press.com/data/r14/t43\rhugocmd expand,hbody(title=è³‡æ–™)\rtabdisp person drug, cellvar(score)\rlist, sepby(person)\r// reshape long drug, i(person) j(dr) //å¯¬è½‰é•·\rhugocmd expand,end\ranova score person drug, repeated(drug)\r . use http://www.stata-press.com/data/r14/t43\r(T4.3 -- Winer, Brown, Michels)\r\rè³‡æ–™\r. tabdisp person drug, cellvar(score)\r----------------------------------\r| drug person | 1 2 3 4\r----------\u0026#43;-----------------------\r1 | 30 28 16 34\r2 | 14 18 10 22\r3 | 24 20 18 30\r4 | 38 34 20 44\r5 | 26 28 14 30\r----------------------------------\r. list, sepby(person)\r\u0026#43;-----------------------\u0026#43;\r| person drug score |\r|-----------------------|\r1. | 1 1 30 |\r2. | 1 2 28 |\r3. | 1 3 16 |\r4. | 1 4 34 |\r|-----------------------|\r5. | 2 1 14 |\r6. | 2 2 18 |\r7. | 2 3 10 |\r8. | 2 4 22 |\r|-----------------------|\r9. | 3 1 24 |\r10. | 3 2 20 |\r11. | 3 3 18 |\r12. | 3 4 30 |\r|-----------------------|\r13. | 4 1 38 |\r14. | 4 2 34 |\r15. | 4 3 20 |\r16. | 4 4 44 |\r|-----------------------|\r17. | 5 1 26 |\r18. | 5 2 28 |\r19. | 5 3 14 |\r20. | 5 4 30 |\r\u0026#43;-----------------------\u0026#43;\r. // reshape long drug, i(person) j(dr) //å¯¬è½‰é•·\r. anova score person drug, repeated(drug)\rNumber of obs = 20 R-squared = 0.9244\rRoot MSE = 3.06594 Adj R-squared = 0.8803\rSource | Partial SS df MS F Prob\u0026gt;F\r-----------+----------------------------------------------------\rModel | 1379 7 197 20.96 0.0000\r|\rperson | 680.8 4 170.2 18.11 0.0001\rdrug | 698.2 3 232.73333 24.76 0.0000\r|\rResidual | 112.8 12 9.4 -----------+----------------------------------------------------\rTotal | 1491.8 19 78.515789 Between-subjects error term: person\rLevels: 5 (4 df)\rLowest b.s.e. variable: person\rRepeated variable: drug\rHuynh-Feldt epsilon = 1.0789\r*Huynh-Feldt epsilon reset to 1.0000\rGreenhouse-Geisser epsilon = 0.6049\rBox's conservative epsilon = 0.3333\r------------ Prob \u0026gt; F ------------\rSource | df F Regular H-F G-G Box\r-----------+----------------------------------------------------\rdrug | 3 24.76 0.0000 0.0000 0.0006 0.0076\rResidual | 12\r----------------------------------------------------------------\r.   reshape  df\u0026lt;-as.data.frame(read_dta(\u0026quot;http://www.stata-press.com/data/r14/t43.dta\u0026quot;)) #ğŸ·ğŸ‘read_dta()è®€é€²ä¾†çš„æ˜¯tibble,ç›´æ¥ä½¿ç”¨reshape()è½‰æ›éƒ½æ˜¯ç©ºå€¼ğŸ¤·â€â™€ï¸\rdfw\u0026lt;-reshape(df, idvar=\u0026quot;person\u0026quot;, timevar = \u0026quot;drug\u0026quot;, v.names=\u0026quot;score\u0026quot;, direction = \u0026quot;wide\u0026quot;)\rdfw\r  person score.1 score.2 score.3 score.4   1 1 30 28 16 34  5 2 14 18 10 22  9 3 24 20 18 30  13 4 38 34 20 44  17 5 26 28 14 30     df$drug\u0026lt;-factor(df$drug)\rdf$person\u0026lt;-factor(df$person)\rm2\u0026lt;-aov(score~drug+Error(person/drug),df) #ğŸ·ğŸ‘åªèƒ½æ˜¯é•·è³‡æ–™\rsummary(m2)\rError: person\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F)\rResiduals 4 680.8 170.2 Error: person:drug\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F) drug 3 698.2 232.7 24.76 1.99e-05 ***\rResiduals 12 112.8 9.4 ---\rSignif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r å°ç…§\nm1\u0026lt;-aov(score~drug,df) summary(m1) # \rå±•é–‹\r Df Sum Sq Mean Sq F value Pr(\u0026gt;F) drug 3 698.2 232.7 4.692 0.0155 *\rResiduals 16 793.6 49.6 ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rm2\u0026lt;-aov(score~drug+Error(person),df)\rsummary(m2) # \rå±•é–‹\rError: person\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F)\rResiduals 4 680.8 170.2 Error: Within\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F) drug 3 698.2 232.7 24.76 1.99e-05 ***\rResiduals 12 112.8 9.4 ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rm3\u0026lt;-aov(score~drug+person,df)\rsummary(m2) # \rå±•é–‹\rError: person\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F)\rResiduals 4 680.8 170.2 Error: Within\rDf Sum Sq Mean Sq F value Pr(\u0026gt;F) drug 3 698.2 232.7 24.76 1.99e-05 ***\rResiduals 12 112.8 9.4 ---\rSignif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r"},
{"uri": "/blogR//econometrics/a_a_%E8%B3%87%E6%96%99%E8%99%95%E7%90%86.html","title": "A.a è³‡æ–™è™•ç†",
	"tags": [],
	"description": "data",
	"content": "éœ€è¦ å¥—ä»¶\ninstall.packages(\u0026quot;wooldridge\u0026quot;)\r# è®€å–stataè³‡æ–™\r# haven,readr,rio\rinstall.packages(\u0026quot;haven\u0026quot;) # å–ä»£å¥—ä»¶ rio,readr\r# more\rinstall.packages(\u0026quot;WDI\u0026quot;)\rinstall.packages(\u0026quot;dplyr\u0026quot;)\rinstall.packages(\u0026quot;ggplot\u0026quot;)\r ç·´ç¿’è³‡æ–™çš„å¹¾ç¨®è¼‰å…¥è³‡æ–™çš„æ–¹æ³• data(affairs, package='wooldridge')\r# Version 2: Adjust path\raffairs2 \u0026lt;- haven::read_dta(\u0026quot;~/data/wooldridge/affairs.dta\u0026quot;)\r# Version 3: Change working directory\rsetwd(\u0026quot;~/data/wooldridge\u0026quot;)\raffairs3 \u0026lt;- haven::read_dta(\u0026quot;affairs.dta\u0026quot;)\r# Version 4: directly load from internet\raffairs4 \u0026lt;- haven::read_dta(\u0026quot;http://fmwww.bc.edu/ec-p/data/wooldridge/affairs.dta\u0026quot;)\r ä»¥å¥—ä»¶è¼‰å…¥ç‚ºä¾‹\ndata(affairs, package='wooldridge')\r# è¨ˆç®—å¹³å‡\rmean(affairs$naffairs)\r#\u0026gt; [1] 1.455907\r ä¸€èˆ¬è³‡æ–™è™•ç† - è®€ã€è½‰ã€ç®—ã€å¯« # Define one x vector for all:\ryear \u0026lt;- c(2008,2009,2010,2011,2012,2013)\r# Define a matrix of y values:\rproduct1\u0026lt;-c(0,3,6,9,7,8); product2\u0026lt;-c(1,2,3,5,9,6); product3\u0026lt;-c(2,4,4,2,3,2)\rsales_mat \u0026lt;- cbind(product1,product2,product3)\rrownames(sales_mat) \u0026lt;- year\r# The matrix looks like this:\rsales_mat\r#\u0026gt; product1 product2 product3\r#\u0026gt; 2008 0 1 2\r#\u0026gt; 2009 3 2 4\r#\u0026gt; 2010 6 3 4\r#\u0026gt; 2011 9 5 2\r#\u0026gt; 2012 7 9 3\r#\u0026gt; 2013 8 6 2\r# Create a data frame and display it:\rsales \u0026lt;- as.data.frame(sales_mat) # ğŸ·ğŸ‘è½‰\rsales\r  product1 product2 product3   2008 0 1 2  2009 3 2 4  2010 6 3 4  2011 9 5 2  2012 7 9 3  2013 8 6 2     colMeans(sales) #ğŸ·ğŸ‘ ç®—: æ¯å€‹è®Šæ•¸çš„å¹³å‡\r#\u0026gt; product1 product2 product3 #\u0026gt; 5.500000 4.333333 2.833333\rsave(sales, file = \u0026quot;data/oursalesdata.RData\u0026quot;) # ğŸ·ğŸ‘å¯«\rrm(sales) #æ¸…é™¤\rexists(\u0026quot;sales\u0026quot;) # å·¥ä½œå€ä¸­æ˜¯å¦ä»ç„¶æœ‰é€™å€‹è®Šæ•¸\r#\u0026gt; [1] FALSE\rload(\u0026quot;data/oursalesdata.RData\u0026quot;) # è¼‰å…¥ä¹‹å‰çš„å·¥ä½œé›†\r basic statistic 1 - pnorm(2,4,3) + pnorm(-2,4,3)\r#\u0026gt; [1] 0.7702576\r# Using the transformation:\rpnorm(2/3) - pnorm(-2/3)\r#\u0026gt; [1] 0.4950149\r# Working directly with the distribution of X:\rpnorm(6,4,3) - pnorm(2,4,3)\r#\u0026gt; [1] 0.4950149\r table # load data set\rdata(affairs, package='wooldridge')\r# Generate \u0026quot;Factors\u0026quot; to attach labels\rhaskids \u0026lt;- factor(affairs$kids,labels=c(\u0026quot;no\u0026quot;,\u0026quot;yes\u0026quot;))\rmlab \u0026lt;- c(\u0026quot;very unhappy\u0026quot;,\u0026quot;unhappy\u0026quot;,\u0026quot;average\u0026quot;,\u0026quot;happy\u0026quot;, \u0026quot;very happy\u0026quot;)\rmarriage \u0026lt;- factor(affairs$ratemarr, labels=mlab)\r# Frequencies for having kids:\rtable(haskids)\r#\u0026gt; haskids\r#\u0026gt; no yes #\u0026gt; 171 430\r# Marriage ratings (share):\rprop.table(table(marriage))\r#\u0026gt; marriage\r#\u0026gt; very unhappy unhappy average happy very happy #\u0026gt; 0.0266223 0.1098170 0.1547421 0.3227953 0.3860233\r# Contigency table: counts (display \u0026amp; store in var.)\r(countstab \u0026lt;- table(marriage,haskids))\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 3 13\r#\u0026gt; unhappy 8 58\r#\u0026gt; average 24 69\r#\u0026gt; happy 40 154\r#\u0026gt; very happy 96 136\r# Share within \u0026quot;marriage\u0026quot; (i.e. within a row):\rprop.table(countstab, margin=1)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.1875000 0.8125000\r#\u0026gt; unhappy 0.1212121 0.8787879\r#\u0026gt; average 0.2580645 0.7419355\r#\u0026gt; happy 0.2061856 0.7938144\r#\u0026gt; very happy 0.4137931 0.5862069\r# Share within \u0026quot;haskids\u0026quot; (i.e. within a column):\rprop.table(countstab, margin=2)\r#\u0026gt; haskids\r#\u0026gt; marriage no yes\r#\u0026gt; very unhappy 0.01754386 0.03023256\r#\u0026gt; unhappy 0.04678363 0.13488372\r#\u0026gt; average 0.14035088 0.16046512\r#\u0026gt; happy 0.23391813 0.35813953\r#\u0026gt; very happy 0.56140351 0.31627907\r ç·´ç¿’ Wdi library(WDI)\rwdi_raw \u0026lt;- WDI(indicator=c(\u0026quot;SP.DYN.LE00.FE.IN\u0026quot;),\rstart = 1960, end = 2014) # ğŸ·WDI æ˜¯ä¸€å€‹å‡½æ•¸,wdi_rawæ˜¯ä¸€å€‹data.frame\r# ä¸è¦ç›´æ¥é¡¯ç¤ºæ‰€æœ‰è³‡æ–™,å¤ªé•·\rhead(wdi_raw,n=10)\r iso2c country SP.DYN.LE00.FE.IN year   ZH Africa Eastern and Southern 63.74479 2014  ZH Africa Eastern and Southern 63.01116 2013  ZH Africa Eastern and Southern 62.19697 2012  ZH Africa Eastern and Southern 61.31294 2011  ZH Africa Eastern and Southern 60.37721 2010  ZH Africa Eastern and Southern 59.40726 2009  ZH Africa Eastern and Southern 58.42882 2008  ZH Africa Eastern and Southern 57.47517 2007  ZH Africa Eastern and Southern 56.57331 2006  ZH Africa Eastern and Southern 55.75485 2005     #tail(wdi_raw)\r descriptive statistics data(ceosal1, package='wooldridge') # class(ceosal1) = data.frame\r# sample average:\rmean(ceosal1$salary)\r#\u0026gt; [1] 1281.12\r# sample median:\rmedian(ceosal1$salary)\r#\u0026gt; [1] 1039\r#standard deviation:\rsd(ceosal1$salary)\r#\u0026gt; [1] 1372.345\r# summary information:\rsummary(ceosal1$salary)\r#\u0026gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #\u0026gt; 223 736 1039 1281 1407 14822\r# correlation with ROE:\rcor(ceosal1$salary, ceosal1$roe)\r#\u0026gt; [1] 0.1148417\r plot basic plot curve(dnorm(x,0,1),-10,10,lwd=1,lty=1)\rcurve(dnorm(x,0,2),-10,10,add=TRUE,lwd=1,lty=1) #ğŸ·ç–Šåœ–\rcurve(dnorm(x,0,3),-10,10,add=TRUE,lwd=1,lty=1)\r figure\r histogram data(ceosal1, package='wooldridge')\r# Extract ROE to single vector\rROE \u0026lt;- ceosal1$roe\r# Subfigure (a): histogram (counts)\rhist(ROE)\r figure\r # Subfigure (b): histogram (densities, explicit breaks)\rhist(ROE, breaks=c(0,5,10,20,30,60) )\r figure\r ggplot2 library(ggplot2)\rhead(mpg)\r#\u0026gt; # A tibble: 6 x 11\r#\u0026gt; manufacturer model displ year cyl trans drv cty hwy fl class #\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; #\u0026gt; 1 audi a4 1.8 1999 4 auto(l5) f 18 29 p compa~\r#\u0026gt; 2 audi a4 1.8 1999 4 manual(m5) f 21 29 p compa~\r#\u0026gt; 3 audi a4 2 2008 4 manual(m6) f 20 31 p compa~\r#\u0026gt; 4 audi a4 2 2008 4 auto(av) f 21 30 p compa~\r#\u0026gt; 5 audi a4 2.8 1999 6 auto(l5) f 16 26 p compa~\r#\u0026gt; 6 audi a4 2.8 1999 6 manual(m5) f 18 26 p compa~\rggplot(mpg, aes(displ, hwy)) + geom_point() +\rgeom_smooth()\r#\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r figure\r"},
{"uri": "/blogR//econometrics/a_b_mpg%E7%82%BA%E4%BE%8B%E7%9A%84ggplot.html","title": "A.b mpgç‚ºä¾‹çš„ggplot",
	"tags": [],
	"description": "mpg",
	"content": "ggplot ex  åƒè€ƒ   library(ggplot2)\rggplot(midwest, aes(x=area, y=poptotal)) + geom_point()\r figure\r ex library(ggplot2)\rex1 \u0026lt;- ggplot(mtcars)\rex1 \u0026lt;- ex1 + aes(x = mpg, y = wt)\rex1 \u0026lt;- ex1 + geom_point()\rsummary(ex1)  #\u0026gt; data: mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb [32x11]\r#\u0026gt; mapping: x = ~mpg, y = ~wt\r#\u0026gt; faceting: \u0026lt;ggproto object: Class FacetNull, Facet, gg\u0026gt;\r#\u0026gt; compute_layout: function\r#\u0026gt; draw_back: function\r#\u0026gt; draw_front: function\r#\u0026gt; draw_labels: function\r#\u0026gt; draw_panels: function\r#\u0026gt; finish_data: function\r#\u0026gt; init_scales: function\r#\u0026gt; map_data: function\r#\u0026gt; params: list\r#\u0026gt; setup_data: function\r#\u0026gt; setup_params: function\r#\u0026gt; shrink: TRUE\r#\u0026gt; train_scales: function\r#\u0026gt; vars: function\r#\u0026gt; super: \u0026lt;ggproto object: Class FacetNull, Facet, gg\u0026gt;\r#\u0026gt; -----------------------------------\r#\u0026gt; geom_point: na.rm = FALSE\r#\u0026gt; stat_identity: na.rm = FALSE\r#\u0026gt; position_identity\r ex1 # ğŸ·é€™è£¡æ‰æœ‰åœ–å‡ºä¾†\r figure\r éƒ¨åˆ†ä¿®æ”¹: åªæ”¹è®Šé¡è‰²\nex1 + geom_point(aes(colour = factor(cyl))) #ğŸ·ç”¨æ±½ç¼¸å€’é¡è‰²\r figure\r éƒ¨åˆ†ä¿®æ”¹: åªæ”¹è®ŠYè»¸\nex1 + geom_point(aes(y = disp))\r figure\r åˆªé™¤\naes(y = NULL)\r #\u0026gt; Aesthetic mapping: #\u0026gt; * `y` -\u0026gt; NULL\r ex1\r figure\r mpg library(ggplot2)\r# First rows of data of data set mpg:\rhead(mpg)\r manufacturer model displ year cyl trans drv cty hwy fl class   audi a4 1.8 1999 4 auto(l5) f 18 29 p compact  audi a4 1.8 1999 4 manual(m5) f 21 29 p compact  audi a4 2.0 2008 4 manual(m6) f 20 31 p compact  audi a4 2.0 2008 4 auto(av) f 21 30 p compact  audi a4 2.8 1999 6 auto(l5) f 16 26 p compact  audi a4 2.8 1999 6 manual(m5) f 18 26 p compact     ggplot() + geom_point( data=mpg, mapping=aes(x=displ, y=hwy) )\r figure\r ggplot(mpg, aes(displ, hwy)) + geom_point() +\rgeom_smooth()\r #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r figure\r ggplot(mpg, aes(displ, hwy)) + geom_point(color=gray(0.5)) +\rgeom_smooth(color=\u0026quot;black\u0026quot;)\r #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r figure\r ggplot(mpg, aes(displ, hwy)) + geom_point( aes(color=class) ) +\rgeom_smooth(color=\u0026quot;black\u0026quot;) +\rscale_color_grey()\r #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r figure\r ggplot(mpg, aes(displ, hwy)) + geom_point( aes(color=class, shape=class) ) +\rgeom_smooth(color=\u0026quot;black\u0026quot;) +\rscale_color_grey() +\rscale_shape_manual(values=1:7)\r #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r figure\r ggplot(mpg, aes(displ, hwy, color=class, shape=class)) + geom_point() +\rgeom_smooth(se=FALSE) +\rscale_color_grey() +\rscale_shape_manual(values=1:7)\r #\u0026gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : span too small. fewer data values than degrees of freedom.\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : pseudoinverse used at 5.6935\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : neighborhood radius 0.5065\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : reciprocal condition number 0\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : There are other near singularities as well. 0.65044\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : pseudoinverse used at 4.008\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : neighborhood radius 0.708\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : reciprocal condition number 0\r #\u0026gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric =\r#\u0026gt; parametric, : There are other near singularities as well. 0.25\r figure\r"},
{"uri": "/blogR//econometrics/lmm.html","title": "lmm",
	"tags": [],
	"description": "lmm",
	"content": " stata R  Formula å¤§è‡´ä¸Šçš„å…¬å¼è¨­å®šå½¢å¼éƒ½æ˜¯ y ~ termsã€‚ è€Œå°æ–¼ linear mixed-effects models, å…¬å¼å‹æ…‹ç‚º $$ y ~ fixed + (random_1|grouping_1) + ... + (random_R|grouping_R) $$, å…¶ä¸­fixed, randomåˆ†åˆ¥åŒ…å« fixed-effects å’Œ random-effects terms.\nWilkinson notation:ã€€å‡è¨­\n DV, y IV, \\( X_j \\), which can be continuous or grouping variables åˆ†çµ„è®Šæ•¸, \\(g_1, g_2, ..., g_R\\),  å‰‡ \\( y \\sim fixed + (random_1|g_1) + ... + (random_R|g_R) \\), å…¶ä¸­fixedå°æ‡‰åˆ° fixed-effects design matrix X, random1 å‰‡æ˜¯ random-effects design matrix Z1 å°æ‡‰åˆ°åˆ†çµ„è®Šæ•¸ g1\nWilkinson notation describes the factors present in models. The notation relates to factors present in models, not to the multipliers (coefficients) of those factors. Wilkinson Notation Factors in Standard Notation   1 Constant (intercept) term  X^k, where k is a positive integer X, X2, ..., Xk  X1 + X2 X1, X2  X1*X2 X1, X2, X1.*X2 (elementwise multiplication of X1 and X2)  X1:X2 X1.*X2 only  - X2 Do not include X2  X1*X2 + X3 X1, X2, X3, X1*X2  X1 + X2 + X3 + X1:X2 X1, X2, X3, X1*X2  X1X2X3 - X1:X2:X3 X1, X2, X3, X1X2, X1X3, X2*X3  X1*(X2 + X3) X1, X2, X3, X1X2, X1X3    \nFormula Description   'y ~ X1 + X2' Fixed effects for the intercept, X1 and X2. This is equivalent to 'y ~ 1 + X1 + X2'.  'y ~ -1 + X1 + X2' No intercept and fixed effects for X1 and X2. The implicit intercept term is suppressed by including -1.  'y ~ 1 + (1 | g1)' Fixed effects for the intercept plus random effect for the intercept for each level of the grouping variable g1.  'y ~ X1 + (1 | g1)' Random intercept model with a fixed slope.  'y ~ X1 + (X1 | g1)' Random intercept and slope, with possible correlation between them. This is equivalent to 'y ~ 1 + X1 + (1 + X1  'y ~ X1 + (1 | g1) + (-1 + X1 | g1)' Independent random effects terms for intercept and slope.  'y ~ 1 + (1 | g1) + (1 | g2) + (1 | g1:g2)' Random intercept model with independent main effects for g1 and g2, plus an independent interaction effect.     R library(dplyr)\r#\u0026gt; #\u0026gt; è¼‰å…¥å¥—ä»¶ï¼š'dplyr'\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:stats':\r#\u0026gt; #\u0026gt; filter, lag\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:base':\r#\u0026gt; #\u0026gt; intersect, setdiff, setequal, union\rn.groups \u0026lt;- 4 # number of groups\rn.repeats \u0026lt;- 2 # samples per group\rgroups \u0026lt;- rep(1:n.groups, each=n.repeats) %\u0026gt;% as.factor\rgroups #\rå±•é–‹\r#\u0026gt; [1] 1 1 2 2 3 3 4 4\r#\u0026gt; Levels: 1 2 3 4\rn \u0026lt;- length(groups)\rz0 \u0026lt;- rnorm(n.groups, 0, 10) (z \u0026lt;- z0[as.numeric(groups)]) # generate and inspect random group effects\r#\u0026gt; [1] -8.05104362 -8.05104362 0.07557837 0.07557837 -1.74865382 -1.74865382\r#\u0026gt; [7] 0.09171603 0.09171603\r epsilon \u0026lt;- rnorm(n,0,1) # generate measurement error\rbeta0 \u0026lt;- 2 # this is the actual parameter of interest! The global mean.\ry \u0026lt;- beta0 + z + epsilon # sample from an LMM\r library(lme4)\r#\u0026gt; è¼‰å…¥éœ€è¦çš„å¥—ä»¶ï¼šMatrix\r# fit a linear model assuming independence\rlm.5 \u0026lt;- lm(y~1) # fit a mixed-model that deals with the group dependence\rlibrary(lme4)\rlme.5 \u0026lt;- lmer(y~1|groups)  The summary of the linear model\nsummary.lm.5 \u0026lt;- summary(lm.5)\rsummary.lm.5\r#\u0026gt; #\u0026gt; Call:\r#\u0026gt; lm(formula = y ~ 1)\r#\u0026gt; #\u0026gt; Residuals:\r#\u0026gt; Min 1Q Median 3Q Max #\u0026gt; -5.351 -2.579 1.389 2.388 4.691 #\u0026gt; #\u0026gt; Coefficients:\r#\u0026gt; Estimate Std. Error t value Pr(\u0026gt;|t|)\r#\u0026gt; (Intercept) -0.5387 1.3134 -0.41 0.694\r#\u0026gt; #\u0026gt; Residual standard error: 3.715 on 7 degrees of freedom\r The summary of the LMM\nsummary.lme.5 \u0026lt;- summary(lme.5)\rsummary.lme.5\r#\u0026gt; Linear mixed model fit by REML ['lmerMod']\r#\u0026gt; Formula: y ~ 1 | groups\r#\u0026gt; #\u0026gt; REML criterion at convergence: 34.1\r#\u0026gt; #\u0026gt; Scaled residuals: #\u0026gt; Min 1Q Median 3Q Max #\u0026gt; -1.0874 -0.3856 -0.1688 0.5091 1.0596 #\u0026gt; #\u0026gt; Random effects:\r#\u0026gt; Groups Name Variance Std.Dev.\r#\u0026gt; groups (Intercept) 14.220 3.771 #\u0026gt; Residual 1.613 1.270 #\u0026gt; Number of obs: 8, groups: groups, 4\r#\u0026gt; #\u0026gt; Fixed effects:\r#\u0026gt; Estimate Std. Error t value\r#\u0026gt; (Intercept) -0.5387 1.9382 -0.278\r ex1  test  d=read.delim(\u0026quot;//Antqueen/d/Academic2/çµ±è¨ˆ/lecture/dnett/s511/SeedlingDryWeight2.txt\u0026quot;)\rstr(d)\r#\u0026gt; 'data.frame':\t56 obs. of 4 variables:\r#\u0026gt; $ Genotype : chr \u0026quot;A\u0026quot; \u0026quot;A\u0026quot; \u0026quot;A\u0026quot; \u0026quot;A\u0026quot; ...\r#\u0026gt; $ Tray : int 1 1 1 1 1 2 2 2 2 2 ...\r#\u0026gt; $ Seedling : int 1 2 3 4 5 1 2 3 4 5 ...\r#\u0026gt; $ SeedlingWeight: int 8 9 11 12 10 17 17 16 15 19 ...\rd #\r \rå±•é–‹\rGenotype Tray Seedling SeedlingWeight   A 1 1 8  A 1 2 9  A 1 3 11  A 1 4 12  A 1 5 10  A 2 1 17  A 2 2 17  A 2 3 16  A 2 4 15  A 2 5 19  A 2 6 18  A 2 7 18  A 2 8 18  A 2 9 24  A 3 1 12  A 3 2 12  A 3 3 16  A 3 4 15  A 3 5 15  A 3 6 14  A 4 1 17  A 4 2 20  A 4 3 20  A 4 4 19  A 4 5 19  A 4 6 18  A 4 7 20  A 4 8 19  A 4 9 19  B 5 1 9  B 5 2 12  B 5 3 13  B 5 4 16  B 5 5 14  B 5 6 14  B 6 1 10  B 6 2 10  B 6 3 9  B 6 4 8  B 6 5 13  B 6 6 9  B 6 7 11  B 7 1 12  B 7 2 16  B 7 3 17  B 7 4 15  B 7 5 15  B 7 6 15  B 8 1 9  B 8 2 6  B 8 3 8  B 8 4 8  B 8 5 13  B 8 6 9  B 8 7 9  B 8 8 10    \r X=cbind(1,d[,1]==\u0026quot;A\u0026quot;,d[,1]==\u0026quot;B\u0026quot;)\rX #ğŸ·ğŸ‘åˆ†åˆ¥å°A,Bç”¢ç”Ÿé¡åˆ¥(å•é¡Œæ˜¯é€™æ¨£è¦æ€éº¼ä¼°è¨ˆ?) #\rå±•é–‹\r#\u0026gt; [,1] [,2] [,3]\r#\u0026gt; [1,] 1 1 0\r#\u0026gt; [2,] 1 1 0\r#\u0026gt; [3,] 1 1 0\r#\u0026gt; [4,] 1 1 0\r#\u0026gt; [5,] 1 1 0\r#\u0026gt; [6,] 1 1 0\r#\u0026gt; [7,] 1 1 0\r#\u0026gt; [8,] 1 1 0\r#\u0026gt; [9,] 1 1 0\r#\u0026gt; [10,] 1 1 0\r#\u0026gt; [11,] 1 1 0\r#\u0026gt; [12,] 1 1 0\r#\u0026gt; [13,] 1 1 0\r#\u0026gt; [14,] 1 1 0\r#\u0026gt; [15,] 1 1 0\r#\u0026gt; [16,] 1 1 0\r#\u0026gt; [17,] 1 1 0\r#\u0026gt; [18,] 1 1 0\r#\u0026gt; [19,] 1 1 0\r#\u0026gt; [20,] 1 1 0\r#\u0026gt; [21,] 1 1 0\r#\u0026gt; [22,] 1 1 0\r#\u0026gt; [23,] 1 1 0\r#\u0026gt; [24,] 1 1 0\r#\u0026gt; [25,] 1 1 0\r#\u0026gt; [26,] 1 1 0\r#\u0026gt; [27,] 1 1 0\r#\u0026gt; [28,] 1 1 0\r#\u0026gt; [29,] 1 1 0\r#\u0026gt; [30,] 1 0 1\r#\u0026gt; [31,] 1 0 1\r#\u0026gt; [32,] 1 0 1\r#\u0026gt; [33,] 1 0 1\r#\u0026gt; [34,] 1 0 1\r#\u0026gt; [35,] 1 0 1\r#\u0026gt; [36,] 1 0 1\r#\u0026gt; [37,] 1 0 1\r#\u0026gt; [38,] 1 0 1\r#\u0026gt; [39,] 1 0 1\r#\u0026gt; [40,] 1 0 1\r#\u0026gt; [41,] 1 0 1\r#\u0026gt; [42,] 1 0 1\r#\u0026gt; [43,] 1 0 1\r#\u0026gt; [44,] 1 0 1\r#\u0026gt; [45,] 1 0 1\r#\u0026gt; [46,] 1 0 1\r#\u0026gt; [47,] 1 0 1\r#\u0026gt; [48,] 1 0 1\r#\u0026gt; [49,] 1 0 1\r#\u0026gt; [50,] 1 0 1\r#\u0026gt; [51,] 1 0 1\r#\u0026gt; [52,] 1 0 1\r#\u0026gt; [53,] 1 0 1\r#\u0026gt; [54,] 1 0 1\r#\u0026gt; [55,] 1 0 1\r#\u0026gt; [56,] 1 0 1\r é€™è£¡ç”¨æœ€å¤§è“‹ä¼¼æ³•(ML)\n#d=read.delim(\u0026quot;//Antqueen/d/Academic2/çµ±è¨ˆ/lecture/dnett/s511/SeedlingDryWeight2.txt\u0026quot;)\rplot(d[,2],d[,4]+rnorm(56,0,.2),\rxlab=\u0026quot;Tray\u0026quot;,ylab=\u0026quot;Seedling Dry Weight\u0026quot;,\rcol=2*(1+(d[,1]==\u0026quot;B\u0026quot;)),pch=\u0026quot;-\u0026quot;,cex=2)\rlegend(\u0026quot;topright\u0026quot;,c(\u0026quot;Genotype A\u0026quot;,\u0026quot;Genotype B\u0026quot;),fill=c(2,4),border=c(2,4))\r figure\r library(nlme)\r#\u0026gt; #\u0026gt; è¼‰å…¥å¥—ä»¶ï¼š'nlme'\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:lme4':\r#\u0026gt; #\u0026gt; lmList\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:dplyr':\r#\u0026gt; #\u0026gt; collapse\rlme(SeedlingWeight~Genotype,random=~1|Tray,method=\u0026quot;ML\u0026quot;,data=d)\r#\u0026gt; Linear mixed-effects model fit by maximum likelihood\r#\u0026gt; Data: d #\u0026gt; Log-likelihood: -126.3709\r#\u0026gt; Fixed: SeedlingWeight ~ Genotype #\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.301832 -3.567017 #\u0026gt; #\u0026gt; Random effects:\r#\u0026gt; Formula: ~1 | Tray\r#\u0026gt; (Intercept) Residual\r#\u0026gt; StdDev: 2.932294 1.88247\r#\u0026gt; #\u0026gt; Number of Observations: 56\r#\u0026gt; Number of Groups: 8\rlibrary(lme4)\rlmer(SeedlingWeight~Genotype+(1|Tray),REML=F,data=d)\r#\u0026gt; Linear mixed model fit by maximum likelihood ['lmerMod']\r#\u0026gt; Formula: SeedlingWeight ~ Genotype + (1 | Tray)\r#\u0026gt; Data: d\r#\u0026gt; AIC BIC logLik deviance df.resid #\u0026gt; 260.7418 268.8432 -126.3709 252.7418 52 #\u0026gt; Random effects:\r#\u0026gt; Groups Name Std.Dev.\r#\u0026gt; Tray (Intercept) 2.932 #\u0026gt; Residual 1.882 #\u0026gt; Number of obs: 56, groups: Tray, 8\r#\u0026gt; Fixed Effects:\r#\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.302 -3.567\r ML VS REML\n#d=read.delim(\u0026quot;//Antqueen/d/Academic2/çµ±è¨ˆ/lecture/dnett/s511/SeedlingDryWeight2.txt\u0026quot;)\rplot(d[,2],d[,4]+rnorm(56,0,.2),\rxlab=\u0026quot;Tray\u0026quot;,ylab=\u0026quot;Seedling Dry Weight\u0026quot;,\rcol=2*(1+(d[,1]==\u0026quot;B\u0026quot;)),pch=\u0026quot;-\u0026quot;,cex=2)\rlegend(\u0026quot;topright\u0026quot;,c(\u0026quot;Genotype A\u0026quot;,\u0026quot;Genotype B\u0026quot;),fill=c(2,4),border=c(2,4))\r figure\r # ML\rlme(SeedlingWeight~Genotype,random=~1|Tray,method=\u0026quot;ML\u0026quot;,data=d)\r#\u0026gt; Linear mixed-effects model fit by maximum likelihood\r#\u0026gt; Data: d #\u0026gt; Log-likelihood: -126.3709\r#\u0026gt; Fixed: SeedlingWeight ~ Genotype #\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.301832 -3.567017 #\u0026gt; #\u0026gt; Random effects:\r#\u0026gt; Formula: ~1 | Tray\r#\u0026gt; (Intercept) Residual\r#\u0026gt; StdDev: 2.932294 1.88247\r#\u0026gt; #\u0026gt; Number of Observations: 56\r#\u0026gt; Number of Groups: 8\rlmer(SeedlingWeight~Genotype+(1|Tray),REML=F,data=d)\r#\u0026gt; Linear mixed model fit by maximum likelihood ['lmerMod']\r#\u0026gt; Formula: SeedlingWeight ~ Genotype + (1 | Tray)\r#\u0026gt; Data: d\r#\u0026gt; AIC BIC logLik deviance df.resid #\u0026gt; 260.7418 268.8432 -126.3709 252.7418 52 #\u0026gt; Random effects:\r#\u0026gt; Groups Name Std.Dev.\r#\u0026gt; Tray (Intercept) 2.932 #\u0026gt; Residual 1.882 #\u0026gt; Number of obs: 56, groups: Tray, 8\r#\u0026gt; Fixed Effects:\r#\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.302 -3.567\r#REML is the default method for estimating variance components.\rlme(SeedlingWeight~Genotype,random=~1|Tray,data=d)\r#\u0026gt; Linear mixed-effects model fit by REML\r#\u0026gt; Data: d #\u0026gt; Log-restricted-likelihood: -123.5705\r#\u0026gt; Fixed: SeedlingWeight ~ Genotype #\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.288838 -3.550201 #\u0026gt; #\u0026gt; Random effects:\r#\u0026gt; Formula: ~1 | Tray\r#\u0026gt; (Intercept) Residual\r#\u0026gt; StdDev: 3.414856 1.88223\r#\u0026gt; #\u0026gt; Number of Observations: 56\r#\u0026gt; Number of Groups: 8\rlmer(SeedlingWeight~Genotype+(1|Tray),data=d)\r#\u0026gt; Linear mixed model fit by REML ['lmerMod']\r#\u0026gt; Formula: SeedlingWeight ~ Genotype + (1 | Tray)\r#\u0026gt; Data: d\r#\u0026gt; REML criterion at convergence: 247.1411\r#\u0026gt; Random effects:\r#\u0026gt; Groups Name Std.Dev.\r#\u0026gt; Tray (Intercept) 3.415 #\u0026gt; Residual 1.882 #\u0026gt; Number of obs: 56, groups: Tray, 8\r#\u0026gt; Fixed Effects:\r#\u0026gt; (Intercept) GenotypeB #\u0026gt; 15.29 -3.55\r"},
{"uri": "/blogR//topic/simulation/2_1_%E9%9A%A8%E6%A9%9F%E8%AE%8A%E6%95%B8.html","title": "2.1 éš¨æ©Ÿè®Šæ•¸",
	"tags": [],
	"description": "éš¨æ©Ÿè®Šæ•¸",
	"content": "5åˆ†é˜  5åˆ†é˜github)   ref  é€†è½‰æ›æŠ½æ¨£(Inverse transform sampling) å¾æŸå€‹CDFçš„é€†å‡½æ•¸\\(F^{-1}(x)\\)ï¼ŒæŠ½å‡ºç¬¦åˆé€™å€‹åˆ†é…çš„äº‚æ•¸ã€‚ . ä¾‹å¦‚æŸå€‹éš¨æ©Ÿè®Šæ•¸\\(X\\)ã€€å…¶ï¼£ï¼¤ï¼¦ is \\(F_X(x) = P(X \\leq x)\\). ç„¶å¾Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨\\(U\\)ã€€(uniformly distributed on \\([0,1]\\). )æŠ½å‡ºéš¨æ©Ÿäº‚æ•¸\\(X\\)ã€‚\n Theorem: If X is a continuous r.v. with CDF \\( F_X(x) \\), then \\( U = F_X(X) \u0018\\sim U(0,1) \\). \rã€inverse methodçš„è­‰æ˜ã€‘\rXæ˜¯éš¨æ©Ÿè®Šæ•¸Uçš„å‡½æ•¸ï¼ŒFæ˜¯é€£çºŒçš„CDFï¼Œ\\(F^{-1}\\)æ˜¯é€†å‡½æ•¸ï¼Œä¸”Uæ˜¯å‡å‹»åˆ†é…çš„RVï¼Œå‰‡\\(F^{-1}(U)\\)éµå¾ªFåˆ†é…\nProof: $$ P(X\u0026lt;x)=P(F^{-1}(U)\u0026lt;x)=P(U\u0026lt;F(x))=F_X(x) $$\n\n æ¼”ç®—æ³• Continuous Distributions å¦‚æœè¦ç”¢ç”Ÿéš¨æ©Ÿè®Šæ•¸æŠ½æ¨£ \\(X\\) å…¶ï¼£ï¼¤ï¼¦ç‚º \\(F_X\\). å‰‡é€†å–æ¨£æ¼”ç®—æ³•ç‚º\n Generate \\(U \\sim \\text{Unif}(0,1)\\) Let \\(X = F_X^{-1}(U)\\).  ä¸Šé¢çš„ \\(X\\) éµå¾ª \\(F_X\\)çš„åˆ†é…ã€‚\né€™å€‹æ¼”ç®—æ³•åœ¨ \\(X\\) æ˜¯exponential éš¨æ©Ÿè®Šæ•¸çš„æ™‚å€™ï¼Œ\\(U \\sim \\text{Unif}(0,1)\\) å–é€†æ˜¯å¾ˆå®¹æ˜“ï¼Œä½†å¦‚æœ \\(X\\)æ˜¯éš¨æ©Ÿè®Šæ•¸ï¼Œå‰‡å–é€†ä¸å¯¦éš›ã€‚\nDiscrete Distributions è‹¥ \\(X\\) é›¢æ•£äº‚æ•¸å‰‡ \\(P(X = x_i) = p_i\\).\n Generate \\(U \\sim \\text{Unif}(0,1)\\) Determine the index \\(k\\) such that \\(\\sum_{j=1}^{k-1} p_j \\leq U \u0026lt; \\sum_{j=1}^k p_j\\), and return \\(X = x_k\\).  Notice that the second step requires a search.\nAssume our random variable \\(X\\) can take on any one of \\(K\\) values with probabilities \\({p_1, \\ldots, p_K}\\). We implement the algorithm below, assuming these probabilities are stored in a vector called p.vec.\n# note: this inefficient implementation is for pedagogical purposes\r# in general, consider using the rmultinom() function\rdiscrete.inv.transform.sample \u0026lt;- function( p.vec ) {\rU \u0026lt;- runif(1)\rif(U \u0026lt;= p.vec[1]){\rreturn(1)\r}\rfor(state in 2:length(p.vec)) {\rif(sum(p.vec[1:(state-1)]) \u0026lt; U \u0026amp;\u0026amp; U \u0026lt;= sum(p.vec[1:state]) ) {\rreturn(state)\r}\r}\r}\r ã€Poissonã€‘é›¢æ•£åˆ†é… \\( f_X (k;Î»)=P({X=k})=\\frac{Î»^k}{k!} e^{-Î»} \\)ã€€\rpoissonæ¡ˆä¾‹\rä¸€å…¬å¸ä¹‹é›»è©±é€šæ•¸å¤§ç´„æ¯å°æ™‚ 20 é€šï¼Œæ±‚åœ¨ 5 åˆ†é˜å…§ä¸€é€šé›»è©±ä¹Ÿæ²’æœ‰çš„æ©Ÿç‡ï¼Ÿ\næ¯å°æ™‚ 20 é€š, è¡¨ç¤ºæ¯åˆ†é˜å¹³å‡ \\(\\lambda =\\frac{1}{3}\\) é€š/åˆ†ã€‚ å› æ­¤åœ¨ 5 åˆ†é˜çš„æ™‚é–“å€é–“ä¸­, å¹³å‡çš„é›»è©±é€šæ•¸ç‚º \\( m=\\lambda T=\\frac{1}{3}\\times 5=\\frac{5}{3}\\)ã€‚\næ‰€ä»¥\\(P(k);\\equiv;P(k,5);=;\\frac{(\\frac{5}{3})^k}{k!} e^{-\\frac{5}{3}},\\quad k=0,1,2,\\cdots\\)\nå› æ­¤æ²’æœ‰ä¸€é€šé›»è©±çš„æ©Ÿç‡ \\(P(0)= e^{-\\frac{5}{3}};\\approx; 0.19 \\)\n\npoisson random numberæ¼”ç®—æ³• å› ç‚º \\( P_{i+1}=P(X=i+1)=\\frac{Î»^{i+1}}{(i+1)!} e^{-Î»}=\\frac{Î»}{i+1}\\frac{Î»^i}{i!}e^{-Î»}=\\frac{Î»}{i+1} p_i \\)\n \\( i=0,p=e^{-Î»},F=p \\) ğŸ·ğŸ‘æ­¤æ™‚çš„Fæ˜¯äº‹ä»¶ä¸ç™¼ç”Ÿçš„æ©Ÿç‡,åœ¨æ­¥é©Ÿ3ç”¨ä¾†æ±ºå®šæ˜¯å¦0è¦è¼¸å‡º \\( U \\sim U(0,1) \\) ç”¢ç”Ÿéš¨æ©Ÿè®Šæ•¸ï¼µ å¦‚æœU\u0026lt;Fï¼Œå‰‡X=i ï¼Œå¦å‰‡åˆ°æ­¥é©Ÿ 4é‡æ–°è¨ˆç®—F) ğŸ·ğŸ‘(ç›®å‰çš„iæ˜¯å¦è¦è¼¸å‡ºï¼Œç”¢ç”Ÿçš„Uå¦‚æœå°æ–¼F,å°±æ¥å— \\( p=Î» \\frac{p}{i+1},F=F+p,i=i+1 \\) ğŸ·ğŸ‘påªæ˜¯å€‹ä¸­é–“å€¼ä¸»è¦é‡æ–°è¨ˆç®—F åˆ°æ­¥é©Ÿ 3  language R:\nlambda \u0026lt;-2.3\ru\u0026lt;-runif(1)\ri=0\rp=exp(-lambda)\rF=p\rwhile (F\u0026lt;=u){\rp=lambda*p/(i+1)\rF=F+p\ri=i+1\r}\rx=i\rcat(x,\u0026quot;\\n\u0026quot;) # ğŸ·ğŸ‘åªæœ‰ä¸€å€‹\r#\u0026gt; 3\r excel,vb\nPublic Function Randpoisson(ByVal lambda As Double) As Double\rDim N As Integer\rDim temp As Double\rtemp = alea() //æ²’æœ‰0,1 çš„uniform\rN = 1\rWhile (temp \u0026gt; Exp(-lambda))\rN = N + 1\rtemp = temp +alea()\rWend\rRandpoisson = N - 1\rEnd Function\r \rè§£èªªä¸Šé¢çš„æ¼”ç®—æ³•\rdpois(),ppois(),rpois()\n# compare with rpois(1,2.3)\rx1\u0026lt;-0:6\rlambda\u0026lt;-2.3\rp=exp(-lambda)\rF[1]=p\rfor(i in x1[-1]){\rp=lambda*p/(i)\rF[i+1]=F[i]+p\r}\ry\u0026lt;-ppois(x1,lambda)\rplot(x1,y,type=\u0026quot;p\u0026quot;)\rlines(x1,F)\r figure\n\r ã€æŒ‡æ•¸åˆ†ä½ˆäº‚æ•¸ã€‘é€™æ˜¯é€†æ–¹æ³• \\( PDF: f(x)=Î» e^{-Î»x} \\)\n\\( CDF: 1-e^{-Î»x} \\) #ğŸ·è¨»è§£ğŸ‘ç”±poisson processçŸ¥é“åœ¨tæ™‚é–“å…§æ²’æœ‰ç™¼ç”Ÿäº‹ä»¶çš„æ©Ÿç‡ç‚º\n\\( R.V. X=-1/Î» lnU \\sim E(Î») \\)\n\\( F(x)=1-e^{-Î»x}=u \\) \\(ã€€x=F^{-1}(u) =-\\frac{ln(1-u)}{Î»} \\)\nâ›³ \rä»¤ W è¡¨ç¤ºåœ¨ Poisson éç¨‹ä¸­ï¼Œç”±é–‹å§‹åˆ°ç¬¬ä¸€æ¬¡äº‹ä»¶ç™¼ç”Ÿçš„æ™‚é–“ï¼ˆé€™æ˜¯ä¸€éš¨æ©Ÿè®Šæ•¸ï¼‰ã€‚ç”±ä¸Šç¯€çŸ¥ $$ P(W\u0026gt;t)=P(åœ¨[0,t]ç„¡äº‹ä»¶ç™¼ç”Ÿ ) \\ =e^{-\\lambda t}, t\u0026gt;0 $$ ä½† \\begin{equation}F_W(t)=P(W\\leq t)=1-P(W\u0026gt;t) =1-e^{-\\lambda t} \\end{equation}\næŠŠtä»£æ›ç‚ºå–®ä½æ™‚é–“(=1),å°±æ˜¯poissonåˆ†é…ã€‚\n\r\rR ç·´ç¿’ Continuous Example: Exponential Distribution è‹¥ \\(Y\\) æ˜¯æŒ‡æ•¸RVå¸¶é€Ÿç‡åƒæ•¸ \\(\\lambda = 2\\). å‰‡PDF \\(p(y) = 2e^{-2y}\\), for \\(y \u0026gt; 0\\). ä¸”CDF: $$F_Y(x) = P(Y\\leq x) = \\int_0^x 2e^{-2y} dy = 1 - e^{-2x}$$\nè§£å¾—CDFé€†å‡½æ•¸ $$F_Y^{-1}(y) = -\\frac{\\ln(1-y)}{2}$$\nUsing our algorithm above, we first generate \\(U \\sim \\text{Unif}(0,1)\\), then set \\(X = F_Y^{-1}(U) = -\\frac{\\ln(1-U)}{2}\\). We do this in the R code below and compare the histogram of our samples with the true density of \\(Y\\).\n# inverse transform sampling\rnum.samples \u0026lt;- 1000\rU \u0026lt;- runif(num.samples)\rX \u0026lt;- -log(1-U)/2\r# plot\rhist(X, freq=F, xlab='X', main='Generating Exponential R.V.')\r#\u0026gt; Warning in if (freq) x$counts else x$density: æ¢ä»¶çš„é•·åº¦ \u0026gt; 1ï¼Œå› æ­¤åªèƒ½ç”¨å…¶ç¬¬ä¸€å…ƒ\r#\u0026gt; ç´ \r#\u0026gt; Warning in if (!freq) \u0026quot;Density\u0026quot; else \u0026quot;Frequency\u0026quot;: æ¢ä»¶çš„é•·åº¦ \u0026gt; 1ï¼Œå› æ­¤åªèƒ½ç”¨å…¶ç¬¬\r#\u0026gt; ä¸€å…ƒç´ \rcurve(dexp(x, rate=2) , 0, 3, lwd=2, xlab = \u0026quot;\u0026quot;, ylab = \u0026quot;\u0026quot;, add = T)\r figure\r Indeed, the plot indicates that our random variables are following the intended distribution.\nDiscrete Example Let's assume we want to simulate a discrete random variable \\(X\\) that follows the following distribution:\n   x_i P(X=x_i)     1 0.1   2 0.4   3 0.2   4 0.3    Below we simulate from this distribution using the discrete.inv.transform.sample() function above, and plot both the true probability vector, and the empirical proportions from our simulation.\nnum.samples \u0026lt;- 1000\rp.vec \u0026lt;- c(0.1, 0.4, 0.2, 0.3)\rnames(p.vec) \u0026lt;- 1:4\rsamples \u0026lt;- numeric(num.samples)\rfor(i in seq_len(num.samples) ) {\rsamples[i] \u0026lt;- discrete.inv.transform.sample(p.vec)\r}\rbarplot(p.vec, main='True Probability Mass Function')\r figure\r barplot(table(samples), main='Empirical Probability Mass Function')\r figure\r Again, the plot supports our claim that we are drawing from the true probability distribution\n"},
{"uri": "/blogR//topic/simulation/2_1_%E4%BA%82%E6%95%B8%E5%87%BD%E6%95%B8%E7%B7%B4%E7%BF%92.html","title": "2.1.1 äº‚æ•¸å‡½æ•¸ç·´ç¿’",
	"tags": [],
	"description": "2_1_äº‚æ•¸å‡½æ•¸ç·´ç¿’",
	"content": "Rçš„äº‚æ•¸å‡½æ•¸  å‡å‹»åˆ†é…æŠ½æ¨£   æ¨™æº–å‡å‹»äº‚æ•¸\n  runif(n, min = 0, max = 1)\n  0åˆ°100çš„å‡å‹»åˆ†é…\n  runif(100, min = 0, max = 100)\nRandomNumbers \u0026lt;- runif(10000, min = 0, max = 100)\rhist(RandomNumbers)\r figure\r    å¸¸æ…‹åˆ†é…äº‚æ•¸   rnorm(n, mean = 0, sd = 1)\nnormalSample \u0026lt;- rnorm(10000, mean = 100, sd = 50)\rhist(normalSample)\r figure\r     Simulating a coin toss æ“²ç¡¬å¹£10æ¬¡,5H:5T,4H:6Tçš„æ©Ÿç‡æ˜¯å¤šå°‘?\nallHeads \u0026lt;- c()\rfor (i in 1:10000) {\rtotalHeads \u0026lt;- sum(round(runif(10, min = 0, max = 1)))\rallHeads \u0026lt;- c(allHeads,totalHeads)\r}\rx\u0026lt;-hist(allHeads) #ğŸ·ğŸ‘å¦‚æœè¦probability density functionå‰‡ hist(allHeads,âœ”freq=FALSE)\r figure\r x #ğŸ·ğŸ‘å¦‚æœåªè¦åœ–å½¢,ä¸ç”¨æŒ‡æ´¾çµ¦è®Šæ•¸x,å°±æ˜¯èªªåªè¦âœ”hist(allHeads)\r#\u0026gt; $breaks\r#\u0026gt; [1] 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0\r#\u0026gt; [16] 7.5 8.0 8.5 9.0 9.5 10.0\r#\u0026gt; #\u0026gt; $counts\r#\u0026gt; [1] 8 98 0 478 0 1154 0 1997 0 2467 0 2047 0 1189 0\r#\u0026gt; [16] 436 0 120 0 6\r#\u0026gt; #\u0026gt; $density\r#\u0026gt; [1] 0.0016 0.0196 0.0000 0.0956 0.0000 0.2308 0.0000 0.3994 0.0000 0.4934\r#\u0026gt; [11] 0.0000 0.4094 0.0000 0.2378 0.0000 0.0872 0.0000 0.0240 0.0000 0.0012\r#\u0026gt; #\u0026gt; $mids\r#\u0026gt; [1] 0.25 0.75 1.25 1.75 2.25 2.75 3.25 3.75 4.25 4.75 5.25 5.75 6.25 6.75 7.25\r#\u0026gt; [16] 7.75 8.25 8.75 9.25 9.75\r#\u0026gt; #\u0026gt; $xname\r#\u0026gt; [1] \u0026quot;allHeads\u0026quot;\r#\u0026gt; #\u0026gt; $equidist\r#\u0026gt; [1] TRUE\r#\u0026gt; #\u0026gt; attr(,\u0026quot;class\u0026quot;)\r#\u0026gt; [1] \u0026quot;histogram\u0026quot;\r ä¸Šåœ–æ˜¯10æ¬¡ä¸­å‡ºç¾Hçš„0,1,2..æ¬¡æ•¸ã€‚\nround(0.1)\r#\u0026gt; [1] 0\rround(0.6)\r#\u0026gt; [1] 1\r \r\rä½†æ˜¯ç‚ºç”šéº¼æŸ±ç‹€ä¹‹é–“æœ‰ç©ºæ ¼?æç¤º\r #\u0026gt; $breaks \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘0åˆ°10ä¸­çš„åˆ†å‰²é»\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 10.0\r#\u0026gt; #\u0026gt; $counts \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ¯å€‹åˆ†å‰²çš„Hå€‹æ•¸\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] 12 104 0 464 0 1163 0 2005 0 2443 0 2045 0 1207 0 449 0 102 0 6\r#\u0026gt; #\u0026gt; $density \u0026lt;!--html_preserve--\u0026gt;\u0026lt;span class=\u0026quot;codenote nopre\u0026quot;\u0026gt;ğŸ·\u0026lt;span class=\u0026quot;tooltiptext\u0026quot; \u0026gt;ğŸ‘æ¯å€‹BINçš„å¯†åº¦\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;!--/html_preserve--\u0026gt;\r#\u0026gt; [1] 0.0024 0.0208 0.0000 0.0928 0.0000 0.2326 0.0000 0.4010 0.0000 0.4886 0.0000 0.4090 0.0000 0.2414 0.0000 0.0898 0.0000 0.0204 0.0000 0.0012\r å› ç‚ºè¼¸å‡ºç‚ºæ•´æ•¸,è€Œåˆ†éš”ä»¥0.5ç‚ºå–®ä½,å°è‡´æœ‰äº›åœ°æ–¹æ²’æœ‰è³‡æ–™=0ã€‚\n ä¿®æ­£åœ–ä¸­ä¸æ‡‰è©²æœ‰çš„ç©ºç™½é–“éš™ã€‚\nhist(allHeads, freq = FALSE, breaks = 11) #ğŸ·ğŸ‘è‡ªè¡ŒæŒ‡å®šåˆ†å‰²é»\r figure\r ç”¢ç”Ÿæœ‰éºå¤±å€¼(missing data)çš„è³‡æ–™ set.seed(11991) # Set seed\rN \u0026lt;- 1000 # Sample size\rx_num \u0026lt;- round(rnorm(N, 0, 5)) # Numeric\rx_fac \u0026lt;- as.factor(round(runif(N, 0, 3))) # Factor\rx_cha \u0026lt;- sample(letters, N, replace = TRUE) # Character\rx_num[rbinom(N, 1, 0.2) == 1] \u0026lt;- NA # 20% missings\rx_fac[rbinom(N, 1, 0.3) == 1] \u0026lt;- NA # 30% missings\rx_cha[rbinom(N, 1, 0.05) == 1] \u0026lt;- NA # 5% missings\rdata \u0026lt;- data.frame(x_num, x_fac, x_cha, # Create data frame\rstringsAsFactors = FALSE)\rhead(data)  x_num x_fac x_cha   8 2 p  0 NA a  -4 2 j  NA 1 x  -6 1 s  -3 NA k    "},
{"uri": "/blogR//topic/simulation/4_01_sim.html","title": "4.1 æ¨¡æ“¬åŸºæœ¬ 1",
	"tags": [],
	"description": "4_01_sim",
	"content": "t-test tæª¢å®šã€‚\n å–®ä¸€æ¨£æœ¬ ç¨ç«‹æ¨£æœ¬ é…å°æ¨£æœ¬  Simulating a one-sample t-test å–®æ¨£æœ¬t-testç”¨ä¾†çœ‹æŸå€‹æ¨£æœ¬å¹³å‡æ˜¯å¦é¡¯è‘—ç•°æ–¼æ¯é«”å¹³å‡ã€‚ å¦‚æœä¸€å€‹ç­ç´šæœ‰10å€‹å­¸ç”Ÿé¤èˆ‡T/Fè€ƒè©¦,ç¾åœ¨\ntestScores \u0026lt;- rnorm(10, mean = 50, sd = 20)\rtestScores[testScores \u0026gt; 100] \u0026lt;- 100 #ğŸ·ğŸ‘ä½†æ˜¯ç¾åœ¨å•é¡Œæ˜¯å¸¸æ…‹åˆ†é…æŠ½åˆ°çš„å¯èƒ½å°æ–¼0,ä¹Ÿå¯èƒ½å¤§æ–¼100ã€‚ä¿®æ­£æ–¹æ³•æ˜¯\u0026gt;100çš„è¨­å®šç‚º100,å°æ–¼0çš„è¨­å®šç‚º0ã€‚\rtestScores[testScores \u0026lt; 0] \u0026lt;- 0\rmean(testScores) #ğŸ·ğŸ‘çœ‹ä¸€ä¸‹é€™æ¬¡æŠ½æ¨£çš„å¹³å‡\r#\u0026gt; [1] 43.3123\rt.test(testScores,mu=50) #ğŸ·ğŸ‘one-sample t-test\r#\u0026gt; #\u0026gt; One Sample t-test\r#\u0026gt; #\u0026gt; data: testScores\r#\u0026gt; t = -0.90415, df = 9, p-value = 0.3895\r#\u0026gt; alternative hypothesis: true mean is not equal to 50\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 26.57984 60.04476\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x #\u0026gt; 43.3123\r testScores \u0026lt;- rnorm(10, mean = 80, sd = 20)\rtestScores[testScores \u0026gt; 100] \u0026lt;- 100\rtestScores[testScores \u0026lt; 0] \u0026lt;- 0\rt.test(testScores, mu = 50)\r#\u0026gt; #\u0026gt; One Sample t-test\r#\u0026gt; #\u0026gt; data: testScores\r#\u0026gt; t = 5.1905, df = 9, p-value = 0.0005713\r#\u0026gt; alternative hypothesis: true mean is not equal to 50\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 66.40485 91.75050\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x #\u0026gt; 79.07768\r ç¨ç«‹æ¨£æœ¬çš„t-test(independent samples t-test - two groups, between-subjects Alcohol \u0026lt;- rnorm(20, mean = 250, sd = 100)\rControl \u0026lt;- rnorm(20, mean = 150, sd = 100)\rAlcohol[Alcohol \u0026lt; 0] \u0026lt;- 0\rControl[Control \u0026lt; 0] \u0026lt;- 0\rt.test(Alcohol,Control)\r#\u0026gt; #\u0026gt; Welch Two Sample t-test\r#\u0026gt; #\u0026gt; data: Alcohol and Control\r#\u0026gt; t = 4.2856, df = 37.743, p-value = 0.0001211\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 68.71219 191.79599\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x mean of y #\u0026gt; 267.5791 137.3250\r åœ¨Rä¸­çš„tæª¢å®š,ä½¿ç”¨çš„æ˜¯ Welch Two Sample t-testã€‚å¦‚æœè¦å¾—åˆ°åƒæ˜¯EXCEL,SPSSçš„é¡ä¼¼æ•¸å€¼,å¯ä»¥\nt.test(Alcohol,Control, var.equal = TRUE)\r#\u0026gt; #\u0026gt; Two Sample t-test\r#\u0026gt; #\u0026gt; data: Alcohol and Control\r#\u0026gt; t = 4.2856, df = 38, p-value = 0.0001199\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; 68.72594 191.78223\r#\u0026gt; sample estimates:\r#\u0026gt; mean of x mean of y #\u0026gt; 267.5791 137.3250\r æˆå°æ¨£æœ¬(paired samples)çš„tæª¢å®št-test (two conditions, within-subjects) day1\u0026lt;-rnorm(20, mean = 20, sd = 5)\rday2\u0026lt;-rnorm(20, mean = 30, sd = 5)\rday1[day1\u0026lt;0]\u0026lt;-0\rday2[day2\u0026lt;0]\u0026lt;-0\rmean(day1)\r#\u0026gt; [1] 21.3291\rmean(day2)\r#\u0026gt; [1] 29.52225\rt.test(day1, day2, var.equal=TRUE, paired=TRUE)\r#\u0026gt; #\u0026gt; Paired t-test\r#\u0026gt; #\u0026gt; data: day1 and day2\r#\u0026gt; t = -4.7153, df = 19, p-value = 0.0001506\r#\u0026gt; alternative hypothesis: true difference in means is not equal to 0\r#\u0026gt; 95 percent confidence interval:\r#\u0026gt; -11.829904 -4.556394\r#\u0026gt; sample estimates:\r#\u0026gt; mean of the differences #\u0026gt; -8.193149\r Finally, compute the paired-samples t-test using the t.test function. This will be the same as before, except the option for a paired test will be set to TRUE.\nGenerality of the t-test examples The above examples illustrate specific cases of simulating and analyzing data for one-sample, independent sample, and paired-sample t-tests. The code can be extended to simulate data for any kind of experiment or set of data that should be analyzed by these tests. The only changes that need to be made are the names of the variables, and the predictions for the number of subjects, and means, standard deviations, or other parameters of the sampling distribution chosen to model the data.\nFormatting data in R for more complex designs ç”¢ç”Ÿç”¨ä¾†åˆ†æå€‹é«”ä¹‹é–“ã€ä¹‹å…§çš„(between,within subject) å–®/å¤š å› å­è¨­è¨ˆ(single/multi factor design) è·‘ANOVAåˆ©ç”¨çš„å‡½æ•¸æ˜¯aov()ã€‚é€™å€‹å‡½æ•¸éœ€è¦è³‡æ–™æ•´ç†æˆlong-formatçš„å‹æ…‹(åœ¨Rä¸­,ä½¿ç”¨data farme) )\n\rå±•é–‹\rğŸ¶Experimental designs involve manipulations and measurements. The manipulations are described by independent variables, and the measurements refer to dependent variables. Every independent variable has at least two levels, and possibly many more. In balanced designs there is one measurement (DV) for each of the levels of the independent variables. Thus, in order to represent the results of an experiment, it is necessary to organize the data so that the measurement for each level of each independent variable can be identified. Data is typically organized either in wide or long-format. å¯¦é©—è¨­è¨ˆåŒ…å«è™•ç†å’Œæ¸¬é‡(manipulations and measurements)ã€‚è™•ç†å°±æ˜¯IV,æ¸¬é‡å°±æ˜¯DVã€‚æ¯å€‹IVå¯èƒ½è‡³å°‘æœ‰2å€‹åˆ°å¤šå€‹levelã€‚åœ¨balanced designs ä¸­,IVä¸­çš„æ¯å€‹LEVELæœ‰ä¸€å€‹æ¸¬é‡(DV)ã€‚ é…åˆä¸Šè¿°çš„å¯¦é©—çµæœ,è³‡æ–™ç´€éŒ„çš„æ–¹å¼æœ‰å¯¬(wide)å’Œé•·(long)å…©ç¨®æ ¼å¼ã€‚ å¯¬è³‡æ–™ Subjects L1 L2 L3   1 5 5 10  2 7 6 10  3 10 8 10  4 9 10 9  5 9 6 8     é•·è³‡æ–™ Subjects IV DV   1 L1 5  2 L1 7  3 L1 10  4 L1 9  5 L1 9  1 L2 5  2 L2 6  3 L2 8  4 L2 10  5 L2 6  1 L3 10  2 L3 10  3 L3 6  4 L3 9  5 L3 8     é•·å¯¬è³‡æ–™æŒ‡çš„æ˜¯å€‹é«”è™Ÿç¢¼æ˜¯å¦æœ‰é‡è¤‡ã€‚\nç”¢ç”Ÿçš„è³‡æ–™å¤§æ¦‚è€ƒæ…®å¾Œå¹¾é»(é€™è£¡ç”¨çš„éƒ½æ˜¯é•·è³‡æ–™)\n å€‹é«”æœ‰å¹¾å€‹ æ¯å€‹IVçš„level DVçš„è§€å¯Ÿå€¼å€‹æ•¸  Single Factor ANOVAs: Data-Simulation and Analysis Simulating data for a one-way within subjects ANOVA with 3 levels æ‰“å­—é€Ÿåº¦æ˜¯å¦éš¨è‘—æ•™å­¸æ™‚é–“è€Œè®ŠåŒ–ã€‚20å€‹å—æ¸¬è€…,DVæ˜¯æ¯åˆ†é˜çš„å­—æ•¸ã€‚IVæ˜¯ç¬¬1,2,3å¤©3å€‹LEVELã€‚\nç”¢ç”Ÿæ¨¡æ“¬è³‡æ–™\n  ç”¢ç”ŸDV,å‘½åç‚ºWPM,è¡¨ç¤ºç¬¬ä¸€ã€äºŒã€ä¸‰å¤©çš„æ‰“å­—é€Ÿåº¦:\nday1 \u0026lt;- rnorm(20, mean = 20, sd = 5)\rday2 \u0026lt;- rnorm(20, mean = 30, sd = 5)\rday3 \u0026lt;- rnorm(20, mean = 40, sd = 5)\rday1[day1 \u0026lt; 0] \u0026lt;- 0 #ğŸ·ğŸ‘è®“è² æ•¸æˆç‚º0\rday2[day2 \u0026lt; 0] \u0026lt;- 0\rday3[day3 \u0026lt; 0] \u0026lt;- 0\rWPM \u0026lt;- c(day1,day2,day3)\r   subjectsä»£è¡¨å€‹é«”(å› å­)\nSubjects \u0026lt;- c(seq(1,20), seq(1,20), seq(1,20)) #ğŸ·ğŸ‘ ä¹Ÿå¯ä»¥åˆ©ç”¨seq()å‡½æ•¸: Subjects\u0026lt;-rep(seq(1,20),3)\rSubjects\u0026lt;-factor(Subjects) #ğŸ·ğŸ‘å› ç‚ºè¦é€²è¡ŒANOVA,æ‰€ä»¥å€‹é«”è®Šæ•¸å¿…é ˆæ˜¯å› å­(åœ¨Rä¸­çš„å°æ‡‰ç‚ºfactor é¡åˆ¥)\r   ç›®å‰æœ‰WPM(DV) å’ŒSubjects(subject factor),é‚„å°‘äº†ä¸€å€‹IVä»£è¡¨ç·´ç¿’çš„level(1å¤©,2å¤©,3å¤©),é€™è£¡ç”¨è®Šæ•¸Practiceä»£è¡¨\nPractice \u0026lt;- c(rep(\u0026quot;day1\u0026quot;,20), rep(\u0026quot;day2\u0026quot;,20), rep(\u0026quot;day3\u0026quot;,20))\r   æ•´åˆä¸Šé¢ä¸‰å€‹è®Šæ•¸ç‚ºdata.frame,ç„¶å¾Œå‘½åç‚ºAllData\n ç¬¬1å€‹æ¬„ä½æ˜¯å€‹é«”è®Šæ•¸(1-20è™Ÿ) ç¬¬2å€‹æ¬„ä½æ˜¯The second column should show the Practice variable, with the names of each of the levels repeated 20 times each, and the ç¬¬3ç¬¬3å€‹æ¬„ä½æ˜¯æ¯åˆ†é˜æ‰“å­—å€‹æ•¸ã€‚  AllData\u0026lt;-data.frame(WPM,Subjects,Practice)\rAllData #\r \rå±•é–‹\rWPM Subjects Practice   17.53071 1 day1  21.43697 2 day1  31.52852 3 day1  20.25248 4 day1  19.50004 5 day1  13.44917 6 day1  26.39973 7 day1  18.26791 8 day1  12.53538 9 day1  24.16280 10 day1  23.79540 11 day1  23.33252 12 day1  20.09107 13 day1  20.90508 14 day1  16.54755 15 day1  10.56084 16 day1  17.61916 17 day1  19.99282 18 day1  20.54418 19 day1  18.38454 20 day1  37.85092 1 day2  29.79049 2 day2  23.85790 3 day2  32.38066 4 day2  28.36341 5 day2  29.43509 6 day2  29.92492 7 day2  28.72727 8 day2  35.42817 9 day2  38.60877 10 day2  26.37381 11 day2  28.04359 12 day2  27.41671 13 day2  32.96870 14 day2  42.34004 15 day2  29.11271 16 day2  29.85050 17 day2  24.02582 18 day2  31.26926 19 day2  26.03427 20 day2  45.98557 1 day3  44.31836 2 day3  33.84533 3 day3  38.31360 4 day3  43.94651 5 day3  39.66407 6 day3  40.60591 7 day3  35.66862 8 day3  37.71101 9 day3  43.11171 10 day3  40.27382 11 day3  37.35554 12 day3  31.92775 13 day3  38.20757 14 day3  40.15106 15 day3  35.13515 16 day3  42.89976 17 day3  41.31063 18 day3  39.06312 19 day3  47.16056 20 day3    \r    åŸ·è¡ŒANOVA\nANOVAresults \u0026lt;- aov(WPM~Practice + Error(Subjects/Practice), AllData)\r   å ±è¡¨\nsummary(ANOVAresults)\r#\u0026gt; #\u0026gt; Error: Subjects\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F)\r#\u0026gt; Residuals 19 349 18.37 #\u0026gt; #\u0026gt; Error: Subjects:Practice\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; Practice 2 4004 2002.0 90.74 3.38e-15 ***\r#\u0026gt; Residuals 38 838 22.1 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;) #\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 30.08826 #\u0026gt; #\u0026gt; Practice #\u0026gt; Practice\r#\u0026gt; day1 day2 day3 #\u0026gt; 19.84 30.59 39.83\r   \rå…¨éƒ¨ç¨‹å¼ç¢¼\rday1\u0026lt;-rnorm(20, mean = 20, sd = 5)\rday2\u0026lt;-rnorm(20, mean = 30, sd = 5)\rday3\u0026lt;-rnorm(20, mean = 40, sd = 5)\rday1[day1\u0026lt;0]\u0026lt;-0\rday2[day2\u0026lt;0]\u0026lt;-0\rday3[day3\u0026lt;0]\u0026lt;-0\rWPM\u0026lt;-c(day1,day2,day3)\rSubjects\u0026lt;-c(seq(1,20), seq(1,20), seq(1,20))\rSubjects\u0026lt;-factor(Subjects)\rPractice\u0026lt;-c(rep(\u0026quot;day1\u0026quot;,20), rep(\u0026quot;day2\u0026quot;,20), rep(\u0026quot;day3\u0026quot;,20))\rAllData\u0026lt;-data.frame(Subjects,Practice,WPM)\rANOVAresults\u0026lt;-aov(WPM~Practice + Error(Subjects/Practice), AllData)\rsummary(ANOVAresults)\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)  å¯«ç·Šæ¹Šé»\nWPM\u0026lt;-rnorm(60,c(20,30,40),5)\rWPM[WPM\u0026lt;0]\u0026lt;-0\rSubjects\u0026lt;-factor(rep(seq(1,20),each=3))\rPractice\u0026lt;-rep(c(\u0026quot;day1\u0026quot;,\u0026quot;day2\u0026quot;,\u0026quot;day3\u0026quot;),20)\rAllData\u0026lt;-data.frame(Subjects,Practice,WPM)\rANOVAresults\u0026lt;-aov(WPM~Practice + Error(Subjects/Practice), AllData)\rsummary(ANOVAresults)\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)   Simulating data for a one-way between subjects design with 3 levels between-subjects design with 60 subjects\nè¨­è¨ˆä¸€å€‹è¨˜æ†¶å¯¦é©—,å€‹é«”60å€‹åˆ†æˆä¸‰çµ„,å—æ¸¬è€…è®€20å€‹å­—çš„åˆ—è¡¨ã€‚ç„¶å¾Œåˆ†ç‚ºé¦¬ä¸Š,1å°æ™‚,2å°æ™‚å€™é»˜å¯«å‡ºä¾†çœ‹åˆ°çš„å­—ã€‚ é æ¸¬æ˜¯å»¶é²æ„ˆä¹…,æ­£ç¢ºç‡æ„ˆå·® DVæ˜¯æ­£ç¢ºçš„å­—ã€‚ IVæ˜¯å»¶é²çš„å°æ™‚æ•¸ã€‚ å€‹é«”ç·¨è™Ÿå¾1åˆ°60ã€‚\nThe DV could be the number of words recalled, this number would range between 0 and 20. There are 20 subjects and 2 conditions, so the DV should have 60 observations. The variables for the DV, and Subjects and Delay factors can be constructed in a similar manner to the previous example. The major difference being that the Subjects factor will contain the numbers 1-60, reflecting the fact that 60 different subjects completed the experiment. The following code creates the complete data frame and runs the ANOVA.\nRecall\u0026lt;-c(rnorm(20,mean=17,sd=3),rnorm(20,mean=15,sd=3),rnorm(20,mean=12, sd=3))\rRecall[Recall\u0026gt;20]\u0026lt;-20\rRecall[Recall\u0026lt;0]\u0026lt;-0\rSubjects\u0026lt;-factor(seq(1,60))\rDelay\u0026lt;-c(rep(\u0026quot;Immediate\u0026quot;,20), rep(\u0026quot;1Hour\u0026quot;,20), rep(\u0026quot;2Hour\u0026quot;,20))\rAllData\u0026lt;-data.frame(Subjects,Recall,Delay)\rANOVAresults\u0026lt;-aov(Recall~Delay, AllData)\rsummary(ANOVAresults)\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; Delay 2 228.6 114.29 11.58 6.02e-05 ***\r#\u0026gt; Residuals 57 562.6 9.87 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)\r#\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 13.98015 #\u0026gt; #\u0026gt; Delay #\u0026gt; Delay\r#\u0026gt; 1Hour 2Hour Immediate #\u0026gt; 15.123 11.233 15.585\r Using the aov function for within or between-subjects designs The aov function is used for within, between and mixed design ANOVAs. The aov formula has the following syntax:\naov(formula,dataframe)\r dataframe refers to the name of the variable containing the data. The formula parameter defines the nature of the ANOVA. Here are some examples of the formula for different single and multi-factor between subject designs. The term DV will refer the name of the dependent variable, and IV for the name of the independent variable.\nBetween subjects ANOVA formulas  Single-factor design  aov(DV~IV, dataframe)   2 IVs  aov(DV~IV1*IV2, dataframe)   3 IVs  aov(DV~IV1*IV2*IV3, dataframe)    The main differences between these formulas are the additional IV variables. Each additional variable is multiplied to the others.\nThe aov formula changes in an important way for within-subjects designs. This is because within-subjects designs use an error term that incorporates the Subjects variable. This error term needs to be explicitly defined in the aov formula. It is also important that the subjects variable in the dataframe is defined as a factor. Here are some examples:\nWithin subjects ANOVA formulas (all factors within)  Single-factor design  aov(DV~IV + Error(Subjects/IV), dataframe)   2 IVs  aov(DV~IV1*IV2 + Error(Subjects/IV1*IV2), dataframe)   3 IVs  aov(DV~IV1*IV2*IV3 + Error(Subjects/IV1*IV2*IV3), dataframe)    Mixed design ANOVAs with between and within factors For these examples IVB will refer to between subject variables, and IVW will refer to within subjects variables\n One between IV and one within IV  aov(DV~IVB*IVW + Error(Subjects/IVW), dataframe)   One between IV and two Within IVs  aov(DV~IVBIVW1IVW2 + Error(Subjects/(IVW1*IVW2), dataframe)   Two between IVs and two Within IVs  aov(DV~IVB1IVB2IVW1IVW2 + Error(Subjects/(IVW1IVW2)+(IVB1*IVB2), dataframe)    note: in this last example an additional error term is added for the interaction between the two between subject variables.\nSimulating data for multi-factor designs 2x2 between subjects design The following code assumes 20 subjects per group (80 total). IV1 has two levels. IV2 has two levels.\nDV\u0026lt;-rnorm(80,c(100,200,300,400),sd=10)\rIV1\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=2,20)\rIV2\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=1,40)\rAllData\u0026lt;-data.frame(DV,IV1,IV2)\rANOVAresults\u0026lt;-aov(DV~IV1*IV2, AllData)\rsummary(ANOVAresults)\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IV1 1 794236 794236 8079.683 \u0026lt;2e-16 ***\r#\u0026gt; IV2 1 225846 225846 2297.506 \u0026lt;2e-16 ***\r#\u0026gt; IV1:IV2 1 6 6 0.062 0.805 #\u0026gt; Residuals 76 7471 98 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)\r#\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 248.7171 #\u0026gt; #\u0026gt; IV1 #\u0026gt; IV1\r#\u0026gt; level1 level2 #\u0026gt; 149.1 348.4 #\u0026gt; #\u0026gt; IV2 #\u0026gt; IV2\r#\u0026gt; level1 level2 #\u0026gt; 195.58 301.85 #\u0026gt; #\u0026gt; IV1:IV2 #\u0026gt; IV2\r#\u0026gt; IV1 level1 level2\r#\u0026gt; level1 95.7 202.5 #\u0026gt; level2 295.5 401.2\r 2x2 within subjects designs The following code assumes 20 subjects participating in each condition. IV1 has two levels. IV2 has two levels.\nSubjects\u0026lt;-factor(rep(seq(1,20),each=4)) DV\u0026lt;-rnorm(80,c(100,200,300,400),sd=10)\rIV1\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=2,20)\rIV2\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=1,40)\rAllData\u0026lt;-data.frame(DV,IV1,IV2)\rANOVAresults\u0026lt;-aov(DV~IV1*IV2 + Error(Subjects/(IV1*IV2)), AllData)\rsummary(ANOVAresults)\r#\u0026gt; #\u0026gt; Error: Subjects\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F)\r#\u0026gt; Residuals 19 1802 94.82 #\u0026gt; #\u0026gt; Error: Subjects:IV1\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IV1 1 775293 775293 7672 \u0026lt;2e-16 ***\r#\u0026gt; Residuals 19 1920 101 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r#\u0026gt; #\u0026gt; Error: Subjects:IV2\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IV2 1 177718 177718 1979 \u0026lt;2e-16 ***\r#\u0026gt; Residuals 19 1706 90 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r#\u0026gt; #\u0026gt; Error: Subjects:IV1:IV2\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F)\r#\u0026gt; IV1:IV2 1 0 0.03 0 0.987\r#\u0026gt; Residuals 19 2011 105.86\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)\r#\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 248.1555 #\u0026gt; #\u0026gt; IV1 #\u0026gt; IV1\r#\u0026gt; level1 level2 #\u0026gt; 149.7 346.6 #\u0026gt; #\u0026gt; IV2 #\u0026gt; IV2\r#\u0026gt; level1 level2 #\u0026gt; 201.02 295.29 #\u0026gt; #\u0026gt; IV1:IV2 #\u0026gt; IV2\r#\u0026gt; IV1 level1 level2\r#\u0026gt; level1 102.6 196.8 #\u0026gt; level2 299.4 393.8\r 2x2 mixed design (1 within, 1 between) The following code assumes 40 total subjects. 20 participate in each level of IVB, and all participate in each level of IVW. IVB has two levels, IVW has two levels\nSubjects\u0026lt;-factor(c(rep(seq(1,40),each=2)))\rDV\u0026lt;-rnorm(80,c(100,200,300,400),sd=10)\rIVB\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=2,20)\rIVW\u0026lt;-rep(c(\u0026quot;level1\u0026quot;,\u0026quot;level2\u0026quot;),each=1,40)\rAllData\u0026lt;-data.frame(DV,IVB,IVW)\rANOVAresults\u0026lt;-aov(DV~IVB*IVW + Error(Subjects/(IVW)), AllData)\rsummary(ANOVAresults)\r#\u0026gt; #\u0026gt; Error: Subjects\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IVB 1 790598 790598 7723 \u0026lt;2e-16 ***\r#\u0026gt; Residuals 38 3890 102 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r#\u0026gt; #\u0026gt; Error: Subjects:IVW\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IVW 1 194722 194722 2049.830 \u0026lt;2e-16 ***\r#\u0026gt; IVB:IVW 1 188 188 1.983 0.167 #\u0026gt; Residuals 38 3610 95 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)\r#\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 250.7302 #\u0026gt; #\u0026gt; IVB #\u0026gt; IVB\r#\u0026gt; level1 level2 #\u0026gt; 151.3 350.1 #\u0026gt; #\u0026gt; IVW #\u0026gt; IVW\r#\u0026gt; level1 level2 #\u0026gt; 201.39 300.07 #\u0026gt; #\u0026gt; IVB:IVW #\u0026gt; IVW\r#\u0026gt; IVB level1 level2\r#\u0026gt; level1 103.5 199.1 #\u0026gt; level2 299.3 401.0\r Power analysis and sample-size planning by Monte Carlo simulation The above code blocks show examples of simulating data in a few different designs, and then analyzing the simulated data with an ANOVA. By repeating this process many times for any given design, we can estimate statistical properties of the design that should hold over the long run. For example, how often does the design produce a â€˜significantâ€™ (p\u0026lt;.05) effect? This can be estimated by running 1000s of independent simulations, computing and saving the p-value from each simulation, and then determining the proportion of p-values less than .05 from the distribution of simulated p-values. In principle, long-run expectations for any other statistic of a simulated design could be estimated in this way as well. In addition, design simulations can be constructed down to the level of individual trial data for individual subjects, which can aid in sample-size and cell-size planning. Some example monte-carlo simulations are presented below.\nMonte-Carlo one-sample T-test Simulation The following simulates 25 sample means from a normal distribution (mu=100, sd=10), and then conducts a one-sample t-test against the population mean of 100. This is equivalent to simulating the null. The simulation is repeated 1000 times, each time the observed p-value is saved.\nsims_to_run\u0026lt;-1000\rsave_p \u0026lt;- vector(length=sims_to_run)\rfor(i in 1:sims_to_run){\rsim_data \u0026lt;- rnorm(25,100,10)\rt.out \u0026lt;-t.test(sim_data,mu=100)\rsave_p[i] \u0026lt;- t.out$p.value\r}\rhist(save_p)\r figure\r proportion_sig\u0026lt;-length(save_p[save_p\u0026lt;.05])/sims_to_run\rproportion_sig\r#\u0026gt; [1] 0.054\r As expected, the histogram of simulated p-values is roughly uniform, indicating that all possible p-values are equally likely. In other words, chance would be expected to produce p\u0026lt;.05 about 5% of the time. The calculated proportion of significant values was 0.043. In general, as the number of simulated runs increases toward infinity, the estimated parameter should settle on itâ€™s true expected value.\nMonte-Carlo paired T-test Simulation 25 subjects, with expected mean 100 in Condition 1 and mean 110 in Condition 2, with standard deviation 30. This simulation includes a programmed difference of 10, so there is a true effect.\nsims_to_run\u0026lt;-1000\rsave_p \u0026lt;- vector(length=sims_to_run)\rfor(i in 1:sims_to_run){\rcondition_1 \u0026lt;- rnorm(25,100,30)\rcondition_2 \u0026lt;- rnorm(25,110,30)\rt.out \u0026lt;-t.test(condition_1,condition_2,paired=TRUE,var.equal = TRUE)\rsave_p[i] \u0026lt;- t.out$p.value\r}\rhist(save_p)\r figure\r proportion_sig\u0026lt;-length(save_p[save_p\u0026lt;.05])/sims_to_run\rproportion_sig\r#\u0026gt; [1] 0.217\r [1] 0.223\nThe histogram of p-values is skewed left, so this design is more likely to produce p\u0026lt;.05 than not, but the statistical power (or proportion of significant simulations) is only 0.223.\nTo determine the number of subjects needed to achieve power = .8, you could fiddle with the number of subjects until you find the number, or you could add another loop to run multiple monte carlo simulations with difference numbers of subjects.\nsubject_numbers\u0026lt;-c(25,50,75,100,125,150,175,200)\rpower\u0026lt;-vector(length=length(subject_numbers))\rfor(subnum in 1:length(subject_numbers)){\rsims_to_run\u0026lt;-1000\rsave_p \u0026lt;- vector(length=sims_to_run)\rfor(i in 1:sims_to_run){\rcondition_1 \u0026lt;- rnorm(subject_numbers[subnum],100,30)\rcondition_2 \u0026lt;- rnorm(subject_numbers[subnum],110,30)\rt.out \u0026lt;-t.test(condition_1,condition_2,paired=TRUE,var.equal = TRUE)\rsave_p[i] \u0026lt;- t.out$p.value\r}\rpower[subnum]\u0026lt;-length(save_p[save_p\u0026lt;.05])/sims_to_run\r}\rpower_table\u0026lt;-data.frame(subject_numbers,power)\rkable(power_table)\r    subject_numbers power     25 0.201   50 0.389   75 0.523   100 0.656   125 0.744   150 0.821   175 0.871   200 0.917    subject_numbers\tpower 25\t0.213 50\t0.359 75\t0.503 100\t0.651 125\t0.747 150\t0.811 175\t0.871 200\t0.895\nMonte-Carlo One-way Repeated Measures Simulation The above simulations estimated individual subject sample means by drawing values directly from distributions. The individual trial data for each subject can also be simulated if desired. This can be useful for design planning as both the number of subjects and cell-size determine the power of the design. Depending on the situation, increasing the number of trials may do more for improving the sensitivity of the design than increasing the number of subjects, or vice-versa. To illustrate, the following example simulates individual trial data for subjects in a Stroop experiment. The retimes package is used to generate RT distributions.\nBefore simulating an entire experiment it is worth simulating a Stroop effect for a single simulated subject. This shows the variance of Stroop effects given programmed values for the mean difference between congruent and incongruent trials, values of mu, sigma, and tau for the base RT distributions, as well as number of trials.\nlibrary(retimes)\r#\u0026gt; Error in library(retimes): ä¸å­˜åœ¨å« 'retimes' é€™å€‹åç¨±çš„å¥—ä»¶\rlibrary(ggplot2)\rstroop_effects\u0026lt;-c()\rn_trials \u0026lt;- 144\rsim_mu \u0026lt;- 600\rsim_sigma \u0026lt;- 80\rsim_tau \u0026lt;- 150\rcongruency_effect \u0026lt;- 100\rfor(i in 1:1000){\rCongruentRTs \u0026lt;- rexgauss(n_trials,mu=sim_mu,sigma=sim_sigma,tau=sim_tau)\rIncongruentRTs \u0026lt;- rexgauss(n_trials,mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)\rstroop_effects \u0026lt;- c(stroop_effects,mean(IncongruentRTs)-mean(CongruentRTs))\r}\r#\u0026gt; Error in rexgauss(n_trials, mu = sim_mu, sigma = sim_sigma, tau = sim_tau): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;rexgauss\u0026quot;\rqplot(stroop_effects)+xlab(\u0026quot;Simulated Stroop Effects\u0026quot;)+geom_bar(fill=\u0026quot;white\u0026quot;,color=\u0026quot;black\u0026quot;)\r figure\r  ??? stat_bin() using bins = 30. Pick better value with binwidth. The histogram shows that under the simulated parameters, the programmed Stroop effect of 100ms can easily take a value -from 50 to 150. The variance in the simulated Stroop effect for a single subject is determined by the variance in the underlying RT distributions for the congruent and incongruent conditions.\n The following simulation expands on the above to model multiple subjects in a Stroop experiment. We start with a minimum number of 10 trials per condition, in an Experiment with 20 subjects, and programmed Stroop effect of 50ms.\nsims_to_run\u0026lt;-100\rn_trials \u0026lt;- 10\rsim_mu \u0026lt;- 600\rsim_sigma \u0026lt;- 80\rsim_tau \u0026lt;- 150\rcongruency_effect \u0026lt;- 50\rn_subjects \u0026lt;- 20\rsave_p\u0026lt;-vector(length=sims_to_run)\rfor(i in 1:sims_to_run){\rall_subjects\u0026lt;-data.frame()\rfor(sub in 1:n_subjects){\rCongruentRTs \u0026lt;- rexgauss(n_trials,mu=sim_mu,sigma=sim_sigma,tau=sim_tau)\rIncongruentRTs \u0026lt;- rexgauss(n_trials,mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)\rtemp_subject \u0026lt;- data.frame(subject=rep(sub,n_trials*2),\rcondition=rep(c(\u0026quot;Congruent\u0026quot;,\u0026quot;Incongruent\u0026quot;),each=n_trials),\rRTs=c(CongruentRTs,IncongruentRTs))\rall_subjects\u0026lt;-rbind(all_subjects,temp_subject)\r}\rmean_subject_data\u0026lt;-aggregate(RTs~subject*condition,all_subjects,mean)\raov.out\u0026lt;-summary(aov(RTs~condition+Error(subject/condition),mean_subject_data))\rsave_p[i]\u0026lt;-aov.out[[3]][[1]][[5]][1]\r}\r#\u0026gt; Error in rexgauss(n_trials, mu = sim_mu, sigma = sim_sigma, tau = sim_tau): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;rexgauss\u0026quot;\rhist(save_p)\r#\u0026gt; Error in hist.default(save_p): 'x' å¿…é ˆæ˜¯æ•¸å€¼\rproportion_sig\u0026lt;-length(save_p[save_p\u0026lt;.05])/sims_to_run\r Tith these minimum trial counts, the power is 0.26 to detect the Stroop effect. Estimated power will increase with increasing numbers of subjects and/or trials in the simulated design. The last simulation shows how power increases as function of increasing trial counts.\nsims_to_run\u0026lt;-100\rn_trials \u0026lt;- c(10,20,30,40,50,60,70)\rsim_mu \u0026lt;- 600\rsim_sigma \u0026lt;- 80\rsim_tau \u0026lt;- 150\rcongruency_effect \u0026lt;- 50\rn_subjects \u0026lt;- 20\rsave_p\u0026lt;-vector(length=sims_to_run)\rproportion_sig\u0026lt;-vector(length=length(n_trials))\rfor(trials in 1:length(n_trials)){\rfor(i in 1:sims_to_run){\rall_subjects\u0026lt;-data.frame()\rfor(sub in 1:n_subjects){\rCongruentRTs \u0026lt;- rexgauss(n_trials[trials],mu=sim_mu,sigma=sim_sigma,tau=sim_tau)\rIncongruentRTs \u0026lt;- rexgauss(n_trials[trials],mu=sim_mu+congruency_effect,sigma=sim_sigma,tau=sim_tau)\rtemp_subject \u0026lt;- data.frame(subject=rep(sub,n_trials[trials]*2),\rcondition=rep(c(\u0026quot;Congruent\u0026quot;,\u0026quot;Incongruent\u0026quot;),each=n_trials[trials]),\rRTs=c(CongruentRTs,IncongruentRTs))\rall_subjects\u0026lt;-rbind(all_subjects,temp_subject)\r}\rmean_subject_data\u0026lt;-aggregate(RTs~subject*condition,all_subjects,mean)\raov.out\u0026lt;-summary(aov(RTs~condition+Error(subject/condition),mean_subject_data))\rsave_p[i]\u0026lt;-aov.out[[3]][[1]][[5]][1]\r}\rproportion_sig[trials]\u0026lt;-length(save_p[save_p\u0026lt;.05])/sims_to_run\r}\r#\u0026gt; Error in rexgauss(n_trials[trials], mu = sim_mu, sigma = sim_sigma, tau = sim_tau): æ²’æœ‰é€™å€‹å‡½å¼ \u0026quot;rexgauss\u0026quot;\rkable(data.frame(n_trials,proportion_sig))\r    n_trials proportion_sig     10 FALSE   20 FALSE   30 FALSE   40 FALSE   50 FALSE   60 FALSE   70 FALSE    Analysing data from a file This tutorial comes with a folder containing several data files. All of these files are .txt files that you can open and view in any text editor. Each of the files has data formatted in a specific way, called long format. The first line of each file contains headers or names for each of the columns of data in the file. For example, The SingleFactor_Between.txt file contains 61 lines of text. The first few lines should like something like this (except the text file will not include the number signs).\nAllData[1:5,]\r DV IVB IVW   90.84322 level1 level1  199.66018 level1 level2  298.69142 level2 level1  385.57085 level2 level2  93.92569 level1 level1     The Subjects column refers to individual subjects in the data file. Each number corresponds to a unique subject. The IV1 column refers to the single independent variable or factor in this data file. There are three levels: Group1, Group2, and Group3. If you scroll down the lines of the data file you will see that subjects 1-20 are associated with Group1, subjects 21-40 are associated with Group2, and subjects 41-60 are associated with Group3. The final column DV stands for the dependent variable, and the numbers in this column represent mean values for each subject in each condition.\nReading data into R There are several ways to import data into R. We focus on using the read.table function (but see also scan). To use read.table you will need to tell R where it can find your data files. In R studio look at the bottom right panel, and find the â€œFilesâ€ tab. When you click on the â€œFilesâ€ tab you should see the current working directory. Use the file section to navigate to the folder on your computer that contains the data files. When you have succesfully done this you will see the data files listed in the bottom-right window. Now you want to set the current working directoy to this folder (that contains the data files). Choose the option â€œMoreâ€, listed underneath the â€œfilesâ€ tab. You should see an option to â€œset as working directoryâ€. Click this option. Now R will be able to find your data files.\nThe next step is to input the data file into a variable in R. If you have correctly set the working directory then type the second line of code into the R terminal on the bottom left window of R-studio, then press enter. The first line of code shows how the working directory can be set with a script.\nAllData\u0026lt;-read.table(\u0026quot;RFiles/SingleFactor_Between.txt\u0026quot;,header=TRUE,sep=\u0026quot;\\t\u0026quot;) You should now see a variable called AllData appear in the workspace (top right window). If you type AllData into the terminal and press enter, you should see R list your data file in the terminal.\n5.11 Running an ANOVA for a single-factor design between-subjects design We have already used the aov function to conduct ANOVAs on our simulated data sets. The same function is used to anlayse data inputted into R. In this case, the data file that we have inputted is already structured in long-format, and R reads the data in as a dataframe object. So, to conduct the ANOVA we simply need to write the following:\nsummary(aov(DV~IV1,AllData))\r#\u0026gt; Df Sum Sq Mean Sq F value Pr(\u0026gt;F) #\u0026gt; IV1 1 790598 790598 304.7 \u0026lt;2e-16 ***\r#\u0026gt; Residuals 78 202410 2595 #\u0026gt; ---\r#\u0026gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r In the above print-out, the Df column refers to degrees of freedom, Sum Sq refers to the sum of squares, Mean Sq refers to Mean squared error, F-value is the F-statistic, and Pr(\u0026gt;F) is the p-value.\nWe can see that the p-value is .0166, indicating significance. This means that at least one of the three groups is significantly different from the others. However, the ANOVA alone does not tell us either the means of each group, or which ones are significantly different from each other. This requires specific comparisons between levels.\nThe summary function does not provide descriptive statistics, so we are unable to see the means for each condition. One option to view the means is to use thethe aggregate function.\naggregate(DV~IV1,AllData,mean)\r \rIV1 DV   level1 151.3196  level2 350.1408     It is worth pointing out that although the summary function does not immediately display the means for each condition, it does create a data structure that represents this information. And, the means can be found using model.tables in the following way.\naovResults\u0026lt;-aov(DV~IV1,AllData)\rprint(model.tables(aovResults,\u0026quot;means\u0026quot;),digits=6)\r#\u0026gt; Tables of means\r#\u0026gt; Grand mean\r#\u0026gt; #\u0026gt; 250.7302 #\u0026gt; #\u0026gt; IV1 #\u0026gt; IV1\r#\u0026gt; level1 level2 #\u0026gt; 151.320 350.141\r We see that the mean for Group 1 is numerically smaller than the mean for Group 2, which is numerically smaller than the mean for Group 3. We can conclude, based on the ANOVA, that the largest and smallest means are different from each other, so we know that the mean for Group 1 was significantly smaller than the mean for Group 3. We need to perform a follow-up t-test to determine whether Group 1 is different from Group 2, and yet another test to determine if Group 2 is different from Group 3.\nThe design is between-subjects, so the appropriate t-test is an independent samples t-test. We can conduct this test comparing groups 1 and 2 using the t.test function as follows:\nt.test(AllData[AllData$IV1==\u0026quot;Group1\u0026quot;,]$DV,AllData[AllData$IV1==\u0026quot;Group2\u0026quot;,]$DV,var.equal=TRUE)\r#\u0026gt; Error in t.test.default(AllData[AllData$IV1 == \u0026quot;Group1\u0026quot;, ]$DV, AllData[AllData$IV1 == : not enough 'x' observations\r We see that the p-value is p=0.06831, which is not \u0026lt;.05. So, Group 1 is not significantly different than Group 2.\nWe can run an additional t-test comparing Group 2 and Group 3 using the following:\nt.test(AllData[AllData$IV1==\u0026quot;Group2\u0026quot;,]$DV,AllData[AllData$IV1==\u0026quot;Group3\u0026quot;,]$DV,var.equal=TRUE)\r#\u0026gt; Error in t.test.default(AllData[AllData$IV1 == \u0026quot;Group2\u0026quot;, ]$DV, AllData[AllData$IV1 == : not enough 'x' observations\r Again, we see that the difference is not significant (p=.284). So Group 2 is not significantly different from Group 3.\nPrettier results using kable and broom The results of anovas or t-tests arenâ€™t appealing look to at when they are printed to the console, and often look cluttered when printed to a .pdf or .html file using Rmarkdown. The kable function from the package knitr, and the xtable function from the xtable package can help with improving the look and feel of ANOVA and other tables.\nlibrary(knitr)\rlibrary(xtable)\raov.out \u0026lt;- summary(aov(DV~IV1,AllData))\rkable(xtable(aov.out),format='markdown')\r     Df Sum Sq Mean Sq F value Pr(\u0026gt;F)     IV1 1 790597.8 790597.753 304.6624 0   Residuals 78 202409.7 2594.996 NA NA   Df\tSum Sq\tMean Sq\tF value\tPr(\u0026gt;F)        IV1\t2\t101780.0\t50890.02\t4.405401\t0.0166327        Residuals\t57\t658448.8\t11551.73\tNA\tNA        The results from t-tests can be prettified using broom         library(broom)\rkable(tidy(t.test(DV~IV1,AllData[AllData$IV1!=\u0026quot;Group1\u0026quot;,], paired=TRUE)))\r#\u0026gt; Error in model.frame.default(formula = DV ~ IV1, data = AllData[AllData$IV1 != : è®Šæ•¸çš„é•·åº¦ä¸ä¸€æ¨£('IV1')\r estimate\tstatistic\tp.value\tparameter\tconf.low\tconf.high\tmethod\talternative -33.88101\t-1.06247\t0.3013409\t19\t-100.6253\t32.86325\tPaired t-test\ttwo.sided\nWriting up the results The preceding section covered the steps of loading a data-file into R. The data-file was for a single-factor between subjects design with 3 levels, and 20 subjects per level. An ANOVA revealed a significant effect, and the post-hoc t-tests showed that the only significant result was between Group 1 and 2. With all of this information in hand it is now possible to write-up a complete results section for this analysis. Here is an example:\nMean reaction times for each subject in each condition were submitted to a one-way ANOVA. The main effect of group was significant, F(2,57) = 4.405, MSE = 11552, p\u0026lt;.016. The mean reaction times were 490 ms, 555 ms, and 589 ms, for groups one, two, and three, respectively. Follow-up comparisons showed that group one was not significantly different from group two, t(38)=1.876, p=.068. Similarly, group 2 was not significantly different from group 3, t(38)=1.086, p=.284.\nRunning a between subjects ANOVA for a 2x2 Factorial design The data file 2x2Factorial_Between.txt contains simulated data for a classic memory experiment performed by Godden \u0026amp; Baddeley (1975). The purpose of their experiment was to test the role of contextual information in guiding memory retrieval. They had different groups of subjects encode a list of words for a later memory test in one of two contexts, either on land or under water (the subjects were expert divers). Thus, the first IV was encoding context (land vs. water). In a later memory test the subjects were asked to recall as many words as possible from the list. For the subjects who encoded the words in the land context, half of the subjects performed the recall test on land, and half performed under water. The same was true for the subjects who encoded the words in the under water context. Thus, the second IV was the context of the memory test (Land vs. Water). The purpose of the experiment was to determine whether memory performance would be better when the encoding and test contexts matched (e.g., encoded and tested on land, or encoded and tested under water), compared to when the encoding and test contexts mismathced (e.g., encoded on land but tested under water, or encoded under water but tested on land).\nThe file contains simulated data for 80 subjects. There were four total conditions, and twenty subjects completed each condition. For example, 20 subjects encoded on land and tested on land, 20 subjects encoded on land and tested under water, 20 subjects encoded on land tested under water, and 20 subjects encoded under water and tested under water. The design can be described as a 2 (Encoding context: land vs. water) x 2 (Testing context: land vs. water) between subjects experiment. The dependent variable was proportion of words correctly recalled. The proportion ranges from 0 (no words recalled) to 1 (all words correctly recalled).\nLetâ€™s load the data file into R, then perform the necessary statistical tests to interpret the results. The final product will be a complete results section.\nLoad the data into R\nAllData\u0026lt;-read.table(\u0026quot;RFiles/2x2Factorial_Between.txt\u0026quot;,header=TRUE,sep=\u0026quot;\\t\u0026quot;) Perform a 2x2 ANOVA Note: Accuracy is the name of the column in the data file representing the DV, so it is used in the aov formula. Similarly, TestContext and EncodingContext are the names of the columns representing the IVs, so they are used in the aov formula.\nsummary(aov(Accuracy~TestContext*EncodingContext,AllData))\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r We can see the ANOVA produced two main effects and one interaction. The main effect for test context was not signifcant, and the main effect for encoding context was not significant. However, the interaction between encoding and test context was significant. The p-value is expressed in scientific notation, meaning that 8.79e-13 is really 0.000000000000879. This is definetly p\u0026lt; .05.\nThe next step is to find the means for each main effect, and the means for the interaction.\nThe means for main effect of test context can be found as follows:\naggregate(Accuracy~TestContext,AllData,mean)\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r The means for the main effect of encoding context can be found as follows:\naggregate(Accuracy~EncodingContext,AllData,mean)\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r The means for the interaction between test and encoding context can be found as follows:\naggregate(Accuracy~TestContext*EncodingContext,AllData,mean)\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r The ANOVA shows that the only the interaction is significant. The means for the interaction effect are displayed immediately above. There are four means, corresponding to each of the ways that the encoding context is paired with the test context. The next step is to interpret the pattern of this interaction. In some sense, the question here is the same as interpreting a significant result from ANOVA on a single-factor with 4-levels. A significant result in either case indicates that at least one of the means is different from the other three, but the ANOVA itself does not specify which means are different from each other. That is, the ANOVA alone does not explain the pattern of the means.\nInspecting the numbers we see what is known as a cross-over interaction. If these numbers were graphed in a line chart, we would see that the lines would cross-over. Indeed, the pattern of the cross-over interaction is exactly what was predicted. Remember, the main prediction of the study was that memory accuracy should be better when the encoding and test contexts match than when they mismatch. Memory performance was .83 and .77 in the matching conditions (land/land, water/water). Memory performance was .61 and .60 in the mismatching conditions (water/land, land/water). It is important to keep the predictions in mind when conducting the follow-up tests.\nThere are 6 possible comparisons that can be made to fully explain the interaction pattern. For example, the means between 1\u0026amp;2, 1\u0026amp;3, 1\u0026amp;4, 2\u0026amp;3, 2\u0026amp;4, and 3\u0026amp;4 can all be submitted to separate t-tests. Sometimes it is necessary to conduct all of the possible comparisons, but usually it is only necessary to conduct the comparisons most relevant to the predictions at hand.\nLetâ€™s start with the subjects who encoded words on Land. They should have better memory when they were tested on land than under water. The t-test is:\nt.test(Accuracy~TestContext, data=AllData[AllData$EncodingContext==\u0026quot;Land\u0026quot;,], var.equal=TRUE)\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r Next, the subjects who encoded words under water. They should have better memory memory when they were tested under water than on land. The t-test is:\nt.test(Accuracy~TestContext, data=AllData[AllData$EncodingContext==\u0026quot;Water\u0026quot;,], var.equal=TRUE)\r#\u0026gt; Error in eval(predvars, data, env): æ‰¾ä¸åˆ°ç‰©ä»¶ 'Accuracy'\r These two t-test verify the main predictions of the study. If you look at the original paper, you will see that the authors conducted additional tests to show that there were no significant differences between memory performance in the matching conditions (land/land vs. water/water), and no significant differences between memory performance in the non-matching conditions (land/water vs. water/land).\nWriting up the results section The preceding section produced ANOVA results for a 2x2 between-subjects design, and means for each main effect and interaction, as well as follow-up tests to explain the significant interaction. With all of this information in place it is possible to write-up a complete results section. Here is an example:\nThe mean proportions of correctly recalled words for each subject in each condition were submitted to a 2 (encoding context: land vs. water) x 2 (test context: land vs. water) between-subjects ANOVA. The main effect of encoding context was not significant, F\u0026lt;1. The main effect of test context not significant, F(1,76) = 1.190, MSE = .011, p = .279. The two-way interaction between encoding and test context was significant, F(1,76) = 73.495, MSE = .011, p \u0026lt; .001 . Planned comparisons showed that for participants who encoded words on land, proportion recall was higher when they tested on land (.83) than under water (.61), t(38) = 7.00, p\u0026lt; .001. Similarly, for participants who encoded words under water, proportion recall was higher when they tested under water (.79) than on land (.60), t(38) = 5.23, p\u0026lt; .001.\nNote: The above results section is written with a few guidelines in mind. When a result is not significant some authors decide to simply state that the result was not significant. Some journals may require the author to fully report the F-value, the MSE, and the p-value for all non-significant effects. In the above example, the full report is not given for the first non-significant effect because the F-value was less than 1. In this case, it is often appropriate to simply report that F was less than one. Also notice that the means for the nonsignificant effects were not given. Some journals may require that these means are listed. At the very least it is important that all of the important means can be reconstructed. In this case, the four means from the interaction effect are individually listed; thus, it is is possible for the reader to reconstruct the means for both of the main effects.\nPractice Problems Single factor design with a within-subjects factor The datafile is titled SingleFactor_Within.txt\nThe data file contains simulated data for 20 subjects in a sequence learning task. The dependent variable is ReactionTime. The single independent variable is called Practice, and it has four levels, 1, 2, 3, and 4. Each level represents four different blocks of practicing the sequence. The general prediction is that reaction time should decrease across the four practice blocks. Use R to load the data file and conduct a repeated-measures ANOVA, compute the means for each of the practice blocks, and conduct the necessary paired-samples t-tests. Then write a complete results section for the example data.\nTo get you started the necessary R commands are listed below\nAllData\u0026lt;-read.table(\u0026quot;RFiles/SingleFactor_Within.txt\u0026quot;,header=TRUE,sep=\u0026quot;\\t\u0026quot;)\rsummary(aov(ReactionTime~Practice + Error(as.character(Subjects)/Practice),AllData))\raggregate(ReactionTime~Practice,AllData,mean)\rt.test(AllData[AllData$Practice==\u0026quot;Block1\u0026quot;,]$ReactionTime,AllData[AllData$Practice==\u0026quot;Block2\u0026quot;,]$ReactionTime, paired=TRUE,var.equal=TRUE)\rnote: for the t-test, change the terms Block1 and Block2 to make other comparisons (e.g., Block3 or Block4).\r#\u0026gt; Error: \u0026lt;text\u0026gt;:6:11: æœªé æœŸçš„ç¬¦è™Ÿ\r#\u0026gt; 5: t.test(AllData[AllData$Practice==\u0026quot;Block1\u0026quot;,]$ReactionTime,AllData[AllData$Practice==\u0026quot;Block2\u0026quot;,]$ReactionTime, paired=TRUE,var.equal=TRUE)\r#\u0026gt; 6: note: for the\r#\u0026gt; ^\r 2x2 within-subjects design The datafile is titled 2x2Factorial_Within.txt\nThe data file contains simulated for 20 subjects in a Stroop task. In a Stroop task, participants are presented with color words printed in congruent or incongruent ink-colors. For example, the word blue printed in BLUE color is a congruent item. The word red printed in BLUE is an incongruent item. In the standard task, participants are instructed to identify the ink-color and ignore the word. Typically, reactions are faster for congruent than incongruent items. In this experiment, participants completed the Stroop task with two different instructions. In one phase they were presented with congruent and incongruent items, and were told to identify the ink-color and ignore the word, this is called the NameColor condition. In the other phase, participants were presented with congruent and incongruent items, and were told to identify the word and ignore the ink-color, this is called the NameWord condition. The predictions are that RTs should generally be faster for congruent than incongruent trials. Also, RTs should generally be faster for the word naming task than the color naming task. Finally, there should be an interaction between congruency and task, such that the Stroop effect (difference between incongruent and congruent items) is larger for the name color task than the name word task.\nThere are two IVS. The first IV is Congruency, with the levels Congruent and Incongruent. The second IV is Task, with the levels NameColor and and Name Word. The DV is ReactionTime. Use R to load the data file, then conduct a repeated-measures ANOVA, compute the means for each of the main effects and the interaction, and conduct any necessary paired-sample t-tests. Then write a complete results section for the example data.\nTo get you started here are the neccessary R commands:\nAllData\u0026lt;-read.table(\u0026quot;RFiles/2x2Factorial_Within.txt\u0026quot;,header=TRUE,sep=\u0026quot;\\t\u0026quot;)\rsummary(aov(ReactionTime~Task*Congruency + Error(as.character(Subjects)/(Task*Congruency)),AllData))\r You can also put the results of the aov into a variable\naovResult\u0026lt;-aov(ReactionTime~Task*Congruency + Error(as.character(Subjects)/(Task*Congruency)),AllData)\r Then you can print all of the means for the main effects and interactions using the following:\nmodel.tables(aovResult,\u0026quot;means\u0026quot;)  Loading raw-data into R Using R to analyze the results from real experiments requires that raw data-files are loaded into R and then transformed into a long-format data frame. Depending on how the raw data is formatted this process can be fairly straightforward, or not. The following provides an example of how to load multiple subjects data files into R and then complete an analysis. The example is taken from a Stroop experiment conducted in PsychoPy. Each subjectâ€™s data file is saved as separate .csv files (comma separated value). Each .csv file contains the raw data from a 24 trial Stroop experiment with 12 congruent and 12 incongruent items. The data files are already organized in long-format. The first row contains the columns headers, and each remaining row contains the raw data for each trial. The data files are named Subject1.csv, Subject2.csv, and so on.\nThe following read.table will load a single file into a datafram. However, the working directory must first be set to the location of the file.\nSubject1\u0026lt;-read.table(\u0026quot;RFiles/PsychoPyStroop.csv\u0026quot;,header=TRUE,sep=\u0026quot;,\u0026quot;)\r The ultimate goal here is to load in all 8 subjects worth of data into a single dataframe. This is done using a for loop in R.\nfnames\u0026lt;-c(\u0026quot;RFiles/Subject1.csv\u0026quot;,\u0026quot;RFiles/Subject2.csv\u0026quot;,\u0026quot;RFiles/Subject3.csv\u0026quot;,\u0026quot;RFiles/Subject4.csv\u0026quot;,\u0026quot;RFiles/Subject5.csv\u0026quot;,\u0026quot;RFiles/Subject6.csv\u0026quot;,\u0026quot;RFiles/Subject7.csv\u0026quot;,\u0026quot;RFiles/Subject8.csv\u0026quot;)\rAllSubjectData\u0026lt;-data.frame()\rfor (i in 1:length(fnames)){\rSubjectData\u0026lt;-read.table(fnames[i],header=TRUE,sep=\u0026quot;,\u0026quot;)\rAllSubjectData\u0026lt;-rbind(AllSubjectData,SubjectData)\r}\rCongruencyMeans\u0026lt;-aggregate(KeypressTime.rt~participant*congruency,data=AllSubjectData,mean)\rANOVAresults\u0026lt;-aov(KeypressTime.rt~factor(congruency) + Error(as.character(participant)/factor(congruency)),CongruencyMeans)\rsummary(ANOVAresults)\rmodel.tables(ANOVAresults,\u0026quot;means\u0026quot;)\r"},
{"uri": "/blogR//topic/simulation/4_02_sim.html","title": "4.2 æ¨¡æ“¬åŸºæœ¬ 2",
	"tags": [],
	"description": "4_02_sim",
	"content": "basic dnorm : PDF pnorm : CDF qnorm : inverse CDF rnorm : random\ncdf z_scores \u0026lt;- seq(-3, 3, by = .1)\rpvalues \u0026lt;- pnorm(z_scores)\r# Now we'll plot these values\rplot(pvalues, # Plot where y = values and x = index of the value in the vector\rxaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis\rtype = \u0026quot;l\u0026quot;, # Make it a line plot\rmain = \u0026quot;cdf of the Standard Normal\u0026quot;,\rxlab= \u0026quot;Quantiles\u0026quot;,\rylab=\u0026quot;Probability Density\u0026quot;) # These commands label the x-axis\raxis(1, at=which(pvalues == pnorm(-2)), labels=round(pnorm(-2), 2))\raxis(1, at=which(pvalues == pnorm(-1)), labels=round(pnorm(-1), 2))\raxis(1, at=which(pvalues == pnorm(0)), labels=c(.5))\raxis(1, at=which(pvalues == pnorm(1)), labels=round(pnorm(1), 2))\raxis(1, at=which(pvalues == pnorm(2)), labels=round(pnorm(2), 2))\r figure\r ğŸ‘ axisä¸‹å·¦ä¸Šåˆ(1,2,3,4) ç¬¬2å€‹åƒæ•¸ç”¨çš„æ˜¯è¦é¡¯ç¤ºçš„è™Ÿç¢¼å€¼,å°æ¨£æ¯å€‹æ¨£æœ¬é»ã€‚ å¦‚æœæ˜¯x,y ploté€™å€‹axis()ç„¡ä½œç”¨,é€™è£¡åªç”¨åˆ°Yã€‚\npdf z_scores \u0026lt;- seq(-3, 3, by = .1)\rdvalues \u0026lt;- dnorm(z_scores)\rplot(dvalues, # Plot where y = values and x = index of the value in the vector\rxaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis\rtype = \u0026quot;l\u0026quot;, # Make it a line plot\rmain = \u0026quot;pdf of the Standard Normal\u0026quot;,\rxlab= \u0026quot;Z-score\u0026quot;) # These commands label the x-axis\raxis(1, at=which(dvalues == dnorm(0)), labels=c(0))\raxis(1, at=which(dvalues == dnorm(1)), labels=c(-1, 1))\raxis(1, at=which(dvalues == dnorm(2)), labels=c(-2, 2))\r figure\r pnorm pnorm(2) ## [1] 0.9772499\r#\u0026gt; [1] 0.9772499\rpnorm(2, mean = 5, sd = 3) ## [1] 0.1586553\r#\u0026gt; [1] 0.1586553\rpnorm(2, mean = 5, sd = 3, lower.tail = FALSE)\r#\u0026gt; [1] 0.8413447\r compare oldpar \u0026lt;- par()\rpar(mfrow=c(1,2))\rz_scores \u0026lt;- seq(-3, 3, by = .1)\rpvalues \u0026lt;- pnorm(z_scores)\rquantiles \u0026lt;- seq(0, 1, by = .05)\rqvalues \u0026lt;- qnorm(quantiles)\r# Plot the z_scores\rplot(qvalues,\rtype = \u0026quot;l\u0026quot;, # We want a line graph\rxaxt = \u0026quot;n\u0026quot;, # No x-axis\rxlab=\u0026quot;Probability Density\u0026quot;,\rylab=\u0026quot;Z-scores\u0026quot;)\r# Same pnorm plot from before\rplot(pvalues, # Plot where y = values and x = index of the value in the vector\rxaxt = \u0026quot;n\u0026quot;, # Don't label the x-axis\rtype = \u0026quot;l\u0026quot;, # Make it a line plot\rmain = \u0026quot;cdf of the Standard Normal\u0026quot;,\rxlab= \u0026quot;Quantiles\u0026quot;,\rylab=\u0026quot;Probability Density\u0026quot;) # These commands label the x-axis\raxis(1, at=which(pvalues == pnorm(-2)), labels=round(pnorm(-2), 2))\raxis(1, at=which(pvalues == pnorm(-1)), labels=round(pnorm(-1), 2))\raxis(1, at=which(pvalues == pnorm(0)), labels=c(.5))\raxis(1, at=which(pvalues == pnorm(1)), labels=round(pnorm(1), 2))\raxis(1, at=which(pvalues == pnorm(2)), labels=round(pnorm(2), 2))\r figure\r  qnorm(0.95) ? ä¸€å€‹æ¨™æº–å·®å äº†ä½”äº†å¤šå°‘ç™¾åˆ†æ¯”?  \r\r\rhint\r1. zscore of 95 percent 1. percent\u0026lt;-pnorm(1)-pnorm(-1) simulate 1    èº«é«˜ å¥³ç”Ÿ ç”·ç”Ÿ      1 0   å¹³å‡ 180 170   æ¨™æº–å·® 10 10    fn_num\u0026lt;-100\rfh\u0026lt;-rnorm(fn_num,180,10)\rfm\u0026lt;-rnorm(200-fn_num,170,10)\rheight\u0026lt;-c(fh,fm)\rsex\u0026lt;-c(rep(1,fn_num),rep(0,200-fn_num))\rr1\u0026lt;-tapply(height, sex,mean)\rr1\r#\u0026gt; 0 1 #\u0026gt; 172.0062 179.6464\r fn_num_set\u0026lt;-sample(1:199,1000,replace=T) #å…ˆæŠ½å‡ºfemaleçš„å€‹æ•¸\rrst\u0026lt;-matrix(rep(0,2000),ncol=2) #æ¯ä¸€æ¬¡æŠ½æ¨£ç”·ç”Ÿ/å¥³ç”Ÿçš„å¹³å‡å€¼\rfor(idx in 1:1000)\r{\rfn_num \u0026lt;-fn_num_set[idx]\rfh\u0026lt;-rnorm(fn_num,180,10)\rfm\u0026lt;-rnorm(200-fn_num,170,10)\rheight\u0026lt;-c(fh,fm)\rsex\u0026lt;-c(rep(1,fn_num),rep(0,200-fn_num))\rr1\u0026lt;-tapply(height, sex,mean)\rrst[idx,1]=r1[1]\rrst[idx,2]=r1[2]\r}\rsummary(rst)\r#\u0026gt; V1 V2 #\u0026gt; Min. :159.1 Min. :162.6 #\u0026gt; 1st Qu.:169.3 1st Qu.:179.3 #\u0026gt; Median :170.0 Median :180.0 #\u0026gt; Mean :170.0 Mean :180.0 #\u0026gt; 3rd Qu.:170.7 3rd Qu.:180.8 #\u0026gt; Max. :183.7 Max. :198.5\r ä¸‹é¢é€™å€‹,å¥½åƒåœ¨rmarkdown ç•«ä¸å‡ºä¾† unknown reason !!\nalist\u0026lt;-list(rst[,1],rst[,2])\rdinfo\u0026lt;-lapply(alist,density)\rt1\u0026lt;-sapply(dinfo,function(item){range(item$x)})\rrx\u0026lt;-range(t1)\rt2\u0026lt;-sapply(dinfo,function(item){range(item$y)})\rry\u0026lt;-range(t2)\rplot(dinfo[[1]], xlim = rx, ylim = ry, main = \u0026quot;\u0026quot;)\rfor(i in 1:length(dinfo)) {\rlines(dinfo[[i]], xlim = rx, ylim = ry, col = i)\r}  figure\r è½‰å‡½æ•¸\nç¸½é«”è€Œè¨€ï¼Œè½‰æˆå‡½æ•¸çš„è€ƒæ…®å°±æ˜¯å¦‚ä½•é¿å…hard codingã€‚\nplot.multi.density\u0026lt;-function (alist)\r{\rdinfo\u0026lt;-lapply(alist,density)#æ¯çµ„è³‡æ–™ï¼Œæ±‚density\r# æ¯çµ„è³‡æ–™çš„xç¯„åœ\rt1\u0026lt;-sapply(dinfo,function(item){range(item$x)})\rrx\u0026lt;-range(t1)\r# æ¯çµ„è³‡æ–™çš„yç¯„åœ\rt2\u0026lt;-sapply(dinfo,function(item){range(item$y)})\rry\u0026lt;-range(t2)\rplot(dinfo[[1]],xlim = rx, ylim = ry, main = \u0026quot;\u0026quot;)\rfor(i in 1:length(dinfo)) {\rlines(dinfo[[i]],xlim = rx, ylim = ry, col = i)\r} }  è¨è«–ï¼šä¸Šé¢å‡½æ•¸çš„é™åˆ¶ï¼Ÿ ç¬¬ä¸€å€‹é™åˆ¶ï¼Œå…ˆçœ‹çœ‹æœ‰æ²’æœ‰é è¨­çµ„åˆ¥\nå•é¡Œï¼šå¦‚æœè¦åŠ ä¸Šå€åŸŸé¡è‰²ï¼Ÿ ç°¡å–®ä¸€é»çš„è©±ï¼Œå¯ä»¥ç”¨é¸é …type=\u0026quot;h\u0026quot;, (plot, lineå…©å€‹å‡½æ•¸éƒ½åƒ)\næ‡‰ç”¨è‡ªå·±çš„å‡½æ•¸\nalist\u0026lt;-list(rst[,1],rst[,2])\rplot.multi.density(alist)\r figure\r ä¸Šé¢çš„å‡½æ•¸ï¼Œé è¨­åƒæ•¸æ˜¯å‚³å…¥ä½¿ç”¨è€…æŒ‡å®šçš„listï¼Œè£¡é¢æœ‰ä½¿ç”¨è€…æŒ‡å®šçš„çµ„åˆ¥ ä½†æ˜¯å¦‚æœå› ç‚ºéœ€è¦ï¼Œç™¼ç¾å‚³å…¥çŸ©é™£æ¯”è¼ƒæ–¹ä¾¿ï¼ˆä¾‹å¦‚æ¯ä¸€å€‹æ¬„ä½ä»£è¡¨æ¯ä¸€çµ„çš„æ¨¡æ“¬çµæœï¼Œé‚£æ¨£æ€æ¨£é¿å…hard coding?\nelist\u0026lt;-vector(\u0026quot;list\u0026quot;,ncol(rst))#æŒ‡å®šå¤§å°çš„list,å¦‚æœç©ºé›†åˆelist\u0026lt;-list()\rfor(i in 1:ncol(rst)){\relist[[i]]\u0026lt;-rst[,i] #æ³¨æ„é›™æ‹¬è™Ÿ\r}\r ä¹‹å‰æœ‰æéï¼Œå¤§éƒ¨åˆ†çš„æ–‡ä»¶éƒ½æ˜¯èªªå–®/é›™æ‹¬è™Ÿçš„å·®åˆ¥æ˜¯å‰è€…æ‹¿åˆ°çš„ä»ç„¶æ˜¯list,å¾Œè€…æ‹¿åˆ°çš„æ˜¯å…§å®¹ã€‚ ä½†æ˜¯ä»¥ç¨‹å¼èªè¨€çš„çœ¼å…‰ä¾†çœ‹ï¼Œæˆ‘å€‘å…ˆèªªå‡¡æ˜¯é™£åˆ—ï¼Œå…¶å…ƒç´ çš„å‹æ…‹éƒ½åªèƒ½æ”¾ä¸€æ¨£ï¼ˆä¹Ÿå°±æ˜¯å¤§å°å›ºå®šï¼‰ï¼Œä½†æ˜¯ç¾åœ¨listçš„å…ƒç´ å‹æ…‹å¯ä»¥ä¸å–®ä¸€ï¼Œå› æ­¤ï¼Œç·¨è­¯å™¨ç„¡æ³•çŸ¥é“å¦‚ä½•æŒ‡æ´¾å¤§å°ï¼Œè§£æ±ºè¾¦æ³•å°±æ˜¯æ¯ä¸€å€‹å…ƒç´ å…¶å¯¦éƒ½æ˜¯ä¸€å€‹æŒ‡æ¨™ã€‚ ï¼ˆtodo: éœ€è¦ä¸€å€‹åœ–ï¼‰\r\r\råˆ©ç”¨å¥—ä»¶sm The sm package also includes a way of doing multiple density plots. The data must be in a data frame.\nlibrary(sm)\r#\u0026gt; Package 'sm', version 2.2-5.6: type help(sm) for summary information\rrstdf\u0026lt;-data.frame(rst)\rcolnames(rstdf)\u0026lt;-c(\u0026quot;male\u0026quot;,\u0026quot;female\u0026quot;)\rsm.density.compare(rstdf$male, rstdf$female)\r figure\r # Add a legend (the color numbers start from 2 and go up)\r#legend(\u0026quot;topright\u0026quot;, levels(data$cond), fill=2+(0:nlevels(data$cond)))\r sm ç¯„ä¾‹ sm.density.compare(iris$Sepal.Length, iris$Species, xlab=\u0026quot;Species\u0026quot;)\rtitle(main=\u0026quot;Distributions of Species\u0026quot;)\r figure\r x \u0026lt;- seq(from = 110, to = 174, by = 0.5)\ry1 \u0026lt;- dnorm(x, mean = 145, sd = 9)\ry2 \u0026lt;- dnorm(x, mean = 138, sd = 8)\rplot(x, y1, type=\u0026quot;l\u0026quot;, lwd=2, col=\u0026quot;red\u0026quot;,\rmain=\u0026quot;Systolic Blood Pressure Before and After Treatment\u0026quot;,\rxlab = \u0026quot;Systolic Blood Pressure (mmHg)\u0026quot;,\rylab = \u0026quot;Frequency\u0026quot;, yaxt=\u0026quot;n\u0026quot;,\rxlim = c(110, 175), ylim = c(0, 0.05))\rlines(x, y2)\rpolygon(c(110,x,175),c(0,y2,0), col=\u0026quot;firebrick3\u0026quot;,\rborder = \u0026quot;black\u0026quot;)\rpolygon(c(117,x,175),c(0,y1,0), col=\u0026quot;dodgerblue4\u0026quot;,\rborder = \u0026quot;black\u0026quot;)\rylab=c(seq(from=0, to=175, by=25))\ry=c(seq(from=0, to=0.05, length.out = 8))\raxis(2,at=y,labels=ylab, las=1)#ä¸‹å·¦ï¼ˆ2ï¼‰ï¼Œåœ¨yå‘é‡ä¸Šæ¨™ylab,las æ–‡å­—å’Œåº§æ¨™çš„è§’åº¦\rtext(x = 120, y = 0.045, \u0026quot;- Pre-Treatment BP\u0026quot;, col = \u0026quot;dodgerblue4\u0026quot;, cex = 0.9)\rtext(x = 120, y = 0.04, \u0026quot; - Post-Treatment BP\u0026quot;, col = \u0026quot;firebrick3\u0026quot;, cex = 0.9)\rpoints(109, 0.0445, pch = 15, col = \u0026quot;dodgerblue4\u0026quot;)\rpoints(109, 0.0395, pch = 15, col = \u0026quot;firebrick3\u0026quot;)\r figure\r å…¶ä»–æ¸¬è©¦\nx \u0026lt;- seq(-2, 2, 0.05)\ry1 \u0026lt;- pnorm(x)\ry2 \u0026lt;- pnorm(x,1,1)\rplot(x,y1,type=\u0026quot;l\u0026quot;,col=\u0026quot;red\u0026quot;)\rlines(x,y2,col=\u0026quot;green\u0026quot;)\r figure\r plot( x, y1, type=\u0026quot;l\u0026quot;, col=\u0026quot;red\u0026quot; )\rpar(new=TRUE)\rplot( x, y2, type=\u0026quot;l\u0026quot;, col=\u0026quot;green\u0026quot; )\r figure\r note: add=TRUE æœ‰æ™‚å€™ä¸ä½œç”¨ï¼Œä¾‹å¦‚plot\nhist( y1 ,col=\u0026quot;red\u0026quot; )\rhist( y2, add=TRUE,col=\u0026quot;blue\u0026quot; )\r figure\r"},
{"uri": "/blogR//topic/simulation/mc_%E5%9F%BA%E6%9C%AC.html","title": "MC_åŸºæœ¬",
	"tags": [],
	"description": "MC_åŸºæœ¬",
	"content": "äº‚æ•¸ # Sample from a standard normal RV with sample size n=5:\rrnorm(5)\r# A different sample from the same distribution:\rrnorm(5)\r# Set the seed of the random number generator and take two samples:\rset.seed(6254137)\rrnorm(5)\rrnorm(5)\r# Reset the seed to the same value to get the same samples again:\rset.seed(6254137)\rrnorm(5)\rrnorm(5)\r æŠ½æ¨£ rbinom(10,1,0.5) # Bernouli rnorm(10) # normal\r é‡è¤‡æŠ½æ¨£\n# Set the random seed\rset.seed(123456)\r# initialize ybar to a vector of length r=10000 to later store results:\rr \u0026lt;- 10000\rybar \u0026lt;- numeric(r)\r# repeat r times:\rfor(j in 1:r) {\r# Draw a sample and store the sample mean in pos. j=1,2,... of ybar: sample \u0026lt;- rnorm(100,10,2)\rybar[j] \u0026lt;- mean(sample)\r}\r çµæœåˆ†æ\n# The first 20 of 10000 estimates:\rybar[1:20]\r# Simulated mean:\rmean(ybar)\r# Simulated variance:\rvar(ybar)\r# Simulated density:\rplot(density(ybar))\rcurve( dnorm(x,10,sqrt(.04)), add=TRUE,lty=2)\r æ¨¡æ“¬ä¼°è¨ˆ # Set the random seed\rset.seed(123456)\r# Draw a sample given the population parameters\rsample \u0026lt;- rnorm(100,10,2)\r# Estimate the population mean with the sample average\rmean(sample)\r#\u0026gt; [1] 10.03364\r# Draw a different sample and estimate again:\rsample \u0026lt;- rnorm(100,10,2)\rmean(sample)\r#\u0026gt; [1] 9.913197\r# Draw a third sample and estimate again:\rsample \u0026lt;- rnorm(100,10,2)\rmean(sample)\r#\u0026gt; [1] 10.21746\r æ¨¡æ“¬æ¨è«– # Set the random seed\rset.seed(123456)\r# initialize vectors to later store results:\rr \u0026lt;- 10000\rCIlower \u0026lt;- numeric(r); CIupper \u0026lt;- numeric(r)\rpvalue1 \u0026lt;- numeric(r); pvalue2 \u0026lt;- numeric(r)\r# repeat r times:\rfor(j in 1:r) {\r# Draw a sample\rsample \u0026lt;- rnorm(100,10,2)\r# test the (correct) null hypothesis mu=10:\rtestres1 \u0026lt;- t.test(sample,mu=10)\r# store CI \u0026amp; p value:\rCIlower[j] \u0026lt;- testres1$conf.int[1]\rCIupper[j] \u0026lt;- testres1$conf.int[2]\rpvalue1[j] \u0026lt;- testres1$p.value\r# test the (incorrect) null hypothesis mu=9.5 \u0026amp; store the p value:\rpvalue2[j] \u0026lt;- t.test(sample,mu=9.5)$p.value\r}\r# Test results as logical value\rreject1\u0026lt;-pvalue1\u0026lt;=0.05; reject2\u0026lt;-pvalue2\u0026lt;=0.05\rtable(reject1)\r#\u0026gt; reject1\r#\u0026gt; FALSE TRUE #\u0026gt; 9492 508\rtable(reject2)\r#\u0026gt; reject2\r#\u0026gt; FALSE TRUE #\u0026gt; 3043 6957\r"},
{"uri": "/blogR//topic/simulation/poisson%E5%88%86%E9%85%8D.html","title": "Poissonåˆ†é…",
	"tags": [],
	"description": "Poissonåˆ†é…",
	"content": " ç›¸é—œğŸ¤¦â€â™‚ï¸ é‡‘é–€ğŸ¤¦â€â™‚ï¸ ç›´æ¥âœ”  R Functions dpois, ppois, and rpois\n\\( f_X (k;Î»)=P({X=k})=\\frac{Î»^k}{k!} e^{-Î»} \\)ã€€å¹³å‡ \\(Î¼=Î»\\)\nè®Šç•°æ•¸ \\(Ïƒ^2=Î»\\)\n dpois(x, lambda) ppois(q, lambda, lower.tail) is the cumulative probability (lower.tail = TRUE for left tail, lower.tail = FALSE for right tail) of less than or equal to q successes. rpois(n, lambda) ç”¢ç”Ÿäº‚æ•¸ x ~ Poisson distribution(lambda). qpois(p, lambda, lower.tail) returns the value (quantile) at the specified cumulative probability (percentile) p.  Example What is the probability of making 2 to 4 sales in a week if the average sales rate is 3 per week?\n# Using cumulative probability\rppois(q = 4, lambda = 3, lower.tail = TRUE) - ppois(q = 1, lambda = 3, lower.tail = TRUE)\r#\u0026gt; [1] 0.616115\r# Using exact probability\rdpois(x = 2, lambda = 3) +\rdpois(x = 3, lambda = 3) +\rdpois(x = 4, lambda = 4)\r#\u0026gt; [1] 0.6434504\r# expected number of sales = lambda = 3\r# variance = lambda = 3\rlibrary(ggplot2)\rlibrary(dplyr)\r#\u0026gt; #\u0026gt; è¼‰å…¥å¥—ä»¶ï¼š'dplyr'\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:stats':\r#\u0026gt; #\u0026gt; filter, lag\r#\u0026gt; ä¸‹åˆ—ç‰©ä»¶è¢«é®æ–·è‡ª 'package:base':\r#\u0026gt; #\u0026gt; intersect, setdiff, setequal, union\roptions(scipen = 999, digits = 2) # sig digits\revents \u0026lt;- 0:10\rdensity \u0026lt;- dpois(x = events, lambda = 3)\rprob \u0026lt;- ppois(q = events, lambda = 3, lower.tail = TRUE)\rdf \u0026lt;- data.frame(events, density, prob)\rggplot(df, aes(x = factor(events), y = density)) +\rgeom_col() +\rgeom_text(\raes(label = round(density,2), y = density + 0.01),\rposition = position_dodge(0.9),\rsize = 3,\rvjust = 0\r) +\rlabs(title = \u0026quot;PMF and CDF of Poisson Distribution\u0026quot;,\rsubtitle = \u0026quot;P(3).\u0026quot;,\rx = \u0026quot;Events (x)\u0026quot;,\ry = \u0026quot;Density\u0026quot;) +\rgeom_line(data = df, aes(x = events, y = prob))\r figure\r Example\nSuppose a baseball player has a p=.300 batting average. What is the probability of X\u0026lt;=150 hits in n=500 at bats? X=150? X\u0026gt;150?\n# probability of x \u0026lt;= 150\rppois(q = 150, lambda = .300 * 500, lower.tail = TRUE)\r#\u0026gt; [1] 0.52\r# probability of x = 150\rdpois(x = 150, lambda = .300 * 500)\r#\u0026gt; [1] 0.033\r# probability of x \u0026gt; 150\rppois(q = 150, lambda = .300 * 500, lower.tail = FALSE) #\u0026gt; [1] 0.48\rlibrary(ggplot2)\rlibrary(dplyr)\roptions(scipen = 999, digits = 2) # sig digits\rhits \u0026lt;- 0:100 * 3\rdensity \u0026lt;- dpois(x = hits, lambda = .300 * 500)\rprob \u0026lt;- ppois(q = hits, lambda = .300 * 500, lower.tail = TRUE)\rdf \u0026lt;- data.frame(hits, density, prob)\rggplot(df, aes(x = hits, y = density)) +\rgeom_col() +\rlabs(title = \u0026quot;Poisson(150)\u0026quot;,\rsubtitle = \u0026quot;PMF and CDF of Poisson(3) distribution.\u0026quot;,\rx = \u0026quot;Hits (x)\u0026quot;,\ry = \u0026quot;Density\u0026quot;) +\rgeom_line(data = df, aes(x = hits, y = prob))\r figure\r The Poisson distribution approximates the binomial distribution with Î»=np if n\u0026gt;=20 and p\u0026lt;=0.05.\nExample What is the distribution of successes from a sample of n = 50 when the probability of success is p = .03?\nlibrary(ggplot2)\rlibrary(dplyr)\rlibrary(tidyr)\roptions(scipen = 999, digits = 2) # sig digits\rn = 0:10\rdf \u0026lt;- data.frame(events = 0:10, Poisson = dpois(x = n, lambda = .03 * 50),\rBinomial = dbinom(x = n, size = 50, p = .03))\rdf_tidy \u0026lt;- gather(df, key = \u0026quot;Distribution\u0026quot;, value = \u0026quot;density\u0026quot;, -c(events))\rggplot(df_tidy, aes(x = factor(events), y = density, fill = Distribution)) +\rgeom_col(position = \u0026quot;dodge\u0026quot;) +\rlabs(title = \u0026quot;Poisson(15) and Binomial(50, .03)\u0026quot;,\rsubtitle = \u0026quot;Poisson approximates binomial when n \u0026gt;= 20 and p \u0026lt;= .05.\u0026quot;,\rx = \u0026quot;Events (x)\u0026quot;,\ry = \u0026quot;Density\u0026quot;)\r figure\r Example Suppose the probability that a drug produces a certain side effect is p = = 0.1% and n = 1,000 patients in a clinical trial receive the drug. What is the probability 0 people experience the side effect?\n# The expected value is np\r1000 * .001\r#\u0026gt; [1] 1\r# The probability of measuring 0 when the expected value is 1\rdpois(x = 0, lambda = 1000 * .001) #\u0026gt; [1] 0.37\rlibrary(ggplot2)\rlibrary(dplyr)\roptions(scipen = 999, digits = 2) # sig digits\rx \u0026lt;- 0:10\rdensity \u0026lt;- dpois(x = x, lambda = 1000 * .001)\rprob \u0026lt;- ppois(q = x, lambda = 1000 * .001, lower.tail = TRUE)\rdf \u0026lt;- data.frame(x, density, prob)\rggplot(df, aes(x = x, y = density)) +\rgeom_col() +\rgeom_text(\raes(label = round(density,2), y = density + 0.01),\rposition = position_dodge(0.9),\rsize = 3,\rvjust = 0\r) +\rlabs(title = \u0026quot;Poisson(1)\u0026quot;,\rsubtitle = \u0026quot;PMF and CDF of Poisson(1) distribution.\u0026quot;,\rx = \u0026quot;Events (x)\u0026quot;,\ry = \u0026quot;Density\u0026quot;) +\rgeom_line(data = df, aes(x = x, y = prob))\r figure\r"},
{"uri": "/blogR//topic/simulation/central.html","title": "ä¸­å¤®",
	"tags": [],
	"description": "åŒ…æ‹¬ä¸­å¤®æ¥µé™",
	"content": "å¤§æ•¸æ³•å‰‡çš„å¯¦é©— x \u0026lt;-rnorm(1000, 10, 1)\ry \u0026lt;-cumsum(x)/(1:1000)\rplot(y, t ='l')\rabline(h =10)\r figure\r test å“¡å·¥çš„è–ªæ°´åˆ†é…ï¼Œåš´é‡æ‡·ç–‘ä¸æ˜¯å¸¸æ…‹åˆ†é…\n100: -\u0026gt;\n mu\u0026lt;-100 sd\u0026lt;-100 se(stander error) \u0026lt;- /sd/sqrt(100)  1.96\n-1.96*/se , /mu , 1.96* /se\nboot strapping æŠŠæˆ‘å€‘å¾—åˆ°çš„100å€‹æ¨£æœ¬ï¼Œé‡è¤‡æŠ½1000ï¼Œ(æ¯æ¬¡å¿…é ˆæŠ½100å€‹)ç„¶å¾Œå¾—åˆ°1000å€‹å¹³å‡ mu,sd percentile(2.5) , mu, percentile(97.5)\nN\u0026lt;-10\rmetasample\u0026lt;-rnorm(N,5,2)\rbmu\u0026lt;-numeric(1000)\rfor(i in 1:1000){\rrndno\u0026lt;-as.integer(runif(N)*N)+1 smp\u0026lt;-metasample[rndno]\rbmu[i]\u0026lt;-mean(smp)\r}\rp\u0026lt;-density(bmu)\rplot(p)\rqq\u0026lt;-quantile(bmu)\rrug(qq,col=\u0026quot;red\u0026quot;)\r figure\r qq\r#\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 1.694805 4.186672 4.608124 5.090237 6.352302\r N\u0026lt;-100\rmetasample\u0026lt;-rnorm(N,5,2)\rbmu\u0026lt;-numeric(1000)\rfor(i in 1:1000){\rrndno\u0026lt;-as.integer(runif(N)*N)+1 smp\u0026lt;-metasample[rndno]\rbmu[i]\u0026lt;-mean(smp)\r}\rp\u0026lt;-density(bmu)\rplot(p)\rqq\u0026lt;-quantile(bmu)\rrug(qq,col=\u0026quot;red\u0026quot;)\r figure\r qq\r#\u0026gt; 0% 25% 50% 75% 100% #\u0026gt; 4.502879 4.990880 5.127810 5.260000 5.787620\r N\u0026lt;-100\rmetasample\u0026lt;-rnorm(N,5,2)\rhinfo\u0026lt;-hist(metasample)\rlx\u0026lt;-seq(min(metasample),max(metasample),length=100)\rly\u0026lt;-dnorm(lx,mean(metasample),sd(metasample))\rsy\u0026lt;-ly*(diff(lx)[1])*N lines(lx,sy,col=\u0026quot;blue\u0026quot;)\r figure\r N\u0026lt;-100\rmetasample\u0026lt;-rnorm(N,5,2)\rhinfo\u0026lt;-hist(metasample)\rly\u0026lt;-dnorm(hinfo$mids,mean(metasample),sd(metasample))\rsy\u0026lt;-ly*(diff(hinfo$mids)[1])*N lines(hinfo$mids,sy,col=\u0026quot;blue\u0026quot;)\r figure\r"}]
